var zw=Object.defineProperty;var Vw=(e,t,n)=>t in e?zw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var tr=(e,t,n)=>Vw(e,typeof t!="symbol"?t+"":t,n);function Bw(e,t){for(var n=0;n<t.length;n++){const s=t[n];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in e)){const o=Object.getOwnPropertyDescriptor(s,r);o&&Object.defineProperty(e,r,o.get?o:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ww=1e-7,jw=1e-4;class Hw{constructor(t,n){this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,n){this.dataIdsCount++,this.data.set(t,n)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}class sm{refCount(t){return Nn("refCount")}incRef(t){return Nn("incRef")}timerAvailable(){return!0}time(t){return Nn("time")}read(t){return Nn("read")}readSync(t){return Nn("readSync")}readToGPU(t,n){return Nn("readToGPU")}numDataIds(){return Nn("numDataIds")}disposeData(t,n){return Nn("disposeData")}write(t,n,s){return Nn("write")}move(t,n,s,r,o){return Nn("move")}createTensorFromGPUData(t,n,s){return Nn("createTensorFromGPUData")}memory(){return Nn("memory")}floatPrecision(){return Nn("floatPrecision")}epsilon(){return this.floatPrecision()===32?Ww:jw}dispose(){return Nn("dispose")}}function Nn(e){throw new Error(`'${e}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ql(e,t,n){return Math.max(e,Math.min(t,n))}function ta(e,t,n){const s=e[t];e[t]=e[n],e[n]=s}function O(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function Rn(e,t,n=""){O(qn(e,t),()=>n+` Shapes ${e} and ${t} must match`)}function zo(e){O(e!=null,()=>"The input to the tensor constructor must be a non-null value.")}function Nt(e){if(e.length===0)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function qw(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==null&&t[n]!==null&&e[n]!==t[n])return!1;return!0}function qn(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Sa(e){return e%1===0}function Ni(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function Kw(e,t){let n=1,s=-1;for(let o=0;o<e.length;++o)if(e[o]>=0)n*=e[o];else if(e[o]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${o}`);s=o}else if(e[o]<0)throw Error(`Shapes can not be < 0. Found ${e[o]} at dim ${o}`);if(s===-1){if(t>0&&t!==n)throw Error(`Size(${t}) must match the product of shape ${e}`);return e}if(n===0)throw Error(`Cannot infer the missing size in [${e}] when there are 0 elements`);if(t%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${n}`);const r=e.slice();return r[s]=t/n,r}function Ye(e,t){const n=t.length;return e=e==null?t.map((s,r)=>r):[].concat(e),O(e.every(s=>s>=-n&&s<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${e}`),O(e.every(s=>Sa(s)),()=>`All values in axis param must be integers but got axis ${e}`),e.map(s=>s<0?n+s:s)}function Uw(e,t){const n=[],s=[],r=t!=null&&Array.isArray(t)&&t.length===0,o=t==null||r?null:Ye(t,e).sort();let a=0;for(let i=0;i<e.length;++i){if(o!=null){if(o[a]===i&&e[i]!==1)throw new Error(`Can't squeeze axis ${i} since its dim '${e[i]}' is not 1`);(o[a]==null||o[a]>i)&&e[i]===1&&(n.push(e[i]),s.push(i)),o[a]<=i&&a++}e[i]!==1&&(n.push(e[i]),s.push(i))}return{newShape:n,keptDims:s}}function mn(e,t){return je(e,t)}function je(e,t){let n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else if(e==="string")n=new Array(t);else throw new Error(`Unknown data type ${e}`);return n}function Gw(e,t){for(let n=0;n<e.length;n++){const s=e[n];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${t} being uploaded contains ${s}.`)}}function Xw(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function Yw(e,t){return!(t==="complex64"||t==="float32"&&e!=="complex64"||t==="int32"&&e!=="float32"&&e!=="complex64"||t==="bool"&&e==="bool")}function Kc(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error(`Unknown dtype ${e}`)}function Zw(e){if(e==null)return 0;let t=0;return e.forEach(n=>t+=n.length),t}function gu(e){return typeof e=="string"||e instanceof String}function Qw(e){return typeof e=="boolean"}function Jw(e){return typeof e=="number"}function Va(e){return Array.isArray(e)?Va(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":Jw(e)?"float32":gu(e)?"string":Qw(e)?"bool":"float32"}function Uc(e){return!!(e&&e.constructor&&e.call&&e.apply)}function Xt(e){const t=e.length;if(t<2)return[];const n=new Array(t-1);n[t-2]=e[t-1];for(let s=t-3;s>=0;--s)n[s]=n[s+1]*e[s+1];return n}function rm(e,t,n,s=!1){const r=new Array;if(t.length===1){const o=t[0]*(s?2:1);for(let a=0;a<o;a++)r[a]=n[e+a]}else{const o=t[0],a=t.slice(1),i=a.reduce((u,c)=>u*c)*(s?2:1);for(let u=0;u<o;u++)r[u]=rm(e+u*i,a,n,s)}return r}function Wn(e,t,n=!1){if(e.length===0)return t[0];const s=e.reduce((r,o)=>r*o)*(n?2:1);if(s===0)return[];if(s!==t.length)throw new Error(`[${e}] does not match the input size ${t.length}${n?" for a complex tensor":""}.`);return rm(0,e,t,n)}function tv(e,t){if(Array.isArray(e))return e;if(t==="float32")return e instanceof Float32Array?e:new Float32Array(e);if(t==="int32")return e instanceof Int32Array?e:new Int32Array(e);if(t==="bool"||t==="string")return Uint8Array.from(new Int32Array(e));throw new Error(`Unknown dtype ${t}`)}function Kl(e,t){const n=sn(e,t);for(let s=0;s<n.length;s++)n[s]=1;return n}function sn(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error(`Unknown data type ${t}`)}function om(e,t){const n=e.reduce((s,r)=>s*r,1);if(t==null||t==="float32")return Wn(e,new Float32Array(n));if(t==="int32")return Wn(e,new Int32Array(n));if(t==="bool")return Wn(e,new Uint8Array(n));throw new Error(`Unknown data type ${t}`)}function Pn(e){e.forEach(t=>{O(Number.isInteger(t)&&t>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${e}].`)})}function ls(e,t,n){if(t===0)return 0;if(t===1)return e[0];let s=e[e.length-1];for(let r=0;r<e.length-1;++r)s+=n[r]*e[r];return s}function Vo(e,t,n){if(t===0)return[];if(t===1)return[e];const s=new Array(t);for(let r=0;r<s.length-1;++r)s[r]=Math.floor(e/n[r]),e-=s[r]*n[r];return s[s.length-1]=e,s}function Br(e){return e&&e.then&&typeof e.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _d="tfjsflags";class ev{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=nv,this.populateURLFlags()}setPlatform(t,n){this.platform!=null&&(ae().getBool("IS_TEST")||ae().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${t}.`)),this.platformName=t,this.platform=n}registerFlag(t,n,s){if(this.flagRegistry[t]={evaluationFn:n,setHook:s},this.urlFlags[t]!=null){const r=this.urlFlags[t];ae().getBool("IS_TEST")||ae().getBool("PROD")||console.warn(`Setting feature override from URL ${t}: ${r}.`),this.set(t,r)}}async getAsync(t){return t in this.flags?this.flags[t]:(this.flags[t]=await this.evaluateFlag(t),this.flags[t])}get(t){if(t in this.flags)return this.flags[t];const n=this.evaluateFlag(t);if(Br(n))throw new Error(`Flag ${t} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[t]=n,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getString(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,n){if(this.flagRegistry[t]==null)throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=n,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(n)}evaluateFlag(t){if(this.flagRegistry[t]==null)throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const t=this.getQueryParams(this.global.location.search);_d in t&&t[_d].split(",").forEach(s=>{const[r,o]=s.split(":");this.urlFlags[r]=rv(r,o)})}}function nv(e){const t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...s)=>(sv(t,s[0],s[1]),s.join("="))),t}function sv(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function rv(e,t){const n=t.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:t}function ae(){return am}let am=null;function ov(e){am=e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let _c;function im(){if(_c==null){let e;if(typeof window<"u")e=window;else if(typeof global<"u")e=global;else if(typeof process<"u")e=process;else if(typeof self<"u")e=self;else throw new Error("Could not find a global object");_c=e}return _c}function av(){const e=im();return e._tfGlobals==null&&(e._tfGlobals=new Map),e._tfGlobals}function Ul(e,t){const n=av();if(n.has(e))return n.get(e);{const s=t();return n.set(e,s),n.get(e)}}const um="Abs",Gl="Acos",Xl="Acosh",yu="Add",cm="AddN",lm="All",fm="Any",hm="ArgMax",dm="ArgMin",Yl="Asin",Zl="Asinh",Ql="Atan",Jl="Atanh",tf="Atan2",pm="AvgPool",iv="AvgPoolGrad",mm="AvgPool3D",uv="AvgPool3DGrad",gm="BatchMatMul",ym="BatchToSpaceND",bm="Bincount",ef="BitwiseAnd",wm="BroadcastArgs",nf="Cast",sf="Ceil",rf="ClipByValue",vm="Complex",km="ComplexAbs",xm="Concat",Sm="Conv2D",Im="Conv2DBackpropFilter",Nm="Conv2DBackpropInput",_m="Conv3D",cv="Conv3DBackpropFilterV2",Tm="Conv3DBackpropInputV2",of="Cos",af="Cosh",Em="Cumprod",$m="Cumsum",Cm="CropAndResize",Am="DenseBincount",Dm="DepthToSpace",Om="DepthwiseConv2dNative",Fm="DepthwiseConv2dNativeBackpropFilter",Rm="DepthwiseConv2dNativeBackpropInput",Pm="Diag",Mm="Dilation2D",Td="Dilation2DBackpropInput",Ed="Dilation2DBackpropFilter",lv="Draw",uf="RealDiv",Lm="Einsum",cf="Elu",fv="EluGrad",lf="Erf",ff="Equal",hf="Exp",zm="ExpandDims",df="Expm1",Vm="FFT",Bm="Fill",Wm="FlipLeftRight",pf="Floor",mf="FloorDiv",jm="FusedBatchNorm",Hm="GatherV2",qm="GatherNd",gf="Greater",yf="GreaterEqual",bf="Identity",Km="IFFT",Um="Imag",wf="IsFinite",vf="IsInf",kf="IsNan",Gm="LeakyRelu",xf="Less",Sf="LessEqual",Xm="LinSpace",If="Log",Nf="Log1p",_f="LogicalAnd",Tf="LogicalNot",Ef="LogicalOr",Ym="LRN",hv="LRNGrad",Zm="Max",$f="Maximum",Qm="MaxPool",dv="MaxPoolGrad",Jm="MaxPool3D",pv="MaxPool3DGrad",tg="MaxPoolWithArgmax",eg="Mean",ng="Min",Cf="Minimum",sg="MirrorPad",Af="Mod",rg="Multinomial",Df="Multiply",og="Neg",Of="NotEqual",ag="NonMaxSuppressionV3",ig="NonMaxSuppressionV4",ug="NonMaxSuppressionV5",cg="OnesLike",lg="OneHot",fg="Pack",hg="PadV2",Ff="Pow",dg="Prelu",pg="Prod",mg="RaggedGather",gg="RaggedRange",yg="RaggedTensorToTensor",bg="Range",wg="Real",Rf="Reciprocal",Pf="Relu",vg="Reshape",kg="ResizeNearestNeighbor",mv="ResizeNearestNeighborGrad",xg="ResizeBilinear",gv="ResizeBilinearGrad",Mf="Relu6",Sg="Reverse",Lf="Round",zf="Rsqrt",Ig="ScatterNd",Ng="TensorScatterUpdate",_g="SearchSorted",Tg="Select",Vf="Selu",Eg="Slice",Bf="Sin",Wf="Sinh",jf="Sign",Hf="Sigmoid",qf="Softplus",Kf="Sqrt",$g="Sum",Cg="SpaceToBatchND",Ag="SplitV",Dg="Softmax",Og="SparseFillEmptyRows",Fg="SparseReshape",Rg="SparseSegmentMean",Pg="SparseSegmentSum",Mg="SparseToDense",Uf="SquaredDifference",yv="Square",Gf="StaticRegexReplace",Lg="StridedSlice",zg="StringNGrams",Vg="StringSplit",Bg="StringToHashBucketFast",Xf="Sub",Yf="Tan",Zf="Tanh",Qf="Tile",Wg="TopK",jg="Transform",_i="Transpose",Hg="Unique",qg="Unpack",Kg="UnsortedSegmentSum",Ug="ZerosLike",Jf="Step",$d="FromPixels",Gg="RotateWithOffset",Gc="_FusedMatMul",Xc="FusedConv2D",Yc="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ar(...e){ae().getBool("IS_TEST")||ae().getBool("PROD")||console.warn(...e)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wi=Ul("kernelRegistry",()=>new Map),bv=Ul("gradRegistry",()=>new Map);function Zc(e,t){const n=Xg(e,t);return Wi.get(n)}function Cd(e){return bv.get(e)}function Ad(e){const t=Wi.entries(),n=[];for(;;){const{done:s,value:r}=t.next();if(s)break;const[o,a]=r,[i]=o.split("_");i===e&&n.push(a)}return n}function wv(e){const{kernelName:t,backendName:n}=e,s=Xg(t,n);Wi.has(s)&&Ar(`The kernel '${t}' for backend '${n}' is already registered`),Wi.set(s,e)}function Xg(e,t){return`${t}_${e}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yg(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}function vv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function kv(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var n=function s(){return this instanceof s?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(s){var r=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(n,s,r.get?r:{enumerable:!0,get:function(){return e[s]}})}),n}var Tc,Dd;function xv(){if(Dd)return Tc;Dd=1,Tc=t;var e=null;try{e=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function t(L,T,K){this.low=L|0,this.high=T|0,this.unsigned=!!K}t.prototype.__isLong__,Object.defineProperty(t.prototype,"__isLong__",{value:!0});function n(L){return(L&&L.__isLong__)===!0}t.isLong=n;var s={},r={};function o(L,T){var K,Z,rt;return T?(L>>>=0,(rt=0<=L&&L<256)&&(Z=r[L],Z)?Z:(K=i(L,(L|0)<0?-1:0,!0),rt&&(r[L]=K),K)):(L|=0,(rt=-128<=L&&L<128)&&(Z=s[L],Z)?Z:(K=i(L,L<0?-1:0,!1),rt&&(s[L]=K),K))}t.fromInt=o;function a(L,T){if(isNaN(L))return T?I:v;if(T){if(L<0)return I;if(L>=g)return z}else{if(L<=-b)return P;if(L+1>=b)return F}return L<0?a(-L,T).neg():i(L%m|0,L/m|0,T)}t.fromNumber=a;function i(L,T,K){return new t(L,T,K)}t.fromBits=i;var u=Math.pow;function c(L,T,K){if(L.length===0)throw Error("empty string");if(L==="NaN"||L==="Infinity"||L==="+Infinity"||L==="-Infinity")return v;if(typeof T=="number"?(K=T,T=!1):T=!!T,K=K||10,K<2||36<K)throw RangeError("radix");var Z;if((Z=L.indexOf("-"))>0)throw Error("interior hyphen");if(Z===0)return c(L.substring(1),T,K).neg();for(var rt=a(u(K,8)),et=v,nt=0;nt<L.length;nt+=8){var it=Math.min(8,L.length-nt),tt=parseInt(L.substring(nt,nt+it),K);if(it<8){var ut=a(u(K,it));et=et.mul(ut).add(a(tt))}else et=et.mul(rt),et=et.add(a(tt))}return et.unsigned=T,et}t.fromString=c;function l(L,T){return typeof L=="number"?a(L,T):typeof L=="string"?c(L,T):i(L.low,L.high,typeof T=="boolean"?T:L.unsigned)}t.fromValue=l;var f=65536,d=1<<24,m=f*f,g=m*m,b=g/2,y=o(d),v=o(0);t.ZERO=v;var I=o(0,!0);t.UZERO=I;var _=o(1);t.ONE=_;var N=o(1,!0);t.UONE=N;var C=o(-1);t.NEG_ONE=C;var F=i(-1,2147483647,!1);t.MAX_VALUE=F;var z=i(-1,-1,!0);t.MAX_UNSIGNED_VALUE=z;var P=i(0,-2147483648,!1);t.MIN_VALUE=P;var D=t.prototype;return D.toInt=function(){return this.unsigned?this.low>>>0:this.low},D.toNumber=function(){return this.unsigned?(this.high>>>0)*m+(this.low>>>0):this.high*m+(this.low>>>0)},D.toString=function(T){if(T=T||10,T<2||36<T)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(P)){var K=a(T),Z=this.div(K),rt=Z.mul(K).sub(this);return Z.toString(T)+rt.toInt().toString(T)}else return"-"+this.neg().toString(T);for(var et=a(u(T,6),this.unsigned),nt=this,it="";;){var tt=nt.div(et),ut=nt.sub(tt.mul(et)).toInt()>>>0,ft=ut.toString(T);if(nt=tt,nt.isZero())return ft+it;for(;ft.length<6;)ft="0"+ft;it=""+ft+it}},D.getHighBits=function(){return this.high},D.getHighBitsUnsigned=function(){return this.high>>>0},D.getLowBits=function(){return this.low},D.getLowBitsUnsigned=function(){return this.low>>>0},D.getNumBitsAbs=function(){if(this.isNegative())return this.eq(P)?64:this.neg().getNumBitsAbs();for(var T=this.high!=0?this.high:this.low,K=31;K>0&&(T&1<<K)==0;K--);return this.high!=0?K+33:K+1},D.isZero=function(){return this.high===0&&this.low===0},D.eqz=D.isZero,D.isNegative=function(){return!this.unsigned&&this.high<0},D.isPositive=function(){return this.unsigned||this.high>=0},D.isOdd=function(){return(this.low&1)===1},D.isEven=function(){return(this.low&1)===0},D.equals=function(T){return n(T)||(T=l(T)),this.unsigned!==T.unsigned&&this.high>>>31===1&&T.high>>>31===1?!1:this.high===T.high&&this.low===T.low},D.eq=D.equals,D.notEquals=function(T){return!this.eq(T)},D.neq=D.notEquals,D.ne=D.notEquals,D.lessThan=function(T){return this.comp(T)<0},D.lt=D.lessThan,D.lessThanOrEqual=function(T){return this.comp(T)<=0},D.lte=D.lessThanOrEqual,D.le=D.lessThanOrEqual,D.greaterThan=function(T){return this.comp(T)>0},D.gt=D.greaterThan,D.greaterThanOrEqual=function(T){return this.comp(T)>=0},D.gte=D.greaterThanOrEqual,D.ge=D.greaterThanOrEqual,D.compare=function(T){if(n(T)||(T=l(T)),this.eq(T))return 0;var K=this.isNegative(),Z=T.isNegative();return K&&!Z?-1:!K&&Z?1:this.unsigned?T.high>>>0>this.high>>>0||T.high===this.high&&T.low>>>0>this.low>>>0?-1:1:this.sub(T).isNegative()?-1:1},D.comp=D.compare,D.negate=function(){return!this.unsigned&&this.eq(P)?P:this.not().add(_)},D.neg=D.negate,D.add=function(T){n(T)||(T=l(T));var K=this.high>>>16,Z=this.high&65535,rt=this.low>>>16,et=this.low&65535,nt=T.high>>>16,it=T.high&65535,tt=T.low>>>16,ut=T.low&65535,ft=0,yt=0,pt=0,bt=0;return bt+=et+ut,pt+=bt>>>16,bt&=65535,pt+=rt+tt,yt+=pt>>>16,pt&=65535,yt+=Z+it,ft+=yt>>>16,yt&=65535,ft+=K+nt,ft&=65535,i(pt<<16|bt,ft<<16|yt,this.unsigned)},D.subtract=function(T){return n(T)||(T=l(T)),this.add(T.neg())},D.sub=D.subtract,D.multiply=function(T){if(this.isZero())return v;if(n(T)||(T=l(T)),e){var K=e.mul(this.low,this.high,T.low,T.high);return i(K,e.get_high(),this.unsigned)}if(T.isZero())return v;if(this.eq(P))return T.isOdd()?P:v;if(T.eq(P))return this.isOdd()?P:v;if(this.isNegative())return T.isNegative()?this.neg().mul(T.neg()):this.neg().mul(T).neg();if(T.isNegative())return this.mul(T.neg()).neg();if(this.lt(y)&&T.lt(y))return a(this.toNumber()*T.toNumber(),this.unsigned);var Z=this.high>>>16,rt=this.high&65535,et=this.low>>>16,nt=this.low&65535,it=T.high>>>16,tt=T.high&65535,ut=T.low>>>16,ft=T.low&65535,yt=0,pt=0,bt=0,_t=0;return _t+=nt*ft,bt+=_t>>>16,_t&=65535,bt+=et*ft,pt+=bt>>>16,bt&=65535,bt+=nt*ut,pt+=bt>>>16,bt&=65535,pt+=rt*ft,yt+=pt>>>16,pt&=65535,pt+=et*ut,yt+=pt>>>16,pt&=65535,pt+=nt*tt,yt+=pt>>>16,pt&=65535,yt+=Z*ft+rt*ut+et*tt+nt*it,yt&=65535,i(bt<<16|_t,yt<<16|pt,this.unsigned)},D.mul=D.multiply,D.divide=function(T){if(n(T)||(T=l(T)),T.isZero())throw Error("division by zero");if(e){if(!this.unsigned&&this.high===-2147483648&&T.low===-1&&T.high===-1)return this;var K=(this.unsigned?e.div_u:e.div_s)(this.low,this.high,T.low,T.high);return i(K,e.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?I:v;var Z,rt,et;if(this.unsigned){if(T.unsigned||(T=T.toUnsigned()),T.gt(this))return I;if(T.gt(this.shru(1)))return N;et=I}else{if(this.eq(P)){if(T.eq(_)||T.eq(C))return P;if(T.eq(P))return _;var nt=this.shr(1);return Z=nt.div(T).shl(1),Z.eq(v)?T.isNegative()?_:C:(rt=this.sub(T.mul(Z)),et=Z.add(rt.div(T)),et)}else if(T.eq(P))return this.unsigned?I:v;if(this.isNegative())return T.isNegative()?this.neg().div(T.neg()):this.neg().div(T).neg();if(T.isNegative())return this.div(T.neg()).neg();et=v}for(rt=this;rt.gte(T);){Z=Math.max(1,Math.floor(rt.toNumber()/T.toNumber()));for(var it=Math.ceil(Math.log(Z)/Math.LN2),tt=it<=48?1:u(2,it-48),ut=a(Z),ft=ut.mul(T);ft.isNegative()||ft.gt(rt);)Z-=tt,ut=a(Z,this.unsigned),ft=ut.mul(T);ut.isZero()&&(ut=_),et=et.add(ut),rt=rt.sub(ft)}return et},D.div=D.divide,D.modulo=function(T){if(n(T)||(T=l(T)),e){var K=(this.unsigned?e.rem_u:e.rem_s)(this.low,this.high,T.low,T.high);return i(K,e.get_high(),this.unsigned)}return this.sub(this.div(T).mul(T))},D.mod=D.modulo,D.rem=D.modulo,D.not=function(){return i(~this.low,~this.high,this.unsigned)},D.and=function(T){return n(T)||(T=l(T)),i(this.low&T.low,this.high&T.high,this.unsigned)},D.or=function(T){return n(T)||(T=l(T)),i(this.low|T.low,this.high|T.high,this.unsigned)},D.xor=function(T){return n(T)||(T=l(T)),i(this.low^T.low,this.high^T.high,this.unsigned)},D.shiftLeft=function(T){return n(T)&&(T=T.toInt()),(T&=63)===0?this:T<32?i(this.low<<T,this.high<<T|this.low>>>32-T,this.unsigned):i(0,this.low<<T-32,this.unsigned)},D.shl=D.shiftLeft,D.shiftRight=function(T){return n(T)&&(T=T.toInt()),(T&=63)===0?this:T<32?i(this.low>>>T|this.high<<32-T,this.high>>T,this.unsigned):i(this.high>>T-32,this.high>=0?0:-1,this.unsigned)},D.shr=D.shiftRight,D.shiftRightUnsigned=function(T){if(n(T)&&(T=T.toInt()),T&=63,T===0)return this;var K=this.high;if(T<32){var Z=this.low;return i(Z>>>T|K<<32-T,K>>>T,this.unsigned)}else return T===32?i(K,0,this.unsigned):i(K>>>T-32,0,this.unsigned)},D.shru=D.shiftRightUnsigned,D.shr_u=D.shiftRightUnsigned,D.toSigned=function(){return this.unsigned?i(this.low,this.high,!1):this},D.toUnsigned=function(){return this.unsigned?this:i(this.low,this.high,!0)},D.toBytes=function(T){return T?this.toBytesLE():this.toBytesBE()},D.toBytesLE=function(){var T=this.high,K=this.low;return[K&255,K>>>8&255,K>>>16&255,K>>>24,T&255,T>>>8&255,T>>>16&255,T>>>24]},D.toBytesBE=function(){var T=this.high,K=this.low;return[T>>>24,T>>>16&255,T>>>8&255,T&255,K>>>24,K>>>16&255,K>>>8&255,K&255]},t.fromBytes=function(T,K,Z){return Z?t.fromBytesLE(T,K):t.fromBytesBE(T,K)},t.fromBytesLE=function(T,K){return new t(T[0]|T[1]<<8|T[2]<<16|T[3]<<24,T[4]|T[5]<<8|T[6]<<16|T[7]<<24,K)},t.fromBytesBE=function(T,K){return new t(T[4]<<24|T[5]<<16|T[6]<<8|T[7],T[0]<<24|T[1]<<16|T[2]<<8|T[3],K)},Tc}var Zg=xv();const Qg=vv(Zg),Sv=Bw({__proto__:null,default:Qg},[Zg]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dr=Qg||Sv;function bu(e){return Dr.fromString(e,!0,16)}const Jg=bu("c3a5c85c97cb3127"),$r=bu("b492b66fbe98f273"),cn=bu("9ae16a3b2f90404f");function Qc(e){return e.xor(e.shru(47))}function ty(e,t,n){const s=e.slice(t,t+n);return Dr.fromBytes(Array.from(s),!0,!0)}function ke(e,t){return ty(e,t,8)}function Od(e,t){return ty(e,t,4)}function Xe(e,t){return t===0?e:e.shru(t).or(e.shl(64-t))}function ar(e,t,n=bu("9ddfea08eb382d69")){let s=e.xor(t).mul(n);s=s.xor(s.shru(47));let r=t.xor(s).mul(n);return r=r.xor(r.shru(47)),r=r.mul(n),r}function Iv(e,t,n,s,r,o){r=r.add(e),o=Xe(o.add(r).add(s),21);const a=r;return r=r.add(t),r=r.add(n),o=o.add(Xe(r,44)),[r.add(s),o.add(a)]}function bi(e,t,n,s){return Iv(ke(e,t),ke(e,t+8),ke(e,t+16),ke(e,t+24),n,s)}function Nv(e,t=e.length){if(t>=8){const n=cn.add(t*2),s=ke(e,0).add(cn),r=ke(e,t-8),o=Xe(r,37).mul(n).add(s),a=Xe(s,25).add(r).mul(n);return ar(o,a,n)}if(t>=4){const n=cn.add(t*2),s=Od(e,0);return ar(s.shl(3).add(t),Od(e,t-4),n)}if(t>0){const n=e[0],s=e[t>>1],r=e[t-1],o=n+(s<<8),a=t+(r<<2);return Qc(cn.mul(o).xor(Jg.mul(a))).mul(cn)}return cn}function _v(e,t=e.length){const n=cn.add(t*2),s=ke(e,0).mul($r),r=ke(e,8),o=ke(e,t-8).mul(n),a=ke(e,t-16).mul(cn);return ar(Xe(s.add(r),43).add(Xe(o,30)).add(a),s.add(Xe(r.add(cn),18)).add(o),n)}function Tv(e,t=e.length){const n=cn.add(t*2),s=ke(e,0).mul(cn),r=ke(e,8),o=ke(e,t-8).mul(n),a=ke(e,t-16).mul(cn),i=Xe(s.add(r),43).add(Xe(o,30)).add(a),u=ar(i,s.add(Xe(r.add(cn),18)).add(o),n),c=ke(e,16).mul(n),l=ke(e,24),f=i.add(ke(e,t-32)).mul(n),d=u.add(ke(e,t-24)).mul(n);return ar(Xe(c.add(l),43).add(Xe(f,30)).add(d),c.add(Xe(l.add(s),18)).add(f),n)}function Ev(e,t=e.length){const n=Dr.fromNumber(81,!0);if(t<=32)return t<=16?Nv(e,t):_v(e,t);if(t<=64)return Tv(e,t);let s=n,r=n.mul($r).add(113),o=Qc(r.mul(cn).add(113)).mul(cn),a=[Dr.UZERO,Dr.UZERO],i=[Dr.UZERO,Dr.UZERO];s=s.mul(cn).add(ke(e,0));let u=0;const c=(t-1>>6)*64,l=c+(t-1&63)-63;do s=Xe(s.add(r).add(a[0]).add(ke(e,u+8)),37).mul($r),r=Xe(r.add(a[1]).add(ke(e,u+48)),42).mul($r),s=s.xor(i[1]),r=r.add(a[0]).add(ke(e,u+40)),o=Xe(o.add(i[0]),33).mul($r),a=bi(e,u,a[1].mul($r),s.add(i[0])),i=bi(e,u+32,o.add(i[1]),r.add(ke(e,u+16))),[o,s]=[s,o],u+=64;while(u!==c);const f=$r.add(o.and(255).shl(1));return u=l,i[0]=i[0].add(t-1&63),a[0]=a[0].add(i[0]),i[0]=i[0].add(a[0]),s=Xe(s.add(r).add(a[0]).add(ke(e,u+8)),37).mul(f),r=Xe(r.add(a[1]).add(ke(e,u+48)),42).mul(f),s=s.xor(i[1].mul(9)),r=r.add(a[0].mul(9).add(ke(e,u+40))),o=Xe(o.add(i[0]),33).mul(f),a=bi(e,u,a[1].mul(f),s.add(i[0])),i=bi(e,u+32,o.add(i[1]),r.add(ke(e,u+16))),[o,s]=[s,o],ar(ar(a[0],i[0],f).add(Qc(r).mul(Jg)).add(o),ar(a[1],i[1],f).add(s),f)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function th(e,t){return t==="string"?Mr(e):Qr([e],t)}function $v(e,t){return e instanceof Float32Array&&t==="float32"||e instanceof Int32Array&&t==="int32"||e instanceof Uint8Array&&t==="bool"}function Qr(e,t){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=Na(e)),ae().getBool("DEBUG")&&Gw(e,t),$v(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){const n=new Uint8Array(e.length);for(let s=0;s<n.length;++s)Math.round(e[s])!==0&&(n[s]=1);return n}else throw new Error(`Unknown data type ${t}`)}function To(){return ae().platform.now()}function Mr(e,t="utf-8"){return t=t||"utf-8",ae().platform.encode(e,t)}function Ia(e,t="utf-8"){return t=t||"utf-8",ae().platform.decode(e,t)}function Kn(e){return ae().platform.isTypedArray!=null?ae().platform.isTypedArray(e):Yg(e)}function Na(e,t=[],n=!1){if(t==null&&(t=[]),typeof e=="boolean"||typeof e=="number"||typeof e=="string"||Br(e)||e==null||Kn(e)&&n)t.push(e);else if(Array.isArray(e)||Kn(e))for(let s=0;s<e.length;++s)Na(e[s],t,n);else{let s=-1;for(const r of Object.keys(e))/^([1-9]+[0-9]*|0)$/.test(r)&&(s=Math.max(s,Number(r)));for(let r=0;r<=s;r++)Na(e[r],t,n)}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cv{constructor(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new Dv)}profileKernel(t,n,s){let r;const o=()=>{r=s()};let a;const i=To();if(this.backendTimer.timerAvailable())a=this.backendTimer.time(o);else{o();for(const c of r)c.dataSync();a=Promise.resolve({kernelMs:To()-i})}if(ae().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<r.length;c++){const l=r[c];l.data().then(f=>{Av(f,l.dtype,t)})}return{kernelName:t,outputs:r,inputs:n,timeMs:a.then(c=>c.kernelMs),extraInfo:a.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(t){const{kernelName:n,outputs:s,timeMs:r,inputs:o,extraInfo:a}=t;s.forEach(i=>{Promise.all([i.data(),r,a]).then(u=>{this.logger.logKernelProfile(n,i,u[0],u[1],o,u[2])})})}}function Av(e,t,n){if(t!=="float32")return!1;for(let s=0;s<e.length;s++){const r=e[s];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${n}'`),!0}return!1}class Dv{logKernelProfile(t,n,s,r,o,a){const i=typeof r=="number"?Ni(`${r}ms`,9):r.error,u=Ni(t,25),c=n.rank,l=n.size,f=Ni(n.shape.toString(),14);let d="";for(const m in o){const g=o[m];if(g!=null){const b=g.shape||n.shape,y=b.length;d+=`${m}: ${y}D ${y>0?b:""} `}}console.log(`%c${u}	%c${i}	%c${c}D ${f}	%c${l}	%c${d}	%c${a}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ov(e,t,n){const s={},r={};for(let u=0;u<t.length;u++)s[t[u].id]=!0;for(let u=0;u<e.length;u++){const c=e[u],l=c.inputs;for(const f in l){const d=l[f];let m=!1;for(let g=0;g<t.length;g++)if(s[d.id]){c.outputs.forEach(b=>s[b.id]=!0),m=!0,r[c.id]=!0;break}if(m)break}}const o={};o[n.id]=!0;const a={};for(let u=e.length-1;u>=0;u--){const c=e[u],l=c.inputs;for(let f=0;f<c.outputs.length;f++)if(o[c.outputs[f].id]){for(const d in l)o[l[d].id]=!0,a[c.id]=!0;break}}const i=[];for(let u=0;u<e.length;u++){const c=e[u];if(r[c.id]&&a[c.id]){const l={};for(const d in c.inputs){const m=c.inputs[d];s[m.id]&&(l[d]=m)}const f=Object.assign({},c);f.inputs=l,f.outputs=c.outputs,i.push(f)}}return i}function Fv(e,t,n,s){for(let r=t.length-1;r>=0;r--){const o=t[r],a=[];if(o.outputs.forEach(u=>{const c=e[u.id];c!=null?a.push(c):a.push(null)}),o.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${o.kernelName}.`);const i=o.gradient(a);for(const u in o.inputs){if(!(u in i))throw new Error(`Cannot backprop through input ${u}. Available gradients found: ${Object.keys(i)}.`);const c=n(()=>i[u]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input ${u} must have 'float32' dtype, but has '${c.dtype}'`);const l=o.inputs[u];if(!qn(c.shape,l.shape))throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input '${u}' has shape '${c.shape}', which does not match the shape of the input '${l.shape}'`);if(e[l.id]==null)e[l.id]=c;else{const f=e[l.id];e[l.id]=s(f,c),f.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fd=20,ea=3,Ec=7;function Rv(e,t,n,s){const r=Xt(t),o=Pv(e,t,n,r),a=t.length,i=Ti(e,t,n,r,o),u=["Tensor"];return s&&(u.push(`  dtype: ${n}`),u.push(`  rank: ${a}`),u.push(`  shape: [${t}]`),u.push("  values:")),u.push(i.map(c=>"    "+c).join(`
`)),u.join(`
`)}function Pv(e,t,n,s){const r=Nt(t),o=s[s.length-1],a=new Array(o).fill(0),i=t.length,u=n==="complex64"?ia(e):e;if(i>1)for(let c=0;c<r/o;c++){const l=c*o;for(let f=0;f<o;f++)a[f]=Math.max(a[f],aa(u[l+f],0,n).length)}return a}function aa(e,t,n){let s;return Array.isArray(e)?s=`${parseFloat(e[0].toFixed(Ec))} + ${parseFloat(e[1].toFixed(Ec))}j`:gu(e)?s=`'${e}'`:n==="bool"?s=ey(e):s=parseFloat(e.toFixed(Ec)).toString(),Ni(s,t)}function ey(e){return e===0?"false":"true"}function Ti(e,t,n,s,r,o=!0){const a=n==="complex64"?2:1,i=t[0],u=t.length;if(u===0){if(n==="complex64"){const b=ia(e);return[aa(b[0],0,n)]}return n==="bool"?[ey(e[0])]:[e[0].toString()]}if(u===1){if(i>Fd){const y=ea*a;let v=Array.from(e.slice(0,y)),I=Array.from(e.slice((i-ea)*a,i*a));return n==="complex64"&&(v=ia(v),I=ia(I)),["["+v.map((_,N)=>aa(_,r[N],n)).join(", ")+", ..., "+I.map((_,N)=>aa(_,r[i-ea+N],n)).join(", ")+"]"]}return["["+(n==="complex64"?ia(e):Array.from(e)).map((y,v)=>aa(y,r[v],n)).join(", ")+"]"]}const c=t.slice(1),l=s.slice(1),f=s[0]*a,d=[];if(i>Fd){for(let b=0;b<ea;b++){const y=b*f,v=y+f;d.push(...Ti(e.slice(y,v),c,n,l,r,!1))}d.push("...");for(let b=i-ea;b<i;b++){const y=b*f,v=y+f;d.push(...Ti(e.slice(y,v),c,n,l,r,b===i-1))}}else for(let b=0;b<i;b++){const y=b*f,v=y+f;d.push(...Ti(e.slice(y,v),c,n,l,r,b===i-1))}const m=u===2?",":"";d[0]="["+(i>0?d[0]+m:"");for(let b=1;b<d.length-1;b++)d[b]=" "+d[b]+m;let g=`,
`;for(let b=2;b<u;b++)g+=`
`;return d[d.length-1]=" "+d[d.length-1]+"]"+(o?"":g),d}function ia(e){const t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ke{constructor(t,n,s){if(this.dtype=n,this.shape=t.slice(),this.size=Nt(t),s!=null){const r=s.length;O(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||je(n,this.size),this.strides=Xt(t)}set(t,...n){n.length===0&&(n=[0]),O(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const s=this.locToIndex(n);this.values[s]=t}get(...t){t.length===0&&(t=[0]);let n=0;for(const r of t){if(r<0||r>=this.shape[n]){const o=`Requested out of range element at ${t}.   Buffer shape=${this.shape}`;throw new Error(o)}n++}let s=t[t.length-1];for(let r=0;r<t.length-1;++r)s+=this.strides[r]*t[r];return this.values[s]}locToIndex(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];let n=t[t.length-1];for(let s=0;s<t.length-1;++s)n+=this.strides[s]*t[s];return n}indexToLoc(t){if(this.rank===0)return[];if(this.rank===1)return[t];const n=new Array(this.shape.length);for(let s=0;s<n.length-1;++s)n[s]=Math.floor(t/this.strides[s]),t-=n[s]*this.strides[s];return n[n.length-1]=t,n}get rank(){return this.shape.length}toTensor(){return Un().makeTensor(this.values,this.shape,this.dtype)}}let Un=null,po=null;function Mv(e){Un=e}function Lv(e){po=e}class ln{constructor(t,n,s,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=Nt(t),this.strides=Xt(t),this.dataId=s,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const t=await this.data();return po.buffer(this.shape,this.dtype,t)}bufferSync(){return po.buffer(this.shape,this.dtype,this.dataSync())}async array(){const t=await this.data();return Wn(this.shape,t,this.dtype==="complex64")}arraySync(){return Wn(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const t=Un().read(this.dataId);if(this.dtype==="string"){const n=await t;try{return n.map(s=>Ia(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t}dataToGPU(t){return this.throwIfDisposed(),Un().readToGPU(this.dataId,t)}dataSync(){this.throwIfDisposed();const t=Un().readSync(this.dataId);if(this.dtype==="string")try{return t.map(n=>Ia(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}async bytes(){this.throwIfDisposed();const t=await Un().read(this.dataId);return this.dtype==="string"?t:new Uint8Array(t.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Un().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(t=!1){return po.print(this,t)}clone(){return this.throwIfDisposed(),po.clone(this)}toString(t=!1){const n=this.dataSync();return Rv(n,this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),po.cast(this,t)}variable(t=!0,n,s){return this.throwIfDisposed(),Un().makeVariable(this,t,n,s)}}Object.defineProperty(ln,Symbol.hasInstance,{value:e=>!!e&&e.data!=null&&e.dataSync!=null&&e.throwIfDisposed!=null});function ny(){return Ul("Tensor",()=>ln)}ny();class ji extends ln{constructor(t,n,s,r){super(t.shape,t.dtype,t.dataId,r),this.trainable=n,this.name=s}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and previous value (${this.dtype}) must match`);if(!qn(t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and previous value (${this.shape}) must match`);Un().disposeTensor(this),this.dataId=t.dataId,Un().incRef(this,null)}dispose(){Un().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(ji,Symbol.hasInstance,{value:e=>e instanceof ln&&e.assign!=null&&e.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Rd;(function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"})(Rd||(Rd={}));var Jc;(function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"})(Jc||(Jc={}));var tl;(function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"})(tl||(tl={}));var el;(function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"})(el||(el={}));var nl;(function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"})(nl||(nl={}));const zv={float32:el,int32:Jc,bool:tl,complex64:nl};function Bo(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error(`Can not upcast ${e} with ${t}`)}return zv[e][t]}function sy(e){return e!=null&&typeof e=="object"&&"texture"in e&&e.texture instanceof WebGLTexture}function ry(e){return typeof GPUBuffer<"u"&&e!=null&&typeof e=="object"&&"buffer"in e&&e.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Re(e,t){if(e.dtype===t.dtype)return[e,t];const n=Bo(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function Vv(e,t){O(e.dtype===t.dtype,()=>`The dtypes of the first(${e.dtype}) and second(${t.dtype}) input must match`)}function oy(e){const t=[];return ay(e,t,new Set),t}function ay(e,t,n){if(e==null)return;if(e instanceof ln){t.push(e);return}if(!Bv(e))return;const s=e;for(const r in s){const o=s[r];n.has(o)||(n.add(o),ay(o,t,n))}}function Bv(e){return Array.isArray(e)||typeof e=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $c(e){return e.kernelName!=null}class Pd{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(t=>t.name)))}}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}class Eo{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Pd}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const t=this.getSortedBackends();for(let n=0;n<t.length;n++){const s=t[n];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:t,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${t}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry))if(t in this.registryFactory){const{asyncInit:n}=this.initializeBackend(t);if(n)return null}else return null;return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,n,s=1){return t in this.registryFactory?(Ar(`${t} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[t]={factory:n,priority:s},!0)}async setBackend(t){if(this.registryFactory[t]==null)throw new Error(`Backend name '${t}' not found in registry`);if(this.backendName=t,this.registry[t]==null){this.backendInstance=null;const{success:n,asyncInit:s}=this.initializeBackend(t);if(!(s?await n:n))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new Cv(this.backendInstance),!0}setupRegisteredKernels(){Ad(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(t){Ad(t).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[t])})}initializeBackend(t){const n=this.registryFactory[t];if(n==null)throw new Error(`Cannot initialize backend ${t}, no registration found.`);try{const s=n.factory();if(s&&!(s instanceof sm)&&typeof s.then=="function"){const r=++this.pendingBackendInitId,o=s.then(a=>r<this.pendingBackendInitId?!1:(this.registry[t]=a,this.pendingBackendInit=null,!0)).catch(a=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,Ar(`Initialization of backend ${t} failed`),Ar(a.stack||a.message)),!1));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}else return this.registry[t]=s,{success:!0,asyncInit:!1}}catch(s){return Ar(`Initialization of backend ${t} failed`),Ar(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error(`${t} backend not found in registry`);this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((t,n)=>this.registryFactory[n].priority-this.registryFactory[t].priority)}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let n=0;n<t.length;n++){const s=t[n],{success:r,asyncInit:o}=this.initializeBackend(s);if(o||r)return{name:s,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,n){const s=this.state.tensorInfo.get(n),r=s.backend,o=this.readSync(n),a=r.refCount(n);r.disposeData(n,!0),s.backend=t,t.move(n,o,s.shape,s.dtype,a),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,n){let s=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=t}let r;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(r),()=>(r=n(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(t,n,s){t();try{const r=s();return n(),r}catch(r){throw n(),r}}nextTensorId(){return Eo.nextTensorId++}nextVariableId(){return Eo.nextVariableId++}clone(t){const n=W.runKernel(bf,{x:t}),s={x:t},r=a=>({x:()=>{const i="float32",u={x:a},c={dtype:i};return W.runKernel(nf,u,c)}}),o=[];return this.addTapeNode(this.state.activeScope.name,s,[n],r,o,{}),n}runKernel(t,n,s){if(this.backendName==null&&this.backend,!(Zc(t,this.backendName)!=null))throw new Error(`Kernel '${t}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:t,inputs:n,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,n,s){const r=this.backend.numDataIds();let o=0;s.forEach(u=>{o+=u.dtype==="complex64"?3:1});const a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],i=r-n-o-a;if(i>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${i} data ids) after running '${t}'`)}runKernelFunc(t){let n,s=[];const r=this.isTapeOn(),o=this.state.numBytes,a=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let i;this.backendName==null&&this.backend;let u;const c=$c(t)?t.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if($c(t)){const{kernelName:g,inputs:b,attrs:y}=t;this.backendName==null&&this.backend;const v=Zc(g,this.backendName);O(v!=null,()=>`Cannot find registered kernel '${g}' for backend '${this.backendName}'`),i=()=>{const I=this.backend.numDataIds();u=v.kernelFunc({inputs:b,attrs:y,backend:this.backend});const _=Array.isArray(u)?u:[u];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(g,I,_);const N=_.map(C=>C.rank!=null?C:this.makeTensorFromTensorInfo(C));if(r){const C=this.getTensorsForGradient(g,b,N);s=this.saveTensorsForBackwardMode(C)}return N}}else{const{forwardFunc:g}=t,b=y=>{r&&(s=y.map(v=>this.keep(this.clone(v))))};i=()=>{const y=this.backend.numDataIds();u=this.tidy(()=>g(this.backend,b));const v=Array.isArray(u)?u:[u];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,y,v),v}}const{inputs:l,attrs:f}=t,d=$c(t)?null:t.backwardsFunc;let m;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=i():(m=this.profiler.profileKernel(c,l,()=>i()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(m),n=m.outputs)}),r&&this.addTapeNode(c,l,n,d,s,f),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-o,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-a,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(l).map(g=>l[g]!=null?l[g].shape:null),outputShapes:n.map(g=>g.shape),kernelTimeMs:m.timeMs,extraInfo:m.extraInfo}),Array.isArray(u)?n:n[0]}saveTensorsForBackwardMode(t){return t.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(t,n,s){const r=Cd(t);if(r!=null){const o=r.inputsToSave||[],a=r.outputsToSave||[];let i;r.saveAllInputs?(O(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),i=Object.keys(n).map(c=>n[c])):i=o.map(c=>n[c]);const u=s.filter((c,l)=>a[l]);return i.concat(u)}return[]}makeTensor(t,n,s,r){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",r=r||this.backend;let o=t;s==="string"&&gu(t[0])&&(o=t.map(u=>Mr(u)));const a=r.write(o,n,s),i=new ln(n,s,a,this.nextTensorId());if(this.trackTensor(i,r),s==="string"){const u=this.state.tensorInfo.get(a),c=Zw(o);this.state.numBytes+=c-u.bytes,u.bytes=c}return i}makeTensorFromDataId(t,n,s,r){s=s||"float32";const o={dataId:t,shape:n,dtype:s};return this.makeTensorFromTensorInfo(o,r)}makeTensorFromTensorInfo(t,n){const{dataId:s,shape:r,dtype:o}=t,a=new ln(r,o,s,this.nextTensorId());return this.trackTensor(a,n),a}makeVariable(t,n=!0,s,r){s=s||this.nextVariableId().toString(),r!=null&&r!==t.dtype&&(t=t.cast(r));const o=new ji(t,n,s,this.nextTensorId());if(this.state.registeredVariables[o.name]!=null)throw new Error(`Variable with name ${o.name} was already registered`);return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o}trackTensor(t,n){this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++;let s=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(s=t.size*Kc(t.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(t.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:s})),t instanceof ji||this.track(t)}incRef(t,n){this.trackTensor(t,n),this.backend.incRef(t.dataId)}removeDataId(t,n){this.state.tensorInfo.has(t)&&this.state.tensorInfo.get(t).backend===n&&(this.state.tensorInfo.delete(t),this.state.numDataBuffers--)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;const n=this.state.tensorInfo.get(t.dataId);if(this.state.numTensors--,t.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),t.dtype!=="complex64"&&t.dtype!=="string"){const s=t.size*Kc(t.dtype);this.state.numBytes-=s}n.backend.disposeData(t.dataId)&&this.removeDataId(t.dataId,n.backend)}disposeVariables(){for(const t in this.state.registeredVariables){const n=this.state.registeredVariables[t];this.disposeVariable(n)}}disposeVariable(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;const n=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(t,n,s,r,o,a){const i={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:s,saved:o},u=Cd(t);u!=null&&(r=u.gradFunc),r!=null&&(i.gradient=c=>(c=c.map((l,f)=>{if(l==null){const d=s[f],m=sn(d.size,d.dtype);return this.makeTensor(m,d.shape,d.dtype)}return l}),r(c.length>1?c:c[0],o,a))),this.state.activeTape.push(i)}keep(t){return t.kept=!0,t}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(t){const n=oy(t),s=new Set(n.map(o=>o.id));for(let o=0;o<this.state.activeScope.track.length;o++){const a=this.state.activeScope.track[o];!a.kept&&!s.has(a.id)&&a.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(o=>{!o.kept&&o.scopeId===r.id&&this.track(o)})}gradients(t,n,s,r=!1){if(O(n.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const o=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",t));O(o instanceof ln,()=>"The result y returned by f() must be a tensor.");const a=Ov(this.state.activeTape,n,o);if(!r&&a.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const i={};i[o.id]=s??Wv(o.shape),Fv(i,a,c=>this.tidy(c),jv);const u=n.map(c=>i[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const l of c.saved)l.dispose()}),this.state.activeTape=null),{value:o,grads:u}})}customGrad(t){return O(Uc(t),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{O(n.every(i=>i instanceof ln),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const r={};n.forEach((i,u)=>{r[u]=i});const o=(i,u)=>(s=t(...n,u),O(s.value instanceof ln,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),O(Uc(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),a=(i,u)=>{const c=s.gradFunc(i,u),l=Array.isArray(c)?c:[c];O(l.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),O(l.every(d=>d instanceof ln),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const f={};return l.forEach((d,m)=>{f[m]=()=>d}),f};return this.runKernelFunc({forwardFunc:o,backwardsFunc:a,inputs:r})}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}readToGPU(t,n){return this.state.tensorInfo.get(t).backend.readToGPU(t,n)}async time(t){const n=To(),s=await this.backend.time(t);return s.wallMs=To()-n,s}track(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Pd;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Eo.nextTensorId=0;Eo.nextVariableId=0;function Wv(e){const t=Kl(Nt(e),"float32");return W.makeTensor(t,e,"float32")}function iy(){const e=im();if(e._tfengine==null){const t=new ev(e);e._tfengine=new Eo(t)}return ov(e._tfengine.ENV),Mv(()=>e._tfengine),e._tfengine}const W=iy();function jv(e,t){const n={a:e,b:t};return W.runKernel(yu,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hv(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sn=ae();Sn.registerFlag("DEBUG",()=>!1,e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Sn.registerFlag("IS_BROWSER",()=>Hv());Sn.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Sn.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Sn.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));Sn.registerFlag("PROD",()=>!1);Sn.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Sn.getBool("DEBUG"));Sn.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Sn.registerFlag("IS_TEST",()=>!1);Sn.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Sn.getBool("DEBUG"));Sn.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Sn.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Sn.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mr(e,t){let n=e;if(Kn(e))return t==="string"?[]:[e.length];if(sy(e)){const r=e.channels||"RGBA";return[e.height,e.width*r.length]}else if(ry(e))return[e.buffer.size/(t==null?4:Kc(t))];if(!Array.isArray(e))return[];const s=[];for(;Array.isArray(n)||Kn(n)&&t!=="string";)s.push(n.length),n=n[0];return Array.isArray(e)&&ae().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&uy(e,s,[]),s}function uy(e,t,n){if(n=n||[],!Array.isArray(e)&&!Kn(e)){O(t.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`);return}O(t.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${e.length} elements`),O(e.length===t[0],()=>`Element arr[${n.join("][")}] should have ${t[0]} elements, but has ${e.length} elements`);const s=t.slice(1);for(let r=0;r<e.length;++r)uy(e[r],s,n.concat(r))}function Md(e,t,n,s){if(e!=="string_or_numeric"){if(e==null)throw new Error("Expected dtype cannot be null.");if(e!=="numeric"&&e!==t||e==="numeric"&&t==="string")throw new Error(`Argument '${n}' passed to '${s}' must be ${e} tensor, but got ${t} tensor`)}}function $(e,t,n,s="numeric"){if(e instanceof ny())return Md(s,e.dtype,t,n),e;let r=Va(e);if(r!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(r=s),Md(s,r,t,n),e==null||!Kn(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){const u=e==null?"null":e.constructor.name;throw new Error(`Argument '${t}' passed to '${n}' must be a Tensor or TensorLike, but got '${u}'`)}const o=mr(e,r);!Kn(e)&&!Array.isArray(e)&&(e=[e]);const i=r!=="string"?Qr(e,r):Na(e,[],!0);return W.makeTensor(i,o,r)}function Hi(e,t,n,s="numeric"){if(!Array.isArray(e))throw new Error(`Argument ${t} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return e.map((o,a)=>$(o,`${t}[${a}]`,n,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cy="__op";function V(e){const t=Object.keys(e);if(t.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let n=t[0];const s=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+cy;const r=(...o)=>{W.startScope(n);try{const a=s(...o);return Br(a)&&console.error("Cannot return a Promise inside of tidy."),W.endScope(a),a}catch(a){throw W.endScope(null),a}};return Object.defineProperty(r,"name",{value:n,configurable:!0}),r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qv(e,t){const n=$(e,"real","complex"),s=$(t,"imag","complex");Rn(n.shape,s.shape,`real and imag shapes, ${n.shape} and ${s.shape}, must match in call to tf.complex().`);const r={real:n,imag:s};return W.runKernel(vm,r)}const fr=V({complex_:qv});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gr(e,t,n,s){if(s==null)s=Va(e);else if(s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(ry(e)||sy(e)){if(s!=="float32"&&s!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return W.backend.createTensorFromGPUData(e,t||n,s)}if(!Kn(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){Pn(t);const r=Nt(t),o=Nt(n);O(r===o,()=>`Based on the provided shape, [${t}], the tensor should have ${r} values but has ${o}`);for(let a=0;a<n.length;++a){const i=n[a],u=a===n.length-1?i!==Nt(t.slice(a)):!0;O(n[a]===t[a]||!u,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${t}). `)}}return!Kn(e)&&!Array.isArray(e)&&(e=[e]),t=t||n,e=s!=="string"?Qr(e,s):Na(e,[],!0),W.makeTensor(e,t,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fs(e,t,n){const s=mr(e,n);return gr(e,t,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wr={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class Zn{static join(t){return new Zn(t).slice()}constructor(t){if(this.shards=[],this.previousShardIndex=0,t==null||(t instanceof Array||(t=[t]),t=t.map(s=>Kn(s)?s.buffer:s),t.length===0))return;this.bufferUniformSize=t[0].byteLength;let n=0;for(let s=0;s<t.length;s++){const r=t[s];s!==t.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const o=n+r.byteLength;this.shards.push({buffer:r,start:n,end:o}),n=o}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(t=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(t=isNaN(Number(t))?0:t,n=isNaN(Number(n))?0:n,t=Math.max(0,t),n=Math.min(this.byteLength,n),n<=t)return new ArrayBuffer(0);const s=this.findShardForByte(t);if(s===-1)throw new Error(`Could not find start shard for byte ${t}`);const r=n-t,o=new ArrayBuffer(r),a=new Uint8Array(o);let i=0;for(let u=s;u<this.shards.length;u++){const c=this.shards[u],f=t+i-c.start,d=i,g=Math.min(n,c.end)-c.start,b=new Uint8Array(c.buffer,f,g-f);if(a.set(b,d),i+=b.length,n<c.end)break}return o}findShardForByte(t){if(this.shards.length===0||t<0||t>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(t/this.bufferUniformSize),this.previousShardIndex;function n(r){return t<r.start?-1:t>=r.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const s=Kv(this.shards,n);return s===-1?-1:(this.previousShardIndex=s,this.previousShardIndex)}}function Kv(e,t){let n=0,s=e.length;for(;n<=s;){const r=Math.floor((s-n)/2)+n,o=t(e[r]);if(o===0)return r;o<0?s=r:n=r+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ld(){return W}function de(e,t){return W.tidy(e,t)}function xn(e){oy(e).forEach(n=>n.dispose())}function cs(e){return W.keep(e)}function zd(e){return W.setBackend(e)}function Uv(){return W.ready()}function Gv(){return W.backendName}function Xv(e,t,n=1){return W.registerBackend(e,t,n)}function Yv(){return W.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hr=4;async function Zv(e,t){const n=[],s=[],r=Array.isArray(e)?e.map(a=>a.name):Object.keys(e);for(let a=0;a<r.length;++a){const i=r[a],u=Array.isArray(e)?e[a].tensor:e[i];if(u.dtype!=="float32"&&u.dtype!=="int32"&&u.dtype!=="bool"&&u.dtype!=="string"&&u.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${i}': ${u.dtype}`);const c={name:i,shape:u.shape,dtype:u.dtype};if(u.dtype==="string"){const l=new Promise(async f=>{const d=await u.bytes(),m=d.reduce((y,v)=>y+v.length,0)+hr*d.length,g=new Uint8Array(m);let b=0;for(let y=0;y<d.length;y++){const v=d[y],I=new Uint8Array(new Uint32Array([v.length]).buffer);g.set(I,b),b+=hr,g.set(v,b),b+=v.length}f(g)});s.push(l)}else s.push(u.data());t!=null&&(c.group=t),n.push(c)}const o=await Promise.all(s);return{data:t1(o),specs:n}}function ly(e,t){const n=new Zn(e),s={};let r=0;for(const o of t){const a=Qv(o,(i,u)=>n.slice(r+i,r+u));s[o.name]=fy(o,n.slice(r,r+a)),r+=a}return s}function Qv(e,t){const n=Nt(e.shape);let s;if("quantization"in e){const r=e.quantization;s=Wr[r.dtype]}else if(e.dtype==="string"){let r=0;for(let o=0;o<n;o++)r+=hr+new Uint32Array(t(r,r+hr))[0];return r}else s=Wr[e.dtype];return n*s}async function Jv(e,t){const n=Nt(e.shape);let s;if("quantization"in e){const r=e.quantization;s=Wr[r.dtype]}else if(e.dtype==="string"){let r=0;for(let o=0;o<n;o++)r+=hr+new Uint32Array(await t(r,r+hr))[0];return r}else s=Wr[e.dtype];return n*s}function fy(e,t){const n=e.name,s=e.dtype,r=e.shape,o=Nt(r);let a,i=0;if("quantization"in e){const u=e.quantization;if(u.dtype==="uint8"||u.dtype==="uint16"){if(!("min"in u&&"scale"in u))throw new Error(`Weight ${e.name} with quantization ${u.dtype} doesn't have corresponding metadata min and scale.`)}else if(u.dtype==="float16"){if(s!=="float32")throw new Error(`Weight ${e.name} is quantized with ${u.dtype} which only supports weights of type float32 not ${s}.`)}else throw new Error(`Weight ${e.name} has unknown quantization dtype ${u.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const c=Wr[u.dtype],l=u.dtype==="uint8"?new Uint8Array(t):new Uint16Array(t);if(s==="float32")if(u.dtype==="uint8"||u.dtype==="uint16"){a=new Float32Array(l.length);for(let f=0;f<l.length;f++){const d=l[f];a[f]=d*u.scale+u.min}}else if(u.dtype==="float16")a=i1()(l);else throw new Error(`Unsupported quantization type ${u.dtype} for weight type float32.`);else if(s==="int32"){if(u.dtype!=="uint8"&&u.dtype!=="uint16")throw new Error(`Unsupported quantization type ${u.dtype} for weight type int32.`);a=new Int32Array(l.length);for(let f=0;f<l.length;f++){const d=l[f];a[f]=Math.round(d*u.scale+u.min)}}else throw new Error(`Unsupported dtype in weight '${n}': ${s}`);i+=o*c}else if(s==="string"){const u=Nt(e.shape);a=[];for(let c=0;c<u;c++){const l=new Uint32Array(t.slice(i,i+hr))[0];i+=hr;const f=new Uint8Array(t.slice(i,i+l));a.push(f),i+=l}}else{const u=Wr[s];if(s==="float32")a=new Float32Array(t);else if(s==="int32")a=new Int32Array(t);else if(s==="bool")a=new Uint8Array(t);else if(s==="complex64"){a=new Float32Array(t);const c=new Float32Array(a.length/2),l=new Float32Array(a.length/2);for(let g=0;g<c.length;g++)c[g]=a[g*2],l[g]=a[g*2+1];const f=fs(c,r,"float32"),d=fs(l,r,"float32"),m=fr(f,d);return f.dispose(),d.dispose(),m}else throw new Error(`Unsupported dtype in weight '${n}': ${s}`);i+=o*u}return fs(a,r,s)}async function Vd(e,t,n){let s=new Uint8Array(t);for(;s.byteLength<n;){const{done:r,value:o}=await e.read();if(r&&o==null){const i=n-s.byteLength;throw new Error(`Reader is done but ${i} bytes are still expected`)}const a=new Uint8Array(s.length+o.byteLength);a.set(s,0),a.set(new Uint8Array(o),s.length),s=a}return s.buffer}async function hy(e,t){const n={},s=e.getReader();let r=new ArrayBuffer(0);for(const o of t){const a=await Jv(o,async(c,l)=>(r=await Vd(s,r,l),r.slice(c,l)));r=await Vd(s,r,a);const i=r.slice(0,a);r=r.slice(a);const u=fy(o,i);if(n[o.name]=u,Gv()==="webgpu"){const c=Yv();"uploadToGPU"in c&&Nt(u.shape)>=ae().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&c.uploadToGPU(u.dataId)}}return n}function t1(e){if(e===null)throw new Error(`Invalid input value: ${JSON.stringify(e)}`);let t=0;const n=[];e.forEach(o=>{if(t+=o.byteLength,n.push(o.byteLength===o.buffer.byteLength?o:new o.constructor(o)),!(o instanceof Float32Array||o instanceof Int32Array||o instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${o.constructor.name}`)});const s=new Uint8Array(t);let r=0;return n.forEach(o=>{s.set(new Uint8Array(o.buffer),r),r+=o.byteLength}),s.buffer}const eh=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function Bd(e){return eh?Buffer.byteLength(e,"utf8"):new Blob([e]).size}function e1(e){if(eh)return Buffer.from(e).toString("base64");const t=new Uint8Array(e);let n="";for(let s=0,r=t.length;s<r;s++)n+=String.fromCharCode(t[s]);return btoa(n)}function n1(e){if(eh){const s=Buffer.from(e,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const t=atob(e),n=new Uint8Array(t.length);for(let s=0;s<t.length;++s)n.set([t.charCodeAt(s)],s);return n.buffer}function s1(e){return Zn.join(e)}function Wd(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);const n=e.split("/");return n[n.length-1]}function dy(e,t){const n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return e.signature!=null&&(n.signature=e.signature),e.userDefinedMetadata!=null&&(n.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(n.modelInitializer=e.modelInitializer),e.initializerSignature!=null&&(n.initializerSignature=e.initializerSignature),e.trainingConfig!=null&&(n.trainingConfig=e.trainingConfig),n}function py(e,t,n){const s={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(e.trainingConfig!=null&&(s.trainingConfig=e.trainingConfig),e.weightsManifest!=null){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");s.weightSpecs=t,s.weightData=n}return e.signature!=null&&(s.signature=e.signature),e.userDefinedMetadata!=null&&(s.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(s.modelInitializer=e.modelInitializer),e.initializerSignature!=null&&(s.initializerSignature=e.initializerSignature),s}async function nh(e,t){let n,s;return e.weightsManifest!=null&&([n,s]=await t(e.weightsManifest)),py(e,n,s)}function Ba(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:Bd(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:Bd(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:new Zn(e.weightData).byteLength}}function sl(e){const t=[];for(const n of e)t.push(...n.weights);return t}function r1(){const e=n=>{let s=n<<13,r=0;for(;(s&8388608)===0;)r-=8388608,s<<=1;return s&=-8388609,r+=947912704,s|r},t=new Uint32Array(2048);t[0]=0;for(let n=1;n<1024;n++)t[n]=e(n);for(let n=1024;n<2048;n++)t[n]=939524096+(n-1024<<13);return t}function o1(){const e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(let t=1;t<31;t++)e[t]=t<<23;for(let t=33;t<63;t++)e[t]=2147483648+(t-32<<23);return e}function a1(){const e=new Uint32Array(64);for(let t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}function i1(){const e=r1(),t=o1(),n=a1();return s=>{const r=new ArrayBuffer(4*s.length),o=new Uint32Array(r);for(let a=0;a<s.length;a++){const i=s[a],u=e[n[i>>10]+(i&1023)]+t[i>>10];o[a]=u}return new Float32Array(r)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class De{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return De.instance==null&&(De.instance=new De),De.instance}static registerSaveRouter(t){De.getInstance().saveRouters.push(t)}static registerLoadRouter(t){De.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return De.getHandlers(t,"save")}static getLoadHandlers(t,n){return De.getHandlers(t,"load",n)}static getHandlers(t,n,s){const r=[];return(n==="load"?De.getInstance().loadRouters:De.getInstance().saveRouters).forEach(a=>{const i=a(t,s);i!==null&&r.push(i)}),r}}const u1=e=>De.registerSaveRouter(e),c1=e=>De.registerLoadRouter(e),l1=e=>De.getSaveHandlers(e),f1=(e,t)=>De.getLoadHandlers(e,t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rl="tensorflowjs",ol=1,Rr="models_store",or="model_info_store";function my(){if(!ae().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const e=typeof window>"u"?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function al(e){const t=e.result;t.createObjectStore(Rr,{keyPath:"modelPath"}),t.createObjectStore(or,{keyPath:"modelPath"})}class jr{constructor(t){if(this.indexedDB=my(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)}async load(){return this.databaseAction(this.modelPath)}databaseAction(t,n){return new Promise((s,r)=>{const o=this.indexedDB.open(rl,ol);o.onupgradeneeded=()=>al(o),o.onsuccess=()=>{const a=o.result;if(n==null){const i=a.transaction(Rr,"readonly"),c=i.objectStore(Rr).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return a.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(c.result.modelArtifacts)},c.onerror=l=>(a.close(),r(c.error)),i.oncomplete=()=>a.close()}else{n.weightData=Zn.join(n.weightData);const i=Ba(n),u=a.transaction(or,"readwrite");let c=u.objectStore(or),l;try{l=c.put({modelPath:this.modelPath,modelArtifactsInfo:i})}catch(d){return r(d)}let f;l.onsuccess=()=>{f=a.transaction(Rr,"readwrite");const d=f.objectStore(Rr);let m;try{m=d.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:i})}catch(g){return r(g)}m.onsuccess=()=>s({modelArtifactsInfo:i}),m.onerror=g=>{c=u.objectStore(or);const b=c.delete(this.modelPath);b.onsuccess=()=>(a.close(),r(m.error)),b.onerror=y=>(a.close(),r(m.error))}},l.onerror=d=>(a.close(),r(l.error)),u.oncomplete=()=>{f==null?a.close():f.oncomplete=()=>a.close()}}},o.onerror=a=>r(o.error)})}}jr.URL_SCHEME="indexeddb://";const gy=e=>ae().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(jr.URL_SCHEME)?h1(e.slice(jr.URL_SCHEME.length)):null;De.registerSaveRouter(gy);De.registerLoadRouter(gy);function h1(e){return new jr(e)}function d1(e){return e.startsWith(jr.URL_SCHEME)?e.slice(jr.URL_SCHEME.length):e}class p1{constructor(){this.indexedDB=my()}async listModels(){return new Promise((t,n)=>{const s=this.indexedDB.open(rl,ol);s.onupgradeneeded=()=>al(s),s.onsuccess=()=>{const r=s.result,o=r.transaction(or,"readonly"),i=o.objectStore(or).getAll();i.onsuccess=()=>{const u={};for(const c of i.result)u[c.modelPath]=c.modelArtifactsInfo;t(u)},i.onerror=u=>(r.close(),n(i.error)),o.oncomplete=()=>r.close()},s.onerror=r=>n(s.error)})}async removeModel(t){return t=d1(t),new Promise((n,s)=>{const r=this.indexedDB.open(rl,ol);r.onupgradeneeded=()=>al(r),r.onsuccess=()=>{const o=r.result,a=o.transaction(or,"readwrite"),i=a.objectStore(or),u=i.get(t);let c;u.onsuccess=()=>{if(u.result==null)return o.close(),s(new Error(`Cannot find model with path '${t}' in IndexedDB.`));{const l=i.delete(t),f=()=>{c=o.transaction(Rr,"readwrite");const m=c.objectStore(Rr).delete(t);m.onsuccess=()=>n(u.result.modelArtifactsInfo),m.onerror=g=>s(u.error)};l.onsuccess=f,l.onerror=d=>(f(),o.close(),s(u.error))}},u.onerror=l=>(o.close(),s(u.error)),a.oncomplete=()=>{c==null?o.close():c.oncomplete=()=>o.close()}},r.onerror=o=>s(r.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cs="/",mo="tensorflowjs_models",yy="info",m1="model_topology",g1="weight_specs",y1="weight_data",b1="model_metadata";function by(e){return{info:[mo,e,yy].join(Cs),topology:[mo,e,m1].join(Cs),weightSpecs:[mo,e,g1].join(Cs),weightData:[mo,e,y1].join(Cs),modelMetadata:[mo,e,b1].join(Cs)}}function wy(e){for(const t of Object.values(e))window.localStorage.removeItem(t)}function w1(e){const t=e.split(Cs);if(t.length<3)throw new Error(`Invalid key format: ${e}`);return t.slice(1,t.length-1).join(Cs)}function v1(e){return e.startsWith(Hr.URL_SCHEME)?e.slice(Hr.URL_SCHEME.length):e}class Hr{constructor(t){if(!ae().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=by(this.modelPath)}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(t.modelTopology),s=JSON.stringify(t.weightSpecs),r=Ba(t),o=Zn.join(t.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,e1(o));const a={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,signature:t.signature!=null?t.signature:void 0,userDefinedMetadata:t.userDefinedMetadata!=null?t.userDefinedMetadata:void 0,modelInitializer:t.modelInitializer!=null?t.modelInitializer:void 0,initializerSignature:t.initializerSignature!=null?t.initializerSignature:void 0,trainingConfig:t.trainingConfig!=null?t.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(a)),{modelArtifactsInfo:r}}catch{throw wy(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(t==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=s;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=r;const o=this.LS.getItem(this.keys.modelMetadata);if(o!=null){const i=JSON.parse(o);n.format=i.format,n.generatedBy=i.generatedBy,n.convertedBy=i.convertedBy,i.signature!=null&&(n.signature=i.signature),i.userDefinedMetadata!=null&&(n.userDefinedMetadata=i.userDefinedMetadata),i.modelInitializer!=null&&(n.modelInitializer=i.modelInitializer),i.initializerSignature!=null&&(n.initializerSignature=i.initializerSignature),i.trainingConfig!=null&&(n.trainingConfig=i.trainingConfig)}const a=this.LS.getItem(this.keys.weightData);if(a==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=n1(a),n}}Hr.URL_SCHEME="localstorage://";const vy=e=>ae().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Hr.URL_SCHEME)?k1(e.slice(Hr.URL_SCHEME.length)):null;De.registerSaveRouter(vy);De.registerLoadRouter(vy);function k1(e){return new Hr(e)}class x1{constructor(){O(ae().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),O(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const t={},n=mo+Cs,s=Cs+yy;for(let r=0;r<this.LS.length;++r){const o=this.LS.key(r);if(o.startsWith(n)&&o.endsWith(s)){const a=w1(o);t[a]=JSON.parse(this.LS.getItem(o))}}return t}async removeModel(t){t=v1(t);const n=by(t);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${t}'`);const s=JSON.parse(this.LS.getItem(n.info));return wy(n),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wo="://";class un{constructor(){this.managers={}}static getInstance(){return un.instance==null&&(un.instance=new un),un.instance}static registerManager(t,n){O(t!=null,()=>"scheme must not be undefined or null."),t.endsWith(wo)&&(t=t.slice(0,t.indexOf(wo))),O(t.length>0,()=>"scheme must not be an empty string.");const s=un.getInstance();O(s.managers[t]==null,()=>`A model store manager is already registered for scheme '${t}'.`),s.managers[t]=n}static getManager(t){const n=un.getInstance().managers[t];if(n==null)throw new Error(`Cannot find model manager for scheme '${t}'`);return n}static getSchemes(){return Object.keys(un.getInstance().managers)}}function Ei(e){if(e.indexOf(wo)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${un.getSchemes().join(",")}`);return{scheme:e.split(wo)[0],path:e.split(wo)[1]}}async function ky(e,t,n=!1){O(e!==t,()=>`Old path and new path are the same: '${e}'`);const s=De.getLoadHandlers(e);O(s.length>0,()=>`Copying failed because no load handler is found for source URL ${e}.`),O(s.length<2,()=>`Copying failed because more than one (${s.length}) load handlers for source URL ${e}.`);const r=s[0],o=De.getSaveHandlers(t);O(o.length>0,()=>`Copying failed because no save handler is found for destination URL ${t}.`),O(o.length<2,()=>`Copying failed because more than one (${s.length}) save handlers for destination URL ${t}.`);const a=o[0],i=Ei(e).scheme,u=Ei(e).path,c=i===Ei(e).scheme,l=await r.load();n&&c&&await un.getManager(i).removeModel(u);const f=await a.save(l);return n&&!c&&await un.getManager(i).removeModel(u),f.modelArtifactsInfo}async function S1(){const e=un.getSchemes(),t={};for(const n of e){const s=await un.getManager(n).listModels();for(const r in s){const o=n+wo+r;t[o]=s[r]}}return t}async function I1(e){const t=Ei(e);return un.getManager(t.scheme).removeModel(t.path)}async function N1(e,t){return ky(e,t,!1)}async function _1(e,t){return ky(e,t,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class T1{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(t,n){return fetch(t,n)}now(){return performance.now()}encode(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,n){return new TextDecoder(n).decode(t)}setTimeoutCustom(t,n){if(typeof window>"u"||!ae().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(t,n);return}this.functionRefs.push(t),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const r=this.functionRefs[s.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(t){return Yg(t)}}if(ae().get("IS_BROWSER")){ae().setPlatform("browser",new T1);try{un.registerManager(Hr.URL_SCHEME,new x1)}catch{}try{un.registerManager(jr.URL_SCHEME,new p1)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E1={importFetch:()=>require("node-fetch")};let Cc;class $1{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(t,n){return ae().global.fetch!=null?ae().global.fetch(t,n):(Cc==null&&(Cc=E1.importFetch()),Cc(t,n))}now(){const t=process.hrtime();return t[0]*1e3+t[1]/1e6}encode(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(t)}decode(t,n){return t.length===0?"":new this.util.TextDecoder(n).decode(t)}isTypedArray(t){return this.util.types.isFloat32Array(t)||this.util.types.isInt32Array(t)||this.util.types.isUint8Array(t)||this.util.types.isUint8ClampedArray(t)}}ae().get("IS_NODE")&&!ae().get("IS_BROWSER")&&ae().setPlatform("node",new $1);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ie(e,t="float32",n){return t=t||"float32",Pn(e),new Ke(e,t,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C1(e,t){const n=$(e,"x","cast");if(!Xw(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:n},r={dtype:t};return W.runKernel(nf,s,r)}const ze=V({cast_:C1});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A1(e){const n={x:$(e,"x","clone","string_or_numeric")};return W.runKernel(bf,n)}const ir=V({clone_:A1});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xy(e,t=!1){console.log(e.toString(t))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */iy();const D1={buffer:ie,cast:ze,clone:ir,print:xy};Lv(D1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O1(e,t){let n=$(e,"a","add"),s=$(t,"b","add");[n,s]=Re(n,s);const r={a:n,b:s};return W.runKernel(yu,r)}const Qt=V({add_:O1});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F1(e,t){let n=$(e,"a","floorDiv"),s=$(t,"b","floorDiv");[n,s]=Re(n,s);const r={a:n,b:s};return W.runKernel(mf,r)}const Sy=V({floorDiv_:F1});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R1(e,t){let n=$(e,"a","div"),s=$(t,"b","div");if([n,s]=Re(n,s),n.dtype==="int32"&&s.dtype==="int32")return Sy(n,s);const r={a:n,b:s},o={};return W.runKernel(uf,r,o)}const Ie=V({div_:R1});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P1(e,t){let n=$(e,"a","mul"),s=$(t,"b","mul");[n,s]=Re(n,s);const r={a:n,b:s};return W.runKernel(Df,r)}const Ft=V({mul_:P1});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M1(e){const t=$(e,"x","abs");if(t.dtype==="complex64"){const n={x:t};return W.runKernel(km,n)}else{const n={x:t};return W.runKernel(um,n)}}const Dn=V({abs_:M1});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L1(e){const n={x:$(e,"x","acos")};return W.runKernel(Gl,n)}const z1=V({acos_:L1});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V1(e){const n={x:$(e,"x","acosh")};return W.runKernel(Xl,n)}const B1=V({acosh_:V1});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W1(e){O(Array.isArray(e),()=>"The argument passed to tf.addN() must be a list of tensors"),O(e.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${e.length}`);const t=e.map((r,o)=>$(r,`tensors${o}`,"addN")),n=t[0];t.forEach(r=>{if(r.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(r=>{if(!qn(r.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const s=t;return W.runKernel(cm,s)}const j1=V({addN_:W1});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H1(e,t=null,n=!1){const r={x:$(e,"x","all","bool")},o={axis:t,keepDims:n};return W.runKernel(lm,r,o)}const q1=V({all_:H1});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K1(e,t=null,n=!1){const r={x:$(e,"x","any","bool")},o={axis:t,keepDims:n};return W.runKernel(fm,r,o)}const U1=V({any_:K1});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G1(e,t=0){const s={x:$(e,"x","argMax")},r={axis:t};return W.runKernel(hm,s,r)}const X1=V({argMax_:G1});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y1(e,t=0){const s={x:$(e,"x","argMin")},r={axis:t};return W.runKernel(dm,s,r)}const Z1=V({argMin_:Y1});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q1(e){const n={x:$(e,"x","asin")};return W.runKernel(Yl,n)}const J1=V({asin_:Q1});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tk(e){const n={x:$(e,"x","asinh")};return W.runKernel(Zl,n)}const ek=V({asinh_:tk});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nk(e){const n={x:$(e,"x","atan")};return W.runKernel(Ql,n)}const sk=V({atan_:nk});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rk(e,t){let n=$(e,"a","atan2"),s=$(t,"b","atan2");[n,s]=Re(n,s);const r={a:n,b:s};return W.runKernel(tf,r)}const ok=V({atan2_:rk});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ak(e){const n={x:$(e,"x","atanh")};return W.runKernel(Jl,n)}const ik=V({atanh_:ak});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sh(e,t,n,s,r="NHWC",o){const a=e[3],i=[...t,a],u=ku(r);return ws(e,i,n,o,s,null,null,u)}function Wo(e,t,n,s,r,o,a="channelsLast"){const[i,u]=_a(t);let c;if(a==="channelsLast")c=[i,u,e[3],e[3]];else if(a==="channelsFirst")c=[i,u,e[1],e[1]];else throw new Error(`Unknown dataFormat ${a}`);return ws(e,c,n,s,r,o,!1,a)}function wu(e,t,n,s,r,o,a="NDHWC"){const[i,u,c]=il(t);let l,f;if(a==="NDHWC")f="channelsLast",l=[i,u,c,e[4],e[4]];else if(a==="NCDHW")f="channelsFirst",l=[i,u,c,e[1],e[1]];else throw new Error(`Unknown dataFormat ${a}`);return vu(e,l,n,s,r,!1,f,o)}function ws(e,t,n,s,r,o,a=!1,i="channelsLast"){let[u,c,l,f]=[-1,-1,-1,-1];if(i==="channelsLast")[u,c,l,f]=e;else if(i==="channelsFirst")[u,f,c,l]=e;else throw new Error(`Unknown dataFormat ${i}`);const[d,m,,g]=t,[b,y]=_a(n),[v,I]=_a(s),_=vo(d,v),N=vo(m,I),{padInfo:C,outHeight:F,outWidth:z}=lk(r,c,l,b,y,_,N,o,i),P=a?g*f:g;let D;return i==="channelsFirst"?D=[u,P,F,z]:i==="channelsLast"&&(D=[u,F,z,P]),{batchSize:u,dataFormat:i,inHeight:c,inWidth:l,inChannels:f,outHeight:F,outWidth:z,outChannels:P,padInfo:C,strideHeight:b,strideWidth:y,filterHeight:d,filterWidth:m,effectiveFilterHeight:_,effectiveFilterWidth:N,dilationHeight:v,dilationWidth:I,inShape:e,outShape:D,filterShape:t}}function vu(e,t,n,s,r,o=!1,a="channelsLast",i){let[u,c,l,f,d]=[-1,-1,-1,-1,-1];if(a==="channelsLast")[u,c,l,f,d]=e;else if(a==="channelsFirst")[u,d,c,l,f]=e;else throw new Error(`Unknown dataFormat ${a}`);const[m,g,b,,y]=t,[v,I,_]=il(n),[N,C,F]=il(s),z=vo(m,N),P=vo(g,C),D=vo(b,F),{padInfo:L,outDepth:T,outHeight:K,outWidth:Z}=fk(r,c,l,f,v,I,_,z,P,D,i),rt=o?y*d:y;let et;return a==="channelsFirst"?et=[u,rt,T,K,Z]:a==="channelsLast"&&(et=[u,T,K,Z,rt]),{batchSize:u,dataFormat:a,inDepth:c,inHeight:l,inWidth:f,inChannels:d,outDepth:T,outHeight:K,outWidth:Z,outChannels:rt,padInfo:L,strideDepth:v,strideHeight:I,strideWidth:_,filterDepth:m,filterHeight:g,filterWidth:b,effectiveFilterDepth:z,effectiveFilterHeight:P,effectiveFilterWidth:D,dilationDepth:N,dilationHeight:C,dilationWidth:F,inShape:e,outShape:et,filterShape:t}}function uk(e,t,n,s,r){s==null&&(s=Iy(e,t,n));const o=e[0],a=e[1],i=Ta((o-t+2*s)/n+1,r),u=Ta((a-t+2*s)/n+1,r);return[i,u]}function ck(e,t,n,s,r,o){r==null&&(r=Iy(e,t[0],s[0]));const a=[0,0,0,n];for(let i=0;i<3;i++)e[i]+2*r>=t[i]&&(a[i]=Ta((e[i]-t[i]+2*r)/s[i]+1,o));return a}function Iy(e,t,n,s=1){const r=vo(t,s);return Math.floor((e[0]*(n-1)-n+r)/2)}function _a(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function il(e){return typeof e=="number"?[e,e,e]:e}function vo(e,t){return t<=1?e:e+(e-1)*(t-1)}function lk(e,t,n,s,r,o,a,i,u){let c,l,f;if(typeof e=="number"){c={top:e,bottom:e,left:e,right:e,type:e===0?"VALID":"NUMBER"};const m=uk([t,n],o,s,e,i);l=m[0],f=m[1]}else if(e==="same"){l=Math.ceil(t/s),f=Math.ceil(n/r);const d=Math.max(0,(l-1)*s+o-t),m=Math.max(0,(f-1)*r+a-n),g=Math.floor(d/2),b=d-g,y=Math.floor(m/2),v=m-y;c={top:g,bottom:b,left:y,right:v,type:"SAME"}}else if(e==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},l=Math.ceil((t-o+1)/s),f=Math.ceil((n-a+1)/r);else if(typeof e=="object"){const d=u==="channelsLast"?e[1][0]:e[2][0],m=u==="channelsLast"?e[1][1]:e[2][1],g=u==="channelsLast"?e[2][0]:e[3][0],b=u==="channelsLast"?e[2][1]:e[3][1];c={top:d,bottom:m,left:g,right:b,type:d===0&&m===0&&g===0&&b===0?"VALID":"EXPLICIT"},l=Ta((t-o+d+m)/s+1,i),f=Ta((n-a+g+b)/r+1,i)}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:c,outHeight:l,outWidth:f}}function fk(e,t,n,s,r,o,a,i,u,c,l){let f,d,m,g;if(e==="valid"&&(e=0),typeof e=="number"){f={top:e,bottom:e,left:e,right:e,front:e,back:e,type:e===0?"VALID":"NUMBER"};const y=ck([t,n,s,1],[i,u,c],1,[r,o,a],e,l);d=y[0],m=y[1],g=y[2]}else if(e==="same"){d=Math.ceil(t/r),m=Math.ceil(n/o),g=Math.ceil(s/a);const b=(d-1)*r+i-t,y=(m-1)*o+u-n,v=(g-1)*a+c-s,I=Math.floor(b/2),_=b-I,N=Math.floor(y/2),C=y-N,F=Math.floor(v/2),z=v-F;f={top:N,bottom:C,left:F,right:z,front:I,back:_,type:"SAME"}}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:f,outDepth:d,outHeight:m,outWidth:g}}function Ta(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error(`Unknown roundingMode ${t}`)}}function qi(e){const[t,n,s]=_a(e);return t===1&&n===1&&s===1}function Qn(e,t){return qi(e)||qi(t)}function $o(e){return _a(e).every(t=>t>0)}function ku(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${e}`)}function Jn(e,t,n){if(n!=null){if(typeof t=="string")throw Error(`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);if(typeof t=="number")O(Sa(t),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);else if(typeof t=="object")t.forEach(s=>{s.forEach(r=>{O(Sa(r),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${r}.`)})});else throw Error(`Error in ${e}: Unknown padding parameter: ${t}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hk(e,t){const s={x:$(e,"x","reshape","string_or_numeric")},r={shape:t};return W.runKernel(vg,s,r)}const gt=V({reshape_:hk});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dk(e,t,n,s,r){const o=$(e,"x","avgPool","float32"),a=1;O(Qn(n,a),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`);let i=o,u=!1;o.rank===3&&(u=!0,i=gt(o,[1,o.shape[0],o.shape[1],o.shape[2]])),O(i.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${i.rank}.`),Jn("avgPool",s,r);const c={x:i},l={filterSize:t,strides:n,pad:s,dimRoundingMode:r};let f=W.runKernel(pm,c,l);return f=ze(f,o.dtype),u?gt(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const Ny=V({avgPool_:dk});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pk(e,t,n,s,r,o="NDHWC"){const a=$(e,"x","avgPool3d","float32");let i=a,u=!1;a.rank===4&&(u=!0,i=gt(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),O(i.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${i.rank}.`),O(o==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),O(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),Jn("avgPool3d",s,r);const c={x:i},l={filterSize:t,strides:n,pad:s,dimRoundingMode:r,dataFormat:o};let f=W.runKernel(mm,c,l);return f=ze(f,i.dtype),u?gt(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const mk=V({avgPool3d_:pk});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gk(e,t=0){O(e.length>=1,()=>"Pass at least one tensor to concat");const n=Hi(e,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(o=>{if(o.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${o.dtype}. `)}),n.length===1)return ir(n[0]);const s=n,r={axis:t};return W.runKernel(xm,s,r)}const dn=V({concat_:gk});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yk(e,t,n=!1,s=!1){let r=$(e,"a","matMul"),o=$(t,"b","matMul");[r,o]=Re(r,o);const a={a:r,b:o},i={transposeA:n,transposeB:s};return W.runKernel(gm,a,i)}const be=V({matMul_:yk});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bk(e){const n={x:$(e,"x","sigmoid","float32")};return W.runKernel(Hf,n)}const ko=V({sigmoid_:bk});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wk(e,t,n){const s=$(e,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const r={x:s},o={begin:t,size:n};return W.runKernel(Eg,r,o)}const xe=V({slice_:wk});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vk(e){const n={x:$(e,"x","tanh","float32")};return W.runKernel(Zf,n)}const ul=V({tanh_:vk});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kk(e,t,n,s,r,o){const a=$(e,"forgetBias","basicLSTMCell"),i=$(t,"lstmKernel","basicLSTMCell"),u=$(n,"lstmBias","basicLSTMCell"),c=$(s,"data","basicLSTMCell"),l=$(r,"c","basicLSTMCell"),f=$(o,"h","basicLSTMCell"),d=dn([c,f],1),m=be(d,i),g=Qt(m,u),b=g.shape[0],y=g.shape[1]/4,v=[b,y],I=xe(g,[0,0],v),_=xe(g,[0,y],v),N=xe(g,[0,y*2],v),C=xe(g,[0,y*3],v),F=Qt(Ft(ko(I),ul(_)),Ft(l,ko(Qt(a,N)))),z=Ft(ul(F),ko(C));return[F,z]}const xk=V({basicLSTMCell_:kk});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sk(e,t,n){const s=$(e,"x","batchToSpaceND"),r=t.reduce((i,u)=>i*u);O(s.rank>=1+t.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${t.length}`),O(n.length===t.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${t.length}`),O(s.shape[0]%r===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${r}`);const o={x:s},a={blockShape:t,crops:n};return W.runKernel(ym,o,a)}const _y=V({batchToSpaceND_:Sk});function Ik(e){let t;return e.rank===0||e.rank===1?t=gt(e,[1,1,1,e.size]):e.rank===2?t=gt(e,[1,1,e.shape[0],e.shape[1]]):e.rank===3?t=gt(e,[1,e.shape[0],e.shape[1],e.shape[2]]):t=e,t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nk(e,t,n,s,r,o){o==null&&(o=.001);const a=$(e,"x","batchNorm"),i=$(t,"mean","batchNorm"),u=$(n,"variance","batchNorm");let c;r!=null&&(c=$(r,"scale","batchNorm"));let l;s!=null&&(l=$(s,"offset","batchNorm")),O(i.rank===u.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),O(l==null||i.rank===l.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),O(c==null||i.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const d={x:Ik(a),scale:c,offset:l,mean:i,variance:u},m={varianceEpsilon:o},g=W.runKernel(jm,d,m);return gt(g,a.shape)}const xu=V({batchNorm_:Nk});function _k(e,t,n,s,r,o){const a=$(e,"x","batchNorm"),i=$(t,"mean","batchNorm"),u=$(n,"variance","batchNorm");let c;r!=null&&(c=$(r,"scale","batchNorm"));let l;return s!=null&&(l=$(s,"offset","batchNorm")),O(a.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${a.rank}.`),O(i.rank===2||i.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${i.rank}.`),O(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${u.rank}.`),c!=null&&O(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),l!=null&&O(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${l.rank}.`),xu(a,i,u,l,c,o)}const Tk=V({batchNorm2d_:_k});function Ek(e,t,n,s,r,o){const a=$(e,"x","batchNorm"),i=$(t,"mean","batchNorm"),u=$(n,"variance","batchNorm");let c;r!=null&&(c=$(r,"scale","batchNorm"));let l;return s!=null&&(l=$(s,"offset","batchNorm")),O(a.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${a.rank}.`),O(i.rank===3||i.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${i.rank}.`),O(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${u.rank}.`),c!=null&&O(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),l!=null&&O(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${l.rank}.`),xu(a,i,u,l,c,o)}const $k=V({batchNorm3d_:Ek});function Ck(e,t,n,s,r,o){const a=$(e,"x","batchNorm"),i=$(t,"mean","batchNorm"),u=$(n,"variance","batchNorm");let c;r!=null&&(c=$(r,"scale","batchNorm"));let l;return s!=null&&(l=$(s,"offset","batchNorm")),O(a.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${a.rank}.`),O(i.rank===4||i.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${i.rank}.`),O(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${u.rank}.`),c!=null&&O(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),l!=null&&O(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${l.rank}.`),xu(a,i,u,l,c,o)}const Ak=V({batchNorm4d_:Ck});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dk(e,t,n){const s=$(e,"x","bincount"),r=$(t,"weights","bincount");O(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),O(n>=0,()=>`size must be non-negative, but got ${n}.`),O(r.size===s.size||r.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${r.shape}.`);const o={x:s,weights:r},a={size:n};return W.runKernel(bm,o,a)}const Ty=V({bincount_:Dk});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ok(e,t){const n=$(e,"x","bitwiseAnd"),s=$(t,"y","bitwiseAnd");if(!qn(n.shape,s.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${s.shape}`);if(n.dtype!=="int32"||s.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${s.dtype}`);const r={a:n,b:s};return W.runKernel(ef,r)}const Fk=V({bitwiseAnd_:Ok});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rk(e,t){const n=$(e,"s0","broadcastArgs","int32"),s=$(t,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(s.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${s.rank}`);const r={s0:n,s1:s};return W.runKernel(wm,r)}const Pk=V({broadcastArgs_:Rk});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mk(e,t){let n=$(e,"broadcastTo","x");const s=n.shape;if(Pn(t),t.length<n.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${n.rank}.`);if(t.length>n.rank){const c=n.shape.slice();for(;c.length<t.length;)c.unshift(1);n=gt(n,c)}const r=n.shape,o=Array.from(t);for(let c=t.length-1;c>=0;c--)if(r[c]===t[c])o[c]=1;else if(n.shape[c]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${t}].`);if(o.map((c,l)=>c>1?l:-1).filter(c=>c>=0).length===0)return ir(n);const i={x:n},u={reps:o};return W.runKernel(Qf,i,u)}const fa=V({broadcastTo_:Mk});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lk(e){const n={x:$(e,"x","ceil","float32")};return W.runKernel(sf,n)}const zk=V({ceil_:Lk});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wa(e,t,n){Pn(e),n=n||Va(t);const s={shape:e,value:t,dtype:n};return W.runKernel(Bm,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vk(e,t,n){const s=$(e,"x","clipByValue");if(O(t<=n,()=>`Error in clip: min (${t}) must be less than or equal to max (${n}).`),t===n)return Wa(s.shape,t,s.dtype);const r={x:s},o={clipValueMin:t,clipValueMax:n};return W.runKernel(rf,r,o)}const Bk=V({clipByValue_:Vk});function Wk(e){return dn(e,0)}const jk=V({concat1d_:Wk});function Hk(e,t){return dn(e,t)}const qk=V({concat2d_:Hk});function Kk(e,t){return dn(e,t)}const Uk=V({concat3d_:Kk});function Gk(e,t){return dn(e,t)}const Xk=V({concat4d_:Gk});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yk(e,t,n,s,r="NHWC",o=[1,1],a){const i=$(e,"x","conv2d","float32"),u=$(t,"filter","conv2d","float32");let c=i,l=!1;i.rank===3&&(l=!0,c=gt(i,[1,i.shape[0],i.shape[1],i.shape[2]])),O(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),O(u.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${u.rank}.`),Jn("conv2d",s,a);const f=r==="NHWC"?c.shape[3]:c.shape[1];O(f===u.shape[2],()=>`Error in conv2d: depth of input (${f}) must match input depth for filter ${u.shape[2]}.`),O(Qn(n,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),O($o(o),()=>"Error in conv2D: Dilated rates should be larger than 0."),O($o(n),()=>"Error in conv2D: Strides should be larger than 0.");const d={x:c,filter:u},m={strides:n,pad:s,dataFormat:r,dilations:o,dimRoundingMode:a},g=W.runKernel(Sm,d,m);return l?gt(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const Su=V({conv2d_:Yk});function Zk(e,t,n,s,r="NWC",o=1,a){const i=$(e,"x","conv1d"),u=$(t,"filter","conv1d");let c=i,l=!1;i.rank===2&&(l=!0,c=gt(i,[1,i.shape[0],i.shape[1]])),O(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),O(u.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${u.rank}.`),Jn("conv1d",s,a),O(c.shape[2]===u.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${u.shape[1]}.`),O(Qn(n,o),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${o}'`),O($o(o),()=>"Error in conv1D: Dilated rates should be larger than 0."),O($o(n),()=>"Error in conv1D: Stride should be larger than 0."),O(r==="NWC",()=>`Error in conv1d: got dataFormat of ${r} but only NWC is currently supported.`);const f=gt(u,[1,u.shape[0],u.shape[1],u.shape[2]]),d=gt(c,[c.shape[0],1,c.shape[1],c.shape[2]]),y=Su(d,f,[1,n],s,"NHWC",[1,o],a);return l?gt(y,[y.shape[2],y.shape[3]]):gt(y,[y.shape[0],y.shape[2],y.shape[3]])}const Qk=V({conv1d_:Zk});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jk(e,t,n,s,r,o="NHWC",a){O(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let i=e,u=t,c=!1;t.rank===3&&(c=!0,u=gt(t,[1,t.shape[0],t.shape[1],t.shape[2]]),i=[1,e[0],e[1],e[2]]),O(i.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${i.length}.`),O(u.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${u.rank}`),O(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const l=o==="NHWC"?i[3]:i[1],f=o==="NHWC"?u.shape[3]:u.shape[1];O(l===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[2]}.`),O(f===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${f}) must match output depth for filter ${n.shape[3]}.`),Jn("conv2dDerInput",r,a);const d={dy:u,filter:n},m={strides:s,pad:r,dataFormat:o,dimRoundingMode:a,inputShape:i},g=W.runKernel(Nm,d,m);return c?gt(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const Ey=V({conv2DBackpropInput_:Jk});function tx(e,t,n,s,r,o){const a=$(e,"x","conv2dTranspose"),i=$(t,"filter","conv2dTranspose");return Ey(n,a,i,s,r,"NHWC",o)}const ex=V({conv2dTranspose_:tx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nx(e,t,n,s,r="NDHWC",o=[1,1,1]){const a=$(e,"x","conv3d"),i=$(t,"filter","conv3d");let u=a,c=!1;a.rank===4&&(c=!0,u=gt(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),O(u.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${u.rank}.`),O(i.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${i.rank}.`),O(u.shape[4]===i.shape[3],()=>`Error in conv3d: depth of input (${u.shape[4]}) must match input depth for filter ${i.shape[3]}.`),O(Qn(n,o),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),O(r==="NDHWC",()=>`Error in conv3d: got dataFormat of ${r} but only NDHWC is currently supported.`),O($o(o),()=>"Error in conv3D: Dilated rates should be larger than 0."),O($o(n),()=>"Error in conv3D: Strides should be larger than 0.");const l={x:u,filter:i},f={strides:n,pad:s,dataFormat:r,dilations:o},d=W.runKernel(_m,l,f);return c?gt(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const sx=V({conv3d_:nx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rx(e,t,n,s,r){O(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let o=e,a=t,i=!1;t.rank===4&&(i=!0,a=gt(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),o=[1,e[0],e[1],e[2],e[3]]);const u=o[4],c=a.shape[4];O(o.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${o.length}.`),O(a.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${a.rank}`),O(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),O(u===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${u}) must match input depth for filter ${n.shape[3]}.`),O(c===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${n.shape[4]}.`);const l={dy:a,filter:n},f={pad:r,strides:s,inputShape:o},d=W.runKernel(Tm,l,f);return i?gt(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const ox=V({conv3DBackpropInput_:rx});function ax(e,t,n,s,r){const o=$(e,"x","conv3dTranspose"),a=$(t,"filter","conv3dTranspose");return ox(n,o,a,s,r)}const ix=V({conv3dTranspose_:ax});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ux(e){const n={x:$(e,"x","cos","float32")};return W.runKernel(of,n)}const cx=V({cos_:ux});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lx(e){const n={x:$(e,"x","cosh","float32")};return W.runKernel(af,n)}const fx=V({cosh_:lx});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hx(e,t=0,n=!1,s=!1){const o={x:$(e,"x","cumprod")},a={axis:t,exclusive:n,reverse:s};return W.runKernel(Em,o,a)}const dx=V({cumprod_:hx});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function px(e,t=0,n=!1,s=!1){const o={x:$(e,"x","cumsum")},a={axis:t,exclusive:n,reverse:s};return W.runKernel($m,o,a)}const mx=V({cumsum_:px});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gx(e,t,n,s=!1){const r=$(e,"x","denseBincount"),o=$(t,"weights","denseBincount");O(r.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${r.dtype}`),O(r.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${r.rank}.`),O(n>=0,()=>`size must be non-negative, but got ${n}.`),O(o.size===r.size||o.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${r.shape}, weights shape: ${o.shape}.`);const a={x:r,weights:o},i={size:n,binaryOutput:s};return W.runKernel(Am,a,i)}const yx=V({denseBincount_:gx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bx(e,t,n="NHWC"){const s=$(e,"x","depthToSpace","float32"),r=n==="NHWC"?s.shape[1]:s.shape[2],o=n==="NHWC"?s.shape[2]:s.shape[3],a=n==="NHWC"?s.shape[3]:s.shape[1];O(t>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${t}`),O(r*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${t}  for depthToSpace with input shape
    ${s.shape}`),O(o*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${o} and ${t} for depthToSpace with input shape
        ${s.shape}`),O(a%(t*t)===0,()=>`Dimension size must be evenly divisible by ${t*t} but is ${a} for depthToSpace with input shape ${s.shape}`);const i={x:s},u={blockSize:t,dataFormat:n};return W.runKernel(Dm,i,u)}const wx=V({depthToSpace_:bx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vx(e,t,n,s,r="NHWC",o=[1,1],a){const i=$(e,"x","depthwiseConv2d","float32"),u=$(t,"filter","depthwiseConv2d","float32");let c=i,l=!1;i.rank===3&&(l=!0,c=gt(i,[1,i.shape[0],i.shape[1],i.shape[2]])),O(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),O(u.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${u.rank}.`);const f=r==="NHWC"?c.shape[3]:c.shape[1];O(f===u.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${f}) must match the inChannels dimension in filter ${u.shape[2]}.`),Jn("depthwiseConv2d",s,a);const d={x:c,filter:u},m={strides:n,pad:s,dataFormat:r,dilations:o,dimRoundingMode:a},g=W.runKernel(Om,d,m);return l?gt(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const rh=V({depthwiseConv2d_:vx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kx(e){const n={x:$(e,"x","diag")};return W.runKernel(Pm,n)}const xx=V({diag_:kx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sx(e,t,n,s,r=[1,1],o="NHWC"){const a=$(e,"x","dilation2d"),i=$(t,"filter","dilation2d");O(a.rank===3||a.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${a.rank}.`),O(i.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${i.rank}.`),O(o==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${o}`);let u=a,c=!1;a.rank===3&&(u=gt(a,[1,a.shape[0],a.shape[1],a.shape[2]]),c=!0),O(u.shape[3]===i.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${u.shape[3]} vs ${i.shape[2]}`);const l={x:u,filter:i},f={strides:n,pad:s,dilations:r},d=W.runKernel(Mm,l,f);return c?gt(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Ix=V({dilation2d_:Sx});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ki(e,t){const n=e.length,s=[];for(let r=0;r<n;r++){const o=n-1-r,a=e[o]||1;(t[t.length-1-r]||1)>1&&a===1&&s.unshift(o)}return s}function Nx(e,t){const n=[];for(let s=0;s<t.length;s++){const r=e[e.length-s-1],o=t.length-s-1,a=t[o];(r==null||r===1&&a>1)&&n.unshift(o)}return n}function Pe(e,t){const n=Math.max(e.length,t.length),s=new Array(n);for(let r=0;r<n;r++){let o=e[e.length-r-1];o==null&&(o=1);let a=t[t.length-r-1];if(a==null&&(a=1),o===1)s[n-r-1]=a;else if(a===1)s[n-r-1]=o;else if(o!==a){const i=`Operands could not be broadcast together with shapes ${e} and ${t}.`;throw Error(i)}else s[n-r-1]=o}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _x(e,t){let n=$(e,"a","equal","string_or_numeric"),s=$(t,"b","equal","string_or_numeric");[n,s]=Re(n,s),Pe(n.shape,s.shape);const r={a:n,b:s};return W.runKernel(ff,r)}const $y=V({equal_:_x});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tx(e,t,n){const s=$(t,"a","where"),r=$(n,"b","where"),o=$(e,"condition","where","bool"),a=Pe(Pe(o.shape,s.shape),r.shape),i=fa(o,a),u=fa(s,a),c=fa(r,a),l={condition:i,t:u,e:c};return W.runKernel(Tg,l)}const ur=V({where_:Tx});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ex(e){const n={x:$(e,"x","zerosLike")};return W.runKernel(Ug,n)}const Fn=V({zerosLike_:Ex});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $x(e,t){let n=$(e,"a","div"),s=$(t,"b","div");[n,s]=Re(n,s);const r=Ie(n,s),o=Fn(r),a=$y(s,o);return ur(a,o,r)}const Cx=V({divNoNan_:$x});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ax(e,t){const n=$(e,"t1","dot"),s=$(t,"t2","dot");O((n.rank===1||n.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${s.rank}.`);const r=n.rank===1?n.size:n.shape[1],o=s.rank===1?s.size:s.shape[0];if(O(r===o,()=>`Error in dot: inner dimensions of inputs must match, but got ${r} and ${o}.`),n.rank===1&&s.rank===1){const a=gt(n,[1,-1]),i=gt(s,[-1,1]),u=be(a,i);return gt(u,[])}else if(n.rank===1&&s.rank===2){const a=gt(n,[1,-1]),i=gt(s,[s.shape[0],s.shape[1]]),u=be(a,i);return gt(u,[u.size])}else if(n.rank===2&&s.rank===1){const a=gt(s,[-1,1]),i=be(n,a);return gt(i,[i.size])}else{const a=gt(s,[s.shape[0],s.shape[1]]);return be(n,a)}}const Dx=V({dot_:Ax});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ox(e,...t){const n=t.map((r,o)=>$(r,`tensors${o}`,"einsum")),s={equation:e};return W.runKernel(Lm,n,s)}const go=V({einsum_:Ox});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fx(e){const n={x:$(e,"x","elu","float32")};return W.runKernel(cf,n)}const Cy=V({elu_:Fx});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rx(e,t){const n=$(e,"x","ensureShape","string_or_numeric");if(!qw(n.shape,t))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${t}`);return e}const Px=V({ensureShape_:Rx});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mx(e){let t=$(e,"x","erf");O(t.dtype==="int32"||t.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),t.dtype==="int32"&&(t=ze(t,"float32"));const n={x:t};return W.runKernel(lf,n)}const Lx=V({erf_:Mx});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ay(e,t){for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function zx(e,t,n){const s=e.length+t.length,r=[];let o=0,a=0;for(let i=0;i<s;i++)n.indexOf(i)===-1?r.push(e[o++]):r.push(t[a++]);return r}function Ws(e,t){const n=[],s=e.length;for(let o=0;o<s;o++)t.indexOf(o)===-1&&n.push(e[o]);const r=t.map(o=>e[o]);return[n,r]}function ts(e,t){const n=t.map(s=>1);return zx(e,n,t)}function Jr(e,t,n){O(Ay(t,n),()=>`${e} supports only inner-most axes for now. Got axes ${t} and rank-${n} input.`)}function vs(e,t){if(Ay(e,t))return null;const n=[];for(let s=0;s<t;++s)e.indexOf(s)===-1&&n.push(s);return e.forEach(s=>n.push(s)),n}function Dy(e){return e.map((t,n)=>[n,t]).sort((t,n)=>t[1]-n[1]).map(t=>t[0])}function ks(e,t){const n=[];for(let s=t-e;s<t;++s)n.push(s);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vx(e,t=null,n=!1){const r={x:$(e,"x","max")},o={reductionIndices:t,keepDims:n};return W.runKernel(Zm,r,o)}const xo=V({max_:Vx});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bx(e,t=null,n=!1){const r={x:$(e,"x","min")},o={axis:t,keepDims:n};return W.runKernel(ng,r,o)}const cl=V({min_:Bx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wx(e,t){let n=$(e,"base","pow"),s=$(t,"exp","pow");[n,s]=Re(n,s);const r={a:n,b:s};return W.runKernel(Ff,r)}const Ea=V({pow_:Wx});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ce(e,t){if((Kn(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Kn(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return gr(e,[],[],t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jx(e){const n={x:$(e,"x","sqrt","float32")};return W.runKernel(Kf,n)}const Rs=V({sqrt_:jx});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hx(e){const t=$(e,"x","square"),n={};return W.runKernel("Square",{x:t},n)}const Gn=V({square_:Hx});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qx(e,t=null,n=!1){let s=$(e,"x","sum");s.dtype==="bool"&&(s=ze(s,"int32"));const r={x:s},o={axis:t,keepDims:n};return W.runKernel($g,r,o)}const $e=V({sum_:qx});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kx(e,t="euclidean",n=null,s=!1){e=$(e,"x","norm");const r=Oy(e,t,n);let o=r.shape;if(s){const a=Ye(n,e.shape);o=ts(r.shape,a)}return gt(r,o)}function Oy(e,t,n=null){if(e.rank===0)return Dn(e);if(e.rank!==1&&n===null)return Oy(gt(e,[-1]),t,n);if(e.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(t===1)return $e(Dn(e),n);if(t===1/0)return xo(Dn(e),n);if(t===-1/0)return cl(Dn(e),n);if(t==="euclidean"||t===2)return Rs($e(Ea(Dn(e),ce(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(n)&&n.length===2){if(t===1)return xo($e(Dn(e),n[0]),n[1]-1);if(t===1/0)return xo($e(Dn(e),n[1]),n[0]);if(t===-1/0)return cl($e(Dn(e),n[1]),n[0]);if(t==="fro"||t==="euclidean")return Rs($e(Gn(e),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const Iu=V({norm_:Kx});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ux(e,t=null,n=!1){return Iu(e,"euclidean",t,n)}const Gx=V({euclideanNorm_:Ux});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xx(e){const n={x:$(e,"x","exp")};return W.runKernel(hf,n)}const qr=V({exp_:Xx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yx(e,t=0){const n=$(e,"x","expandDims","string_or_numeric");O(t<=n.rank,()=>"Axis must be <= rank of the tensor");const s={input:n},r={dim:t};return W.runKernel(zm,s,r)}const _s=V({expandDims_:Yx});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zx(e){const n={x:$(e,"x","expm1")};return W.runKernel(df,n)}const Qx=V({expm1_:Zx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jx(e,t){const n=$(e,"x","tile","string_or_numeric");O(n.rank===t.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${t}.`);const s={x:n},r={reps:t};return W.runKernel(Qf,s,r)}const ha=V({tile_:Jx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tS(e,t,n,s="float32"){t==null&&(t=e);const r=ie([e,t],s),o=e<=t?e:t;for(let i=0;i<o;++i)r.set(1,i,i);const a=gt(r.toTensor(),[e,t]);if(n==null)return a;if(n.length===1)return ha(_s(a,0),[n[0],1,1]);if(n.length===2)return ha(_s(_s(a,0),0),[n[0],n[1],1,1]);if(n.length===3)return ha(_s(_s(_s(a,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const Fy=V({eye_:tS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eS(e){const n={x:$(e,"x","floor","float32")};return W.runKernel(pf,n)}const Ry=V({floor_:eS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nS(e,t,n=0,s=0){const r=$(e,"x","gather"),o=$(t,"indices","gather","int32"),a={x:r,indices:o},i={axis:n,batchDims:s};return W.runKernel(Hm,a,i)}const Py=V({gather_:nS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sS(e,t){let n=$(e,"a","greater","string_or_numeric"),s=$(t,"b","greater","string_or_numeric");[n,s]=Re(n,s),Pe(n.shape,s.shape);const r={a:n,b:s};return W.runKernel(gf,r)}const Nu=V({greater_:sS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rS(e,t){let n=$(e,"a","greaterEqual","string_or_numeric"),s=$(t,"b","greaterEqual","string_or_numeric");[n,s]=Re(n,s),Pe(n.shape,s.shape);const r={a:n,b:s};return W.runKernel(yf,r)}const My=V({greaterEqual_:rS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oS(e){const n={input:$(e,"input","imag")};return W.runKernel(Um,n)}const _u=V({imag_:oS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aS(e){const n={x:$(e,"x","isFinite")};return W.runKernel(wf,n)}const iS=V({isFinite_:aS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uS(e){const n={x:$(e,"x","isInf")};return W.runKernel(vf,n)}const cS=V({isInf_:uS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lS(e){const n={x:$(e,"x","isNaN")};return W.runKernel(kf,n)}const fS=V({isNaN_:lS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hS(e,t=.2){const s={x:$(e,"x","leakyRelu")},r={alpha:t};return W.runKernel(Gm,s,r)}const Ly=V({leakyRelu_:hS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dS(e,t){let n=$(e,"a","less","string_or_numeric"),s=$(t,"b","less","string_or_numeric");[n,s]=Re(n,s),Pe(n.shape,s.shape);const r={a:n,b:s};return W.runKernel(xf,r)}const ll=V({less_:dS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pS(e,t){let n=$(e,"a","lessEqual","string_or_numeric"),s=$(t,"b","lessEqual","string_or_numeric");[n,s]=Re(n,s),Pe(n.shape,s.shape);const r={a:n,b:s};return W.runKernel(Sf,r)}const oh=V({lessEqual_:pS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mS(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");const s={start:e,stop:t,num:n};return W.runKernel(Xm,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gS(e,t=5,n=1,s=1,r=.5){const o=$(e,"x","localResponseNormalization");O(o.rank===4||o.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${o.rank}.`),O(Sa(t),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`);let a=o,i=!1;o.rank===3&&(i=!0,a=gt(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const u={x:a},c={depthRadius:t,bias:n,alpha:s,beta:r},l=W.runKernel(Ym,u,c);return i?gt(l,[l.shape[1],l.shape[2],l.shape[3]]):l}const yS=V({localResponseNormalization_:gS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bS(e){const n={x:$(e,"x","log","float32")};return W.runKernel(If,n)}const $a=V({log_:bS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wS(e){const n={x:$(e,"x","log1p")};return W.runKernel(Nf,n)}const zy=V({log1p_:wS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vS(e,t){O(Uc(e),()=>"The f passed in variableGrads(f) must be a function"),O(t==null||Array.isArray(t)&&t.every(c=>c instanceof ji),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=t!=null;if(!n){t=[];for(const c in W.registeredVariables)t.push(W.registeredVariables[c])}const s=n?t.filter(c=>!c.trainable):null,r=t.length;t=t.filter(c=>c.trainable),O(t.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${r} variables is trainable.`);const o=!0,{value:a,grads:i}=W.gradients(e,t,null,o);O(i.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),O(a.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${a.rank} tensor`);const u={};return t.forEach((c,l)=>{i[l]!=null&&(u[c.name]=i[l])}),s!=null&&s.forEach(c=>u[c.name]=null),{value:a,grads:u}}function Ps(e){return W.customGrad(e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kS(e){const n={x:$(e,"x","neg")};return W.runKernel(og,n)}const hs=V({neg_:kS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xS(e){const n={x:$(e,"x","softplus")};return W.runKernel(qf,n)}const Vy=V({softplus_:xS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SS(e){const t=$(e,"x","logSigmoid");return Ps(s=>({value:hs(Vy(hs(s))),gradFunc:a=>Ft(a,ko(hs(s)))}))(t)}const IS=V({logSigmoid_:SS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NS(e,t){let n=$(e,"a","sub"),s=$(t,"b","sub");[n,s]=Re(n,s);const r={a:n,b:s};return W.runKernel(Xf,r)}const oe=V({sub_:NS});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _S(e,t=-1){const n=$(e,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${t}`);return Ps((r,o)=>{const i=xo(r,t,!0),u=oe(r,i),c=oe(ze(u,"float32"),$a($e(qr(u),t,!0)));return o([c]),{value:c,gradFunc:(f,d)=>{const[m]=d,g=!0,b=qr(m);return oe(f,Ft($e(f,t,g),b))}}})(n)}const TS=V({logSoftmax_:_S});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ES(e,t=null,n=!1){const s=$(e,"x","logSumExp"),r=Ye(t,s.shape),o=xo(s,r,!0),a=oe(s,o),i=qr(a),u=$e(i,r),c=$a(u),l=Qt(gt(o,c.shape),c);if(n){const f=ts(l.shape,r);return gt(l,f)}return l}const By=V({logSumExp_:ES});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $S(e,t){const n=$(e,"a","logicalAnd","bool"),s=$(t,"b","logicalAnd","bool");Pe(n.shape,s.shape);const r={a:n,b:s};return W.runKernel(_f,r)}const Ui=V({logicalAnd_:$S});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CS(e){const n={x:$(e,"x","logicalNot","bool")};return W.runKernel(Tf,n)}const Wy=V({logicalNot_:CS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AS(e,t){const n=$(e,"a","logicalOr","bool"),s=$(t,"b","logicalOr","bool");Pe(n.shape,s.shape);const r={a:n,b:s};return W.runKernel(Ef,r)}const jy=V({logicalOr_:AS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DS(e,t){const n=$(e,"a","logicalXor","bool"),s=$(t,"b","logicalXor","bool");return Pe(n.shape,s.shape),Ui(jy(e,t),Wy(Ui(e,t)))}const OS=V({logicalXor_:DS});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wi=2147483648;function FS(e,t,n="left"){const s=$(e,"sortedSequence","searchSorted"),r=$(t,"values","searchSorted"),o=s.shape[s.shape.length-1],a=r.shape[r.shape.length-1],i=gt(s,[-1,o]),u=gt(r,[-1,a]);if(i.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(i.shape[0]!==u.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(Nt(u.shape)>=wi)throw new Error(`values tensor size must less than ${wi}`);if(i.shape[1]>=wi)throw new Error(`trailing dim_size must less than ${wi} for int32 output type, was ${i.shape[1]}`);const c={sortedSequence:i,values:u},l={side:n};return W.runKernel(_g,c,l)}const ah=V({searchSorted_:FS});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RS(e,t){return ah(e,t,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PS(e,t,n,s,r){const o=$(e,"x","maxPool"),a=1;let i=o,u=!1;o.rank===3&&(u=!0,i=gt(o,[1,o.shape[0],o.shape[1],o.shape[2]])),O(i.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${i.rank}.`),O(Qn(n,a),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),Jn("maxPool",s,r);const c={x:i},l={filterSize:t,strides:n,pad:s,dimRoundingMode:r},f=W.runKernel(Qm,c,l);return u?gt(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const Hy=V({maxPool_:PS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MS(e,t=[1,1,1],n,s,r,o="NDHWC"){const a=$(e,"x","maxPool3d");let i=a,u=!1;a.rank===4&&(u=!0,i=gt(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),O(i.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${i.rank}.`),O(o==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),Jn("maxPool3d",s,r);const c={x:i},l={filterSize:t,strides:n,pad:s,dimRoundingMode:r,dataFormat:o},f=W.runKernel(Jm,c,l);return u?gt(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const LS=V({maxPool3d_:MS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zS(e,t,n,s,r=!1){const a={x:$(e,"x","maxPoolWithArgmax")},i={filterSize:t,strides:n,pad:s,includeBatchInIndex:r},u=W.runKernel(tg,a,i);return{result:u[0],indexes:u[1]}}const VS=V({maxPoolWithArgmax_:zS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BS(e,t){let n=$(e,"a","maximum"),s=$(t,"b","maximum");[n,s]=Re(n,s),n.dtype==="bool"&&(n=ze(n,"int32"),s=ze(s,"int32")),Pe(n.shape,s.shape);const r={a:n,b:s};return W.runKernel($f,r)}const qy=V({maximum_:BS});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WS(e,t=null,n=!1){const r={x:$(e,"x","mean")},o={axis:t,keepDims:n};return W.runKernel(eg,r,o)}const Gi=V({mean_:WS});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Co(e,t="float32"){if(Pn(e),t==="complex64"){const s=Co(e,"float32"),r=Co(e,"float32");return fr(s,r)}const n=sn(Nt(e),t);return W.makeTensor(n,e,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pr(e,t="float32"){if(Pn(e),t==="complex64"){const s=Pr(e,"float32"),r=Co(e,"float32");return fr(s,r)}const n=Kl(Nt(e),t);return W.makeTensor(n,e,t)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jS(e,t,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(e===void 0)return[];let s=$(e,"x","meshgrid",e instanceof ln?e.dtype:"float32");if(t===void 0)return[s];let r=$(t,"y","meshgrid",t instanceof ln?t.dtype:"float32");const o=Nt(s.shape),a=Nt(r.shape);return n==="xy"?(s=gt(s,[1,-1]),r=gt(r,[-1,1]),[be(Pr([a,1],s.dtype),s),be(r,Pr([1,o],r.dtype))]):(s=gt(s,[-1,1]),r=gt(r,[1,-1]),[be(s,Pr([1,a],s.dtype)),be(Pr([o,1],r.dtype),r)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HS(e,t){let n=$(e,"a","minimum"),s=$(t,"b","minimum");[n,s]=Re(n,s),n.dtype==="bool"&&(n=ze(n,"int32"),s=ze(s,"int32")),Pe(n.shape,s.shape);const r={a:n,b:s};return W.runKernel(Cf,r)}const Xi=V({minimum_:HS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qS(e,t,n){O(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const s=$(e,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");O(t.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${t.length}.`);const r=n==="reflect"?1:0;for(let i=0;i<s.rank;i++)O(t[i].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),O(t[i][0]>=0&&t[i][0]<=s.shape[i]-r&&t[i][1]>=0&&t[i][1]<=s.shape[i]-r,()=>`Padding in dimension ${i} cannot be greater than or equal to ${s.shape[i]-r} or less than 0 for input of shape ${s.shape}`);const o={paddings:t,mode:n},a={x:s};return W.runKernel(sg,a,o)}const KS=V({mirrorPad_:qS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function US(e,t){let n=$(e,"a","mod"),s=$(t,"b","mod");[n,s]=Re(n,s);const r={a:n,b:s};return W.runKernel(Af,r)}const GS=V({mod_:US});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XS(e,t=null,n=!1){e=$(e,"x","moments");const s=Ye(t,e.shape),r=Gi(e,s,n);let o=r.shape;n||(o=ts(r.shape,s));const a=Gn(oe(ze(e,"float32"),gt(r,o))),i=Gi(a,s,n);return{mean:r,variance:i}}const YS=V({moments_:XS});function ZS(e,t,n,s){const r=$(t,"data","multiRNNCell"),o=Hi(n,"c","multiRNNCell"),a=Hi(s,"h","multiRNNCell");let i=r;const u=[];for(let f=0;f<e.length;f++){const d=e[f](i,o[f],a[f]);u.push(d[0]),u.push(d[1]),i=d[1]}const c=[],l=[];for(let f=0;f<u.length;f+=2)c.push(u[f]),l.push(u[f+1]);return[c,l]}const QS=V({multiRNNCell_:ZS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JS(e,t,n,s=!1){const r=$(e,"logits","multinomial"),o=r.size,a=r.rank;if(o<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${o}.`);if(a>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${a}`);n=n||Math.random();const u={logits:a===1?gt(r,[1,-1]):r},c={numSamples:t,seed:n,normalized:s},l=W.runKernel(rg,u,c);return a===1?gt(l,[l.size]):l}const tI=V({multinomial_:JS});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eI(e,t){let n=$(e,"a","notEqual","string_or_numeric"),s=$(t,"b","notEqual","string_or_numeric");[n,s]=Re(n,s),Pe(n.shape,s.shape);const r={a:n,b:s};return W.runKernel(Of,r)}const Ky=V({notEqual_:eI});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nI(e,t,n=1,s=0,r="int32"){if(t<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${t}`);const a={indices:$(e,"indices","oneHot","int32")},i={dtype:r,depth:t,onValue:n,offValue:s};return W.runKernel(lg,a,i)}const sI=V({oneHot_:nI});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rI(e){const n={x:$(e,"x","onesLike")};return W.runKernel(cg,n)}const oI=V({onesLike_:rI});function aI(e,t){const n=$(e,"v1","outerProduct"),s=$(t,"v2","outerProduct");O(n.rank===1&&s.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${s.rank}.`);const r=gt(n,[-1,1]),o=gt(s,[1,-1]);return be(r,o)}const iI=V({outerProduct_:aI});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uI(e,t,n=0){const s=$(e,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const r={paddings:t,constantValue:n},o={x:s};return W.runKernel(hg,o,r)}const ja=V({pad_:uI});function cI(e,t,n=0){return O(t.length===2,()=>"Invalid number of paddings. Must be length of 2."),ja(e,[t],n)}const lI=V({pad1d_:cI});function fI(e,t,n=0){return O(t.length===2&&t[0].length===2&&t[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),ja(e,t,n)}const hI=V({pad2d_:fI});function dI(e,t,n=0){return O(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),ja(e,t,n)}const pI=V({pad3d_:dI});function mI(e,t,n=0){return O(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),ja(e,t,n)}const gI=V({pad4d_:mI});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yI(e,t,n){const s=$(e,"x","spaceToBatchND");O(s.rank>=1+t.length,()=>`input rank ${s.rank} should be > than [blockShape] ${t.length}`),O(n.length===t.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${t.length}`),O(s.shape.reduce((a,i,u)=>u>0&&u<=t.length?a&&(i+n[u-1][0]+n[u-1][1])%t[u-1]===0:a,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${t.toString()}`);const r={x:s},o={blockShape:t,paddings:n};return W.runKernel(Cg,r,o)}const Uy=V({spaceToBatchND_:yI});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bI(e,t,n,s,r,o,a){r==null&&(r=[1,1]),o==null&&(o=1),s===0&&(s="valid");const i=$(e,"x","maxPool");let u=i,c=!1;i.rank===3&&(c=!0,u=gt(i,[1,i.shape[0],i.shape[1],i.shape[2]])),O(Qn(o,r),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${o} and dilations '${r}'`);const l=Wo(u.shape,t,o,r,s),f=[l.dilationHeight,l.dilationWidth];let d;s==="same"?d=vI([l.filterHeight,l.filterWidth],f):d=[[0,0],[0,0]];const m=f[0]===1&&f[1]===1,[g,b]=wI([l.inHeight,l.inWidth],f,d),y=m?s:"valid",v=m?u:Uy(u,f,g),_=(n==="avg"?()=>Ny(v,t,o,y,a):()=>Hy(v,t,o,y,a))(),N=m?_:_y(_,f,b);return c?gt(N,[N.shape[1],N.shape[2],N.shape[3]]):N}function wI(e,t,n){const s=n.map(l=>l[0]),r=n.map(l=>l[1]),o=e.concat(s,r),a=t.map((l,f)=>(l-o[f]%l)%l),i=r.map((l,f)=>l+a[f]),u=t.map((l,f)=>[s[f],i[f]]),c=t.map((l,f)=>[0,a[f]]);return[u,c]}function vI(e,t){const s=e.map((a,i)=>a+(a-1)*(t[i]-1)).map(a=>a-1),r=s.map(a=>Math.floor(a/2)),o=s.map((a,i)=>a-r[i]);return s.map((a,i)=>[r[i],o[i]])}const kI=V({pool_:bI});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xI(e,t){const n=$(e,"x","prelu"),s=$(t,"alpha","prelu"),r={x:n,alpha:s};return W.runKernel(dg,r)}const Gy=V({prelu_:xI});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SI(e,t=null,n=!1){let s=$(e,"x","prod");s.dtype==="bool"&&(s=ze(s,"int32"));const r={x:s},o={axis:t,keepDims:n};return W.runKernel(pg,r,o)}const II=V({prod_:SI});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NI(e,t,n,s){const r=e.map((l,f)=>$(l,`tensors${f}`,"raggedGather","int32")),o=$(t,"paramsDenseValues","raggedGather"),a=$(n,"indices","raggedGather","int32"),i={paramsNestedSplits:r,paramsDenseValues:o,indices:a},u={outputRaggedRank:s},c=W.runKernel(mg,i,u);return{outputNestedSplits:c.slice(0,c.length-1),outputDenseValues:c[c.length-1]}}const _I=V({raggedGather_:NI});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TI(e,t,n){const s=$(e,"starts","raggedRange"),r=$(t,"limits","raggedRange",s.dtype),o=$(n,"deltas","raggedRange",s.dtype),a={starts:s,limits:r,deltas:o},i=W.runKernel(gg,a);return{rtNestedSplits:i[0],rtDenseValues:i[1]}}const EI=V({raggedRange_:TI});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $I(e,t,n,s,r){const o=$(e,"shape","raggedTensorToTensor","int32"),a=$(t,"values","raggedTensorToTensor"),i=$(n,"defaultValue","raggedTensorToTensor",a.dtype),u=s.map((f,d)=>$(f,`tensors${d}`,"raggedTensorToTensor","int32")),c={shape:o,values:a,defaultValue:i,rowPartitionTensors:u},l={rowPartitionTypes:r};return W.runKernel(yg,c,l)}const CI=V({raggedTensorToTensor_:$I});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AI(e,t,n){Pn(e);const s=Nt(e);let r=null;if(n==null||n==="float32")r=new Float32Array(s);else if(n==="int32")r=new Int32Array(s);else if(n==="bool")r=new Uint8Array(s);else throw new Error(`Unknown data type ${n}`);for(let o=0;o<s;o++)r[o]=t();return W.makeTensor(r,e,n)}const DI=V({rand_:AI});var $i={exports:{}},OI=$i.exports,jd;function FI(){return jd||(jd=1,(function(e){(function(t,n,s){function r(u){var c=this,l=i();c.next=function(){var f=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=f-(c.c=f|0)},c.c=1,c.s0=l(" "),c.s1=l(" "),c.s2=l(" "),c.s0-=l(u),c.s0<0&&(c.s0+=1),c.s1-=l(u),c.s1<0&&(c.s1+=1),c.s2-=l(u),c.s2<0&&(c.s2+=1),l=null}function o(u,c){return c.c=u.c,c.s0=u.s0,c.s1=u.s1,c.s2=u.s2,c}function a(u,c){var l=new r(u),f=c&&c.state,d=l.next;return d.int32=function(){return l.next()*4294967296|0},d.double=function(){return d()+(d()*2097152|0)*11102230246251565e-32},d.quick=d,f&&(typeof f=="object"&&o(f,l),d.state=function(){return o(l,{})}),d}function i(){var u=4022871197,c=function(l){l=String(l);for(var f=0;f<l.length;f++){u+=l.charCodeAt(f);var d=.02519603282416938*u;u=d>>>0,d-=u,d*=u,u=d>>>0,d-=u,u+=d*4294967296}return(u>>>0)*23283064365386963e-26};return c}n&&n.exports?n.exports=a:this.alea=a})(OI,e)})($i)),$i.exports}var Ci={exports:{}},RI=Ci.exports,Hd;function PI(){return Hd||(Hd=1,(function(e){(function(t,n,s){function r(i){var u=this,c="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var f=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^f^f>>>8},i===(i|0)?u.x=i:c+=i;for(var l=0;l<c.length+64;l++)u.x^=c.charCodeAt(l)|0,u.next()}function o(i,u){return u.x=i.x,u.y=i.y,u.z=i.z,u.w=i.w,u}function a(i,u){var c=new r(i),l=u&&u.state,f=function(){return(c.next()>>>0)/4294967296};return f.double=function(){do var d=c.next()>>>11,m=(c.next()>>>0)/4294967296,g=(d+m)/(1<<21);while(g===0);return g},f.int32=c.next,f.quick=f,l&&(typeof l=="object"&&o(l,c),f.state=function(){return o(c,{})}),f}n&&n.exports?n.exports=a:this.xor128=a})(RI,e)})(Ci)),Ci.exports}var Ai={exports:{}},MI=Ai.exports,qd;function LI(){return qd||(qd=1,(function(e){(function(t,n,s){function r(i){var u=this,c="";u.next=function(){var f=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^(f^f<<1))|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,i===(i|0)?u.x=i:c+=i;for(var l=0;l<c.length+64;l++)u.x^=c.charCodeAt(l)|0,l==c.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function o(i,u){return u.x=i.x,u.y=i.y,u.z=i.z,u.w=i.w,u.v=i.v,u.d=i.d,u}function a(i,u){var c=new r(i),l=u&&u.state,f=function(){return(c.next()>>>0)/4294967296};return f.double=function(){do var d=c.next()>>>11,m=(c.next()>>>0)/4294967296,g=(d+m)/(1<<21);while(g===0);return g},f.int32=c.next,f.quick=f,l&&(typeof l=="object"&&o(l,c),f.state=function(){return o(c,{})}),f}n&&n.exports?n.exports=a:this.xorwow=a})(MI,e)})(Ai)),Ai.exports}var Di={exports:{}},zI=Di.exports,Kd;function VI(){return Kd||(Kd=1,(function(e){(function(t,n,s){function r(i){var u=this;u.next=function(){var l=u.x,f=u.i,d,m;return d=l[f],d^=d>>>7,m=d^d<<24,d=l[f+1&7],m^=d^d>>>10,d=l[f+3&7],m^=d^d>>>3,d=l[f+4&7],m^=d^d<<7,d=l[f+7&7],d=d^d<<13,m^=d^d<<9,l[f]=m,u.i=f+1&7,m};function c(l,f){var d,m=[];if(f===(f|0))m[0]=f;else for(f=""+f,d=0;d<f.length;++d)m[d&7]=m[d&7]<<15^f.charCodeAt(d)+m[d+1&7]<<13;for(;m.length<8;)m.push(0);for(d=0;d<8&&m[d]===0;++d);for(d==8?m[7]=-1:m[d],l.x=m,l.i=0,d=256;d>0;--d)l.next()}c(u,i)}function o(i,u){return u.x=i.x.slice(),u.i=i.i,u}function a(i,u){i==null&&(i=+new Date);var c=new r(i),l=u&&u.state,f=function(){return(c.next()>>>0)/4294967296};return f.double=function(){do var d=c.next()>>>11,m=(c.next()>>>0)/4294967296,g=(d+m)/(1<<21);while(g===0);return g},f.int32=c.next,f.quick=f,l&&(l.x&&o(l,c),f.state=function(){return o(c,{})}),f}n&&n.exports?n.exports=a:this.xorshift7=a})(zI,e)})(Di)),Di.exports}var Oi={exports:{}},BI=Oi.exports,Ud;function WI(){return Ud||(Ud=1,(function(e){(function(t,n,s){function r(i){var u=this;u.next=function(){var l=u.w,f=u.X,d=u.i,m,g;return u.w=l=l+1640531527|0,g=f[d+34&127],m=f[d=d+1&127],g^=g<<13,m^=m<<17,g^=g>>>15,m^=m>>>12,g=f[d]=g^m,u.i=d,g+(l^l>>>16)|0};function c(l,f){var d,m,g,b,y,v=[],I=128;for(f===(f|0)?(m=f,f=null):(f=f+"\0",m=0,I=Math.max(I,f.length)),g=0,b=-32;b<I;++b)f&&(m^=f.charCodeAt((b+32)%f.length)),b===0&&(y=m),m^=m<<10,m^=m>>>15,m^=m<<4,m^=m>>>13,b>=0&&(y=y+1640531527|0,d=v[b&127]^=m+y,g=d==0?g+1:0);for(g>=128&&(v[(f&&f.length||0)&127]=-1),g=127,b=512;b>0;--b)m=v[g+34&127],d=v[g=g+1&127],m^=m<<13,d^=d<<17,m^=m>>>15,d^=d>>>12,v[g]=m^d;l.w=y,l.X=v,l.i=g}c(u,i)}function o(i,u){return u.i=i.i,u.w=i.w,u.X=i.X.slice(),u}function a(i,u){i==null&&(i=+new Date);var c=new r(i),l=u&&u.state,f=function(){return(c.next()>>>0)/4294967296};return f.double=function(){do var d=c.next()>>>11,m=(c.next()>>>0)/4294967296,g=(d+m)/(1<<21);while(g===0);return g},f.int32=c.next,f.quick=f,l&&(l.X&&o(l,c),f.state=function(){return o(c,{})}),f}n&&n.exports?n.exports=a:this.xor4096=a})(BI,e)})(Oi)),Oi.exports}var Fi={exports:{}},jI=Fi.exports,Gd;function HI(){return Gd||(Gd=1,(function(e){(function(t,n,s){function r(i){var u=this,c="";u.next=function(){var f=u.b,d=u.c,m=u.d,g=u.a;return f=f<<25^f>>>7^d,d=d-m|0,m=m<<24^m>>>8^g,g=g-f|0,u.b=f=f<<20^f>>>12^d,u.c=d=d-m|0,u.d=m<<16^d>>>16^g,u.a=g-f|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,i===Math.floor(i)?(u.a=i/4294967296|0,u.b=i|0):c+=i;for(var l=0;l<c.length+20;l++)u.b^=c.charCodeAt(l)|0,u.next()}function o(i,u){return u.a=i.a,u.b=i.b,u.c=i.c,u.d=i.d,u}function a(i,u){var c=new r(i),l=u&&u.state,f=function(){return(c.next()>>>0)/4294967296};return f.double=function(){do var d=c.next()>>>11,m=(c.next()>>>0)/4294967296,g=(d+m)/(1<<21);while(g===0);return g},f.int32=c.next,f.quick=f,l&&(typeof l=="object"&&o(l,c),f.state=function(){return o(c,{})}),f}n&&n.exports?n.exports=a:this.tychei=a})(jI,e)})(Fi)),Fi.exports}var Ri={exports:{}};const qI={},KI=Object.freeze(Object.defineProperty({__proto__:null,default:qI},Symbol.toStringTag,{value:"Module"})),UI=kv(KI);var GI=Ri.exports,Xd;function XI(){return Xd||(Xd=1,(function(e){(function(t,n,s){var r=256,o=6,a=52,i="random",u=s.pow(r,o),c=s.pow(2,a),l=c*2,f=r-1,d;function m(N,C,F){var z=[];C=C==!0?{entropy:!0}:C||{};var P=v(y(C.entropy?[N,_(n)]:N??I(),3),z),D=new g(z),L=function(){for(var T=D.g(o),K=u,Z=0;T<c;)T=(T+Z)*r,K*=r,Z=D.g(1);for(;T>=l;)T/=2,K/=2,Z>>>=1;return(T+Z)/K};return L.int32=function(){return D.g(4)|0},L.quick=function(){return D.g(4)/4294967296},L.double=L,v(_(D.S),n),(C.pass||F||function(T,K,Z,rt){return rt&&(rt.S&&b(rt,D),T.state=function(){return b(D,{})}),Z?(s[i]=T,K):T})(L,P,"global"in C?C.global:this==s,C.state)}function g(N){var C,F=N.length,z=this,P=0,D=z.i=z.j=0,L=z.S=[];for(F||(N=[F++]);P<r;)L[P]=P++;for(P=0;P<r;P++)L[P]=L[D=f&D+N[P%F]+(C=L[P])],L[D]=C;(z.g=function(T){for(var K,Z=0,rt=z.i,et=z.j,nt=z.S;T--;)K=nt[rt=f&rt+1],Z=Z*r+nt[f&(nt[rt]=nt[et=f&et+K])+(nt[et]=K)];return z.i=rt,z.j=et,Z})(r)}function b(N,C){return C.i=N.i,C.j=N.j,C.S=N.S.slice(),C}function y(N,C){var F=[],z=typeof N,P;if(C&&z=="object")for(P in N)try{F.push(y(N[P],C-1))}catch{}return F.length?F:z=="string"?N:N+"\0"}function v(N,C){for(var F=N+"",z,P=0;P<F.length;)C[f&P]=f&(z^=C[f&P]*19)+F.charCodeAt(P++);return _(C)}function I(){try{var N;return d&&(N=d.randomBytes)?N=N(r):(N=new Uint8Array(r),(t.crypto||t.msCrypto).getRandomValues(N)),_(N)}catch{var C=t.navigator,F=C&&C.plugins;return[+new Date,t,F,t.screen,_(n)]}}function _(N){return String.fromCharCode.apply(0,N)}if(v(s.random(),n),e.exports){e.exports=m;try{d=UI}catch{}}else s["seed"+i]=m})(typeof self<"u"?self:GI,[],Math)})(Ri)),Ri.exports}var Ac,Yd;function YI(){if(Yd)return Ac;Yd=1;var e=FI(),t=PI(),n=LI(),s=VI(),r=WI(),o=HI(),a=XI();return a.alea=e,a.xor128=t,a.xorwow=n,a.xorshift7=s,a.xor4096=r,a.tychei=o,Ac=a,Ac}var Tu=YI();/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ih{constructor(t,n,s,r,o){this.mean=t,this.stdDev=n,this.dtype=s,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const a=o||Math.random();this.random=Tu.alea(a.toString())}nextValue(){if(!isNaN(this.nextVal)){const r=this.nextVal;return this.nextVal=NaN,r}let t,n,s=!1;for(;!s;){let r,o,a;do r=2*this.random()-1,o=2*this.random()-1,a=r*r+o*o;while(a>=1||a===0);const i=Math.sqrt(-2*Math.log(a)/a);t=this.mean+this.stdDev*r*i,n=this.mean+this.stdDev*o*i,(!this.truncated||this.isValidTruncated(t))&&(s=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(t)}convertValue(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}}class ZI{constructor(t,n,s,r){this.alpha=t,this.beta=1/n,this.dtype=s;const o=r||Math.random();this.randu=Tu.alea(o.toString()),this.randn=new ih(0,1,s,!1,this.randu()),t<1?this.d=t+2/3:this.d=t-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let t,n,s,r,o,a;for(;;){do r=this.randn.nextValue(),a=1+this.c*r;while(a<=0);if(a*=a*a,t=r*r,n=1-.331*t*t,s=.5*t+this.d*(1-a+Math.log(a)),o=this.randu(),o<n||Math.log(o)<s)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)}convertValue(t){return this.dtype==="float32"?t:Math.round(t)}}class QI{constructor(t=0,n=1,s,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=t,this.range=n-t,this.dtype=s,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${t} - ${n} <= 1 and dtype is not float`);this.random=Tu.alea(r)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JI(e,t,n=1,s="float32",r){if(Pn(e),n==null&&(n=1),s==null&&(s="float32"),s!=="float32"&&s!=="int32")throw new Error(`Unsupported data type ${s}`);const o=new ZI(t,n,s,r),a=ie(e,s);for(let i=0;i<a.values.length;i++)a.values[i]=o.nextValue();return a.toTensor()}const tN=V({randomGamma_:JI});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eN(e,t=0,n=1,s,r){if(Pn(e),s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const o=new ih(t,n,s,!1,r),a=ie(e,s);for(let i=0;i<a.values.length;i++)a.values[i]=o.nextValue();return a.toTensor()}const Xy=V({randomNormal_:eN});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nN(e,t,n){if(t!=null&&t==="bool")throw new Error(`Unsupported data type ${t}`);return Xy(e,0,1,t,n)}const sN=V({randomStandardNormal_:nN});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rN(e,t=0,n=1,s="float32",r){Pn(e);const o=ie(e,s),a=new QI(t,n,null,r);for(let i=0;i<o.values.length;i++)o.values[i]=a.nextValue();return o.toTensor()}const uh=V({randomUniform_:rN});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oN(e,t,n,s){return uh(e,t,n,"int32",s)}const aN=V({randomUniformInt_:oN});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ca(e,t,n=1,s="float32"){if(n===0)throw new Error("Cannot have a step of zero");const r={start:e,stop:t,step:n,dtype:s};return W.runKernel(bg,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iN(e){const n={input:$(e,"input","real")};return W.runKernel(wg,n)}const Aa=V({real_:iN});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uN(e){const n={x:$(e,"x","reciprocal")};return W.runKernel(Rf,n)}const cN=V({reciprocal_:uN});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lN(e){const n={x:$(e,"x","relu")};return W.runKernel(Pf,n)}const Eu=V({relu_:lN});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fN(e){const n={x:$(e,"x","relu6")};return W.runKernel(Mf,n)}const Yy=V({relu6_:fN});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hN(e,t){const s={x:$(e,"x","reverse")},r={dims:t};return W.runKernel(Sg,s,r)}const Kr=V({reverse_:hN});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dN(e){const t=$(e,"x","reverse");return O(t.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${t.rank}.`),Kr(t,0)}const pN=V({reverse1d_:dN});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mN(e,t){const n=$(e,"x","reverse");return O(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),Kr(n,t)}const gN=V({reverse2d_:mN});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yN(e,t){const n=$(e,"x","reverse");return O(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),Kr(n,t)}const bN=V({reverse3d_:yN});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wN(e,t){const n=$(e,"x","reverse");return O(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),Kr(n,t)}const vN=V({reverse4d_:wN});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kN(e){const n={x:$(e,"x","round")};return W.runKernel(Lf,n)}const Zy=V({round_:kN});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xN(e){const n={x:$(e,"x","rsqrt","float32")};return W.runKernel(zf,n)}const SN=V({rsqrt_:xN});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IN(e){const n={x:$(e,"x","selu")};return W.runKernel(Vf,n)}const NN=V({selu_:IN});function _N(e,t,n,s,r,o=[1,1],a="NHWC"){const i=$(e,"x","separableConv2d"),u=$(t,"depthwiseFilter","separableConv2d"),c=$(n,"pointwiseFilter","separableConv2d");let l=i,f=!1;if(i.rank===3&&(f=!0,l=gt(i,[1,i.shape[0],i.shape[1],i.shape[2]])),a==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");O(l.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${l.rank}.`),O(u.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${u.rank}.`),O(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${u.rank}.`),O(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),O(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const d=u.shape[2],m=u.shape[3];O(c.shape[2]===d*m,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${d*m}, but got ${c.shape[2]}.`);const g=rh(l,u,s,r,a,o),y=Su(g,c,1,"valid",a);return f?gt(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const TN=V({separableConv2d_:_N});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function EN(e,t){const n=$(e,"x","setdiff1d"),s=$(t,"y","setdiff1d");O(n.dtype===s.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${s.dtype}).`),O(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),O(s.rank===1,()=>`y should be 1D tensor, but got y (${s.shape}).`);const r=await n.data(),o=await s.data(),a=new Set(o);let i=0;for(let l=0;l<r.length;l++)a.has(r[l])||i++;const u=new Ke([i],n.dtype),c=new Ke([i],"int32");for(let l=0,f=0;l<r.length;l++)a.has(r[l])||(u.values[f]=r[l],c.values[f]=l,f++);return[u.toTensor(),c.toTensor()]}const $N=EN;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CN(e){const n={x:$(e,"x","sign")};return W.runKernel(jf,n)}const AN=V({sign_:CN});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DN(e){const n={x:$(e,"x","sin","float32")};return W.runKernel(Bf,n)}const ON=V({sin_:DN});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FN(e){const n={x:$(e,"x","sinh")};return W.runKernel(Wf,n)}const RN=V({sinh_:FN});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PN(e,t,n){const s=$(e,"x","slice1d");return O(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),xe(s,[t],[n])}const MN=V({slice1d_:PN});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LN(e,t,n){const s=$(e,"x","slice2d");return O(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),xe(s,t,n)}const zN=V({slice2d_:LN});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VN(e,t,n){const s=$(e,"x","slice3d");return O(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),xe(s,t,n)}const BN=V({slice3d_:VN});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WN(e,t,n){const s=$(e,"x","slice4d");return O(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),xe(s,t,n)}const jN=V({slice4d_:WN});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HN(e,t=-1){const n=$(e,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${t}`);const s={logits:n},r={dim:t};return W.runKernel(Dg,s,r)}const qN=V({softmax_:HN});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KN(e){O(e.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${e.dtype}.`);const t={input:e};return W.runKernel(Vm,t)}const ch=V({fft_:KN});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UN(e){O(e.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${e.dtype}.`);const t={input:e};return W.runKernel(Km,t)}const Yi=V({ifft_:UN});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GN(e){const t=e.shape[e.shape.length-1],n=e.size/t;let s;if(t<=2){const r=gt(e,[n,t]);s=Yi(r)}else{const r=[n,2*(t-1)],o=gt(Aa(e),[n,t]),a=gt(_u(e),[n,t]),i=Kr(xe(o,[0,1],[n,t-2]),1),u=Ft(Kr(xe(a,[0,1],[n,t-2]),1),ce(-1)),c=dn([o,i],1),l=dn([a,u],1),f=gt(fr(c,l),[r[0],r[1]]);s=Yi(f)}if(s=Aa(s),e.rank===3&&e.shape[0]!==0){const r=s,o=e.shape[0];s=gt(s,[o,s.shape[0]/o,s.shape[1]]),r.dispose()}return s}const Qy=V({irfft_:GN});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XN(e,t,n=0){const r={x:$(e,"x","split")},o={numOrSizeSplits:t,axis:n};return W.runKernel(Ag,r,o)}const Da=V({split_:XN});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YN(e,t){O(e.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${e.dtype}`);let n=e.shape[e.shape.length-1];const s=e.size/n;let r;if(t!=null&&t<n){const g=e.shape.map(y=>0),b=e.shape.map(y=>y);b[e.shape.length-1]=t,r=xe(e,g,b),n=t}else if(t!=null&&t>n){const g=e.shape.map(b=>b);g[e.shape.length-1]=t-n,r=dn([e,Co(g)],e.shape.length-1),n=t}else r=e;const o=Fn(r),a=gt(fr(r,o),[s,n]),i=ch(a),u=Math.floor(n/2)+1,c=Aa(i),l=_u(i),f=Da(c,[u,n-u],c.shape.length-1),d=Da(l,[u,n-u],l.shape.length-1),m=r.shape.slice();return m[r.shape.length-1]=u,gt(fr(f[0],d[0]),m)}const lh=V({rfft_:YN});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZN(e,t){let n=$(e,"a","squaredDifference"),s=$(t,"b","squaredDifference");[n,s]=Re(n,s),Pe(n.shape,s.shape);const r={a:n,b:s},o={};return W.runKernel(Uf,r,o)}const Jy=V({squaredDifference_:ZN});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QN(e,t){const n=$(e,"x","squeeze","string_or_numeric");return gt(n,Uw(n.shape,t).newShape)}const fh=V({squeeze_:QN});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JN(e,t=0){const n=Hi(e,"tensors","stack","string_or_numeric");O(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&O(t<=n[0].rank,()=>"Axis must be <= rank of the tensor");const s=n,r={axis:t};return W.runKernel(fg,s,r)}const Ms=V({stack_:JN});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t_(e,t=0){const s={x:$(e,"x","step")},r={alpha:t};return W.runKernel(Jf,s,r)}const tb=V({step_:t_});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e_(e,t,n,s,r=0,o=0,a=0,i=0,u=0){const l={x:$(e,"x","stridedSlice","string_or_numeric")},f={begin:t,end:n,strides:s,beginMask:r,endMask:o,ellipsisMask:a,newAxisMask:i,shrinkAxisMask:u};return W.runKernel(Lg,l,f)}const n_=V({stridedSlice_:e_});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s_(e){const n={x:$(e,"x","tan","float32")};return W.runKernel(Yf,n)}const r_=V({tan_:s_});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vn(e,t){zo(e);const n=mr(e,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return gr(e,null,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function da(e,t,n){if(zo(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=mr(e,n);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return gr(e,t,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eb(e,t,n){if(zo(e),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const s=mr(e,n);if(s.length!==3&&s.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(s.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return gr(e,t,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o_(e,t,n){if(zo(e),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const s=mr(e,n);if(s.length!==4&&s.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(s.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return gr(e,t,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a_(e,t,n){if(zo(e),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const s=mr(e,n);if(s.length!==5&&s.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(s.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return gr(e,t,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i_(e,t,n){if(zo(e),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const s=mr(e,n);if(s.length!==6&&s.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(s.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return t=t||s,gr(e,t,s,n)}function u_(e,t,n){const s=t.rank>1?t.shape[t.rank-1]:1,r=t.rank>1?t.rank-1:1,o=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${t.shape}, shape: ${e}, sliceDim: ${s}, and batchDim: ${r}.`;if(n.rank<r)throw new Error(o+` update.rank < ${r}. `);if(e.length<s+(n.rank-r))throw new Error(o+` Output shape length < ${s+(n.rank-r)}`);if(n.rank!==r+e.length-s)throw new Error(o+` update.rank != ${r+e.length-s}`);for(let a=0;a<r;++a)if(n.shape[a]!==t.shape[a])throw new Error(o+` updates.shape[${a}] (${n.shape[a]}) != indices.shape[${a}] (${t.shape[a]}).`);for(let a=0;a<n.rank-r;++a)if(n.shape[a+r]!==e[a+s])throw new Error(o+` updates.shape[${a+r}] (${n.shape[a+r]}) != shape[${a+r}] (${e[a+r]})`)}function nb(e,t,n){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(t.size===0)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(e.size===0)throw new Error(`Updates specified for empty output. updates shape: ${e.shape}`)}u_(n,t,e)}function hh(e,t,n){const s=t.shape.length,r=s>1?t.shape[s-1]:1,o=n.length;let a=1;for(let f=r;f<o;++f)a*=n[f];const i=r<1?1:r,u=Nt(t.shape)/i,c=[...Xt(n.slice(0,r)),1],l=Nt(n);return{sliceRank:r,numUpdates:u,sliceSize:a,strides:c,outputSize:l}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c_(e,t,n){const s=$(e,"tensor","tensorScatterupdate"),r=$(t,"indices","tensorScatterupdate","int32"),o=$(n,"updates","tensorScatterupdate");if(nb(o,r,s.shape),s.dtype!==o.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${s.dtype} and ${o.dtype}.`);const a={tensor:s,indices:r,updates:o},i={};return W.runKernel(Ng,a,i)}const l_=V({tensorScatterUpdate_:c_});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f_(e,t=1,n=!0){const s=$(e,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const r=s.shape[s.shape.length-1];if(t<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${t}`);if(t>r)throw new Error(`'k' passed to topk() must be <= the last dimension (${r}) but got ${t}`);const o={x:s},a={k:t,sorted:n},[i,u]=W.runKernel(Wg,o,a);return{values:i,indices:u}}const h_=V({topk_:f_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d_(e,t=0,n=1,s,r){if(Pn(e),s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const o=new ih(t,n,s,!0,r),a=ie(e,s);for(let i=0;i<a.values.length;i++)a.values[i]=o.nextValue();return a.toTensor()}const p_=V({truncatedNormal_:d_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m_(e,t=0){const n=$(e,"x","unique","string_or_numeric");O(n.rank>0,()=>"The input tensor must be at least 1D");const s={x:n},r={axis:t},[o,a]=W.runKernel(Hg,s,r);return{values:o,indices:a}}const g_=V({unique_:m_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y_(e,t,n){const s=$(e,"x","unsortedSegmentSum"),r=$(t,"segmentIds","unsortedSegmentSum","int32");O(Sa(n),()=>"numSegments must be of dtype int");const o={x:s,segmentIds:r},a={numSegments:n};return W.runKernel(Kg,o,a)}const b_=V({unsortedSegmentSum_:y_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w_(e,t=0){const n=$(e,"x","unstack","string_or_numeric");O(t>=-n.shape.length&&t<n.shape.length,()=>`Axis = ${t} is not in [-${n.shape.length}, ${n.shape.length})`);const s={value:n},r={axis:t};return W.runKernel(qg,s,r)}const to=V({unstack_:w_});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v_(e,t){return ah(e,t,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k_(e,t=!0,n,s){return W.makeVariable(e,t,n,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sb(e,t){const n=[];for(let o=0;o<t.length;o++)t[o]&&n.push(o);const s=ie(e,"int32"),r=ie([n.length,e.length],"int32");for(let o=0;o<n.length;o++){const a=s.indexToLoc(n[o]),i=o*e.length;r.values.set(a,i)}return r.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function x_(e){const t=$(e,"condition","whereAsync","bool"),n=await t.data(),s=sb(t.shape,n);return e!==t&&t.dispose(),s}const rb=x_;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function S_(e,t,n){const s=$(e,"tensor","boolMask"),r=$(t,"mask","boolMask","bool"),o=n??0,a=r.rank,i=s.shape;O(a>0,()=>"mask cannot be scalar"),Rn(i.slice(o,o+a),r.shape,"mask's shape must match the first K dimensions of tensor's shape,");let u=1;for(let b=o;b<o+a;b++)u*=i[b];const c=i.slice(0,o).concat([u],i.slice(o+a)),l=gt(s,c),f=gt(r,[-1]),d=await rb(f),m=fh(d,[1]),g=Py(l,m,o);return e!==s&&s.dispose(),t!==r&&r.dispose(),m.dispose(),l.dispose(),f.dispose(),d.dispose(),g}const I_=S_;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N_(e,t,n){const s=$(e,"x","transpose");if(t==null&&(t=s.shape.map((a,i)=>i).reverse()),O(s.rank===t.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${t}.`),t.forEach(a=>{O(a>=0&&a<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${t}`)}),s.rank<=1)return s.clone();const r={x:s},o={perm:t};return s.dtype==="complex64"?de(()=>{let a=Aa(s),i=_u(s);return a=W.runKernel(_i,{x:a},o),i=W.runKernel(_i,{x:i},o),n&&(i=hs(i)),fr(a,i)}):W.runKernel(_i,r,o)}const fl=V({transpose_:N_});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function __(e,t,n,s,r=!0){const o=$(e,"v","movingAverage"),a=$(t,"x","movingAverage"),i=$(n,"decay","movingAverage");Vv(o,a),O(qn(o.shape,a.shape),()=>"Shape mismatch in v and x");const u=ce(1),c=oe(u,i);let l=Ft(oe(a,o),c);if(r){O(s!=null,()=>"When using zeroDebias: true, step is required.");const f=$(s,"step","movingAverage");l=Ie(l,oe(u,Ea(i,f)))}return Qt(o,l)}const T_=V({movingAverage_:__});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E_(e,t,n){Pn(n);const s=$(e,"indices","scatterND","int32"),r=$(t,"updates","scatterND");nb(r,s,n);const o={indices:s,updates:r},a={shape:n};return W.runKernel(Ig,o,a)}const $_=V({scatterND_:E_});function C_(e,t,n,s){if(e.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${e.shape}.`);const r=e.rank>0?e.shape[0]:1,o=e.rank>1?e.shape[1]:1;if(n.length!==o)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${o}.`);const a=t.size;if(!(t.rank===0||t.rank===1&&a===r))throw new Error(`sparseValues has incorrect shape ${t.shape}, should be [] or [${r}]`);if(t.dtype!==s.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A_(e,t,n,s=0){Pn(n);const r=$(e,"sparseIndices","sparseToDense","int32"),o=$(t,"sparseValues","sparseToDense","string_or_numeric"),a=$(s,"defaultValue","sparseToDense",o.dtype);C_(r,o,n,a);const i={sparseIndices:r,sparseValues:o,defaultValue:a},u={outputShape:n};return W.runKernel(Mg,i,u)}const D_=V({sparseToDense_:A_});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O_(e,t){const n=$(t,"indices","gatherND","int32"),r={params:$(e,"x","gatherND","string_or_numeric"),indices:n};return W.runKernel(qm,r)}const F_=V({gatherND_:O_});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R_(e,t){if(t==null)return e.shape.slice();if(qn(e.shape,t))return t;if(e.shape.length===t.length){const n=[];for(let s=0;s<e.shape.length;s++)t[s]==null&&e.shape[s]!=null?n.push(e.shape[s]):n.push(t[s]);return n}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P_(e,t,n,s){const r=$(e,"x","dropout");if(O(r.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${r.dtype} tensor instead.`),O(t>=0&&t<1,()=>`rate must be a float in the range [0, 1), but got ${t}.`),t===0)return e instanceof ln?r.clone():r;const o=R_(r,n),a=1-t,i=Ie(Ry(Qt(uh(o,0,1,"float32",s),a)),a);return Ft(r,i)}const M_=V({dropout_:P_});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ob(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function dh(e,t,n){const s=1-e%2,r=new Float32Array(e);for(let o=0;o<e;++o){const a=2*Math.PI*o/(e+s-1);r[o]=t-n*Math.cos(a)}return Vn(r,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function L_(e,t,n=1){const s=$(e,"predictions","inTopK"),r=$(t,"targets","inTopK");O(s.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${s.rank}`),O(s.rank-1===r.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${s.rank} and targets rank ${r.rank}`),Rn(s.shape.slice(0,s.shape.length-1),r.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const o=s.shape[s.shape.length-1];O(n>0&&n<=o,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${o}), but got ${n}`);const a=await s.data(),i=await r.data(),[u,c]=[a.length/o,o],l=mn("bool",u);for(let f=0;f<u;f++){const d=f*c,m=a.subarray(d,d+c),g=[];for(let b=0;b<m.length;b++)g.push({value:m[b],index:b});g.sort((b,y)=>y.value-b.value),l[f]=0;for(let b=0;b<n;b++)if(g[b].index===i[f]){l[f]=1;break}}return e!==s&&s.dispose(),t!==r&&r.dispose(),fs(l,r.shape,"bool")}const z_=L_;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V_(e,t,n,s,r,o="NHWC",a){let i=e;e.rank===3&&(i=gt(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let u=t;u.rank===3&&(u=gt(t,[1,t.shape[0],t.shape[1],t.shape[2]])),O(i.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${i.shape}.`),O(u.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${u.shape}.`),O(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const c=o==="NHWC"?i.shape[3]:i.shape[1],l=o==="NHWC"?u.shape[3]:u.shape[1];O(c===n[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${n[2]}.`),O(l===n[3],()=>`Error in conv2dDerFilter: depth of dy (${l}) must match output depth for filter (${n[3]}).`),Jn("conv2dDerFilter",r,a);const f={x:i,dy:u},d={strides:s,pad:r,dataFormat:o,dimRoundingMode:a,filterShape:n};return W.runKernel(Im,f,d)}const B_=V({conv2DBackpropFilter_:V_});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ph(e,t,n){if(n==null||n==="linear")return e;if(n==="relu")return Ft(e,tb(t));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function mh(e,t){let n=t;const s=Nx(e.shape,t.shape);return s.length>0&&(n=$e(n,s)),gt(n,e.shape)}function gh(e,t,n,s){if(t==="linear")return e;if(t==="relu")return Eu(e);if(t==="elu")return Cy(e);if(t==="relu6")return Yy(e);if(t==="prelu")return Gy(e,n);if(t==="leakyrelu")return Ly(e,s);if(t==="sigmoid")return ko(e);throw new Error(`Unknown fused activation ${t}.`)}const yh=(e,t)=>!(e>0)||t==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W_({x:e,filter:t,strides:n,pad:s,dataFormat:r="NHWC",dilations:o=[1,1],dimRoundingMode:a,bias:i,activation:u="linear",preluActivationWeights:c,leakyreluAlpha:l}){if(u=u||"linear",yh(W.state.gradientDepth,u)===!1){O(r==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${r} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let F=Su(e,t,n,s,r,o,a);return i!=null&&(F=Qt(F,i)),gh(F,u,c,l)}const f=$(e,"x","conv2d","float32"),d=$(t,"filter","conv2d","float32");let m=f,g=!1;f.rank===3&&(g=!0,m=gt(f,[1,f.shape[0],f.shape[1],f.shape[2]])),O(m.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${m.rank}.`),O(d.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${d.rank}.`),Jn("fused conv2d",s,a);const b=r==="NHWC"?m.shape[3]:m.shape[1];O(d.shape[2]===b,()=>`Error in conv2d: depth of input (${b}) must match input depth for filter ${d.shape[2]}.`),O(Qn(n,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);const y=ws(m.shape,d.shape,n,o,s,a);let v;i!=null&&(v=$(i,"bias","fused conv2d"),[v]=Re(v,f),r==="NHWC"?Pe(y.outShape,v.shape):(O(v.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${v.shape.length}.`),O(v.shape.length===0||v.shape[0]===y.outChannels||v.shape[0]===1,()=>`Error in fused conv2d: bias shape (${v.shape}) is not compatible with the number of output channels (${y.outChannels})`)));let I;if(c!=null){const F=c.shape;if(O(F.length<=1||F.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${F.length}.`),F.length===1)O(F[0]===1||F[0]===y.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${F}) is not compatible with the number of output channels (${y.outChannels}).`);else if(F.length===3)try{Pe(F,y.outShape)}catch{const P=`Error in fused conv2d: PReLU activation weights (${F}) is not compatible with the output shape of the conv2d (${y.outShape}).`;throw Error(P)}I=$(c,"prelu weights","fused conv2d")}const _=(F,z)=>{O(r==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${r} but only NHWC is currently supported.`);const[P,D,L,T]=z,K=ph(F,L,u);O(qi(o),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`);const Z=Ey(D.shape,K,P,n,s),rt=B_(D,K,P.shape,n,s),et=[Z,rt];if(T!=null){const nt=mh(T,K);et.push(nt)}return et},N={x:m,filter:d,bias:v,preluActivationWeights:I},C={strides:n,pad:s,dataFormat:r,dilations:o,dimRoundingMode:a,activation:u,leakyreluAlpha:l};return i==null?Ps((z,P,D)=>{let L=W.runKernel(Xc,N,C);return D([P,z,L]),g&&(L=gt(L,[L.shape[1],L.shape[2],L.shape[3]])),{value:L,gradFunc:_}})(m,d):Ps((z,P,D,L)=>{let T=W.runKernel(Xc,N,C);return L([P,z,T,D]),g&&(T=gt(T,[T.shape[1],T.shape[2],T.shape[3]])),{value:T,gradFunc:_}})(m,d,v)}const j_=V({fusedConv2d_:W_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H_(e,t,n,s,r,o=[1,1],a){let i=e;e.rank===3&&(i=gt(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let u=t;u.rank===3&&(u=gt(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const c={x:i,dy:u},l={strides:s,pad:r,dimRoundingMode:a,dilations:o,filterShape:n};return W.runKernel(Fm,c,l)}const q_=V({depthwiseConv2dNativeBackpropFilter_:H_});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K_(e,t,n,s,r,o=[1,1],a){let i=t,u=!1;t.rank===3&&(u=!0,i=gt(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const c={dy:i,filter:n},l={strides:s,pad:r,dimRoundingMode:a,dilations:o,inputShape:e},f=W.runKernel(Rm,c,l);return u?gt(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const U_=V({depthwiseConv2dNativeBackpropInput_:K_});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G_({x:e,filter:t,strides:n,pad:s,dataFormat:r="NHWC",dilations:o=[1,1],dimRoundingMode:a,bias:i,activation:u="linear",preluActivationWeights:c,leakyreluAlpha:l}){if(yh(W.state.gradientDepth,u)===!1){let C=rh(e,t,n,s,r,o,a);return i!=null&&(C=Qt(C,i)),gh(C,u,c,l)}const f=$(e,"x","depthwiseConv2d","float32"),d=$(t,"filter","depthwiseConv2d","float32");let m=f,g=!1;f.rank===3&&(g=!0,m=gt(f,[1,f.shape[0],f.shape[1],f.shape[2]])),O(m.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${m.rank}.`),O(d.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${d.rank}.`),O(m.shape[3]===d.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${m.shape[3]}) must match the inChannels dimension in filter ${d.shape[2]}.`),o==null&&(o=[1,1]),O(Qn(n,o),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),Jn("fused depthwiseConv2d",s,a);const b=ws(m.shape,d.shape,n,o,s,a,!0);let y;i!=null&&(y=$(i,"bias","fused conv2d"),[y]=Re(y,f),Pe(b.outShape,y.shape));let v;c!=null&&(v=$(c,"prelu weights","fused depthwiseConv2d"));const I=(C,F)=>{O(qi(o),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`);const[z,P,D,L]=F,T=ph(C,D,u),K=U_(P.shape,T,z,n,s,o,a),Z=q_(P,T,z.shape,n,s,o,a);if(L!=null){const rt=mh(y,T);return[K,Z,rt]}return[K,Z]},_={x:m,filter:d,bias:y,preluActivationWeights:v},N={strides:n,pad:s,dataFormat:r,dilations:o,dimRoundingMode:a,activation:u,leakyreluAlpha:l};return i==null?Ps((F,z,P)=>{let D=W.runKernel(Yc,_,N);return P([z,F,D]),g&&(D=gt(D,[D.shape[1],D.shape[2],D.shape[3]])),{value:D,gradFunc:I}})(m,d):Ps((F,z,P,D)=>{let L=W.runKernel(Yc,_,N);return D([z,F,L,P]),g&&(L=gt(L,[L.shape[1],L.shape[2],L.shape[3]])),{value:L,gradFunc:I}})(m,d,y)}const X_=V({fusedDepthwiseConv2d_:G_});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y_({a:e,b:t,transposeA:n=!1,transposeB:s=!1,bias:r,activation:o="linear",preluActivationWeights:a,leakyreluAlpha:i=.2}){if(yh(W.state.gradientDepth,o)===!1){let T=be(e,t,n,s);return r!=null&&(T=Qt(T,r)),gh(T,o,a,i)}let u=$(e,"a","fused matMul"),c=$(t,"b","fused matMul");[u,c]=Re(u,c);const l=n?u.shape[u.rank-2]:u.shape[u.rank-1],f=s?c.shape[c.rank-1]:c.shape[c.rank-2],d=n?u.shape[u.rank-1]:u.shape[u.rank-2],m=s?c.shape[c.rank-2]:c.shape[c.rank-1],g=u.shape.slice(0,-2),b=c.shape.slice(0,-2),y=Nt(g),v=Nt(b);O(l===f,()=>`Error in fused matMul: inner shapes (${l}) and (${f}) of Tensors with shapes ${u.shape} and ${c.shape} and transposeA=${n} and transposeB=${s} must match.`);const _=Pe(u.shape.slice(0,-2),c.shape.slice(0,-2)).concat([d,m]),N=n?gt(u,[y,l,d]):gt(u,[y,d,l]),C=s?gt(c,[v,m,f]):gt(c,[v,f,m]);let F;r!=null&&(F=$(r,"bias","fused matMul"),[F]=Re(F,u),Pe(_,F.shape));let z;a!=null&&(z=$(a,"prelu weights","fused matMul"));const P=(T,K)=>{const[Z,rt,et,nt]=K,it=ph(gt(T,et.shape),et,o);let tt,ut;if(!n&&!s?(tt=be(it,rt,!1,!0),ut=be(Z,it,!0,!1)):!n&&s?(tt=be(it,rt,!1,!1),ut=be(it,Z,!0,!1)):n&&!s?(tt=be(rt,it,!1,!0),ut=be(Z,it,!1,!1)):(tt=be(rt,it,!0,!0),ut=be(it,Z,!0,!0)),r!=null){const ft=mh(nt,it);return[tt,ut,ft]}else return[tt,ut]},D={a:N,b:C,bias:F,preluActivationWeights:z},L={transposeA:n,transposeB:s,activation:o,leakyreluAlpha:i};return r==null?Ps((K,Z,rt)=>{const et=W.runKernel(Gc,D,L);return rt([K,Z,et]),{value:gt(et,_),gradFunc:P}})(N,C):Ps((K,Z,rt,et)=>{const nt=W.runKernel(Gc,D,L);return et([K,Z,nt,rt]),{value:gt(nt,_),gradFunc:P}})(N,C,F)}const Z_=V({fusedMatMul_:Y_});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q_=Object.freeze(Object.defineProperty({__proto__:null,conv2d:j_,depthwiseConv2d:X_,matMul:Z_},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J_(e){return dh(e,.54,.46)}const tT=V({hammingWindow_:J_});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eT(e){return dh(e,.5,.5)}const ab=V({hannWindow_:eT});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nT(e,t,n,s=!1,r=0){let o=0;const a=[];for(;o+t<=e.size;)a.push(xe(e,o,t)),o+=n;if(s)for(;o<e.size;){const i=o+t-e.size,u=dn([xe(e,o,t-i),Wa([i],r)]);a.push(u),o+=n}return a.length===0?da([],[0,t]):gt(dn(a),[a.length,t])}const ib=V({frame_:nT});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sT(e,t,n,s,r=ab){s==null&&(s=ob(t));const o=ib(e,t,n),a=Ft(o,r(t));return lh(a,s)}const rT=V({stft_:sT});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oT(e,t,n,s,r="bilinear",o=0){const a=$(e,"image","cropAndResize"),i=$(t,"boxes","cropAndResize","float32"),u=$(n,"boxInd","cropAndResize","int32"),c=i.shape[0];O(a.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${a.rank}.`),O(i.rank===2&&i.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${i.shape}.`),O(u.rank===1&&u.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${i.shape}.`),O(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),O(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),O(r==="bilinear"||r==="nearest",()=>`method must be bilinear or nearest, but was ${r}`);const l={image:a,boxes:i,boxInd:u},f={method:r,extrapolationValue:o,cropSize:s};return W.runKernel(Cm,l,f)}const aT=V({cropAndResize_:oT});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iT(e){const t=$(e,"image","flipLeftRight","float32");O(t.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`);const n={image:t};return W.runKernel(Wm,n,{})}const uT=V({flipLeftRight_:iT});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cT(e){const t=$(e,"image","grayscaleToRGB"),n=t.rank-1,s=t.shape[n];O(t.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`),O(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const r=new Array(t.rank);return r.fill(1,0,n),r[n]=3,ha(t,r)}const lT=V({grayscaleToRGB_:cT});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fT(e){const t=$(e,"image","RGBToGrayscale"),n=t.rank-1,s=t.shape[n];O(t.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${t.rank}.`),O(s===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${s}.`);const r=t.dtype,o=ze(t,"float32"),a=Vn([.2989,.587,.114]);let i;switch(t.rank){case 2:i=go("ij,j->i",o,a);break;case 3:i=go("ijk,k->ij",o,a);break;case 4:i=go("ijkl,l->ijk",o,a);break;case 5:i=go("ijklm,m->ijkl",o,a);break;case 6:i=go("ijklmn,n->ijklm",o,a);break;default:throw new Error("Not a valid tensor rank.")}return i=_s(i,-1),ze(i,r)}const hT=V({rgbToGrayscale_:fT});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dT(e,t,n=0,s=.5){const r=$(e,"image","rotateWithOffset","float32");O(r.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${r.rank}.`);const o={image:r},a={radians:t,fillValue:n,center:s};return W.runKernel(Gg,o,a)}const pT=V({rotateWithOffset_:dT});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jo(e,t,n,s,r,o){s==null&&(s=.5),r==null&&(r=Number.NEGATIVE_INFINITY),o==null&&(o=0);const a=e.shape[0];return n=Math.min(n,a),O(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),O(e.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${e.rank}'`),O(e.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${e.shape[1]}`),O(t.rank===1,()=>"scores must be a 1D tensor"),O(t.shape[0]===a,()=>`scores has incompatible shape with boxes. Expected ${a}, but was ${t.shape[0]}`),O(0<=o&&o<=1,()=>`softNmsSigma must be in [0, 1], but was '${o}'`),{maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mT(e,t,n,s=.5,r=Number.NEGATIVE_INFINITY){const o=$(e,"boxes","nonMaxSuppression","float32"),a=$(t,"scores","nonMaxSuppression","float32"),i=jo(o,a,n,s,r);n=i.maxOutputSize,s=i.iouThreshold,r=i.scoreThreshold;const u={maxOutputSize:n,iouThreshold:s,scoreThreshold:r};return W.runKernel(ag,{boxes:o,scores:a},u)}const gT=V({nonMaxSuppression_:mT});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yT(e,t,n){const s=bT(e,t,n),r=s<0?-(s+1):s;e.splice(r,0,t)}function bT(e,t,n){return vT(e,t,n||wT)}function wT(e,t){return e>t?1:e<t?-1:0}function vT(e,t,n){let s=0,r=e.length,o=0,a=!1;for(;s<r;){o=s+(r-s>>>1);const i=n(t,e[o]);i>0?s=o+1:(r=o,a=!i)}return a?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ub(e,t,n,s,r){return bh(e,t,n,s,r,0)}function cb(e,t,n,s,r,o){return bh(e,t,n,s,r,0,!1,o,!0)}function lb(e,t,n,s,r,o){return bh(e,t,n,s,r,o,!0)}function bh(e,t,n,s,r,o,a=!1,i=!1,u=!1){const c=[];for(let y=0;y<t.length;y++)t[y]>r&&c.push({score:t[y],boxIndex:y,suppressBeginIndex:0});c.sort(Zd);const l=o>0?-.5/o:0,f=[],d=[];for(;f.length<n&&c.length>0;){const y=c.pop(),{score:v,boxIndex:I,suppressBeginIndex:_}=y;if(v<r)break;let N=!1;for(let C=f.length-1;C>=_;--C){const F=kT(e,I,f[C]);if(F>=s){N=!0;break}if(y.score=y.score*xT(s,l,F),y.score<=r)break}y.suppressBeginIndex=f.length,N||(y.score===v?(f.push(I),d.push(y.score)):y.score>r&&yT(c,y,Zd))}const m=f.length,g=n-m;i&&g>0&&(f.push(...new Array(g).fill(0)),d.push(...new Array(g).fill(0)));const b={selectedIndices:f};return a&&(b.selectedScores=d),u&&(b.validOutputs=m),b}function kT(e,t,n){const s=e.subarray(t*4,t*4+4),r=e.subarray(n*4,n*4+4),o=Math.min(s[0],s[2]),a=Math.min(s[1],s[3]),i=Math.max(s[0],s[2]),u=Math.max(s[1],s[3]),c=Math.min(r[0],r[2]),l=Math.min(r[1],r[3]),f=Math.max(r[0],r[2]),d=Math.max(r[1],r[3]),m=(i-o)*(u-a),g=(f-c)*(d-l);if(m<=0||g<=0)return 0;const b=Math.max(o,c),y=Math.max(a,l),v=Math.min(i,f),I=Math.min(u,d),_=Math.max(v-b,0)*Math.max(I-y,0);return _/(m+g-_)}function xT(e,t,n){const s=Math.exp(t*n*n);return n<=e?s:0}function Zd(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function ST(e,t,n,s=.5,r=Number.NEGATIVE_INFINITY){const o=$(e,"boxes","nonMaxSuppressionAsync"),a=$(t,"scores","nonMaxSuppressionAsync"),i=jo(o,a,n,s,r);n=i.maxOutputSize,s=i.iouThreshold,r=i.scoreThreshold;const u=await Promise.all([o.data(),a.data()]),c=u[0],l=u[1],{selectedIndices:f}=ub(c,l,n,s,r);return o!==e&&o.dispose(),a!==t&&a.dispose(),Vn(f,"int32")}const IT=ST;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NT(e,t,n,s=.5,r=Number.NEGATIVE_INFINITY,o=0){const a=$(e,"boxes","nonMaxSuppression"),i=$(t,"scores","nonMaxSuppression"),u=jo(a,i,n,s,r,o);n=u.maxOutputSize,s=u.iouThreshold,r=u.scoreThreshold,o=u.softNmsSigma;const c={boxes:a,scores:i},l={maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:o},f=W.runKernel(ug,c,l);return{selectedIndices:f[0],selectedScores:f[1]}}const _T=V({nonMaxSuppressionWithScore_:NT});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function TT(e,t,n,s=.5,r=Number.NEGATIVE_INFINITY,o=0){const a=$(e,"boxes","nonMaxSuppressionAsync"),i=$(t,"scores","nonMaxSuppressionAsync"),u=jo(a,i,n,s,r,o);n=u.maxOutputSize,s=u.iouThreshold,r=u.scoreThreshold,o=u.softNmsSigma;const c=await Promise.all([a.data(),i.data()]),l=c[0],f=c[1],{selectedIndices:d,selectedScores:m}=lb(l,f,n,s,r,o);return a!==e&&a.dispose(),i!==t&&i.dispose(),{selectedIndices:Vn(d,"int32"),selectedScores:Vn(m)}}const ET=TT;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $T(e,t,n,s=.5,r=Number.NEGATIVE_INFINITY,o=!1){const a=$(e,"boxes","nonMaxSuppression"),i=$(t,"scores","nonMaxSuppression"),u=jo(a,i,n,s,r,null),c=u.maxOutputSize,l=u.iouThreshold,f=u.scoreThreshold,d={boxes:a,scores:i},m={maxOutputSize:c,iouThreshold:l,scoreThreshold:f,padToMaxOutputSize:o},g=W.runKernel(ig,d,m);return{selectedIndices:g[0],validOutputs:g[1]}}const CT=V({nonMaxSuppressionPadded_:$T});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function AT(e,t,n,s=.5,r=Number.NEGATIVE_INFINITY,o=!1){const a=$(e,"boxes","nonMaxSuppressionAsync"),i=$(t,"scores","nonMaxSuppressionAsync"),u=jo(a,i,n,s,r,null),c=u.maxOutputSize,l=u.iouThreshold,f=u.scoreThreshold,[d,m]=await Promise.all([a.data(),i.data()]),{selectedIndices:g,validOutputs:b}=cb(d,m,c,l,f,o);return a!==e&&a.dispose(),i!==t&&i.dispose(),{selectedIndices:Vn(g,"int32"),validOutputs:ce(b,"int32")}}const DT=AT;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OT(e,t,n=!1,s=!1){const r=$(e,"images","resizeBilinear");O(r.rank===3||r.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${r.rank}.`),O(t.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`),O(s===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let o=r,a=!1;r.rank===3&&(a=!0,o=gt(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const i={images:o},u={alignCorners:n,halfPixelCenters:s,size:t},c=W.runKernel(xg,i,u);return a?gt(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const FT=V({resizeBilinear_:OT});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RT(e,t,n=!1,s=!1){const r=$(e,"images","resizeNearestNeighbor");O(r.rank===3||r.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${r.rank}.`),O(t.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`),O(r.dtype==="float32"||r.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),O(s===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let o=r,a=!1;r.rank===3&&(a=!0,o=gt(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const i={images:o},u={alignCorners:n,halfPixelCenters:s,size:t},c=W.runKernel(kg,i,u);return a?gt(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const PT=V({resizeNearestNeighbor_:RT});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MT(e,t="binary",n=!1,s=.5){const r=$(e,"image","threshold"),o=.2989,a=.587,i=.114,u=r.shape[0]*r.shape[1];let c=Ft(Vn([s]),255),l,f,d,m;if(O(r.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${r.rank}.`),O(r.shape[2]===3||r.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${r.shape[2]}.`),O(r.dtype==="int32"||r.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${r.dtype}.`),O(t==="otsu"||t==="binary",()=>`Method must be binary or otsu, but was ${t}`),r.shape[2]===3){[l,f,d]=Da(r,[1,1,1],-1);const y=Ft(l,o),v=Ft(f,a),I=Ft(d,i);m=Qt(Qt(y,v),I)}else m=e;if(t==="otsu"){const y=Ty(ze(Zy(m),"int32"),fs([]),256);c=LT(y,u)}const g=n?oh(m,c):Nu(m,c);return ze(Ft(g,255),"int32")}function LT(e,t){let n=Vn([-1]),s=Vn([0]),r=Vn([0]),o,a,i,u,c,l;for(let f=0;f<e.size-1;f++){o=xe(e,0,f+1),a=xe(e,f+1),c=Ie($e(o),t),l=Ie($e(a),t);const d=$e(Ft(o,Ca(0,o.size)));i=Ie(d,$e(o));const m=Wa(a.shape,o.size),g=Qt(Ca(0,a.size),m),b=Ft(a,g);u=Ie($e(b),$e(a));const y=oe(i,u),v=oe(i,u),I=Ft(c,l);r=Ft(Ft(I,y),v);const _=Nu(r,s);s=ur(_,r,s),n=ur(_,Vn([f]),n)}return n}const zT=V({threshold_:MT});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VT(e,t,n="nearest",s="constant",r=0,o){const a=$(e,"image","transform","float32"),i=$(t,"transforms","transform","float32");O(a.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${a.rank}.`),O(i.rank===2&&(i.shape[0]===a.shape[0]||i.shape[0]===1)&&i.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),O(o==null||o.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${o}.`);const u={image:a,transforms:i},c={interpolation:n,fillMode:s,fillValue:r,outputShape:o};return W.runKernel(jg,u,c)}const BT=V({transform_:VT});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WT(e,t,n){const s=$(e,"a","bandPart");O(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const r=s.shape,[o,a]=s.shape.slice(-2);let i,u;typeof t=="number"?(O(t%1===0,()=>`bandPart(): numLower must be an integer, got ${t}.`),O(t<=o,()=>`bandPart(): numLower (${t}) must not be greater than the number of rows (${o}).`),i=$(t<0?o:t,"numLower","bandPart")):(O(t.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),i=ur(ll(t,0),o,Xi(t,o))),typeof n=="number"?(O(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),O(n<=a,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${a}).`),u=$(n<0?a:n,"numUpper","bandPart")):(O(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),u=ur(ll(n,0),a,Xi(n,a)));const c=gt(Ca(0,o,1,"int32"),[-1,1]),l=Ca(0,a,1,"int32"),f=oe(c,l),d=Ui(oh(f,i),My(f,hs(u))),m=Co([o,a],s.dtype);return gt(Ms(to(gt(s,[-1,o,a])).map(g=>ur(d,g,m))),r)}const jT=V({bandPart_:WT});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HT(e){let t;if(Array.isArray(e)){t=!1,O(e!=null&&e.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const r=e[0].shape[0];for(let o=1;o<e.length;++o)O(e[o].shape[0]===r,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${e[o].shape[0]} vs. ${r})`)}else t=!0,e=Da(e,e.shape[0],0).map(r=>fh(r,[0]));O(e.length<=e[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${e.length}) exceeds number of dimensions (${e[0].shape[0]}).`);const n=[],s=e;for(let r=0;r<e.length;++r)n.push(W.tidy(()=>{let o=s[r];if(r>0)for(let a=0;a<r;++a){const i=Ft($e(Ft(n[a],o)),n[a]);o=oe(o,i)}return Ie(o,Iu(o,"euclidean"))}));return t?Ms(n,0):n}const qT=V({gramSchmidt_:HT});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KT(e,t=!1){if(O(e.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${e.rank}`),e.rank===2)return Qd(e,t);{const n=e.shape.slice(0,e.shape.length-2).reduce((u,c)=>u*c),s=to(gt(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),r=[],o=[];s.forEach(u=>{const[c,l]=Qd(u,t);r.push(c),o.push(l)});const a=gt(Ms(r,0),e.shape),i=gt(Ms(o,0),e.shape);return[a,i]}}function Qd(e,t=!1){return W.tidy(()=>{O(e.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${e.shape.length}D Tensor.`);const n=e.shape[0],s=e.shape[1];let r=Fy(n),o=ir(e);const a=da([[1]],[1,1]);let i=ir(a);const u=n>=s?s:n;for(let c=0;c<u;++c){const l=o,f=i,d=r;[i,o,r]=W.tidy(()=>{const m=xe(o,[c,c],[n-c,1]),g=Iu(m),b=xe(o,[c,c],[1,1]),y=ur(Nu(b,0),da([[-1]]),da([[1]])),v=oe(b,Ft(y,g)),I=Ie(m,v);I.shape[0]===1?i=ir(a):i=dn([a,xe(I,[1,0],[I.shape[0]-1,I.shape[1]])],0);const _=hs(Ie(be(y,v),g)),N=xe(o,[c,0],[n-c,s]),C=Ft(_,i),F=fl(i);if(c===0)o=oe(N,be(C,be(F,N)));else{const D=oe(N,be(C,be(F,N)));o=dn([xe(o,[0,0],[c,s]),D],0)}const z=fl(C),P=xe(r,[0,c],[n,r.shape[1]-c]);if(c===0)r=oe(P,be(be(P,i),z));else{const D=oe(P,be(be(P,i),z));r=dn([xe(r,[0,0],[n,c]),D],1)}return[i,o,r]}),xn([l,f,d])}return!t&&n>s&&(r=xe(r,[0,0],[n,s]),o=xe(o,[0,0],[s,s])),[r,o]})}const UT=V({qr_:KT});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var wn;(function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(wn||(wn={}));function GT(e,t,n=wn.SUM_BY_NONZERO_WEIGHTS){const s=$(e,"losses","computeWeightedLoss");let r=null;t!=null&&(r=$(t,"weights","computeWeightedLoss"));const o=r==null?s:Ft(s,r);if(n===wn.NONE)return o;if(n===wn.SUM)return $e(o);if(n===wn.MEAN){if(r==null)return Gi(o);{const a=s.size/r.size,i=Ie($e(o),$e(r));return a>1?Ie(i,ce(a)):i}}if(n===wn.SUM_BY_NONZERO_WEIGHTS){if(r==null)return Ie($e(o),ce(s.size));{const a=Ft(r,Pr(s.shape)),i=ze($e(Ky(a,ce(0))),"float32");return Ie($e(o),i)}}throw Error(`Unknown reduction: ${n}`)}const js=V({computeWeightedLoss_:GT});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XT(e,t,n,s=wn.SUM_BY_NONZERO_WEIGHTS){const r=$(e,"labels","absoluteDifference"),o=$(t,"predictions","absoluteDifference");let a=null;n!=null&&(a=$(n,"weights","absoluteDifference")),Rn(r.shape,o.shape,"Error in absoluteDifference: ");const i=Dn(oe(r,o));return js(i,a,s)}const YT=V({absoluteDifference_:XT});function ZT(e,t,n,s,r=wn.SUM_BY_NONZERO_WEIGHTS){const o=$(e,"labels","cosineDistance"),a=$(t,"predictions","cosineDistance");let i=null;s!=null&&(i=$(s,"weights","cosineDistance")),Rn(o.shape,a.shape,"Error in cosineDistance: ");const u=ce(1),c=oe(u,$e(Ft(o,a),n,!0));return js(c,i,r)}const QT=V({cosineDistance_:ZT});function JT(e,t,n,s=wn.SUM_BY_NONZERO_WEIGHTS){let r=$(e,"labels","hingeLoss");const o=$(t,"predictions","hingeLoss");let a=null;n!=null&&(a=$(n,"weights","hingeLoss")),Rn(r.shape,o.shape,"Error in hingeLoss: ");const i=ce(1);r=oe(Ft(ce(2),r),i);const u=Eu(oe(i,Ft(r,o)));return js(u,a,s)}const tE=V({hingeLoss_:JT});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eE(e,t,n,s=1,r=wn.SUM_BY_NONZERO_WEIGHTS){const o=$(e,"labels","huberLoss"),a=$(t,"predictions","huberLoss");let i=null;n!=null&&(i=$(n,"weights","huberLoss")),Rn(o.shape,a.shape,"Error in huberLoss: ");const u=ce(s),c=Dn(oe(a,o)),l=Xi(c,u),f=oe(c,l),d=Qt(Ft(ce(.5),Gn(l)),Ft(u,f));return js(d,i,r)}const nE=V({huberLoss_:eE});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sE(e,t,n,s=1e-7,r=wn.SUM_BY_NONZERO_WEIGHTS){const o=$(e,"labels","logLoss"),a=$(t,"predictions","logLoss");let i=null;n!=null&&(i=$(n,"weights","logLoss")),Rn(o.shape,a.shape,"Error in logLoss: ");const u=ce(1),c=ce(s),l=hs(Ft(o,$a(Qt(a,c)))),f=Ft(oe(u,o),$a(Qt(oe(u,a),c))),d=oe(l,f);return js(d,i,r)}const rE=V({logLoss_:sE});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oE(e,t,n,s=wn.SUM_BY_NONZERO_WEIGHTS){const r=$(e,"labels","meanSquaredError"),o=$(t,"predictions","meanSquaredError");let a=null;n!=null&&(a=$(n,"weights","meanSquaredError")),Rn(r.shape,o.shape,"Error in meanSquaredError: ");const i=Jy(r,o);return js(i,a,s)}const aE=V({meanSquaredError_:oE});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iE(e,t){const n=$(e,"labels","sigmoidCrossEntropyWithLogits"),s=$(t,"logits","sigmoidCrossEntropyWithLogits");Rn(n.shape,s.shape,"Error in sigmoidCrossEntropyWithLogits: ");const r=Eu(s),o=Ft(s,n),a=zy(qr(hs(Dn(s))));return Qt(oe(r,o),a)}function uE(e,t,n,s=0,r=wn.SUM_BY_NONZERO_WEIGHTS){let o=$(e,"multiClassLabels","sigmoidCrossEntropy");const a=$(t,"logits","sigmoidCrossEntropy");let i=null;if(n!=null&&(i=$(n,"weights","sigmoidCrossEntropy")),Rn(o.shape,a.shape,"Error in sigmoidCrossEntropy: "),s>0){const c=ce(s),l=ce(1),f=ce(.5);o=Qt(Ft(o,oe(l,c)),Ft(f,c))}const u=iE(o,a);return js(u,i,r)}const cE=V({sigmoidCrossEntropy_:uE});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lE(e,t,n=-1){if(n===-1&&(n=t.rank-1),n!==t.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${t.rank} and dim was ${n}`);return Ps((r,o,a)=>{const u=By(o,[n],!0),c=oe(ze(o,"float32"),u);a([r,c]);const l=hs(Ft(c,r));return{value:$e(l,[n]),gradFunc:(m,g)=>{const[b,y]=g,v=ts(m.shape,[n]);return[Ft(gt(m,v),oe(ze(b,"float32"),qr(y))),Ft(gt(m,v),oe(qr(y),ze(b,"float32")))]}}})(e,t)}function fE(e,t,n,s=0,r=wn.SUM_BY_NONZERO_WEIGHTS){let o=$(e,"onehotLabels","softmaxCrossEntropy");const a=$(t,"logits","softmaxCrossEntropy");let i=null;if(n!=null&&(i=$(n,"weights","softmaxCrossEntropy")),Rn(o.shape,a.shape,"Error in softmaxCrossEntropy: "),s>0){const c=ce(s),l=ce(1),f=ce(o.shape[1]);o=Qt(Ft(o,oe(l,c)),Ie(c,f))}const u=lE(o,a);return js(u,i,r)}const hE=V({softmaxCrossEntropy_:fE});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dE(e,t,n,s){const r=$(e,"indices","sparseFillEmptyRows","int32"),o=$(t,"values","sparseFillEmptyRows"),a=$(n,"denseShape","sparseFillEmptyRows","int32"),i=$(s,"defaultValue","sparseFillEmptyRows",o.dtype);if(r.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${r.shape}`);if(o.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${o.shape}`);if(a.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${a.shape}`);if(i.rank!==0)throw new Error(`Default value should be a scalar but received shape ${i.shape}`);const u={indices:r,values:o,denseShape:a,defaultValue:i},c=W.runKernel(Og,u);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}const pE=V({sparseFillEmptyRows_:dE});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mE(e,t,n){const s=$(e,"inputIndices","sparseReshape","int32"),r=$(t,"inputShape","sparseReshape","int32"),o=$(n,"newShape","sparseReshape","int32");if(s.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${s.shape}`);if(r.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${r.shape}`);if(o.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${o.shape}`);const a={inputIndices:s,inputShape:r,newShape:o},i=W.runKernel(Fg,a);return{outputIndices:i[0],outputShape:i[1]}}const gE=V({sparseReshape_:mE});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yE(e,t,n){const s=$(e,"data","sparseSegmentMean"),r=$(t,"indices","sparseSegmentMean","int32"),o=$(n,"segmentIds","sparseSegmentMean","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${r.shape}`);if(o.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${o.shape}`);const a={data:s,indices:r,segmentIds:o};return W.runKernel(Rg,a)}const bE=V({sparseSegmentMean_:yE});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wE(e,t,n){const s=$(e,"data","sparseSegmentSum"),r=$(t,"indices","sparseSegmentSum","int32"),o=$(n,"segmentIds","sparseSegmentSum","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${r.shape}`);if(o.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${o.shape}`);const a={data:s,indices:r,segmentIds:o};return W.runKernel(Pg,a)}const vE=V({sparseSegmentSum_:wE});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kE(e,t,n,s,r,o,a,i){const u=$(e,"data","stringNGrams","string");if(u.dtype!=="string")throw new Error("Data must be of datatype string");if(u.shape.length!==1)throw new Error(`Data must be a vector, saw: ${u.shape}`);const c=$(t,"dataSplits","stringNGrams");if(c.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const l={separator:n,nGramWidths:s,leftPad:r,rightPad:o,padWidth:a,preserveShortSequences:i},f={data:u,dataSplits:c},d=W.runKernel(zg,f,l);return{nGrams:d[0],nGramsSplits:d[1]}}const xE=V({stringNGrams_:kE});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SE(e,t,n=!0){const s=$(e,"input","stringSplit","string"),r=$(t,"delimiter","stringSplit","string");if(s.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${s.shape}`);if(r.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${r.shape}`);const o={skipEmpty:n},a={input:s,delimiter:r},i=W.runKernel(Vg,a,o);return{indices:i[0],values:i[1],shape:i[2]}}const IE=V({stringSplit_:SE});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NE(e,t){const n=$(e,"input","stringToHashBucketFast","string"),s={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");const r={input:n};return W.runKernel(Bg,r,s)}const _E=V({stringToHashBucketFast_:NE});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TE(e,t,n,s=!0){const r=$(e,"input","staticRegexReplace","string"),o={pattern:t,rewrite:n,replaceGlobal:s};return W.runKernel(Gf,{x:r},o)}const EE=V({staticRegexReplace_:TE});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $E={fft:ch,ifft:Yi,rfft:lh,irfft:Qy},CE={hammingWindow:tT,hannWindow:ab,frame:ib,stft:rT},AE={flipLeftRight:uT,grayscaleToRGB:lT,resizeNearestNeighbor:PT,resizeBilinear:FT,rgbToGrayscale:hT,rotateWithOffset:pT,cropAndResize:aT,nonMaxSuppression:gT,nonMaxSuppressionAsync:IT,nonMaxSuppressionWithScore:_T,nonMaxSuppressionWithScoreAsync:ET,nonMaxSuppressionPadded:CT,nonMaxSuppressionPaddedAsync:DT,threshold:zT,transform:BT},DE={bandPart:jT,gramSchmidt:qT,qr:UT},OE={absoluteDifference:YT,computeWeightedLoss:js,cosineDistance:QT,hingeLoss:tE,huberLoss:nE,logLoss:rE,meanSquaredError:aE,sigmoidCrossEntropy:cE,softmaxCrossEntropy:hE},FE={sparseFillEmptyRows:pE,sparseReshape:gE,sparseSegmentMean:bE,sparseSegmentSum:vE},RE={stringNGrams:xE,stringSplit:IE,stringToHashBucketFast:_E,staticRegexReplace:EE};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PE=new Map,ME=new Map;class LE{getClassName(){return this.constructor.className}static fromConfig(t,n){return new t(n)}}class Or{constructor(){this.classNameMap={}}static getMap(){return Or.instance==null&&(Or.instance=new Or),Or.instance}static register(t){Or.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function zE(e,t,n){O(e.className!=null,()=>"Class being registered does not have the static className property defined."),O(typeof e.className=="string",()=>"className is required to be a string, but got type "+typeof e.className),O(e.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof t>"u"&&(t="Custom"),typeof n>"u"&&(n=e.className);const s=n,r=t+">"+s;return Or.register(e),PE.set(r,e),ME.set(e,r),e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eo extends LE{minimize(t,n=!1,s){const{value:r,grads:o}=this.computeGradients(t,s);if(s!=null){const a=s.map(i=>({name:i.name,tensor:o[i.name]}));this.applyGradients(a)}else this.applyGradients(o);return xn(o),n?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,n){return vS(t,n)}dispose(){this.iterations_!=null&&xn(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:ce(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(t){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(t){return this.iterations_=(await t[0].tensor.data())[0],t.slice(1)}}Object.defineProperty(eo,Symbol.hasInstance,{value:e=>e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VE extends eo{static get className(){return"Adadelta"}constructor(t,n,s=null){super(),this.learningRate=t,this.rho=n,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=W.backend.epsilon())}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,r)=>{const o=W.registeredVariables[s],a=!1;this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accum_grad`,variable:de(()=>Fn(o).variable(a))}),this.accumulatedUpdates[r]==null&&(this.accumulatedUpdates[r]={originalName:`${s}/accum_var`,variable:de(()=>Fn(o).variable(a))});const i=Array.isArray(t)?t[r].tensor:t[s];if(i==null)return;const u=this.accumulatedGrads[r].variable,c=this.accumulatedUpdates[r].variable;de(()=>{const l=Qt(Ft(u,this.rho),Ft(Gn(i),1-this.rho)),f=Ft(Ie(Rs(Qt(c,this.epsilon)),Rs(Qt(u,this.epsilon))),i),d=Qt(Ft(c,this.rho),Ft(Gn(f),1-this.rho));u.assign(l),c.assign(d);const m=Qt(Ft(f,-this.learningRate),o);o.assign(m)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(xn(this.accumulatedGrads.map(t=>t.variable)),xn(this.accumulatedUpdates.map(t=>t.variable)))}async getWeights(){const t=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=t.length/2,s=!1;this.accumulatedGrads=t.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedUpdates=t.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,n){return new t(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BE extends eo{static get className(){return"Adagrad"}constructor(t,n=.1){super(),this.learningRate=t,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,r)=>{const o=W.registeredVariables[s];this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accumulator`,variable:de(()=>Wa(o.shape,this.initialAccumulatorValue).variable(!1))});const a=Array.isArray(t)?t[r].tensor:t[s];if(a==null)return;const i=this.accumulatedGrads[r].variable;de(()=>{const u=Qt(i,Gn(a));i.assign(u);const c=Qt(Ft(Ie(a,Rs(Qt(u,W.backend.epsilon()))),-this.learningRate),o);o.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&xn(this.accumulatedGrads.map(t=>t.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=!1;this.accumulatedGrads=t.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,n){return new t(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WE extends eo{static get className(){return"Adam"}constructor(t,n,s,r=null){super(),this.learningRate=t,this.beta1=n,this.beta2=s,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],de(()=>{this.accBeta1=ce(n).variable(),this.accBeta2=ce(s).variable()}),r==null&&(this.epsilon=W.backend.epsilon())}applyGradients(t){const n=Array.isArray(t)?t.map(s=>s.name):Object.keys(t);de(()=>{const s=oe(1,this.accBeta1),r=oe(1,this.accBeta2);n.forEach((o,a)=>{const i=W.registeredVariables[o],u=!1;this.accumulatedFirstMoment[a]==null&&(this.accumulatedFirstMoment[a]={originalName:`${o}/m`,variable:de(()=>Fn(i).variable(u))}),this.accumulatedSecondMoment[a]==null&&(this.accumulatedSecondMoment[a]={originalName:`${o}/v`,variable:de(()=>Fn(i).variable(u))});const c=Array.isArray(t)?t[a].tensor:t[o];if(c==null)return;const l=this.accumulatedFirstMoment[a].variable,f=this.accumulatedSecondMoment[a].variable,d=Qt(Ft(l,this.beta1),Ft(c,1-this.beta1)),m=Qt(Ft(f,this.beta2),Ft(Gn(c),1-this.beta2)),g=Ie(d,s),b=Ie(m,r);l.assign(d),f.assign(m);const y=Qt(Ft(Ie(g,Qt(Rs(b),this.epsilon)),-this.learningRate),i);i.assign(y)}),this.accBeta1.assign(Ft(this.accBeta1,this.beta1)),this.accBeta2.assign(Ft(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&xn(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedSecondMoment!=null&&xn(this.accumulatedSecondMoment.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(t){t=await this.extractIterations(t),de(()=>{this.accBeta1.assign(Ea(this.beta1,this.iterations_+1)),this.accBeta2.assign(Ea(this.beta2,this.iterations_+1))});const n=t.length/2,s=!1;this.accumulatedFirstMoment=t.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedSecondMoment=t.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,n){return new t(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jE extends eo{static get className(){return"Adamax"}constructor(t,n,s,r=null,o=0){super(),this.learningRate=t,this.beta1=n,this.beta2=s,this.epsilon=r,this.decay=o,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],de(()=>{this.iteration=ce(0).variable(),this.accBeta1=ce(n).variable()}),r==null&&(this.epsilon=W.backend.epsilon())}applyGradients(t){const n=Array.isArray(t)?t.map(s=>s.name):Object.keys(t);de(()=>{const s=oe(1,this.accBeta1),r=Ie(-this.learningRate,Qt(Ft(this.iteration,this.decay),1));n.forEach((o,a)=>{const i=W.registeredVariables[o],u=!1;this.accumulatedFirstMoment[a]==null&&(this.accumulatedFirstMoment[a]={originalName:`${o}/m`,variable:Fn(i).variable(u)}),this.accumulatedWeightedInfNorm[a]==null&&(this.accumulatedWeightedInfNorm[a]={originalName:`${o}/v`,variable:Fn(i).variable(u)});const c=Array.isArray(t)?t[a].tensor:t[o];if(c==null)return;const l=this.accumulatedFirstMoment[a].variable,f=this.accumulatedWeightedInfNorm[a].variable,d=Qt(Ft(l,this.beta1),Ft(c,1-this.beta1)),m=Ft(f,this.beta2),g=Dn(c),b=qy(m,g);l.assign(d),f.assign(b);const y=Qt(Ft(Ie(r,s),Ie(d,Qt(b,this.epsilon))),i);i.assign(y)}),this.iteration.assign(Qt(this.iteration,1)),this.accBeta1.assign(Ft(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&xn(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedWeightedInfNorm!=null&&xn(this.accumulatedWeightedInfNorm.map(t=>t.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,n){return new t(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fb extends eo{static get className(){return"SGD"}constructor(t){super(),this.learningRate=t,this.setLearningRate(t)}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,r)=>{const o=Array.isArray(t)?t[r].tensor:t[s];if(o==null)return;const a=W.registeredVariables[s];de(()=>{const i=Qt(Ft(this.c,o),a);a.assign(i)})}),this.incrementIterations()}setLearningRate(t){this.learningRate=t,this.c!=null&&this.c.dispose(),this.c=cs(ce(-t))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(t){if(t=await this.extractIterations(t),t.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,n){return new t(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HE extends fb{static get className(){return"Momentum"}constructor(t,n,s=!1){super(t),this.learningRate=t,this.momentum=n,this.useNesterov=s,this.accumulations=[],this.m=ce(this.momentum)}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,r)=>{const o=W.registeredVariables[s];this.accumulations[r]==null&&(this.accumulations[r]={originalName:`${s}/momentum`,variable:de(()=>Fn(o).variable(!1))});const a=this.accumulations[r].variable,i=Array.isArray(t)?t[r].tensor:t[s];i!=null&&de(()=>{let u;const c=Qt(Ft(this.m,a),i);this.useNesterov?u=Qt(Ft(this.c,Qt(i,Ft(c,this.m))),o):u=Qt(Ft(this.c,c),o),a.assign(c),o.assign(u)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&xn(this.accumulations.map(t=>t.variable))}setMomentum(t){this.momentum=t}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=!1;this.accumulations=t.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,n){return new t(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qE extends eo{static get className(){return"RMSProp"}constructor(t,n=.9,s=0,r=null,o=!1){if(super(),this.learningRate=t,this.decay=n,this.momentum=s,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=o,r==null&&(this.epsilon=W.backend.epsilon()),t==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,r)=>{const o=W.registeredVariables[s],a=!1;this.accumulatedMeanSquares[r]==null&&(this.accumulatedMeanSquares[r]={originalName:`${s}/rms`,variable:de(()=>Fn(o).variable(a))}),this.accumulatedMoments[r]==null&&(this.accumulatedMoments[r]={originalName:`${s}/momentum`,variable:de(()=>Fn(o).variable(a))}),this.accumulatedMeanGrads[r]==null&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${s}/mg`,variable:de(()=>Fn(o).variable(a))});const i=Array.isArray(t)?t[r].tensor:t[s];if(i==null)return;const u=this.accumulatedMeanSquares[r].variable,c=this.accumulatedMoments[r].variable;de(()=>{const l=Qt(Ft(u,this.decay),Ft(Gn(i),1-this.decay));if(this.centered){const f=this.accumulatedMeanGrads[r].variable,d=Qt(Ft(f,this.decay),Ft(i,1-this.decay)),m=Ie(Ft(i,this.learningRate),Rs(oe(l,Qt(Gn(d),this.epsilon)))),g=Qt(Ft(c,this.momentum),m);u.assign(l),f.assign(d),c.assign(g);const b=oe(o,g);o.assign(b)}else{const f=Qt(Ft(u,this.decay),Ft(Gn(i),1-this.decay)),d=Qt(Ft(c,this.momentum),Ie(Ft(i,this.learningRate),Rs(Qt(f,this.epsilon))));u.assign(f),c.assign(d);const m=oe(o,d);o.assign(m)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&xn(this.accumulatedMeanSquares.map(t=>t.variable)),this.accumulatedMeanGrads!=null&&this.centered&&xn(this.accumulatedMeanGrads.map(t=>t.variable)),this.accumulatedMoments!=null&&xn(this.accumulatedMoments.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&t.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(t.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(t){t=await this.extractIterations(t);const n=this.centered?t.length/3:t.length/2,s=!1;this.accumulatedMeanSquares=t.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedMoments=t.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=t.slice(n*2,n*3).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,n){return new t(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KE=[VE,BE,WE,jE,HE,qE,fb];function UE(){for(const e of KE)zE(e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GE="model",XE=".json",YE=".weights.bin";function Jd(e){return new Promise(t=>setTimeout(t)).then(e)}class Ur{constructor(t){if(!ae().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(Ur.URL_SCHEME)&&(t=t.slice(Ur.URL_SCHEME.length)),(t==null||t.length===0)&&(t=GE),this.modelJsonFileName=t+XE,this.weightDataFileName=t+YE}async save(t){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=Zn.join(t.weightData),s=window.URL.createObjectURL(new Blob([n],{type:"application/octet-stream"}));if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],o=dy(t,r),a=window.URL.createObjectURL(new Blob([JSON.stringify(o)],{type:"application/json"})),i=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(i.download=this.modelJsonFileName,i.href=a,await Jd(()=>i.dispatchEvent(new MouseEvent("click"))),t.weightData!=null){const u=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;u.download=this.weightDataFileName,u.href=s,await Jd(()=>u.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Ba(t)}}}}Ur.URL_SCHEME="downloads://";class ZE{constructor(t){if(t==null||t.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${t}`);this.jsonFile=t[0],this.weightsFiles=t.slice(1)}async load(){return new Promise((t,n)=>{const s=new FileReader;s.onload=r=>{const o=JSON.parse(r.target.result),a=o.modelTopology;if(a==null){n(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(o.weightsManifest==null){n(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){t({modelTopology:a});return}const u=nh(o,c=>this.loadWeights(c));t(u)},s.onerror=r=>n(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),s.readAsText(this.jsonFile)})}loadWeights(t){const n=[],s=[];for(const a of t)n.push(...a.weights),s.push(...a.paths);const r=this.checkManifestAndWeightFiles(t),o=s.map(a=>this.loadWeightsFile(a,r[a]));return Promise.all(o).then(a=>[n,a])}loadWeightsFile(t,n){return new Promise((s,r)=>{const o=new FileReader;o.onload=a=>{const i=a.target.result;s(i)},o.onerror=a=>r(`Failed to weights data from file of path '${t}'.`),o.readAsArrayBuffer(n)})}checkManifestAndWeightFiles(t){const n=[],s=this.weightsFiles.map(o=>Wd(o.name)),r={};for(const o of t)o.paths.forEach(a=>{const i=Wd(a);if(n.indexOf(i)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${i}'`);if(n.push(i),s.indexOf(i)===-1)throw new Error(`Weight file with basename '${i}' is not provided.`);r[a]=this.weightsFiles[s.indexOf(i)]});if(n.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return r}}const QE=e=>ae().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Ur.URL_SCHEME)?JE(e.slice(Ur.URL_SCHEME.length)):null;De.registerSaveRouter(QE);function JE(e="model"){return new Ur(e)}function t2(e){return new ZE(e)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tp(e,t,n,s){a(e),n=n??0,s=s??1,i(n,s);let r=0;const o=u=>(u.then(c=>{const l=n+ ++r/e.length*(s-n);return t(l),c}),u);function a(u){O(u!=null&&Array.isArray(u)&&u.length>0,()=>"promises must be a none empty array")}function i(u,c){O(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${u}`),O(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${c}`),O(c>=u,()=>`startFraction must be no more than endFraction, but got startFraction ${u} and endFraction ${c}`)}return Promise.all(e.map(o))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function hb(e,t){t==null&&(t={});const n=t.fetchFunc==null?ae().platform.fetch:t.fetchFunc,s=e.map(f=>n(f,t.requestInit,{isBinary:!0})),i=(t.onProgress==null?await Promise.all(s):await tp(s,t.onProgress,0,.5)).map(f=>f.arrayBuffer());return t.onProgress==null?await Promise.all(i):await tp(i,t.onProgress,.5,1)}function e2(e,t){var n;const s=t.fetchFunc==null?ae().platform.fetch:t.fetchFunc;let r=0,o;return(n=t.onProgress)===null||n===void 0||n.call(t,0),new ReadableStream({pull:async a=>{for(var i;r<e.length;){o||(o=(await s(e[r],t.requestInit,{isBinary:!0})).body.getReader());const{done:u,value:c}=await o.read();if(u){r++,o=void 0,(i=t.onProgress)===null||i===void 0||i.call(t,r/e.length);continue}a.enqueue(c);return}a.close()}})}async function n2(e,t="",n,s){return db(a=>hb(a,{requestInit:s}))(e,t,n)}function db(e){return async(t,n="",s)=>{const r=t.map(()=>!1),o={},a=s!=null?s.map(()=>!1):[],i=[];if(t.forEach((m,g)=>{let b=0;m.weights.forEach(y=>{const v="quantization"in y?y.quantization.dtype:y.dtype,I=Wr[v]*Nt(y.shape),_=()=>{r[g]=!0,o[g]==null&&(o[g]=[]),o[g].push({manifestEntry:y,groupOffset:b,sizeBytes:I})};s!=null?s.forEach((N,C)=>{N===y.name&&(_(),a[C]=!0)}):_(),i.push(y.name),b+=I})}),!a.every(m=>m)){const m=s.filter((g,b)=>!a[b]);throw new Error(`Could not find weights in manifest with names: ${m.join(", ")}. 
Manifest JSON has weights with names: ${i.join(", ")}.`)}const u=r.reduce((m,g,b)=>(g&&m.push(b),m),[]),c=[];u.forEach(m=>{t[m].paths.forEach(g=>{const b=n+(n.endsWith("/")?"":"/")+g;c.push(b)})});const l=await e(c),f={};let d=0;return u.forEach(m=>{const g=t[m].paths.length,b=new Zn(l.slice(d,d+g));o[m].forEach(v=>{const I=b.slice(v.groupOffset,v.groupOffset+v.sizeBytes),_=ly(I,[v.manifestEntry]);for(const N in _)f[N]=_[N]}),d+=g}),f}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s2="application/octet-stream",r2="application/json";class wh{constructor(t,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(O(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=ae().platform.fetch,O(t!=null&&t.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(t)&&O(t.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${t.length}).`),this.path=t,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{},this.loadOptions=n}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const s=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],r=dy(t,s);if(n.body.append("model.json",new Blob([JSON.stringify(r)],{type:r2}),"model.json"),t.weightData!=null){const a=Zn.join(t.weightData);n.body.append("model.weights.bin",new Blob([a],{type:s2}),"model.weights.bin")}const o=await this.fetch(this.path,n);if(o.ok)return{modelArtifactsInfo:Ba(t),responses:[o]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${o.status}.`)}async loadModelJSON(){const t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error(`Request to ${this.path} failed with status code ${t.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await t.json()}catch{let a=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?a+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":a+=" Please make sure the server is serving valid JSON for this request.",new Error(a)}const s=n.modelTopology,r=n.weightsManifest;if(s==null&&r==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return n}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const t=await this.loadModelJSON();return nh(t,n=>this.loadWeights(n))}async loadStream(){const t=await this.loadModelJSON(),n=await this.getWeightUrls(t.weightsManifest),s=sl(t.weightsManifest),r=()=>e2(n,this.loadOptions);return Object.assign(Object.assign({},t),{weightSpecs:s,getWeightStream:r})}async getWeightUrls(t){const n=Array.isArray(this.path)?this.path[1]:this.path,[s,r]=o2(n),o=this.weightPathPrefix||s,a=[],i=[];for(const u of t)for(const c of u.paths)this.weightUrlConverter!=null?i.push(this.weightUrlConverter(c)):a.push(o+c+r);return this.weightUrlConverter&&a.push(...await Promise.all(i)),a}async loadWeights(t){const n=await this.getWeightUrls(t),s=sl(t),r=await hb(n,this.loadOptions);return[s,r]}}wh.URL_SCHEME_REGEX=/^https?:\/\//;function o2(e){const t=e.lastIndexOf("/"),n=e.lastIndexOf("?"),s=e.substring(0,t),r=n>t?e.substring(n):"";return[s+"/",r]}function hl(e){return e.match(wh.URL_SCHEME_REGEX)!=null}const pb=(e,t)=>{if(typeof fetch>"u"&&(t==null||t.fetchFunc==null))return null;{let n=!0;if(Array.isArray(e)?n=e.every(s=>hl(s)):n=hl(e),n)return vh(e,t)}return null};De.registerSaveRouter(pb);De.registerLoadRouter(pb);function vh(e,t){return new wh(e,t)}function a2(e,t){return vh(e,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dc{constructor(t){this.modelArtifacts=t}load(){return this.modelArtifacts}}class mb{constructor(t){this.saveHandler=t}save(t){return this.saveHandler(t)}}class i2{constructor(t){t.load&&(this.load=()=>Promise.resolve(t.load())),t.save&&(this.save=n=>Promise.resolve(t.save(n)))}}function u2(e,t,n,s){const r=arguments;return new i2(gb(...r))}function gb(e,t,n,s){return arguments.length===1?e.modelTopology!=null||e.weightSpecs!=null?new Dc(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Dc({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Dc({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:s}))}function c2(e){return new mb(e)}function l2(e){return new mb(e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yb=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:Zn,browserFiles:t2,browserHTTPRequest:a2,concatenateArrayBuffers:s1,copyModel:N1,decodeWeights:ly,decodeWeightsStream:hy,encodeWeights:Zv,fromMemory:u2,fromMemorySync:gb,getLoadHandlers:f1,getModelArtifactsForJSON:nh,getModelArtifactsForJSONSync:py,getModelArtifactsInfoForJSON:Ba,getSaveHandlers:l1,getWeightSpecs:sl,http:vh,isHTTPScheme:hl,listModels:S1,loadWeights:n2,moveModel:_1,registerLoadRouter:c1,registerSaveRouter:u1,removeModel:I1,weightsLoaderFactory:db,withSaveHandler:c2,withSaveHandlerSync:l2},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let _r;function f2(e,t=3){if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,s=!1,r=!1,o=!1,a=!1,i=!1;if(e.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&e instanceof ImageData)s=!0;else if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)r=!0;else if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)o=!0;else if(e.getContext!=null)a=!0;else if(typeof ImageBitmap<"u"&&e instanceof ImageBitmap)i=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${e.constructor.name}`);if(Zc($d,W.backendName)!=null){const g={pixels:e},b={numChannels:t};return W.runKernel($d,g,b)}const[c,l]=r?[e.videoWidth,e.videoHeight]:[e.width,e.height];let f;if(a)f=e.getContext("2d").getImageData(0,0,c,l).data;else if(s||n)f=e.data;else if(o||r||i){if(_r==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")_r=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else _r=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});_r.canvas.width=c,_r.canvas.height=l,_r.drawImage(e,0,0,c,l),f=_r.getImageData(0,0,c,l).data}let d;if(t===4)d=new Int32Array(f);else{const g=c*l;d=new Int32Array(g*t);for(let b=0;b<g;b++)for(let y=0;y<t;++y)d[b*t+y]=f[b*4+y]}return eb(d,[l,c,t],"int32")}const h2=V({fromPixels_:f2});function d2(e,t){const n=e.shape.length,s=t.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(t.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[s-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[s-1]} vs. ${n}`);if(Nt(e.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${e.shape}.`);const r=t.shape,o=r[r.length-1];let a=1;for(let f=0;f<r.length-1;++f)a*=r[f];const i=e.shape,u=r.slice();u.pop();let c=1;for(let f=o;f<n;++f)c*=i[f],u.push(i[f]);const l=[...Xt(e.shape).map(f=>f/c),1].slice(0,o);return[u,a,c,l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dl=-2,p2=-1;function m2(e,t,n){const s=e.shape.length;O(s===t.length,()=>`Error in slice${s}D: Length of begin ${t} must match the rank of the array (${s}).`),O(s===n.length,()=>`Error in slice${s}D: Length of size ${n} must match the rank of the array (${s}).`);for(let r=0;r<s;++r)O(t[r]+n[r]<=e.shape[r],()=>`Error in slice${s}D: begin[${r}] + size[${r}] (${t[r]+n[r]}) would overflow input.shape[${r}] (${e.shape[r]})`)}function g2(e,t,n){const s=[];for(let r=0;r<e.length;r++)s[r]=Math.ceil((t[r]-e[r])/n[r]);return s}function y2(e,t,n){let s=n.length;for(let r=0;r<n.length;r++)if(n[r]>1){s=r;break}for(let r=s+1;r<n.length;r++)if(t[r]>0||n[r]!==e[r])return!1;return!0}function b2(e,t){let n=e.length>0?e[e.length-1]:1;for(let s=0;s<e.length-1;s++)n+=e[s]*t[s];return n}function w2(e,t,n){let s;const r=e.shape.length;typeof t=="number"?s=[t,...new Array(r-1).fill(0)]:t.length<r?s=t.concat(new Array(r-t.length).fill(0)):s=t.slice(),s.forEach(a=>{O(a!==-1,()=>"slice() does not support negative begin indexing.")});let o;return n==null?o=new Array(r).fill(-1):typeof n=="number"?o=[n,...new Array(r-1).fill(-1)]:n.length<r?o=n.concat(new Array(r-n.length).fill(-1)):o=n,o=o.map((a,i)=>a>=0?a:(O(a===-1,()=>`Negative size values should be exactly -1 but got ${a} for the slice() size at index ${i}.`),e.shape[i]-s[i])),[s,o]}function v2(e,t,n,s,r,o,a,i,u){let c;if(s==null?(c=new Array(t.length),c.fill(1)):c=s,a!=null&&(a&a-1)!==0)throw new Error("Multiple ellipses in slice is not allowed.");let l=!1;const f={dims:c.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:c.slice(),beginMask:r,endMask:o,ellipsisMask:a,newAxisMask:i,shrinkAxisMask:u};for(let _=0;_<f.dims;_++)l&&(1<<_&i)!==0&&f.numAddAxisAfterEllipsis++,1<<_&a&&(l=!0);l||(f.ellipsisMask|=1<<f.dims,f.dims++);const d={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};k2(f,d);let m=!0,g=!0,b=!0;const y=[],v=[];for(let _=0;_<e.length;++_){if(d.strides[_]===0)throw Error(`strides[${_}] must be non-zero`);const N=!!(d.shrinkAxisMask&1<<_),C=e[_];if(C===-1){y.push(N?1:-1);continue}const F=[d.beginMask&1<<_,d.endMask&1<<_],z=[d.strides[_]>0?0:-1,d.strides[_]>0?C:C-1];if(N&&d.strides[_]<=0)throw Error("only stride 1 allowed on non-range indexing.");b=b&&d.strides[_]===1;const P=!!(d.beginMask&1<<_&&d.endMask&1<<_);if(d.beginValid&&d.endValid){if(N){const K=d.begin[_]<0?C+d.begin[_]:d.begin[_];if(d.begin[_]=K,d.end[_]=d.begin[_]+1,K<0||K>=C)throw Error(`slice index ${d.begin[_]} of dimension ${_} out of bounds.`)}else d.begin[_]=ep(d.begin[_],0,d.strides[_],C,F,z),d.end[_]=ep(d.end[_],1,d.strides[_],C,F,z);const T=d.strides[_]===1&&d.begin[_]===0&&d.end[_]===C;m=m&&T,g=g&&(_===0&&d.strides[_]===1||T)}else m=m&&d.strides[_]===1&&P,g=g&&(_===0&&d.strides[_]===1||P);let D,L=!1;if(d.beginValid&&d.endValid?(D=d.end[_]-d.begin[_],L=!0):N?(D=1,L=!0):P&&C>=0&&(d.strides[_]<0?D=-C:D=C,L=!0),L){let T;D===0||D<0!=d.strides[_]<0?T=0:T=Math.trunc(D/d.strides[_])+(D%d.strides[_]!==0?1:0),y.push(T)}else y.push(-1)}for(let _=0;_<d.finalShapeGatherIndices.length;++_){const N=d.finalShapeGatherIndices[_];N>=0?v.push(y[N]):N===dl&&v.push(1)}return{finalShapeSparse:v.filter((_,N)=>d.finalShapeGatherIndices[N]!==dl),finalShape:v,isIdentity:m,sliceDim0:g,isSimpleSlice:b,begin:d.begin,end:d.end,strides:d.strides}}function k2(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let n=0;t.beginValid=e.begin!=null,t.endValid=e.end!=null,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let s=0;s<e.dims;s++)if(1<<s&e.ellipsisMask){const r=Math.min(t.dims-(e.dims-s)+1+e.numAddAxisAfterEllipsis,t.dims);for(;n<r;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=s}else if(1<<s&e.newAxisMask)t.finalShapeGatherIndices.push(dl),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${t.dims} dims, ${t.begin.length}.`);e.begin!=null&&(t.begin[n]=e.begin[s]),e.end!=null&&(t.end[n]=e.end[s]),t.strides[n]=e.strides[s],e.beginMask&1<<s&&(t.beginMask|=1<<n),e.endMask&1<<s&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<s?(t.finalShapeGatherIndices.push(p2),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(s)),t.inputShapeGatherIndicesSparse[n]=s,n++}}function ep(e,t,n,s,r,o){if(r[t])return n>0?o[t]:o[t+1&1];{const a=e<0?s+e:e;return a<o[0]?o[0]:a>o[1]?o[1]:a}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x2(e,t){const n=e[0].length;e.forEach((r,o)=>{O(r.length===n,()=>`Error in concat${n}D: rank of tensors[${o}] must be the same as the rank of the rest (${n})`)}),O(t>=0&&t<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const s=e[0];e.forEach((r,o)=>{for(let a=0;a<n;a++)O(a===t||r[a]===s[a],()=>`Error in concat${n}D: Shape of tensors[${o}] (${r}) does not match the shape of the rest (${s}) along the non-concatenated axis ${o}.`)})}function Oc(e,t){const n=e[0].slice();for(let s=1;s<e.length;s++)n[t]+=e[s][t];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var is;(function(e){e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS"})(is||(is={}));function S2(e,t,n){let s=new Array;if(n==null&&t==null)return s;if(t==null)for(;s.length<e+n.length;)s.push(-1);else s=t.slice();if(n==null)return s;if(e+n.length!==s.length)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.rank = ${e+n.length}, but shape.rank = ${s.length}`);for(let r=1;r<n.length;++r){const o=n[r],a=s[s.length-n.length+r],i=s[a];if(o>=0)if(i>=0){if(i!==o)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.shape[${r+e}] = ${o} but shape[${r+e}] = ${i}`)}else s[a]=o}return s}function I2(e){const t={FIRST_DIM_SIZE:is.FIRST_DIM_SIZE,VALUE_ROWIDS:is.VALUE_ROWIDS,ROW_LENGTHS:is.ROW_LENGTHS,ROW_SPLITS:is.ROW_SPLITS,ROW_LIMITS:is.ROW_LIMITS,ROW_STARTS:is.ROW_STARTS},n=[];for(const s of e)if(s in t)n.push(t[s]);else break;return n}function N2(e){return e.length===0?0:e[0]===is.FIRST_DIM_SIZE?e.length-1:e.length}function _2(e,t){if(e==null||t==null)return;const n=e.length,s=t.length;if(n>=s)throw new Error(`defaultValue.shape=${e} and ragged tensor flatValues.shape=${t}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${s})`);for(let r=0;r<Math.min(n,s-1);++r){const o=e[r],a=t[r+1];if(o>=0&&a>=0&&o!==1&&o!==a)throw new Error(`defaultValue.shape=${e}, and ragged tensor input flatValues.shape=${t} are incompatible: defaultValue.shape[${r-e.length}] = ${o} but ragged tensor input.flatValues.shape[${r-e.length}] = ${a}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T2(e,t,n){const s=n*(typeof e=="number"?e:e[0]),r=t*(typeof e=="number"?e:e[1]);return[s,r]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bb(e,t,n,s=!0){let r=[];if(s)r=r.concat(t.slice(0)),r.push(e[0]/n),r=r.concat(e.slice(1));else{r=r.concat(e[0]);const o=t.length;for(let a=0;a<o;++a)r=r.concat([e[a+1]/t[a],t[a]]);r=r.concat(e.slice(o+1))}return r}function wb(e,t,n=!0){const s=[];if(n){s.push(t);for(let r=t+1;r<e;++r)r<=2*t?(s.push(r),s.push(r-(t+1))):s.push(r)}else{const r=[],o=[];for(let a=1;a<e;++a)a>=t*2+1||a%2===1?o.push(a):r.push(a);s.push(...r),s.push(0),s.push(...o)}return s}function vb(e,t,n,s=!0){const r=[];s?r.push(e[0]/n):r.push(e[0]*n);for(let o=1;o<e.length;++o)o<=t.length?s?r.push(t[o-1]*e[o]):r.push(e[o]/t[o-1]):r.push(e[o]);return r}function E2(e,t){const n=[0];for(let s=0;s<t;++s)n.push(e[s][0]);return n}function $2(e,t,n){const s=e.slice(0,1);for(let r=0;r<n;++r)s.push(e[r+1]-t[r][0]-t[r][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C2=1.7580993408473768,A2=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D2=.3275911,O2=.254829592,F2=-.284496736,R2=1.421413741,P2=-1.453152027,M2=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ao(e,t){if(e.length!==t.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${e.length}, imag: ${t.length}.`);const n=new Float32Array(e.length*2);for(let s=0;s<n.length;s+=2)n[s]=e[s/2],n[s+1]=t[s/2];return n}function L2(e){const t=new Float32Array(e.length/2),n=new Float32Array(e.length/2);for(let s=0;s<e.length;s+=2)t[s/2]=e[s],n[s/2]=e[s+1];return{real:t,imag:n}}function z2(e){const t=Math.ceil(e.length/4),n=new Float32Array(t),s=new Float32Array(t);for(let r=0;r<e.length;r+=4)n[Math.floor(r/4)]=e[r],s[Math.floor(r/4)]=e[r+1];return{real:n,imag:s}}function V2(e){const t=Math.floor(e.length/4),n=new Float32Array(t),s=new Float32Array(t);for(let r=2;r<e.length;r+=4)n[Math.floor(r/4)]=e[r],s[Math.floor(r/4)]=e[r+1];return{real:n,imag:s}}function kb(e,t){const n=e[t*2],s=e[t*2+1];return{real:n,imag:s}}function B2(e,t,n,s){e[s*2]=t,e[s*2+1]=n}function W2(e,t){const n=new Float32Array(e/2),s=new Float32Array(e/2);for(let r=0;r<Math.ceil(e/2);r++){const o=(t?2:-2)*Math.PI*(r/e);n[r]=Math.cos(o),s[r]=Math.sin(o)}return{real:n,imag:s}}function j2(e,t,n){const s=(n?2:-2)*Math.PI*(e/t),r=Math.cos(s),o=Math.sin(s);return{real:r,imag:o}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fc="->",H2=/->/g,np=",",sp="...";function q2(e,t){e=e.replace(/\s/g,"");const n=(e.length-e.replace(H2,"").length)/Fc.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${Fc}").`);const[s,r]=e.split(Fc);O(s.indexOf(sp)===-1,()=>`The ellipsis notation ("${sp}") is not supported yet.`);const o=s.split(np),a=o.length;if(t!==a)throw new Error(`Expected ${a} input tensors, received ${t}`);if(a>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const i=[];for(let d=0;d<r.length;++d){const m=r[d];if(!o.some(g=>g.indexOf(m)!==-1))throw new Error(`Output subscripts contain the label ${m} not present in the input subscripts.`);i.indexOf(m)===-1&&i.push(m)}for(let d=0;d<s.length;++d){const m=s[d];i.indexOf(m)===-1&&m!==np&&i.push(m)}const u=new Array(o.length);for(let d=0;d<a;++d){if(new Set(o[d].split("")).size!==o[d].length)throw new Error(`Found duplicate axes in input component ${o[d]}. Support for duplicate axes in input is not implemented yet.`);u[d]=[];for(let m=0;m<o[d].length;++m)u[d].push(i.indexOf(o[d][m]))}const c=i.length,l=r.length,f=[];for(let d=l;d<c;++d)f.push(d);return{allDims:i,summedDims:f,idDims:u}}function K2(e,t){let n=new Array(e);n.fill(-1);for(let r=0;r<t.length;++r)n[t[r]]=r;const s=[];for(let r=0;r<e;++r)n[r]===-1&&s.push(r);return n=n.filter(r=>r!==-1),{permutationIndices:n,expandDims:s}}function U2(e,t,n){const s=new Array(e);for(let r=0;r<n.length;++r){const o=n[r].shape;for(let a=0;a<t[r].length;++a)s[t[r][a]]===void 0?s[t[r][a]]=o[a]:O(s[t[r][a]]===o[a],()=>`Expected dimension ${s[t[r][a]]} at axis ${a} of input shaped ${JSON.stringify(o)}, but got dimension ${o[a]}`)}}function G2(e,t){const n=e,s=[];let r=0;e.length===0&&n.push(-1),r=e.length+1;for(let a=0;a<r;++a)s.push([]);const o=[];for(let a=0;a<n.length;++a){const i=n[a],u=Y2(t,i);for(const c of u)o.indexOf(c)===-1&&(s[a].push(c),o.push(c))}return{path:n,steps:s}}function X2(e){return e.every((t,n)=>t===n)}function Y2(e,t){const n=[];for(let s=0;s<e.length;++s)(e[s].length===0||e[s].indexOf(t)!==-1||t===-1)&&n.push(s);return n}function Z2(e,t,n=0){let s=[];if(typeof t=="number")O(e.shape[n]%t===0,()=>"Number of splits must evenly divide the axis."),s=new Array(t).fill(e.shape[n]/t);else{const r=t.reduce((a,i)=>(i===-1&&(a+=1),a),0);O(r<=1,()=>"There should be only one negative value in split array.");const o=t.indexOf(-1);if(o!==-1){const a=t.reduce((i,u)=>u>0?i+u:i);t[o]=e.shape[n]-a}O(e.shape[n]===t.reduce((a,i)=>a+i),()=>"The sum of sizes must match the size of the axis dimension."),s=t}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q2(e){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${e}`}function J2(e,t){return`indices(${e}, 0) is invalid: ${t} < 0`}function t$(e,t,n){return`indices(${e}, 0) is invalid: ${t} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e$(e,t){return`only one output dimension may be -1, not both ${e} and ${t}`}function n$(e,t){return`size ${e} must be non-negative, not ${t}`}function s$(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function r$(e,t){const n=Nt(e),s=Nt(t);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${e} outputShape= ${t}`}function o$(e,t){const n=Nt(e),s=Nt(t);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${s}. inputShape=${e} outputShape=${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rp(){return"segment ids must be >= 0"}function a$(){return"segment ids are not increasing"}function i$(e,t){return`Segment id ${e} out of range [0, ${t}), possibly because segmentIds input is not sorted.`}function u$(e,t,n){return`Bad: indices[${e}] == ${t} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c$(e,t,n,s){const r=t.shape.length,o=e.shape.length;if(s!==0&&(s<-r||s>r))throw new Error(`Expect batchDims in the range of [-${r}, ${r}], but got ${s}`);if(s<0&&(s+=r),s>o)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${o}).`);if(n<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${n}).`);for(let f=0;f<s;++f)if(e.shape[f]!==t.shape[f])throw new Error(`x.shape[${f}]: ${e.shape[f]} should be equal to indices.shape[${f}]: ${t.shape[f]}.`);const a=e.shape[n],i=[];let u=1,c=1,l=1;for(let f=0;f<s;++f)i.push(e.shape[f]),u*=e.shape[f];for(let f=s;f<n;f++)i.push(e.shape[f]),c*=e.shape[f];for(let f=s;f<r;f++)i.push(t.shape[f]);for(let f=n+1;f<o;f++)i.push(e.shape[f]),l*=e.shape[f];return{batchSize:u,sliceSize:l,outerSize:c,dimSize:a,outputShape:i}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oa(e){try{return e.map(t=>Ia(t))}catch(t){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${t}`)}}function l$(e){return e.map(t=>Mr(t))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */UE();/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f$=ae();f$.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,e=>{e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var _n;(function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"})(_n||(_n={}));var op;(function(e){(function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"})(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))})(op||(op={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h$={};function xb(e){return h$[e]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x(e,t,n,s,r){const o=t.inputParams[e];if(o&&o.inputIndexStart!==void 0){const i=o.inputIndexStart,u=o.inputIndexEnd===0?void 0:o.inputIndexEnd===void 0?i+1:o.inputIndexEnd,c=i<0?t.inputNames.length+i:i;if(o.type==="tensor")return Je(t.inputNames[c],n,s,r);if(o.type==="tensors"){const d=t.inputs.slice(i,u);return t.inputNames.slice(i,u).filter((g,b)=>{var y;return((y=d[b])===null||y===void 0?void 0:y.op)!=="NoOp"}).map(g=>Je(g,n,s,r))}const l=Je(t.inputNames[c],n,s,r),f=l.dataSync();return o.type==="number"?f[0]:Wn(l.shape,f)}const a=t.attrParams[e];return a&&a.value}function Je(e,t,n,s){const[r,o]=Tn(e,n);if(s!=null){const i=s.getHashTableHandleByName(r);if(i!=null)return i}const a=n.currentContextIds.find(i=>!!t[Zi(r,i)]);return a!==void 0?t[Zi(r,a)][o]:void 0}function ap(e,t,n){return t[Zi(e,n.currentContextId)]}function Ts(e,t){const[n,s,r]=Tn(e,t);return[Zi(n,t&&t.currentContextId),s,r]}function Zi(e,t){return t?`${e}-${t}`:e}function Tn(e,t){if(e==="")return["",0,void 0];const n=t!=null&&t.parseNodeNameCache!=null;if(n){const o=t.parseNodeNameCache.get(e);if(o!=null)return o}const s=e.split(":");let r;if(s.length===1)r=[e,0,void 0];else{const o=s[0],a=s.length===3?s[1]:void 0,i=Number(s[s.length-1]);r=[o,i,a]}return n&&t.parseNodeNameCache.set(e,r),r}function Pi(e,t,n){let s=x("pad",e,t,n);if(s==="explicit"){s=x("explicitPaddings",e,t,n);const r=[[0,0],[0,0],[0,0],[0,0]];for(let o=0;o<4;o++)r[o][0]=s[o*2],r[o][1]=s[o*2+1];return r}return s}function Es(e){return e.kept?e:ir(e)}/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d$=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],p$=Object.freeze(Object.defineProperty({__proto__:null,json:d$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m$=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],g$=Object.freeze(Object.defineProperty({__proto__:null,json:m$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y$=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],b$=Object.freeze(Object.defineProperty({__proto__:null,json:y$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w$=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],v$=Object.freeze(Object.defineProperty({__proto__:null,json:w$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k$=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],x$=Object.freeze(Object.defineProperty({__proto__:null,json:k$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S$=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],I$=Object.freeze(Object.defineProperty({__proto__:null,json:S$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N$=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],_$=Object.freeze(Object.defineProperty({__proto__:null,json:N$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T$=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],E$=Object.freeze(Object.defineProperty({__proto__:null,json:T$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $$=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],C$=Object.freeze(Object.defineProperty({__proto__:null,json:$$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A$=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],D$=Object.freeze(Object.defineProperty({__proto__:null,json:A$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O$=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],F$=Object.freeze(Object.defineProperty({__proto__:null,json:O$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R$=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],P$=Object.freeze(Object.defineProperty({__proto__:null,json:R$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M$=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],L$=Object.freeze(Object.defineProperty({__proto__:null,json:M$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z$=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],V$=Object.freeze(Object.defineProperty({__proto__:null,json:z$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B$=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],W$=Object.freeze(Object.defineProperty({__proto__:null,json:B$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j$=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],H$=Object.freeze(Object.defineProperty({__proto__:null,json:j$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q$=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],K$=Object.freeze(Object.defineProperty({__proto__:null,json:q$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U$=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],G$=Object.freeze(Object.defineProperty({__proto__:null,json:U$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X$=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],Y$=Object.freeze(Object.defineProperty({__proto__:null,json:X$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ip{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const t=[p$,g$,b$,v$,x$,I$,_$,E$,C$,D$,F$,P$,L$,V$,W$,H$,K$,G$,Y$],n=[].concat(...t.map(s=>s.json));this.opMappers=n.reduce((s,r)=>(s[r.tfOpName]=r,s),{})}transformGraph(t,n={}){const s=t.node,r=[],o=[],a=[],i=s.reduce((b,y)=>(b[y.name]=this.mapNode(y),y.op.startsWith("Placeholder")?r.push(b[y.name]):y.op==="Const"?o.push(b[y.name]):(y.input==null||y.input.length===0)&&a.push(b[y.name]),b),{});let u=[];const c=[];let l={},f={};n!=null&&(l=this.mapSignatureEntries(n.inputs),f=this.mapSignatureEntries(n.outputs));const d=Object.keys(i);d.forEach(b=>{const y=i[b];y.inputNames.forEach((v,I)=>{const[_,,N]=Ts(v),C=i[_];if(C.outputs!=null){const F=C.outputs.indexOf(N);if(F!==-1){const z=`${_}:${F}`;y.inputNames[I]=z}}y.inputs.push(C),C.children.push(y)})}),Object.keys(f).length===0?d.forEach(b=>{const y=i[b];y.children.length===0&&c.push(y)}):Object.keys(f).forEach(b=>{const[y]=Ts(b),v=i[y];v!=null&&(v.signatureKey=f[b],c.push(v))}),Object.keys(l).length>0?Object.keys(l).forEach(b=>{const[y]=Ts(b),v=i[y];v&&(v.signatureKey=l[b],u.push(v))}):u=r;let m={};t.library!=null&&t.library.function!=null&&(m=t.library.function.reduce((b,y)=>(b[y.signature.name]=this.mapFunction(y),b),{}));const g={nodes:i,inputs:u,outputs:c,weights:o,placeholders:r,signature:n,functions:m};return a.length>0&&(g.initNodes=a),g}mapSignatureEntries(t){return Object.keys(t||{}).reduce((n,s)=>(n[t[s].name]=s,n),{})}mapNode(t){const n=xb(t.op)||this.opMappers[t.op]||{};t.attr==null&&(t.attr={});const s={name:t.name,op:t.op,category:n.category,inputNames:(t.input||[]).map(r=>r.startsWith("^")?r.slice(1):r),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr,outputs:n.outputs};return n.inputs!=null&&(s.inputParams=n.inputs.reduce((r,o)=>(r[o.name]={type:o.type,inputIndexStart:o.start,inputIndexEnd:o.end},r),{})),n.attrs!=null&&(s.attrParams=n.attrs.reduce((r,o)=>{const a=o.type;let i;switch(o.type){case"string":i=pl(t.attr,o.tfName,o.defaultValue),i===void 0&&o.tfDeprecatedName&&(i=pl(t.attr,o.tfDeprecatedName,o.defaultValue));break;case"string[]":i=kl(t.attr,o.tfName,o.defaultValue),i===void 0&&o.tfDeprecatedName&&(i=kl(t.attr,o.tfDeprecatedName,o.defaultValue));break;case"number":i=gl(t.attr,o.tfName,o.defaultValue||0),i===void 0&&o.tfDeprecatedName&&(i=gl(t.attr,o.tfDeprecatedName,o.defaultValue));break;case"number[]":i=vl(t.attr,o.tfName,o.defaultValue),i===void 0&&o.tfDeprecatedName&&(i=vl(t.attr,o.tfDeprecatedName,o.defaultValue));break;case"bool":i=ml(t.attr,o.tfName,o.defaultValue),i===void 0&&o.tfDeprecatedName&&(i=ml(t.attr,o.tfDeprecatedName,o.defaultValue));break;case"bool[]":i=Sl(t.attr,o.tfName,o.defaultValue),i===void 0&&o.tfDeprecatedName&&(i=Sl(t.attr,o.tfDeprecatedName,o.defaultValue));break;case"shape":i=wl(t.attr,o.tfName,o.defaultValue),i===void 0&&o.tfDeprecatedName&&(i=wl(t.attr,o.tfDeprecatedName,o.defaultValue));break;case"shape[]":i=xl(t.attr,o.tfName,o.defaultValue),i===void 0&&o.tfDeprecatedName&&(i=xl(t.attr,o.tfDeprecatedName,o.defaultValue));break;case"dtype":i=yl(t.attr,o.tfName,o.defaultValue),i===void 0&&o.tfDeprecatedName&&(i=yl(t.attr,o.tfDeprecatedName,o.defaultValue));break;case"dtype[]":i=bl(t.attr,o.tfName,o.defaultValue),i===void 0&&o.tfDeprecatedName&&(i=bl(t.attr,o.tfDeprecatedName,o.defaultValue));break;case"func":i=up(t.attr,o.tfName,o.defaultValue),i===void 0&&o.tfDeprecatedName&&(i=up(t.attr,o.tfDeprecatedName,o.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${o.type} for op: ${t.op}`)}return r[o.name]={value:i,type:a},r},{})),s}mapFunction(t){const n=t.nodeDef,s=[],r=[];let o={};n!=null&&(o=n.reduce((f,d)=>(f[d.name]=this.mapNode(d),d.op==="Const"&&r.push(f[d.name]),f),{}));const a=[],i=[];t.signature.inputArg.forEach(f=>{const[d]=Ts(f.name),m={name:d,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:kh(f.type),type:"dtype"}},children:[]};m.signatureKey=f.name,a.push(m),o[d]=m}),Object.keys(o).forEach(f=>{const d=o[f];d.inputNames.forEach((m,g)=>{const[b,,y]=Ts(m),v=o[b];if(v.outputs!=null){const I=v.outputs.indexOf(y);if(I!==-1){const _=`${b}:${I}`;d.inputNames[g]=_}}d.inputs.push(v),v.children.push(d)})});const c=t.ret;t.signature.outputArg.forEach(f=>{const[d,m]=Ts(c[f.name]),g=o[d];g!=null&&(g.defaultOutput=m,i.push(g))});const l=this.mapArgsToSignature(t);return{nodes:o,inputs:a,outputs:i,weights:r,placeholders:s,signature:l}}mapArgsToSignature(t){return{methodName:t.signature.name,inputs:t.signature.inputArg.reduce((n,s)=>(n[s.name]=this.mapArgToTensorInfo(s),n),{}),outputs:t.signature.outputArg.reduce((n,s)=>(n[s.name]=this.mapArgToTensorInfo(s,t.ret),n),{})}}mapArgToTensorInfo(t,n){let s=t.name;return n!=null&&(s=n[s]),{name:s,dtype:t.type}}}function Z$(e){const t=ae().global;if(typeof t.atob<"u")return t.atob(e);if(typeof Buffer<"u")return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function Sb(e,t){const n=Array.isArray(e)?String.fromCharCode.apply(null,e):Z$(e);return t?n:n.toLowerCase()}function pl(e,t,n,s=!1){const r=e[t];return r!=null?Sb(r.s,s):n}function ml(e,t,n){const s=e[t];return s?s.b:n}function gl(e,t,n){const s=e[t]||{},r=s.i!=null?s.i:s.f!=null?s.f:n;return typeof r=="number"?r:parseInt(r,10)}function kh(e){switch(typeof e=="string"&&(e=_n[e]),e){case _n.DT_FLOAT:case _n.DT_HALF:return"float32";case _n.DT_INT32:case _n.DT_INT64:case _n.DT_INT8:case _n.DT_UINT8:return"int32";case _n.DT_BOOL:return"bool";case _n.DT_DOUBLE:return"float32";case _n.DT_STRING:return"string";case _n.DT_COMPLEX64:case _n.DT_COMPLEX128:return"complex64";default:return null}}function up(e,t,n){const s=e[t];return s&&s.func?s.func.name:n}function yl(e,t,n){const s=e[t];return s&&s.type?kh(s.type):n}function bl(e,t,n){const s=e[t];return s&&s.list&&s.list.type?s.list.type.map(r=>kh(r)):n}function Ib(e){if(!e.unknownRank)return e.dim!=null?e.dim.map(t=>typeof t.size=="number"?t.size:parseInt(t.size,10)):[]}function wl(e,t,n){const s=e[t];return s&&s.shape?Ib(s.shape):n}function vl(e,t,n){const s=e[t];return s?((s.list.f&&s.list.f.length?s.list.f:s.list.i)||[]).map(r=>typeof r=="number"?r:parseInt(r,10)):n}function kl(e,t,n,s=!1){const r=e[t];return r&&r.list&&r.list.s?r.list.s.map(o=>Sb(o,s)):n}function xl(e,t,n){const s=e[t];return s&&s.list&&s.list.shape?s.list.shape.map(r=>Ib(r)):n}function Sl(e,t,n){const s=e[t];return s&&s.list&&s.list.b?s.list.b:n}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Q${constructor(t,n,s){this.node=t,this.tensorMap=n,this.context=s,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map(r=>this.getInput(r)),t.rawAttrs!=null&&(this.attrs=Object.keys(t.rawAttrs).reduce((r,o)=>(r[o]=this.getAttr(o),r),{}))}getInput(t){return Je(t,this.tensorMap,this.context)}getAttr(t,n){const s=this.node.rawAttrs[t];if(s.tensor!=null)return Je(t,this.tensorMap,this.context);if(s.i!=null||s.f!=null)return gl(this.node.rawAttrs,t,n);if(s.s!=null)return pl(this.node.rawAttrs,t,n);if(s.b!=null)return ml(this.node.rawAttrs,t,n);if(s.shape!=null)return wl(this.node.rawAttrs,t,n);if(s.type!=null)return yl(this.node.rawAttrs,t,n);if(s.list!=null){if(s.list.i!=null||s.list.f!=null)return vl(this.node.rawAttrs,t,n);if(s.list.s!=null)return kl(this.node.rawAttrs,t,n);if(s.list.shape!=null)return xl(this.node.rawAttrs,t,n);if(s.list.b!=null)return Sl(this.node.rawAttrs,t,n);if(s.list.type!=null)return bl(this.node.rawAttrs,t,n)}return n}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const en=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:cy,abs:Dn,acos:z1,acosh:B1,add:Qt,addN:j1,all:q1,any:U1,argMax:X1,argMin:Z1,asin:J1,asinh:ek,atan:sk,atan2:ok,atanh:ik,avgPool:Ny,avgPool3d:mk,basicLSTMCell:xk,batchNorm:xu,batchNorm2d:Tk,batchNorm3d:$k,batchNorm4d:Ak,batchToSpaceND:_y,bincount:Ty,bitwiseAnd:Fk,booleanMaskAsync:I_,broadcastArgs:Pk,broadcastTo:fa,buffer:ie,cast:ze,ceil:zk,clipByValue:Bk,clone:ir,complex:fr,concat:dn,concat1d:jk,concat2d:qk,concat3d:Uk,concat4d:Xk,conv1d:Qk,conv2d:Su,conv2dTranspose:ex,conv3d:sx,conv3dTranspose:ix,cos:cx,cosh:fx,cosineWindow:dh,cumprod:dx,cumsum:mx,denseBincount:yx,depthToSpace:wx,depthwiseConv2d:rh,diag:xx,dilation2d:Ix,div:Ie,divNoNan:Cx,dot:Dx,dropout:M_,einsum:go,elu:Cy,enclosingPowerOfTwo:ob,ensureShape:Px,equal:$y,erf:Lx,euclideanNorm:Gx,exp:qr,expandDims:_s,expm1:Qx,eye:Fy,fft:ch,fill:Wa,floor:Ry,floorDiv:Sy,fused:Q_,gather:Py,gatherND:F_,greater:Nu,greaterEqual:My,ifft:Yi,imag:_u,image:AE,inTopKAsync:z_,irfft:Qy,isFinite:iS,isInf:cS,isNaN:fS,leakyRelu:Ly,less:ll,lessEqual:oh,linalg:DE,linspace:mS,localResponseNormalization:yS,log:$a,log1p:zy,logSigmoid:IS,logSoftmax:TS,logSumExp:By,logicalAnd:Ui,logicalNot:Wy,logicalOr:jy,logicalXor:OS,losses:OE,lowerBound:RS,matMul:be,max:xo,maxPool:Hy,maxPool3d:LS,maxPoolWithArgmax:VS,maximum:qy,mean:Gi,meshgrid:jS,min:cl,minimum:Xi,mirrorPad:KS,mod:GS,moments:YS,movingAverage:T_,mul:Ft,multiRNNCell:QS,multinomial:tI,neg:hs,norm:Iu,notEqual:Ky,oneHot:sI,ones:Pr,onesLike:oI,op:V,outerProduct:iI,pad:ja,pad1d:lI,pad2d:hI,pad3d:pI,pad4d:gI,pool:kI,pow:Ea,prelu:Gy,print:xy,prod:II,raggedGather:_I,raggedRange:EI,raggedTensorToTensor:CI,rand:DI,randomGamma:tN,randomNormal:Xy,randomStandardNormal:sN,randomUniform:uh,randomUniformInt:aN,range:Ca,real:Aa,reciprocal:cN,relu:Eu,relu6:Yy,reshape:gt,reverse:Kr,reverse1d:pN,reverse2d:gN,reverse3d:bN,reverse4d:vN,rfft:lh,round:Zy,rsqrt:SN,scalar:ce,scatterND:$_,searchSorted:ah,selu:NN,separableConv2d:TN,setdiff1dAsync:$N,sigmoid:ko,sign:AN,signal:CE,sin:ON,sinh:RN,slice:xe,slice1d:MN,slice2d:zN,slice3d:BN,slice4d:jN,softmax:qN,softplus:Vy,spaceToBatchND:Uy,sparse:FE,sparseToDense:D_,spectral:$E,split:Da,sqrt:Rs,square:Gn,squaredDifference:Jy,squeeze:fh,stack:Ms,step:tb,stridedSlice:n_,string:RE,sub:oe,sum:$e,tan:r_,tanh:ul,tensor:fs,tensor1d:Vn,tensor2d:da,tensor3d:eb,tensor4d:o_,tensor5d:a_,tensor6d:i_,tensorScatterUpdate:l_,tile:ha,topk:h_,transpose:fl,truncatedNormal:p_,unique:g_,unsortedSegmentSum:b_,unstack:to,upperBound:v_,variable:k_,where:ur,whereAsync:rb,zeros:Co,zerosLike:Fn},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J$=(e,t,n,s=en)=>{switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[s.add(x("a",e,t,n),x("b",e,t,n))];case"AddN":return[s.addN(x("tensors",e,t,n))];case"FloorMod":case"Mod":return[s.mod(x("a",e,t,n),x("b",e,t,n))];case"Mul":return[s.mul(x("a",e,t,n),x("b",e,t,n))];case"RealDiv":case"Div":return[s.div(x("a",e,t,n),x("b",e,t,n))];case"DivNoNan":return[s.divNoNan(x("a",e,t,n),x("b",e,t,n))];case"FloorDiv":return[s.floorDiv(x("a",e,t,n),x("b",e,t,n))];case"Sub":return[s.sub(x("a",e,t,n),x("b",e,t,n))];case"Minimum":return[s.minimum(x("a",e,t,n),x("b",e,t,n))];case"Maximum":return[s.maximum(x("a",e,t,n),x("b",e,t,n))];case"Pow":return[s.pow(x("a",e,t,n),x("b",e,t,n))];case"SquaredDifference":return[s.squaredDifference(x("a",e,t,n),x("b",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tC=(e,t,n,s=en)=>{switch(e.op){case"Abs":case"ComplexAbs":return[s.abs(x("x",e,t,n))];case"Acos":return[s.acos(x("x",e,t,n))];case"Acosh":return[s.acosh(x("x",e,t,n))];case"Asin":return[s.asin(x("x",e,t,n))];case"Asinh":return[s.asinh(x("x",e,t,n))];case"Atan":return[s.atan(x("x",e,t,n))];case"Atan2":return[s.atan2(x("x",e,t,n),x("y",e,t,n))];case"Atanh":return[s.atanh(x("x",e,t,n))];case"Ceil":return[s.ceil(x("x",e,t,n))];case"Complex":return[s.complex(x("real",e,t,n),x("imag",e,t,n))];case"Cos":return[s.cos(x("x",e,t,n))];case"Cosh":return[s.cosh(x("x",e,t,n))];case"Elu":return[s.elu(x("x",e,t,n))];case"Erf":return[s.erf(x("x",e,t,n))];case"Exp":return[s.exp(x("x",e,t,n))];case"Expm1":return[s.expm1(x("x",e,t,n))];case"Floor":return[s.floor(x("x",e,t,n))];case"Log":return[s.log(x("x",e,t,n))];case"Log1p":return[s.log1p(x("x",e,t,n))];case"Imag":return[s.imag(x("x",e,t,n))];case"Neg":return[s.neg(x("x",e,t,n))];case"Reciprocal":return[s.reciprocal(x("x",e,t,n))];case"Real":return[s.real(x("x",e,t,n))];case"Relu":return[s.relu(x("x",e,t,n))];case"Round":return[s.round(x("x",e,t,n))];case"Selu":return[s.selu(x("x",e,t,n))];case"Sigmoid":return[s.sigmoid(x("x",e,t,n))];case"Sin":return[s.sin(x("x",e,t,n))];case"Sign":return[s.sign(x("x",e,t,n))];case"Sinh":return[s.sinh(x("x",e,t,n))];case"Softplus":return[s.softplus(x("x",e,t,n))];case"Sqrt":return[s.sqrt(x("x",e,t,n))];case"Square":return[s.square(x("x",e,t,n))];case"Tanh":return[s.tanh(x("x",e,t,n))];case"Tan":return[s.tan(x("x",e,t,n))];case"ClipByValue":return[s.clipByValue(x("x",e,t,n),x("clipValueMin",e,t,n),x("clipValueMax",e,t,n))];case"Relu6":return[s.relu6(x("x",e,t,n))];case"Rsqrt":return[s.rsqrt(Je(e.inputNames[0],t,n))];case"LeakyRelu":return[s.leakyRelu(x("x",e,t,n),x("alpha",e,t,n))];case"Prelu":return[s.prelu(x("x",e,t,n),x("alpha",e,t,n))];case"IsNan":return[s.isNaN(Je(e.inputNames[0],t,n))];case"IsInf":return[s.isInf(Je(e.inputNames[0],t,n))];case"IsFinite":return[s.isFinite(Je(e.inputNames[0],t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zn(e,t,n=""){if(!(typeof e=="number"||typeof t=="number")){O(e.length===t.length,()=>n+` Shapes ${e} and ${t} must match`);for(let s=0;s<e.length;s++){const r=e[s],o=t[s];O(r<0||o<0||r===o,()=>n+` Shapes ${e} and ${t} must match`)}}}function cp(e){return!(typeof e=="number"||e.some(t=>t<0))}function na(e,t,n){let s=Il(e,n);const r=!cp(s);if(r&&t.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${s}`);if(r&&t.forEach(o=>{s=Il(o.shape,s)}),!cp(s))throw new Error(`Non-fully-defined elementShape: ${s}`);return s}function Il(e,t){if(typeof e=="number")return t;if(typeof t=="number")return e;if(e.length!==t.length)throw new Error(`Incompatible ranks during merge: ${e} vs. ${t}`);const n=[];for(let s=0;s<e.length;++s){const r=e[s],o=t[s];if(r>=0&&o>=0&&r!==o)throw new Error(`Incompatible shape during merge: ${e} vs. ${t}`);n[s]=r>=0?r:o}return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eC{constructor(t,n,s,r,o,a,i){this.name=t,this.dtype=n,this.maxSize=s,this.elementShape=r,this.identicalElementShapes=o,this.dynamicSize=a,this.clearAfterRead=i,this.tensors=[],this.closed_=!1,this.idTensor=ce(0),cs(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(t){this.tensors.forEach(n=>{(t==null||!t.has(n.tensor.id))&&n.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||t>=this.size())throw new Error(`Tried to read from index ${t}, but array size is: ${this.size()}`);const n=this.tensors[t];if(n.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${t} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor}readMany(t){return t.map(n=>this.read(n))}write(t,n){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error(`Tried to write to index ${t}, but array is not resizeable and size is: ${this.maxSize}`);const s=this.tensors[t]||{};if(n.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t},
          because the value dtype is ${n.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=n.shape),zn(this.elementShape,n.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${t}.`),s.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been read.`);if(s.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been written.`);s.tensor=n,cs(n),s.written=!0,this.tensors[t]=s}writeMany(t,n){if(t.length!==n.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${t.length} is not the same as tensors size: ${n.length}.`);t.forEach((s,r)=>this.write(s,n[r]))}gather(t,n){if(n&&n!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${n}`);if(t)t=t.slice(0,this.size());else{t=[];for(let r=0;r<this.size();r++)t.push(r)}if(t.length===0)return fs([],[0].concat(this.elementShape));const s=this.readMany(t);return zn(this.elementShape,s[0].shape,"TensorArray shape mismatch: "),Ms(s,0)}concat(t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${t}`);if(this.size()===0)return fs([],[0].concat(this.elementShape));const n=[];for(let r=0;r<this.size();r++)n.push(r);const s=this.readMany(n);return zn(this.elementShape,s[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${s[0].shape})`),dn(s,0)}scatter(t,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);if(t.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${n.shape[0]}`);const s=Math.max(...t);if(!this.dynamicSize&&s>=this.maxSize)throw new Error(`Max index must be < array size (${s}  vs. ${this.maxSize})`);this.writeMany(t,to(n,0))}split(t,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);let s=0;const r=t.map(u=>(s+=u,s));if(s!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${n.shape}`);if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${t.length}), and the TensorArray is not marked as dynamically resizeable`);const o=s===0?0:n.size/s,a=[];de(()=>{n=gt(n,[1,s,o]);for(let u=0;u<t.length;++u){const l=[0,u===0?0:r[u-1],0],f=[1,t[u],o];a[u]=gt(xe(n,l,f),this.elementShape)}return a});const i=[];for(let u=0;u<t.length;u++)i[u]=u;this.writeMany(i,a)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gr{get id(){return this.idTensor.id}constructor(t,n,s,r=-1){this.tensors=t,this.elementShape=n,this.elementDtype=s,t!=null&&t.forEach(o=>{if(s!==o.dtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${o.dtype}`);zn(n,o.shape,"TensorList shape mismatch: "),cs(o)}),this.idTensor=ce(0),this.maxNumElements=r,cs(this.idTensor)}copy(){return new Gr([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(t){this.tensors.forEach(n=>{(t==null||!t.has(n.id))&&n.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(t,n,s=-1){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(s!==-1&&this.tensors.length!==s)throw new Error(`Operation expected a list with ${s} elements but got a list with ${this.tensors.length} elements.`);zn(t,this.elementShape,"TensorList shape mismatch: ");const r=na(this.elementShape,this.tensors,t);return de(()=>{const o=this.tensors.map(a=>gt(a,r));return Ms(o,0)})}popBack(t,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const s=na(this.elementShape,this.tensors,t),r=this.tensors.pop();return r.kept=!1,zn(r.shape,t,"TensorList shape mismatch: "),gt(r,s)}pushBack(t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(zn(t.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");cs(t),this.tensors.push(t)}resize(t){if(t<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${t}`);if(this.maxNumElements!==-1&&t>this.maxNumElements)throw new Error(`TensorListResize input size ${t} is greater maxNumElement ${this.maxNumElements}.`);const n=new Gr([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=t;for(let s=0;s<Math.min(this.tensors.length,t);++s)n.tensors[s]=this.tensors[s];return n}getItem(t,n,s){if(s!==this.elementDtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${this.elementDtype}`);if(t<0||t>this.tensors.length)throw new Error(`Trying to access element ${t} in a list with ${this.tensors.length} elements.`);if(this.tensors[t]==null)throw new Error(`element at index ${t} is null.`);zn(this.tensors[t].shape,n,"TensorList shape mismatch: ");const r=na(this.elementShape,this.tensors,n);return gt(this.tensors[t],r)}setItem(t,n){if(n.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${this.elementDtype}`);if(t<0||this.maxNumElements!==-1&&t>=this.maxNumElements)throw new Error(`Trying to set element ${t} in a list with max ${this.maxNumElements} elements.`);zn(this.elementShape,n.shape,"TensorList shape mismatch: "),cs(n),this.tensors[t]!=null&&(this.tensors[t].kept=!1),this.tensors[t]=n}gather(t,n,s){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);zn(this.elementShape,s,"TensorList shape mismatch: "),t=t.slice(0,this.size());const r=na(this.elementShape,this.tensors,s);return t.length===0?fs([],[0].concat(r)):de(()=>{const o=t.map(a=>gt(this.tensors[a],r));return Ms(o,0)})}concat(t,n){if(t&&t!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${t}`);zn(this.elementShape,n,"TensorList shape mismatch: ");const s=na(this.elementShape,this.tensors,n);return this.size()===0?fs([],[0].concat(s)):de(()=>{const r=this.tensors.map(o=>gt(o,s));return dn(r,0)})}}function nC(e,t,n){const s=e.dtype;if(e.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${e.shape}`);if(e.dtype!==n)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${n}`);const r=e.shape.slice(1);zn(r,t,"TensorList shape mismatch: ");const o=to(e);return new Gr(o,t,s)}function sC(e,t,n,s){return new Gr([],e,t,s)}function rC(e,t,n,s){if(t.length!==e.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${e.shape[0]}`);const r=Math.max(...t);if(s!=null&&s!==-1&&r>=s)throw new Error(`Max index must be < array size (${r}  vs. ${s})`);const o=new Gr([],n,e.dtype,s),a=to(e,0);return t.forEach((i,u)=>{o.setItem(i,a[u])}),o}function oC(e,t,n){let s=0;const r=t.map(l=>(s+=l,s));if(s!==e.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${e.shape}`);const o=e.shape.slice(1),a=Il(o,n),i=s===0?0:e.size/s,u=de(()=>{const l=[];e=gt(e,[1,s,i]);for(let f=0;f<t.length;++f){const m=[0,f===0?0:r[f-1],0],g=[1,t[f],i];l[f]=gt(xe(e,m,g),a)}return e.dispose(),l}),c=new Gr([],n,e.dtype,t.length);for(let l=0;l<u.length;l++)c.setItem(l,u[l]);return c}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aC=async(e,t,n)=>{switch(e.op){case"If":case"StatelessIf":{const s=x("thenBranch",e,t,n),r=x("elseBranch",e,t,n),o=x("cond",e,t,n),a=x("args",e,t,n);return(await o.data())[0]?n.functionMap[s].executeFunctionAsync(a,n.tensorArrayMap,n.tensorListMap):n.functionMap[r].executeFunctionAsync(a,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const s=x("body",e,t,n),r=x("cond",e,t,n),o=x("args",e,t,n),a=await n.functionMap[r].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap),i=o.map(l=>l.id);let u=await a[0].data();a.forEach(l=>{!l.kept&&i.indexOf(l.id)===-1&&l.dispose()});let c=o;for(;u[0];){const l=c;c=await n.functionMap[s].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);const f=c.map(m=>m.id);l.forEach(m=>{!m.kept&&i.indexOf(m.id)===-1&&f.indexOf(m.id)===-1&&m.dispose()});const d=await n.functionMap[r].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);u=await d[0].data(),d.forEach(m=>{!m.kept&&i.indexOf(m.id)===-1&&f.indexOf(m.id)===-1&&m.dispose()})}return c}case"LoopCond":{const s=x("pred",e,t,n);return[Es(s)]}case"Switch":{const s=x("pred",e,t,n);let r=x("data",e,t,n);return r.kept||(r=Es(r)),(await s.data())[0]?[void 0,r]:[r,void 0]}case"Merge":{const s=e.inputNames.find(r=>Je(r,t,n)!==void 0);if(s){const r=Je(s,t,n);return[Es(r)]}return}case"Enter":{const s=x("frameName",e,t,n),r=x("tensor",e,t,n);return n.enterFrame(s),[Es(r)]}case"Exit":{const s=x("tensor",e,t,n);return n.exitFrame(),[Es(s)]}case"NextIteration":{const s=x("tensor",e,t,n);return n.nextIteration(),[Es(s)]}case"TensorArrayV3":{const s=x("size",e,t,n),r=x("dtype",e,t,n),o=x("elementShape",e,t,n),a=x("dynamicSize",e,t,n),i=x("clearAfterRead",e,t,n),u=x("identicalElementShapes",e,t,n),c=x("name",e,t,n),l=new eC(c,r,s,o,u,a,i);return n.addTensorArray(l),[l.idTensor,ce(1)]}case"TensorArrayWriteV3":{const s=x("tensorArrayId",e,t,n),r=x("index",e,t,n),o=x("tensor",e,t,n),a=n.getTensorArray(s.id);return a.write(r,o),[a.idTensor]}case"TensorArrayReadV3":{const s=x("tensorArrayId",e,t,n),r=x("index",e,t,n);return[n.getTensorArray(s.id).read(r)]}case"TensorArrayGatherV3":{const s=x("tensorArrayId",e,t,n),r=x("indices",e,t,n),o=x("dtype",e,t,n);return[n.getTensorArray(s.id).gather(r,o)]}case"TensorArrayScatterV3":{const s=x("tensorArrayId",e,t,n),r=x("indices",e,t,n),o=x("tensor",e,t,n),a=n.getTensorArray(s.id);return a.scatter(r,o),[a.idTensor]}case"TensorArrayConcatV3":{const s=x("tensorArrayId",e,t,n),r=n.getTensorArray(s.id),o=x("dtype",e,t,n);return[r.concat(o)]}case"TensorArraySplitV3":{const s=x("tensorArrayId",e,t,n),r=x("tensor",e,t,n),o=x("lengths",e,t,n),a=n.getTensorArray(s.id);return a.split(o,r),[a.idTensor]}case"TensorArraySizeV3":{const s=x("tensorArrayId",e,t,n),r=n.getTensorArray(s.id);return[ce(r.size(),"int32")]}case"TensorArrayCloseV3":{const s=x("tensorArrayId",e,t,n),r=n.getTensorArray(s.id);return r.clearAndClose(),[r.idTensor]}case"TensorListSetItem":{const s=x("tensorListId",e,t,n),r=x("index",e,t,n),o=x("tensor",e,t,n),a=n.getTensorList(s.id);return a.setItem(r,o),[a.idTensor]}case"TensorListGetItem":{const s=x("tensorListId",e,t,n),r=x("index",e,t,n),o=x("elementShape",e,t,n),a=x("elementDType",e,t,n);return[n.getTensorList(s.id).getItem(r,o,a)]}case"TensorListScatterV2":case"TensorListScatter":{const s=x("indices",e,t,n),r=x("tensor",e,t,n),o=x("elementShape",e,t,n),a=x("numElements",e,t,n),i=rC(r,s,o,a);return n.addTensorList(i),[i.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const s=x("elementShape",e,t,n),r=x("elementDType",e,t,n);let o;e.op==="TensorListReserve"?o="numElements":o="maxNumElements";const a=x(o,e,t,n),i=e.op==="TensorListReserve"?-1:a,u=sC(s,r,a,i);return n.addTensorList(u),[u.idTensor]}case"TensorListGather":{const s=x("tensorListId",e,t,n),r=x("indices",e,t,n),o=x("elementShape",e,t,n),a=x("elementDType",e,t,n);return[n.getTensorList(s.id).gather(r,a,o)]}case"TensorListStack":{const s=x("tensorListId",e,t,n),r=x("elementShape",e,t,n),o=x("elementDType",e,t,n),a=x("numElements",e,t,n);return[n.getTensorList(s.id).stack(r,o,a)]}case"TensorListFromTensor":{const s=x("tensor",e,t,n),r=x("elementShape",e,t,n),o=x("elementDType",e,t,n),a=nC(s,r,o);return n.addTensorList(a),[a.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const s=x("tensorListId",e,t,n),r=n.getTensorList(s.id),o=x("dtype",e,t,n),a=x("elementShape",e,t,n);return[r.concat(o,a)]}case"TensorListPushBack":{const s=x("tensorListId",e,t,n),r=x("tensor",e,t,n),o=n.getTensorList(s.id);return o.pushBack(r),[o.idTensor]}case"TensorListPopBack":{const s=x("tensorListId",e,t,n),r=x("elementShape",e,t,n),o=x("elementDType",e,t,n);return[n.getTensorList(s.id).popBack(r,o)]}case"TensorListSplit":{const s=x("tensor",e,t,n),r=x("elementShape",e,t,n),o=x("lengths",e,t,n),a=oC(s,o,r);return n.addTensorList(a),[a.idTensor]}case"TensorListLength":{const s=x("tensorListId",e,t,n),r=n.getTensorList(s.id);return[ce(r.size(),"int32")]}case"TensorListResize":{const s=x("tensorListId",e,t,n),r=x("size",e,t,n),a=n.getTensorList(s.id).resize(r);return n.addTensorList(a),[a.idTensor]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lp(e,t,n){const[s,r]=x("fusedOps",e,t,n),o=s==="biasadd",a=!o,i=r==="prelu",u=s==="fusedbatchnorm",c=x("numArgs",e,t,n);if(o){if(i&&c!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!i&&o&&c!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(u)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const l=x("strides",e,t,n),f=Pi(e,t,n),d=x("dataFormat",e,t,n).toUpperCase(),m=x("dilations",e,t,n);let[g,b]=x("args",e,t,n);a&&(b=g,g=void 0);const y=x("leakyreluAlpha",e,t,n);return{stride:l,pad:f,dataFormat:d,dilations:m,biasArg:g,preluArg:b,activationFunc:r,leakyreluAlpha:y}}const iC=(e,t,n,s=en)=>{switch(e.op){case"Conv1D":{const r=x("stride",e,t,n),o=x("pad",e,t,n),a=x("dataFormat",e,t,n).toUpperCase(),i=x("dilation",e,t,n);return[s.conv1d(x("x",e,t,n),x("filter",e,t,n),r,o,a,i)]}case"Conv2D":{const r=x("strides",e,t,n),o=Pi(e,t,n),a=x("dataFormat",e,t,n).toUpperCase(),i=x("dilations",e,t,n);return[s.conv2d(x("x",e,t,n),x("filter",e,t,n),[r[1],r[2]],o,a,[i[1],i[2]])]}case"_FusedConv2D":{const{stride:r,pad:o,dataFormat:a,dilations:i,biasArg:u,preluArg:c,activationFunc:l,leakyreluAlpha:f}=lp(e,t,n);return[s.fused.conv2d({x:x("x",e,t,n),filter:x("filter",e,t,n),strides:[r[1],r[2]],pad:o,dataFormat:a,dilations:[i[1],i[2]],bias:u,activation:l,preluActivationWeights:c,leakyreluAlpha:f})]}case"FusedDepthwiseConv2dNative":{const{stride:r,pad:o,dataFormat:a,dilations:i,biasArg:u,preluArg:c,activationFunc:l,leakyreluAlpha:f}=lp(e,t,n);return[s.fused.depthwiseConv2d({x:x("x",e,t,n),filter:x("filter",e,t,n),strides:[r[1],r[2]],pad:o,dataFormat:a,dilations:[i[1],i[2]],bias:u,activation:l,preluActivationWeights:c,leakyreluAlpha:f})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const r=x("outputShape",e,t,n),o=x("strides",e,t,n),a=Pi(e,t,n);return[s.conv2dTranspose(x("x",e,t,n),x("filter",e,t,n),r,[o[1],o[2]],a)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const r=x("strides",e,t,n),o=Pi(e,t,n),a=x("dilations",e,t,n),i=x("dataFormat",e,t,n).toUpperCase();return[s.depthwiseConv2d(x("input",e,t,n),x("filter",e,t,n),[r[1],r[2]],o,i,[a[1],a[2]])]}case"Conv3D":{const r=x("strides",e,t,n),o=x("pad",e,t,n),a=x("dataFormat",e,t,n).toUpperCase(),i=x("dilations",e,t,n);return[s.conv3d(x("x",e,t,n),x("filter",e,t,n),[r[1],r[2],r[3]],o,a,[i[1],i[2],i[3]])]}case"AvgPool":{const r=x("strides",e,t,n),o=x("pad",e,t,n),a=x("kernelSize",e,t,n);return[s.avgPool(x("x",e,t,n),[a[1],a[2]],[r[1],r[2]],o)]}case"MaxPool":{const r=x("strides",e,t,n),o=x("pad",e,t,n),a=x("kernelSize",e,t,n);return[s.maxPool(x("x",e,t,n),[a[1],a[2]],[r[1],r[2]],o)]}case"MaxPoolWithArgmax":{const r=x("strides",e,t,n),o=x("pad",e,t,n),a=x("kernelSize",e,t,n),i=x("includeBatchInIndex",e,t,n),{result:u,indexes:c}=s.maxPoolWithArgmax(x("x",e,t,n),[a[1],a[2]],[r[1],r[2]],o,i);return[u,c]}case"AvgPool3D":{const r=x("strides",e,t,n),o=x("pad",e,t,n),a=x("kernelSize",e,t,n);return[s.avgPool3d(x("x",e,t,n),[a[1],a[2],a[3]],[r[1],r[2],r[3]],o)]}case"MaxPool3D":{const r=x("strides",e,t,n),o=x("pad",e,t,n),a=x("kernelSize",e,t,n);return[s.maxPool3d(x("x",e,t,n),[a[1],a[2],a[3]],[r[1],r[2],r[3]],o)]}case"Dilation2D":{const r=x("strides",e,t,n),o=x("pad",e,t,n),a=x("dilations",e,t,n),i=r[1],u=r[2],c=a[1],l=a[2];return[s.dilation2d(x("x",e,t,n),x("filter",e,t,n),[i,u],o,[c,l],"NHWC")]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uC=(e,t,n,s=en)=>{switch(e.op){case"Fill":{const r=x("shape",e,t,n),o=x("dtype",e,t,n),a=x("value",e,t,n);return[s.fill(r,a,o)]}case"LinSpace":{const r=x("start",e,t,n),o=x("stop",e,t,n),a=x("num",e,t,n);return[s.linspace(r,o,a)]}case"Multinomial":{const r=x("logits",e,t,n),o=x("numSamples",e,t,n),a=x("seed",e,t,n);return[s.multinomial(r,o,a)]}case"OneHot":{const r=x("indices",e,t,n),o=x("depth",e,t,n),a=x("onValue",e,t,n),i=x("offValue",e,t,n),u=x("dtype",e,t,n);return[s.oneHot(r,o,a,i,u)]}case"Ones":return[s.ones(x("shape",e,t,n),x("dtype",e,t,n))];case"OnesLike":return[s.onesLike(x("x",e,t,n))];case"RandomStandardNormal":return[s.randomStandardNormal(x("shape",e,t,n),x("dtype",e,t,n),x("seed",e,t,n))];case"RandomUniform":return[s.randomUniform(x("shape",e,t,n),x("minval",e,t,n),x("maxval",e,t,n),x("dtype",e,t,n))];case"RandomUniformInt":return[s.randomUniformInt(x("shape",e,t,n),x("minval",e,t,n),x("maxval",e,t,n),x("seed",e,t,n))];case"Range":{const r=x("start",e,t,n),o=x("stop",e,t,n),a=x("step",e,t,n);return[s.range(r,o,a,x("dtype",e,t,n))]}case"TruncatedNormal":{const r=x("shape",e,t,n),o=x("mean",e,t,n),a=x("stdDev",e,t,n),i=x("seed",e,t,n);return[s.truncatedNormal(r,o,a,x("dtype",e,t,n),i)]}case"Zeros":return[s.zeros(x("shape",e,t,n),x("dtype",e,t,n))];case"ZerosLike":return[s.zerosLike(x("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rc(e,t,n){const s=x("boxes",e,t,n),r=x("scores",e,t,n),o=x("maxOutputSize",e,t,n),a=x("iouThreshold",e,t,n),i=x("scoreThreshold",e,t,n),u=x("softNmsSigma",e,t,n);return{boxes:s,scores:r,maxOutputSize:o,iouThreshold:a,scoreThreshold:i,softNmsSigma:u}}const cC=async(e,t,n,s,r=en)=>{switch(e.op){case"NonMaxSuppressionV5":{const{boxes:o,scores:a,maxOutputSize:i,iouThreshold:u,scoreThreshold:c,softNmsSigma:l}=Rc(e,t,n),f=await r.image.nonMaxSuppressionWithScoreAsync(o,a,i,u,c,l);return[f.selectedIndices,f.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:o,scores:a,maxOutputSize:i,iouThreshold:u,scoreThreshold:c}=Rc(e,t,n),l=x("padToMaxOutputSize",e,t,n),f=await r.image.nonMaxSuppressionPaddedAsync(o,a,i,u,c,l);return[f.selectedIndices,f.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:o,scores:a,maxOutputSize:i,iouThreshold:u,scoreThreshold:c}=Rc(e,t,n);return[await r.image.nonMaxSuppressionAsync(o,a,i,u,c)]}case"Where":{const o=r.cast(x("condition",e,t,n),"bool"),a=[await r.whereAsync(o)];return o.dispose(),a}case"ListDiff":return r.setdiff1dAsync(x("x",e,t,n),x("y",e,t,n));default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lC=(e,t,n,s=en)=>{switch(e.op){case"LowerBound":{const r=x("sortedSequence",e,t,n),o=x("values",e,t,n);return[s.lowerBound(r,o)]}case"TopKV2":{const r=x("x",e,t,n),o=x("k",e,t,n),a=x("sorted",e,t,n),i=s.topk(r,o,a);return[i.values,i.indices]}case"UpperBound":{const r=x("sortedSequence",e,t,n),o=x("values",e,t,n);return[s.upperBound(r,o)]}case"Unique":{const r=x("x",e,t,n),o=s.unique(r);return[o.values,o.indices]}case"UniqueV2":{const r=x("x",e,t,n),o=x("axis",e,t,n),a=s.unique(r,o);return[a.values,a.indices]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fC=(e,t,n,s=en)=>{switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":const r=x("default",e,t,n);return[Je(e.name,t,n)||r];case"Placeholder":return[Je(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const l=x("x",e,t,n);return[Es(l)]}case"IdentityN":return x("x",e,t,n).map(l=>Es(l));case"Snapshot":const o=x("x",e,t,n);return[Es(o)];case"Shape":return[s.tensor1d(x("x",e,t,n).shape,"int32")];case"ShapeN":return x("x",e,t,n).map(l=>s.tensor1d(l.shape));case"Size":return[s.scalar(x("x",e,t,n).size,"int32")];case"Rank":return[s.scalar(x("x",e,t,n).rank,"int32")];case"NoOp":return[s.scalar(1)];case"Print":const a=x("x",e,t,n),i=x("data",e,t,n),u=x("message",e,t,n),c=x("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(u);for(let l=0;l<i.length;l++)console.log(Array.prototype.slice.call(i[l].dataSync()).slice(0,c));return[a];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hC{get id(){return this.handle.id}constructor(t,n){this.keyDType=t,this.valueDType=n,this.handle=ce(0),this.tensorMap=new Map,cs(this.handle)}clearAndClose(){this.tensorMap.forEach(t=>t.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return ce(this.size(),"int32")}async import(t,n){this.checkKeyAndValueTensor(t,n);const s=await t.data();return this.tensorMap.forEach(r=>r.dispose()),this.tensorMap.clear(),de(()=>{const r=to(n),o=s.length,a=r.length;O(o===a,()=>`The number of elements doesn't match, keys has ${o} elements, the values has ${a} elements.`);for(let i=0;i<o;i++){const u=s[i],c=r[i];cs(c),this.tensorMap.set(u,c)}return this.handle})}async find(t,n){this.checkKeyAndValueTensor(t,n);const s=await t.data();return de(()=>{const r=[];for(let o=0;o<s.length;o++){const a=s[o],i=this.findWithDefault(a,n);r.push(i)}return Ms(r)})}findWithDefault(t,n){const s=this.tensorMap.get(t);return s??n}checkKeyAndValueTensor(t,n){if(t.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${t.dtype}`);if(n.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${n.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dC=async(e,t,n,s)=>{switch(e.op){case"HashTable":case"HashTableV2":{const r=s.getHashTableHandleByName(e.name);if(r!=null)return[r];{const o=x("keyDType",e,t,n),a=x("valueDType",e,t,n),i=new hC(o,a);return s.addHashTable(e.name,i),[i.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const r=x("tableHandle",e,t,n,s),o=x("keys",e,t,n),a=x("values",e,t,n);return[await s.getHashTableById(r.id).import(o,a)]}case"LookupTableFind":case"LookupTableFindV2":{const r=x("tableHandle",e,t,n,s),o=x("keys",e,t,n),a=x("defaultValue",e,t,n);return[await s.getHashTableById(r.id).find(o,a)]}case"LookupTableSize":case"LookupTableSizeV2":{const r=x("tableHandle",e,t,n,s);return[s.getHashTableById(r.id).tensorSize()]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pC=(e,t,n,s=en)=>{switch(e.op){case"ResizeBilinear":{const r=x("images",e,t,n),o=x("size",e,t,n),a=x("alignCorners",e,t,n),i=x("halfPixelCenters",e,t,n);return[s.image.resizeBilinear(r,[o[0],o[1]],a,i)]}case"ResizeNearestNeighbor":{const r=x("images",e,t,n),o=x("size",e,t,n),a=x("alignCorners",e,t,n),i=x("halfPixelCenters",e,t,n);return[s.image.resizeNearestNeighbor(r,[o[0],o[1]],a,i)]}case"CropAndResize":{const r=x("image",e,t,n),o=x("boxes",e,t,n),a=x("boxInd",e,t,n),i=x("cropSize",e,t,n),u=x("method",e,t,n),c=x("extrapolationValue",e,t,n);return[s.image.cropAndResize(r,o,a,i,u,c)]}case"ImageProjectiveTransformV3":{const r=x("images",e,t,n),o=x("transforms",e,t,n),a=x("outputShape",e,t,n),i=x("fillValue",e,t,n),u=x("interpolation",e,t,n),c=x("fillMode",e,t,n);return[s.image.transform(r,o,u.toLowerCase(),c.toLowerCase(),i,a)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mC=(e,t,n,s=en)=>{switch(e.op){case"Equal":return[s.equal(x("a",e,t,n),x("b",e,t,n))];case"NotEqual":return[s.notEqual(x("a",e,t,n),x("b",e,t,n))];case"Greater":return[s.greater(x("a",e,t,n),x("b",e,t,n))];case"GreaterEqual":return[s.greaterEqual(x("a",e,t,n),x("b",e,t,n))];case"Less":return[s.less(x("a",e,t,n),x("b",e,t,n))];case"LessEqual":return[s.lessEqual(x("a",e,t,n),x("b",e,t,n))];case"LogicalAnd":return[s.logicalAnd(x("a",e,t,n),x("b",e,t,n))];case"LogicalNot":return[s.logicalNot(x("a",e,t,n))];case"LogicalOr":return[s.logicalOr(x("a",e,t,n),x("b",e,t,n))];case"Select":case"SelectV2":return[s.where(x("condition",e,t,n),x("a",e,t,n),x("b",e,t,n))];case"BitwiseAnd":return[s.bitwiseAnd(x("a",e,t,n),x("b",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gC=(e,t,n,s=en)=>{switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[s.matMul(x("a",e,t,n),x("b",e,t,n),x("transposeA",e,t,n),x("transposeB",e,t,n))];case"Einsum":return[s.einsum(x("equation",e,t,n),...x("tensors",e,t,n))];case"Transpose":return[s.transpose(x("x",e,t,n),x("perm",e,t,n))];case"_FusedMatMul":const[r,o]=x("fusedOps",e,t,n),a=r==="biasadd",i=o==="prelu",u=x("numArgs",e,t,n),c=x("leakyreluAlpha",e,t,n);if(a){if(i&&u!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!i&&u!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[l,f]=x("args",e,t,n);return[s.fused.matMul({a:x("a",e,t,n),b:x("b",e,t,n),transposeA:x("transposeA",e,t,n),transposeB:x("transposeB",e,t,n),bias:l,activation:o,preluActivationWeights:f,leakyreluAlpha:c})];case"MatrixBandPart":return[s.linalg.bandPart(x("a",e,t,n),x("numLower",e,t,n),x("numUpper",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yC=(e,t,n,s=en)=>{switch(e.op){case"EuclideanNorm":return[s.euclideanNorm(x("x",e,t,n),x("axis",e,t,n),x("keepDims",e,t,n))];case"FusedBatchNorm":case"FusedBatchNormV2":return[s.batchNorm(x("x",e,t,n),x("mean",e,t,n),x("variance",e,t,n),x("offset",e,t,n),x("scale",e,t,n),x("epsilon",e,t,n))];case"FusedBatchNormV3":return[s.batchNorm(x("x",e,t,n),x("mean",e,t,n),x("variance",e,t,n),x("offset",e,t,n),x("scale",e,t,n),x("epsilon",e,t,n))];case"LRN":return[s.localResponseNormalization(x("x",e,t,n),x("radius",e,t,n),x("bias",e,t,n),x("alpha",e,t,n),x("beta",e,t,n))];case"Softmax":return[s.softmax(x("x",e,t,n))];case"LogSoftmax":return[s.logSoftmax(x("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bC=(e,t,n,s=en)=>{switch(e.op){case"RaggedGather":{const{outputNestedSplits:r,outputDenseValues:o}=s.raggedGather(x("paramsNestedSplits",e,t,n),x("paramsDenseValues",e,t,n),x("indices",e,t,n),x("outputRaggedRank",e,t,n));return r.concat(o)}case"RaggedRange":{const{rtNestedSplits:r,rtDenseValues:o}=s.raggedRange(x("starts",e,t,n),x("limits",e,t,n),x("splits",e,t,n));return[r,o]}case"RaggedTensorToTensor":return[s.raggedTensorToTensor(x("shape",e,t,n),x("values",e,t,n),x("defaultValue",e,t,n),x("rowPartitionTensors",e,t,n),x("rowPartitionTypes",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wC=(e,t,n,s=en)=>{switch(e.op){case"Max":{const i=x("axis",e,t,n),u=x("keepDims",e,t,n);return[s.max(x("x",e,t,n),i,u)]}case"Mean":{const i=x("axis",e,t,n),u=x("keepDims",e,t,n);return[s.mean(x("x",e,t,n),i,u)]}case"Min":{const i=x("axis",e,t,n),u=x("keepDims",e,t,n);return[s.min(x("x",e,t,n),i,u)]}case"Sum":{const i=x("axis",e,t,n),u=x("keepDims",e,t,n);return[s.sum(x("x",e,t,n),i,u)]}case"All":{const i=x("axis",e,t,n),u=x("keepDims",e,t,n);return[s.all(x("x",e,t,n),i,u)]}case"Any":{const i=x("axis",e,t,n),u=x("keepDims",e,t,n);return[s.any(x("x",e,t,n),i,u)]}case"ArgMax":{const i=x("axis",e,t,n);return[s.argMax(x("x",e,t,n),i)]}case"ArgMin":{const i=x("axis",e,t,n);return[s.argMin(x("x",e,t,n),i)]}case"Prod":{const i=x("axis",e,t,n),u=x("keepDims",e,t,n);return[s.prod(x("x",e,t,n),i,u)]}case"Cumprod":{const i=x("axis",e,t,n),u=x("exclusive",e,t,n),c=x("reverse",e,t,n);return[s.cumprod(x("x",e,t,n),i,u,c)]}case"Cumsum":{const i=x("axis",e,t,n),u=x("exclusive",e,t,n),c=x("reverse",e,t,n);return[s.cumsum(x("x",e,t,n),i,u,c)]}case"Bincount":const r=x("x",e,t,n),o=x("weights",e,t,n),a=x("size",e,t,n);return[s.bincount(r,o,a)];case"DenseBincount":{const i=x("x",e,t,n),u=x("weights",e,t,n),c=x("size",e,t,n),l=x("binaryOutput",e,t,n);return[s.denseBincount(i,u,c,l)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vC=(e,t,n,s=en)=>{switch(e.op){case"ConcatV2":case"Concat":{const r=x("n",e,t,n),o=x("axis",e,t,n);let a=x("tensors",e,t,n);return a=a.slice(0,r),[s.concat(a,o)]}case"Gather":{const r=x("x",e,t,n),o=x("indices",e,t,n);return[s.gather(r,s.cast(o,"int32"),0)]}case"GatherV2":{const r=x("axis",e,t,n),o=x("batchDims",e,t,n),a=x("x",e,t,n),i=x("indices",e,t,n);return[s.gather(a,s.cast(i,"int32"),r,o)]}case"Reverse":{const r=x("dims",e,t,n),o=[];for(let i=0;i<r.length;i++)r[i]&&o.push(i);const a=x("x",e,t,n);return[s.reverse(a,o)]}case"ReverseV2":{const r=x("axis",e,t,n),o=x("x",e,t,n);return[s.reverse(o,r)]}case"Slice":{const r=x("begin",e,t,n),o=x("size",e,t,n);return[s.slice(x("x",e,t,n),r,o)]}case"StridedSlice":{const r=x("begin",e,t,n),o=x("end",e,t,n),a=x("strides",e,t,n),i=x("beginMask",e,t,n),u=x("endMask",e,t,n),c=x("ellipsisMask",e,t,n),l=x("newAxisMask",e,t,n),f=x("shrinkAxisMask",e,t,n),d=x("x",e,t,n);return[s.stridedSlice(d,r,o,a,i,u,c,l,f)]}case"Pack":return de(()=>{const r=x("axis",e,t,n),o=x("tensors",e,t,n),a=o[0].shape,i=s.squeeze(o[0]).shape,u=o.map(c=>{const l=qn(c.shape,a);if(!l&&!qn(s.squeeze(c).shape,i))throw new Error("the input tensors shape does not match");return l?c:s.reshape(c,a)});return[s.stack(u,r)]});case"Unpack":{const r=x("axis",e,t,n),o=x("tensor",e,t,n);return s.unstack(o,r)}case"Tile":{const r=x("reps",e,t,n);return[s.tile(x("x",e,t,n),r)]}case"Split":case"SplitV":{const r=x("axis",e,t,n),o=x("numOrSizeSplits",e,t,n),a=x("x",e,t,n);return s.split(a,o,r)}case"ScatterNd":{const r=x("indices",e,t,n),o=x("values",e,t,n),a=x("shape",e,t,n);return[s.scatterND(r,o,a)]}case"GatherNd":{const r=x("x",e,t,n),o=x("indices",e,t,n);return[s.gatherND(r,o)]}case"SparseToDense":{const r=x("sparseIndices",e,t,n),o=x("outputShape",e,t,n),a=x("sparseValues",e,t,n),i=x("defaultValue",e,t,n);return[s.sparseToDense(r,a,o,a.dtype===i.dtype?i:s.cast(i,a.dtype))]}case"TensorScatterUpdate":{const r=x("indices",e,t,n),o=x("values",e,t,n),a=x("tensor",e,t,n);return[s.tensorScatterUpdate(a,r,o)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kC=(e,t,n,s=en)=>{switch(e.op){case"SparseFillEmptyRows":{const{outputIndices:r,outputValues:o,emptyRowIndicator:a,reverseIndexMap:i}=s.sparse.sparseFillEmptyRows(x("indices",e,t,n),x("values",e,t,n),x("denseShape",e,t,n),x("defaultValue",e,t,n));return[r,o,a,i]}case"SparseReshape":{const{outputIndices:r,outputShape:o}=s.sparse.sparseReshape(x("inputIndices",e,t,n),x("inputShape",e,t,n),x("newShape",e,t,n));return[r,o]}case"SparseSegmentMean":return[s.sparse.sparseSegmentMean(x("data",e,t,n),x("indices",e,t,n),x("segmentIds",e,t,n))];case"SparseSegmentSum":return[s.sparse.sparseSegmentSum(x("data",e,t,n),x("indices",e,t,n),x("segmentIds",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xC=(e,t,n,s=en)=>{switch(e.op){case"FFT":return[s.fft(x("x",e,t,n))];case"IFFT":return[s.ifft(x("x",e,t,n))];case"RFFT":return[s.rfft(x("x",e,t,n))];case"IRFFT":return[s.irfft(x("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SC=(e,t,n,s=en)=>{switch(e.op){case"StaticRegexReplace":return[s.string.staticRegexReplace(x("input",e,t,n),x("pattern",e,t,n),x("rewrite",e,t,n),x("replaceGlobal",e,t,n))];case"StringNGrams":{const{nGrams:r,nGramsSplits:o}=s.string.stringNGrams(x("data",e,t,n),x("dataSplits",e,t,n),x("separator",e,t,n),x("nGramWidths",e,t,n),x("leftPad",e,t,n),x("rightPad",e,t,n),x("padWidth",e,t,n),x("preserveShortSequences",e,t,n));return[r,o]}case"StringSplit":{const{indices:r,values:o,shape:a}=s.string.stringSplit(x("input",e,t,n),x("delimiter",e,t,n),x("skipEmpty",e,t,n));return[r,o,a]}case"StringToHashBucketFast":return[s.string.stringToHashBucketFast(x("input",e,t,n),x("numBuckets",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IC=(e,t,n,s=en)=>{switch(e.op){case"Cast":return[s.cast(x("x",e,t,n),x("dtype",e,t,n))];case"ExpandDims":{const r=x("axis",e,t,n);return[s.expandDims(x("x",e,t,n),r)]}case"Squeeze":{const r=x("axis",e,t,n);return[s.squeeze(x("x",e,t,n),r)]}case"Reshape":return[s.reshape(x("x",e,t,n),x("shape",e,t,n))];case"EnsureShape":return[s.ensureShape(x("x",e,t,n),x("shape",e,t,n))];case"MirrorPad":return[s.mirrorPad(x("x",e,t,n),x("padding",e,t,n),x("mode",e,t,n))];case"PadV2":case"Pad":return[s.pad(x("x",e,t,n),x("padding",e,t,n),x("constantValue",e,t,n))];case"SpaceToBatchND":{const r=x("blockShape",e,t,n),o=x("paddings",e,t,n);return[s.spaceToBatchND(x("x",e,t,n),r,o)]}case"BatchToSpaceND":{const r=x("blockShape",e,t,n),o=x("crops",e,t,n);return[s.batchToSpaceND(x("x",e,t,n),r,o)]}case"DepthToSpace":{const r=x("blockSize",e,t,n),o=x("dataFormat",e,t,n).toUpperCase();return[s.depthToSpace(x("x",e,t,n),r,o)]}case"BroadcastTo":return[s.broadcastTo(x("x",e,t,n),x("shape",e,t,n))];case"BroadcastArgs":return[s.broadcastArgs(x("s0",e,t,n),x("s1",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fp(e,t,n,s,r=de){const o=((a,i,u)=>{switch(a.category){case"arithmetic":return r(()=>J$(a,i,u));case"basic_math":return r(()=>tC(a,i,u));case"control":return aC(a,i,u);case"convolution":return r(()=>iC(a,i,u));case"creation":return r(()=>uC(a,i,u));case"dynamic":return cC(a,i,u);case"evaluation":return r(()=>lC(a,i,u));case"image":return r(()=>pC(a,i,u));case"graph":return r(()=>fC(a,i,u));case"logical":return r(()=>mC(a,i,u));case"matrices":return r(()=>gC(a,i,u));case"normalization":return r(()=>yC(a,i,u));case"ragged":return r(()=>bC(a,i,u));case"reduction":return r(()=>wC(a,i,u));case"slice_join":return r(()=>vC(a,i,u));case"sparse":return r(()=>kC(a,i,u));case"spectral":return r(()=>xC(a,i,u));case"string":return r(()=>SC(a,i,u));case"transformation":return r(()=>IC(a,i,u));case"hash_table":return dC(a,i,u,s);case"custom":const c=xb(a.op);if(c&&c.customExecutor)return c.customExecutor(new Q$(a,i,u));throw TypeError(`Custom op ${a.op} is not registered.`);default:throw TypeError(`Unknown op '${a.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(e,t,n);return Br(o)?o.then(a=>[].concat(a)):[].concat(o)}class hp{constructor(t={},n={},s={},r={},o){this.weightMap=t,this.tensorArrayMap=n,this.tensorListMap=s,this.functionMap=r,this.parseNodeNameCache=o,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(t,n){return{id:t,frameName:n,iterationId:0}}set currentContext(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const t=[];for(let n=0;n<this.contexts.length-1;n++){const s=this.contexts.slice(0,this.contexts.length-n);t.push(this.contextIdforContexts(s))}t.push(""),this._currentContextIds=t}contextIdforContexts(t){return t?t.map(n=>n.id===0&&n.iterationId===0?"":`${n.frameName}-${n.iterationId}`).join("/"):""}enterFrame(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(t){return this.weightMap[t]}addTensorArray(t){this.tensorArrayMap[t.id]=t}getTensorArray(t){return this.tensorArrayMap[t]}addTensorList(t){this.tensorListMap[t.id]=t}getTensorList(t){return this.tensorListMap[t]}dispose(t){for(const n in this.tensorArrayMap)this.tensorArrayMap[n].clearAndClose(t);for(const n in this.tensorListMap)this.tensorListMap[n].clearAndClose(t)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dp(e,t,n,s){const r=new Set,o=[];let a=null,i=null;const u=new Set,c=new Set(Object.keys(e).map(d=>Tn(d)[0]));s=s||[];const l=new Set(s.map(d=>Tn(d.name)[0])),f=[...t];for(;f.length>0;){const d=f.pop();if((Fr(d)||DC(d)||OC(d))&&a==null&&(a=d,i=a.children.map(m=>m.name).filter(m=>r.has(m))),r.add(d.name),n[d.name]==null&&!c.has(d.name)&&!l.has(d.name)){if(d.inputs.length===0){o.push(d.name);continue}d.inputs.forEach(m=>{u.has(m.name)||(u.add(m.name),f.push(m))})}}return{inputs:e,outputs:t,usedNodes:r,missingInputs:o,dynamicNode:a,syncInputs:i}}function NC(e,t){const{usedNodes:n,inputs:s}=t,r=Object.keys(s).map(y=>Tn(y)[0]).map(y=>e.nodes[y]),o=e.initNodes||[],a=y=>n.has(typeof y=="string"?y:y.name);function i(y){return[...new Map(y.map(v=>[v.name,v])).values()]}const u=i([...r,...e.weights,...o]).filter(a),c=i([...u,...Object.values(e.nodes)]).filter(a),l=new Map(c.map(y=>[y.name,y])),f={};for(const y of c){f[y.name]=f[y.name]||0;for(const v of y.children)a(v)||(f[v.name]=Number.POSITIVE_INFINITY),f[v.name]=(f[v.name]||0)+1}const d=Object.entries(f).filter(([,y])=>y===0).map(([y])=>y),m=[...d];for(;d.length>0;){const y=d.pop(),v=l.get(y);for(const I of v.children.filter(a))--f[I.name]===0&&(m.push(I.name),d.push(I.name))}const g=m.map(y=>l.get(y)),b=_C(g,u);return TC(b,u),b}function _C(e,t){const n=new Map(e.map(a=>[a.name,a])),s=t.map(a=>a.name),r=new Set(s);for(;s.length>0;){const a=s.pop(),i=n.get(a);for(const u of i.children)!n.has(u.name)||r.has(u.name)||(r.add(u.name),s.push(u.name))}return e.filter(a=>r.has(a.name))}class vi extends Error{constructor(t){super(`NodesExecutionOrderError: ${t}`)}}function TC(e,t){const n=new Map(e.map((i,u)=>[i.name,u])),s=new Set(t.map(i=>i.name)),r=i=>s.has(typeof i=="string"?i:i.name),o=new Set(e.map(i=>i.name)),a=i=>o.has(typeof i=="string"?i:i.name);for(const i of e){for(const u of i.children.filter(a)){if(!n.has(u.name))throw new vi(`Child ${u.name} of node ${i.name} is unreachable.`);if(n.get(i.name)>n.get(u.name))throw new vi(`Node ${i.name} is scheduled to run after its child ${u.name}.`)}if(!r(i))for(const u of i.inputs){if(!n.has(u.name))throw new vi(`Input ${u.name} of node ${i.name} is unreachable.`);if(n.get(u.name)>n.get(i.name))throw new vi(`Node ${i.name} is scheduled to run before its input ${u.name}.`)}}}function EC(e){const t=new Map(e.map((i,u)=>[i.name,u])),n=Number.MAX_SAFE_INTEGER,s=e.map((i,u)=>Fr(i)?n:u),r=i=>{const u=s[t.get(i.name)];return u??-1},o=e.map((i,u)=>i.children.map(r).reduce((c,l)=>Math.max(c,l),s[u])),a=new Map;for(let i=0;i<e.length;++i){const u=o[i];if(u===n)continue;const c=e[i],l=e[u];a.has(l.name)||a.set(l.name,[]),a.get(l.name).push(c)}return a}const $C=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),CC=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),AC=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function Fr(e){return $C.has(e.op)}function DC(e){return CC.has(e.op)}function OC(e){return AC.has(e.op)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qi{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(t){const n=Object.keys(t).map(s=>t[s].map(r=>r.id));this._weightIds=[].concat(...n),this._weightMap=t}set resourceManager(t){this._resourceManager=t}get inputs(){return this._inputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(t=>t.signatureKey||t.name)}get outputNodes(){return this._outputs.map(t=>{const n=t.signatureKey||t.name;return t.defaultOutput?`${n}:${t.defaultOutput}`:n})}get functions(){return Object.keys(this._functions).reduce((t,n)=>(t[n]=this._functions[n].signature,t),{})}constructor(t,n){this.graph=t,this.parent=n,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=t.outputs,this._inputs=t.inputs,this._initNodes=t.initNodes,this._signature=t.signature,this._functions=t.functions,t.functions!=null&&Object.keys(t.functions).forEach(s=>{this._functionExecutorMap[s]=new Qi(t.functions[s],this)})}getCompilationKey(t,n){const s=t.map(o=>o.name).sort(),r=n.map(o=>o.name).sort();return s.join(this.SEPARATOR)+"--"+r.join(this.SEPARATOR)}compile(t,n){const s=dp(t,n,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:o,syncInputs:a}=s;if(o!=null)throw new Error(`This execution contains the node '${o.name}', which has the dynamic op '${o.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${a}]`);if(r.length>0){const c=n.map(f=>f.name),l=Object.keys(t);throw new Error(`Cannot compute the outputs [${c}] from the provided inputs [${l}]. Missing the following inputs: [${r}]`)}const i=NC(this.graph,s),u=EC(i);return{orderedNodes:i,nodeLiveUntilMap:u}}cloneAndKeepTensor(t){if(t==null)return null;const n=t.clone();return cs(n),n}cloneTensorList(t){return t?t.map(s=>this.cloneAndKeepTensor(s)):null}cloneTensorMap(t){return Object.fromEntries(Object.entries(t).map(([n,s])=>[n,this.cloneTensorList(s)]))}execute(t,n){this.disposeIntermediateTensors(),t=this.mapInputs(t);const s=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n);const r=s.map(d=>this.graph.nodes[Tn(d)[0]]),o=n.map(d=>Tn(d)[0]),a=new Set(o);let i=o.map(d=>this.graph.nodes[d]);i.length===0&&(i=this._outputs);const u=this.getCompilationKey(r,i);let c=this.compiledMap.get(u);c==null&&(c=this.compile(t,i),this.compiledMap.set(u,c));try{this.keepIntermediateTensors=ae().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(d){this.keepIntermediateTensors=!1,console.warn(d.message)}const l={},f={};return de(()=>{const d=new hp(this.weightMap,l,f,this.functionExecutorMap,this.parseNodeNameCache),m=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(t).forEach(v=>{const[I,_]=Tn(v,d),N=[];N[_]=t[v],m[I]=N,this.keepIntermediateTensors&&(this.clonedTensorsMap[I]=this.cloneTensorList(N))});const g=this.getFrozenTensorIds(m),{orderedNodes:b,nodeLiveUntilMap:y}=c;for(const v of b){if(m[v.name])continue;const I=fp(v,m,d,this._resourceManager);if(Br(I))throw new Error(`The execution of the op '${v.op}' returned a promise. Please use model.executeAsync() instead.`);m[v.name]=I,this.keepIntermediateTensors&&(this.clonedTensorsMap[v.name]=this.cloneTensorList(I)),this.checkTensorForDisposalWithNodeLiveUntilInfo(v,m,d,g,a,y.get(v.name))}return this.parent==null&&d.dispose(g),n.map(v=>Je(v,m,d))})}getFrozenTensorIds(t){const n=[].concat.apply([],Object.keys(t).map(s=>t[s]).map(s=>s.map(r=>r.id)));return new Set(n)}checkTensorForDisposal(t,n,s,r,o,a,i){if(!(Fr(n)||a.has(t))){for(const u of s[t])u!=null&&(i[u.id]=(i[u.id]||0)+n.children.length);for(const u of n.inputs){if(Fr(u))continue;const c=ap(u.name,s,r);if(c!=null)for(const l of c){if(!l||l.kept||o.has(l.id))continue;const f=i[l.id];f===1?(l.dispose(),delete i[l.id]):f!=null&&i[l.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(t,n,s,r,o,a){function i(u){return Fr(u)||o.has(u.name)}if(!(Fr(t)||a==null))for(const u of a){if(i(u))continue;const c=ap(u.name,n,s);for(const l of c)!l||l.kept||r.has(l.id)||l.dispose()}}async executeAsync(t,n){return this._executeAsync(t,n)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(t=>{for(const n of t)n&&!n.isDisposed&&n.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(t,n,s=!1,r={},o={}){this.disposeIntermediateTensors(),s||(t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepIntermediateTensors=ae().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(d){this.keepIntermediateTensors=!1,console.warn(d.message)}const a=new hp(this.weightMap,r,o,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const i=await this.executeWithControlFlow(t,a,n,s),u=n.map(d=>Je(d,i,a)),c=u.map(d=>d.id),l=Object.keys(t).map(d=>t[d].id),f=new Set([...c,...l,...this.weightIds]);return Object.values(i).forEach(d=>{d.forEach(m=>{m&&!m.isDisposed&&!f.has(m.id)&&m.dispose()})}),this.parent==null&&a.dispose(f),u}async executeFunctionAsync(t,n,s){const r=t.reduce((o,a,i)=>(o[this.inputs[i].name]=a,o),{});return this._executeAsync(r,this.outputNodes,!0,n,s)}async executeWithControlFlow(t,n,s,r){const o=Object.keys(t),a=o.map(N=>this.graph.nodes[Tn(N)[0]]),i=s.map(N=>Tn(N)[0]),u=new Set(i);let c=i.map(N=>this.graph.nodes[N]);c.length===0&&(c=this._outputs);const{usedNodes:l,missingInputs:f,dynamicNode:d,syncInputs:m}=dp(t,c,this.weightMap,this._initNodes),g=[...a,...this.graph.weights,...this._initNodes||[]].map(N=>({node:N,contexts:n.currentContext})),b=Object.assign({},this.weightMap);Object.keys(t).forEach(N=>{const[C,F]=Tn(N),z=[];z[F]=t[N],b[C]=z});const y={},v=this.getFrozenTensorIds(b),I={};for(;g.length>0;){const N=this.processStack(a,g,n,b,I,v,u,y,l);await Promise.all(N)}d==null&&!r&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const _=c.filter(N=>!Fr(N)&&!Je(N.name,b,n)).map(N=>N.name);if(_.length>0){let N="";throw d!=null&&(N=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${m}]`),new Error(`Cannot compute the outputs [${_}] from the provided inputs [${o}]. Consider providing the following inputs: [${f}]. ${N}`)}return b}processStack(t,n,s,r,o,a,i,u,c){const l=[];for(;n.length>0;){const f=n.pop();s.currentContext=f.contexts;let d="";if(f.node.op==="Enter"&&x("isConstant",f.node,r,s)&&([d]=Ts(f.node.name,s)),r[f.node.name]==null){const m=fp(f.node,r,s,this._resourceManager);d||([d]=Ts(f.node.name,s));const g=s.currentContext;Br(m)?l.push(m.then(b=>(r[d]=b,this.keepIntermediateTensors&&(this.clonedTensorsMap[d]=this.cloneTensorList(b)),s.currentContext=g,this.checkTensorForDisposal(d,f.node,r,s,a,i,u),this.processChildNodes(f.node,n,s,r,o,c),b))):(r[d]=m,this.keepIntermediateTensors&&(this.clonedTensorsMap[d]=this.cloneTensorList(m)),this.checkTensorForDisposal(d,f.node,r,s,a,i,u),this.processChildNodes(f.node,n,s,r,o,c))}else this.processChildNodes(f.node,n,s,r,o,c)}return l}processChildNodes(t,n,s,r,o,a){t.children.forEach(i=>{const[u]=Ts(i.name,s);o[u]||!a.has(i.name)||(i.op==="Merge"?i.inputNames.some(c=>!!Je(c,r,s))&&(o[u]=!0,n.push({contexts:s.currentContext,node:i})):i.inputNames.every(c=>!!Je(c,r,s))&&(o[u]=!0,n.push({contexts:s.currentContext,node:i})))})}dispose(){Object.keys(this.weightMap).forEach(t=>this.weightMap[t].forEach(n=>n.dispose()))}checkInputShapeAndType(t){Object.keys(t).forEach(n=>{const s=t[n],[r]=Tn(n),o=this.graph.nodes[r];if(o.attrParams.shape&&o.attrParams.shape.value){const a=o.attrParams.shape.value,i=a.length===s.shape.length&&s.shape.every((u,c)=>a[c]===-1||a[c]===u);O(i,()=>`The shape of dict['${o.name}'] provided in model.execute(dict) must be [${a}], but was [${s.shape}]`)}o.attrParams.dtype&&o.attrParams.dtype.value&&O(s.dtype===o.attrParams.dtype.value,()=>`The dtype of dict['${o.name}'] provided in model.execute(dict) must be ${o.attrParams.dtype.value}, but was ${s.dtype}`)})}mapInputs(t){var n,s;const r={};for(const o in t){const a=(s=(n=this._signature)===null||n===void 0?void 0:n.inputs)===null||s===void 0?void 0:s[o];a!=null?r[a.name]=t[o]:r[o]=t[o]}return r}checkInputs(t){const n=Object.keys(t).filter(s=>{const[r]=Tn(s);return this.graph.nodes[r]==null});if(n.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${n}] that are not part of graph`)}mapOutputs(t){return t.map(n=>{var s,r;const o=(r=(s=this._signature)===null||s===void 0?void 0:s.outputs)===null||r===void 0?void 0:r[n];return o!=null?o.name:n},{})}checkOutputs(t){t.forEach(n=>{const[s]=Tn(n);if(!this.graph.nodes[s])throw new Error(`The output '${n}' is not found in the graph`)})}}class FC{constructor(t={},n={}){this.hashTableNameToHandle=t,this.hashTableMap=n}addHashTable(t,n){this.hashTableNameToHandle[t]=n.handle,this.hashTableMap[n.id]=n}getHashTableHandleByName(t){return this.hashTableNameToHandle[t]}getHashTableById(t){return this.hashTableMap[t]}dispose(){for(const t in this.hashTableMap)this.hashTableMap[t].clearAndClose(),delete this.hashTableMap[t];for(const t in this.hashTableNameToHandle)this.hashTableNameToHandle[t].dispose(),delete this.hashTableNameToHandle[t]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RC="?tfjs-format=file",PC="model.json";class MC{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(t,n={},s=yb){this.modelUrl=t,this.loadOptions=n,this.version="n/a",this.io=s,n==null&&(this.loadOptions={}),this.resourceManager=new FC}findIOHandler(){const t=this.modelUrl;if(t.load!=null)this.handler=t;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(t,this.loadOptions);else{const n=this.io.getLoadHandlers(t,this.loadOptions);if(n.length===0)n.push(this.io.browserHTTPRequest(t,this.loadOptions));else if(n.length>1)throw new Error(`Found more than one (${n.length}) load handlers for URL '${[t]}'`);this.handler=n[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const t=this.handler.load();return Br(t)?t.then(n=>n.getWeightStream==null?this.loadSync(n):this.loadStreaming(n)):this.loadSync(t)}loadSync(t){const n=this.io.decodeWeights(t.weightData,t.weightSpecs);return this.loadWithWeightMap(t,n)}async loadStreaming(t){if(t.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const n=await hy(t.getWeightStream(),t.weightSpecs);return this.loadWithWeightMap(t,n)}loadWithWeightMap(t,n){this.artifacts=t;const s=this.artifacts.modelTopology;let r=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const o=this.artifacts.userDefinedMetadata;o.signature!=null&&(r=o.signature),o.structuredOutputKeys!=null&&(this.structuredOutputKeys=o.structuredOutputKeys)}if(this.signature=r,this.version=`${s.versions.producer}.${s.versions.minConsumer}`,this.executor=new Qi(ip.Instance.transformGraph(s,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(n),this.executor.resourceManager=this.resourceManager,t.modelInitializer!=null&&t.modelInitializer.node!=null){const o=ip.Instance.transformGraph(t.modelInitializer);this.initializer=new Qi(o),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=t.initializerSignature}return!0}async save(t,n){if(typeof t=="string"){const s=this.io.getSaveHandlers(t);if(s.length===0)throw new Error(`Cannot find any save handlers for URL '${t}'`);if(s.length>1)throw new Error(`Found more than one (${s.length}) save handlers for URL '${t}'`);t=s[0]}if(t.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return t.save(this.artifacts)}addStructuredOutputNames(t){if(this.structuredOutputKeys){const n=t instanceof ln?[t]:t,s={};return n.forEach((r,o)=>s[this.structuredOutputKeys[o]]=r),s}return t}predict(t,n){const s=this.execute(t,this.outputNodes);return this.addStructuredOutputNames(s)}async predictAsync(t,n){const s=await this.executeAsync(t,this.outputNodes);return this.addStructuredOutputNames(s)}normalizeInputs(t){var n;if(!(t instanceof ln)&&!Array.isArray(t)){const o=(n=this.signature)===null||n===void 0?void 0:n.inputs;if(o!=null)for(const a in o){const i=o[a];i.resourceId!=null&&(t[a]=this.resourceIdToCapturedInput[i.resourceId])}return t}t=Array.isArray(t)?t:[t];const s=Object.keys(this.resourceIdToCapturedInput).length;if(t.length+s!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-s} non-resource placeholders, while there are ${t.length} input tensors provided.`);let r=0;return this.inputNodes.reduce((o,a)=>{var i,u,c;const l=(c=(u=(i=this.signature)===null||i===void 0?void 0:i.inputs)===null||u===void 0?void 0:u[a])===null||c===void 0?void 0:c.resourceId;return l!=null?o[a]=this.resourceIdToCapturedInput[l]:o[a]=t[r++],o},{})}normalizeOutputs(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(t){if(this.resourceIdToCapturedInput={},this.initializerSignature){const n=this.initializerSignature.outputs,s=Object.keys(n);for(let r=0;r<s.length;r++){const o=s[r],a=n[o];this.resourceIdToCapturedInput[a.resourceId]=t[r]}}}execute(t,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),t=this.normalizeInputs(t),n=this.normalizeOutputs(n);const s=this.executor.execute(t,n);return s.length>1?s:s[0]}async executeAsync(t,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),t=this.normalizeInputs(t),n=this.normalizeOutputs(n);const s=await this.executor.executeAsync(t,n);return s.length>1?s:s[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(t){return Object.keys(t).reduce((n,s)=>(n[s]=[t[s]],n),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&xn(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function LC(e,t={},n=yb){if(e==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");t==null&&(t={}),t.fromTFHub&&typeof e=="string"&&(e=zC(e));const s=new MC(e,t,n);return await s.load(),s}function zC(e){return e.endsWith("/")||(e=e+"/"),`${e}${PC}${RC}`}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jt(e,t){Array.isArray(e)||(e=[e]),e.forEach(n=>{n!=null&&O(n.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VC=sb;class $u extends sm{nextDataId(){return $u.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new Hw(this,Ld())}write(t,n,s){this.firstUse&&(this.firstUse=!1,ae().get("IS_NODE")&&Ar(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const r={id:this.nextDataId()};return this.data.set(r,{values:t,dtype:s,refCount:1}),r}makeTensorInfo(t,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&gu(s[0])){const o=s.map(a=>Mr(a));r=this.write(o,t,n)}else r=this.write(s,t,n);return{dataId:r,shape:t,dtype:n}}refCount(t){return this.data.has(t)?this.data.get(t).refCount:0}incRef(t){const n=this.data.get(t);n.refCount++}decRef(t){if(this.data.has(t)){const n=this.data.get(t);n.refCount--}}move(t,n,s,r,o){this.data.set(t,{values:n,dtype:r,refCount:o})}numDataIds(){return this.data.numDataIds()}async read(t){return this.readSync(t)}readSync(t){const{dtype:n,complexTensorInfos:s}=this.data.get(t);if(n==="complex64"){const r=this.readSync(s.real.dataId),o=this.readSync(s.imag.dataId);return Ao(r,o)}return tv(this.data.get(t).values,n)}bufferSync(t){const n=this.readSync(t.dataId);if(t.dtype==="string")try{const s=n.map(r=>Ia(r));return ie(t.shape,t.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return ie(t.shape,t.dtype,n)}makeOutput(t,n,s){return Ld().makeTensorFromTensorInfo(this.makeTensorInfo(n,s,t),this)}disposeData(t,n=!1){if(this.data.has(t)){if(this.data.get(t).refCount--,!n&&this.data.get(t).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(t);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(t)}return!0}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}async time(t){const n=To();return t(),{kernelMs:To()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(t){jt([t],"where");const n=this.readSync(t.dataId);return VC(t.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}$u.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BC(e){const t=new Float32Array(e.length);for(let n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}const WC=e=>{const{x:t}=e.inputs,n=e.backend;jt(t,"abs");let s=new Float32Array(Nt(t.shape));const r=n.data.get(t.dataId).values;return s=BC(r),n.makeOutput(s,t.shape,t.dtype)},jC={kernelName:um,backendName:"cpu",kernelFunc:WC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ve(e){return(t,n,s,r,o)=>{const a=Pe(t,n),i=a.length,u=Xt(a),c=Nt(a),l=mn(o,c),f=t.length,d=n.length,m=Xt(t),g=Xt(n),b=Ki(t,a),y=Ki(n,a);if(b.length+y.length===0)for(let v=0;v<l.length;++v)l[v]=e(s[v%s.length],r[v%r.length]);else for(let v=0;v<l.length;++v){const I=Vo(v,i,u),_=I.slice(-f);b.forEach(z=>_[z]=0);const N=ls(_,f,m),C=I.slice(-d);y.forEach(z=>C[z]=0);const F=ls(C,d,g);l[v]=e(s[N],r[F])}return[l,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $n(e){const{inputs:t,backend:n}=e,{real:s,imag:r}=t,o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,i=n.makeTensorInfo(s.shape,"complex64"),u=n.data.get(i.dataId);return u.complexTensorInfos={real:n.makeTensorInfo(s.shape,"float32",o),imag:n.makeTensorInfo(r.shape,"float32",a)},i}const HC={kernelName:vm,backendName:"cpu",kernelFunc:$n};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ji(e,t,n="float32"){if(n==="complex64"){const r=Ji(e,t,"float32"),o=Ji(e,t,"float32");return $n({inputs:{real:r,imag:o},backend:e})}const s=sn(Nt(t),n);return e.makeTensorInfo(t,n,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gs(e){const{inputs:t,backend:n}=e,{x:s}=t;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const qC={kernelName:bf,backendName:"cpu",kernelFunc:gs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xr(e){const{inputs:t,backend:n}=e,{input:s}=t,r=n.data.get(s.dataId).complexTensorInfos.real,o=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,o)}const KC={kernelName:wg,backendName:"cpu",kernelFunc:Xr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UC(e,t,n,s){if(s==="int32"){const r=Int32Array.from(e);return[t,"int32",r]}if(s==="bool"){const r=Qr([0],n),[o,a]=Ve((i,u)=>i!==u?1:0)(t,[],e,r,"bool");return[a,"bool",o]}throw new Error(`Error in Cast: failed to cast ${n} to ${s}`)}function dr(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{dtype:o}=s;if(o==="complex64"){if(r.dtype==="complex64")return gs({inputs:{x:r},backend:n});const l=Ji(n,r.shape,r.dtype),f=dr({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),d=$n({inputs:{real:f,imag:l},backend:n});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(f),d}if(r.dtype==="complex64"){const l=Xr({inputs:{input:r},backend:n}),f=dr({inputs:{x:l},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(l),f}if(!Yw(r.dtype,o)){const l=gs({inputs:{x:r},backend:n});return{dataId:l.dataId,shape:l.shape,dtype:o}}const a=n.data.get(r.dataId).values,[i,u,c]=UC(a,r.shape,r.dtype,o);return n.makeTensorInfo(i,u,c)}const GC={kernelName:nf,backendName:"cpu",kernelFunc:dr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ue(e,t,n,s){return n==null?({inputs:r,backend:o})=>{const{a,b:i}=r,u=o;jt([a,i],e);const c=u.data.get(a.dataId).values,l=u.data.get(i.dataId).values,f=a.dtype==="string"?Oa(c):c,d=a.dtype==="string"?Oa(l):l,m=s||a.dtype,[g,b]=t(a.shape,i.shape,f,d,m);return u.makeTensorInfo(b,m,g)}:({inputs:r,backend:o})=>{const{a,b:i}=r,u=o;if(a.dtype==="complex64"||i.dtype==="complex64"){const c=dr({inputs:{x:a},backend:u,attrs:{dtype:"complex64"}}),l=u.data.get(c.dataId),f=l.complexTensorInfos.real,d=l.complexTensorInfos.imag,m=u.data.get(f.dataId).values,g=u.data.get(d.dataId).values,b=dr({inputs:{x:i},backend:u,attrs:{dtype:"complex64"}}),y=u.data.get(b.dataId),v=y.complexTensorInfos.real,I=y.complexTensorInfos.imag,_=u.data.get(v.dataId).values,N=u.data.get(I.dataId).values,[C,F,z]=n(a.shape,i.shape,m,g,_,N),P=u.makeTensorInfo(z,"float32",C),D=u.makeTensorInfo(z,"float32",F),L=$n({inputs:{real:P,imag:D},backend:u});return u.disposeIntermediateTensorInfo(c),u.disposeIntermediateTensorInfo(b),u.disposeIntermediateTensorInfo(P),u.disposeIntermediateTensorInfo(D),L}else{const c=u.data.get(a.dataId).values,l=u.data.get(i.dataId).values,f=s||a.dtype,[d,m]=t(a.shape,i.shape,c,l,f);return u.makeTensorInfo(m,f,d)}}}function xh(e){return(t,n,s,r,o,a)=>{const i=Pe(t,n),u=Nt(i),c=i.length,l=Xt(i),f=mn("float32",u),d=mn("float32",u),m=Ki(t,i),g=Ki(n,i),b=Ao(s,r),y=Ao(o,a),v=t.length,I=Xt(t),_=n.length,N=Xt(n);if(m.length+g.length===0)for(let C=0;C<f.length;C++){const F=C%b.length,z=C%y.length,P=e(b[F*2],b[F*2+1],y[z*2],y[z*2+1]);f[C]=P.real,d[C]=P.imag}else for(let C=0;C<f.length;C++){const F=Vo(C,c,l),z=F.slice(-v);m.forEach(K=>z[K]=0);const P=ls(z,v,I),D=F.slice(-_);g.forEach(K=>D[K]=0);const L=ls(D,_,N),T=e(b[P*2],b[P*2+1],y[L*2],y[L*2+1]);f[C]=T.real,d[C]=T.imag}return[f,d,i]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XC=Ve(((e,t)=>e+t)),YC=xh(((e,t,n,s)=>({real:e+n,imag:t+s}))),Do=Ue(yu,XC,YC),ZC={kernelName:yu,backendName:"cpu",kernelFunc:Do};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nb(e,t,n,s,r){const o=Nt(s),a=sn(r,n);for(let i=0;i<e.length;i++){const u=e[i];if(u<0)throw new Error("Input x must be non-negative!");u>=r||(o>0?a[u]+=t[i]:a[u]+=1)}return a}function QC(e,t,n,s=!1){const r=e.shape[0],o=e.shape[1],a=ie([r,n],t.dtype);for(let i=0;i<r;i++)for(let u=0;u<o;u++){const c=e.get(i,u);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(s?a.set(1,i,c):t.size>0?a.set(a.get(i,c)+t.get(i,u),i,c):a.set(a.get(i,c)+1,i,c))}return a}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JC=Ve(((e,t)=>e&t)),tA=Ue(ef,JC),eA={kernelName:ef,backendName:"cpu",kernelFunc:tA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yr(e){return(t,n,s)=>{const r=je(n,t.length);for(let o=0;o<t.length;++o)r[o]=e(t[o],s);return r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ye(e,t,n){const s=yr(t);return br(e,s,n)}function br(e,t,n){return({inputs:s,attrs:r,backend:o})=>{const{x:a}=s;jt(a,e);const i=o,u=i.data.get(a.dataId).values;let c;if(a.dtype==="string"){if(!Array.isArray(u))throw new Error("String tensor's value was not an instance of Array");c=Oa(u)}else c=u;const l=n||a.dtype,f=t(c,l,r);return i.makeTensorInfo(a.shape,l,f)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nA=yr(e=>Math.ceil(e)),sA=br(sf,nA),rA={kernelName:sf,backendName:"cpu",kernelFunc:sA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oA(e,t,n,s){const r=je(n,Nt(t));if(s&&n!=="string"){let o=0;e.forEach(a=>{const i=Nt(a.shape);r.set(a.vals,o),o+=i})}else{let o=0;e.forEach(a=>{const i=n==="string"?Oa(a.vals):a.vals;let u=0;for(let c=0;c<a.shape[0];++c){const l=c*t[1]+o;for(let f=0;f<a.shape[1];++f)r[l+f]=i[u++]}o+=a.shape[1]})}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aA=Ve((e,t)=>e===t?1:0),_b=Ue(ff,aA,null,"bool"),iA={kernelName:ff,backendName:"cpu",kernelFunc:_b};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uA=yr(e=>Math.exp(e)),Tb=br(hf,uA,"float32"),cA={kernelName:hf,backendName:"cpu",kernelFunc:Tb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lA=yr(e=>Math.expm1(e)),fA=br(df,lA),hA={kernelName:df,backendName:"cpu",kernelFunc:fA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dA=yr(e=>Math.floor(e)),pA=br(pf,dA),mA={kernelName:pf,backendName:"cpu",kernelFunc:pA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gA=Ve((e,t)=>Math.floor(e/t)),yA=Ue(mf,gA,null,"int32"),bA={kernelName:mf,backendName:"cpu",kernelFunc:yA};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wA(e,t,n,s,r,o,a,i,u){const c=ie([s,o],n);for(let l=0;l<s;l++){const f=[];let d=0;for(let m=0;m<r;m++){const g=e[l*r+m];d+=g*a[m],f.push(g)}if(d<0||d>=u/o)throw new Error(`Invalid indices: ${f} does not index into ${i}`);for(let m=0;m<o;m++)c.values[l*o+m]=t.get(...t.indexToLoc(d*o+m))}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vA(e,t,n){const s=ie(n,e.dtype);for(let r=0;r<s.size;++r){const a=s.indexToLoc(r).slice(),i=a[0],u=a[2],c=t.locToIndex([i,u]);a[2]=t.values[c];const l=e.locToIndex(a);0<=l&&l<e.values.length&&(s.values[r]=e.values[l])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kA=Ve((e,t)=>e>t?1:0),xA=Ue(gf,kA,null,"bool"),SA={kernelName:gf,backendName:"cpu",kernelFunc:xA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IA=Ve((e,t)=>e>=t?1:0),NA=Ue(yf,IA,null,"bool"),_A={kernelName:yf,backendName:"cpu",kernelFunc:NA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TA=Ve((e,t)=>e<t?1:0),EA=Ue(xf,TA,null,"bool"),$A={kernelName:xf,backendName:"cpu",kernelFunc:EA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CA=Ve((e,t)=>e<=t?1:0),AA=Ue(Sf,CA,null,"bool"),DA={kernelName:Sf,backendName:"cpu",kernelFunc:AA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OA(e,t,n){const s=(t-e)/(n-1),r=sn(n,"float32");r[0]=e;for(let o=1;o<r.length;o++)r[o]=r[o-1]+s;return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FA=yr(e=>Math.log(e)),RA=br(If,FA),PA={kernelName:If,backendName:"cpu",kernelFunc:RA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MA(e,t,n,s){const r=mn(s,Nt(n));for(let o=0;o<r.length;++o){const a=o*t;let i=e[a];for(let u=0;u<t;++u){const c=e[a+u];(Number.isNaN(c)||c>i)&&(i=c)}r[o]=i}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LA=Ve(((e,t)=>Math.max(e,t))),zA=Ue($f,LA),VA={kernelName:$f,backendName:"cpu",kernelFunc:zA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BA=Ve(((e,t)=>Math.min(e,t))),WA=Ue(Cf,BA),jA={kernelName:Cf,backendName:"cpu",kernelFunc:WA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eb=Ve(((e,t)=>e*t)),HA=xh(((e,t,n,s)=>({real:e*n-t*s,imag:e*s+t*n}))),Cu=Ue(Df,Eb,HA),qA={kernelName:Df,backendName:"cpu",kernelFunc:Cu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KA(e,t,n){const s=th(-1,n);return Eb([],t,s,e,n)}function UA(e){const{inputs:t,backend:n}=e,{x:s}=t;jt(s,"neg");const r=n.data.get(s.dataId).values,[o,a]=KA(r,s.shape,s.dtype);return n.makeTensorInfo(a,s.dtype,o)}const GA={kernelName:og,backendName:"cpu",kernelFunc:UA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XA=Ve(((e,t)=>e!==t?1:0)),YA=Ue(Of,XA,null,"bool"),ZA={kernelName:Of,backendName:"cpu",kernelFunc:YA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $b(e,t,n,s,r){const o=t.length,a=Nt(t),i=Xt(t),u=Xt(r),c=mn(n,Nt(r));for(let l=0;l<a;++l){const f=Vo(l,o,i),d=new Array(f.length);for(let g=0;g<d.length;g++)d[g]=f[s[g]];const m=ls(d,o,u);c[m]=e[l]}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function In(e){const{inputs:t,attrs:n,backend:s}=e,{x:r}=t,{perm:o}=n;jt(r,"transpose");const a=r.shape.length,i=new Array(a);for(let f=0;f<i.length;f++)i[f]=r.shape[o[f]];const u=s.data.get(r.dataId).values,c=$b(u,r.shape,r.dtype,o,i);return{dataId:s.write(c,i,r.dtype),shape:i,dtype:r.dtype}}const QA={kernelName:_i,backendName:"cpu",kernelFunc:In};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JA(e,t,n,s){const[r,o]=Ws(e,s),a=Bo(t,"int32"),i=sn(Nt(r),a),u=Nt(o);for(let c=0;c<i.length;++c){const l=c*u;let f=1;for(let d=0;d<u;++d)f*=n[l+d];i[c]=f}return{outVals:i,outShape:r,outDtype:a}}function tD(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:o,keepDims:a}=s;jt(r,"prod");const i=r.shape.length,u=Ye(o,r.shape),c=vs(u,i);let l=u,f=r;const d=[];c!=null&&(f=In({inputs:{x:r},backend:n,attrs:{perm:c}}),d.push(f),l=ks(l.length,i));const m=n.data.get(f.dataId).values,{outVals:g,outShape:b,outDtype:y}=JA(f.shape,f.dtype,m,l);let v=b;return a&&(v=ts(b,u)),d.forEach(I=>n.disposeIntermediateTensorInfo(I)),n.makeTensorInfo(v,y,g)}const eD={kernelName:pg,backendName:"cpu",kernelFunc:tD};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nD(e,t,n){e.forEach((s,r)=>{if(s<0||s>=n){const o=Vo(r,t.length,Xt(t)).join(",");throw new Error(`indices[${o}] = ${s} is not in [0, ${n})`)}})}function sD(e,t){for(let n=0;n<e.length;++n){const s=e[n],r=n===e.length-1?t:e[n+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>r)throw new Error("Ragged splits must not point past values");for(let o=1;o<s.length;++o)if(s[o-1]>s[o])throw new Error("Ragged splits must be sorted in ascending order")}}function rD(e,t,n,s){const r=[];let o=0;const a=t.length-1+n.length,i=new Array(a).fill(null).map(()=>[0]);sD(n,s);let u=1;for(let c=0;c<t.length-1;++c){u*=t[c];const l=t[c+1];for(let f=1;f<u+1;++f)i[c].push(f*l)}for(let c=0;c<e.length;++c){let l=e[c],f=e[c]+1;for(let d=0;d<n.length;++d){const m=n[d],g=d+t.length-1;if(g>=0){const b=i[g],y=b[b.length-1]-m[l];for(let v=l;v<f;++v)i[g].push(m[v+1]+y)}l=m[l],f=m[f]}f!==l&&(r.push([l,f]),o+=f-l)}return{outSplits:i,valueSlices:r,numValues:o}}function oD(e){const t=[];for(let n=0;n<e.length;++n){const s=e[n].length,r=je("int32",s);t.push(r),e[n].forEach((o,a)=>r[a]=o)}return t}function pp(e,t){const n=e.slice(0,t);for(;n.length<t;)n.push(1);for(let s=t;s<e.length;s++)n[t-1]*=e[s];return n}function aD(e,t,n,s,r,o){const a=pp(t,2)[1],i=pp(o,2)[1];let u=0;for(const c of n)for(let l=c[0];l<c[1];++l){for(let f=0;f<s;++f)r[u*i+f]=e[l*a+f];++u}}function iD(e,t,n,s,r){const o=t.slice();o[0]=r;const a=je(n,Nt(o)),i=e.length,u=i===0?0:i/t[0];return aD(e,t,s,u,a,o),[a,o]}function uD(e,t,n,s,r,o,a,i){if(e.length===0)throw new Error("paramsNestedSplits must be non empty");if(t[0].length===0)throw new Error("Split tensors must not be scalars");const u=t[0][0]-1;if(nD(o,a,u),s.length===0)throw new Error("params.rank must be nonzero");const c=s[0],{outSplits:l,valueSlices:f,numValues:d}=rD(o,a,e,c),m=oD(l),g=iD(n,s,r,f,d);return[m,g[0],g[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mp=2147483647;function cD(e,t,n,s,r,o,a){if(t.length>1)throw new Error("starts must be a scalar or vector");if(r.length>1)throw new Error("limits must be a scalar or vector");if(a.length>1)throw new Error("deltas must be a scalar or vector");const i=t.length===0,u=r.length===0,c=a.length===0,l=[];i||l.push(t[0]),u||l.push(r[0]),c||l.push(a[0]);for(let y=1;y<l.length;++y)if(l[y]!==l[y-1])throw new Error("starts, limits, and deltas must have the same shape");const f=l.length===0?1:l[0],d=je("int32",f+1);d[0]=0;for(let y=0;y<f;++y){const v=i?e[0]:e[y],I=u?s[0]:s[y],_=c?o[0]:o[y];if(_===0)throw new Error("Requires delta != 0");let N;if(_>0&&I<v||_<0&&I>v)N=0;else if(N=Math.ceil(Math.abs((I-v)/_)),N>mp)throw new Error(`Requires ((limit - start) / delta) <= ${mp}`);d[y+1]=d[y]+N}const m=d[f],g=je(n,m);let b=0;for(let y=0;y<f;++y){const v=d[y+1]-d[y];let I=i?e[0]:e[y];const _=c?o[0]:o[y];for(let N=0;N<v;++N)g[b++]=I,I+=_}return[d,g]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ln=is;class tu{constructor(t,n,s,r,o,a,i,u,c,l){this.shape=t,this.shapeShape=n,this.values=s,this.valuesShape=r,this.valuesDType=o,this.defaultValue=a,this.defaultValueShape=i,this.rowPartitionValues=u,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=I2(l),this.raggedRank=N2(this.rowPartitionTypes)}getRowPartitionTypeByDimension(t){return this.rowPartitionTypes[0]===Ln.FIRST_DIM_SIZE?this.rowPartitionTypes[t+1]:this.rowPartitionTypes[t]}getRowPartitionTensor(t){return this.rowPartitionTypes[0]===Ln.FIRST_DIM_SIZE?this.rowPartitionValues[t+1]:this.rowPartitionValues[t]}getMaxWidth(t){const n=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case Ln.VALUE_ROWIDS:return tu.getMaxWidthValueRowID(n);case Ln.ROW_SPLITS:return tu.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${Ln[this.getRowPartitionTypeByDimension(t-1)]}`)}}static getMaxWidthRowSplit(t){const n=t.length;if(n===0||n===1)return 0;let s=0;for(let r=0;r<n-1;++r){const o=t[r+1]-t[r];o>s&&(s=o)}return s}static getMaxWidthValueRowID(t){const n=t.length;if(n===0)return 0;let s=0,r=t[0],o=0;for(let a=1;a<n;++a){const i=t[a];i!==r&&(r=i,o=Math.max(a-s,o),s=a)}return Math.max(n-s,o)}tensorShapeFromTensor(t,n,s=!0){if(n.length===0){if(t[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return yp(t,s)}calculateOutputSize(t){const n=this.valuesShape,s=this.defaultValueShape;_2(s,n);const r=this.tensorShapeFromTensor(this.shape,this.shapeShape),a=S2(this.raggedRank,r,n);a[0]<0&&(a[0]=t);for(let i=1;i<=this.raggedRank;++i)a[i]<0&&(a[i]=this.getMaxWidth(i));return a}calculateFirstParentOutputIndex(t,n,s){const r=Math.min(t,s),o=[];let a=0;for(let i=0;i<r;++i,a+=n)o.push(a);for(let i=r;i<t;++i)o.push(-1);return O(o.length===t,()=>"Final length of result must be equal to firstDimension."),o}calculateOutputIndexRowSplit(t,n,s,r){const o=t.length,a=[];for(let i=0;i<o-1;++i){const u=t[i+1]-t[i];let c=Math.min(r,u),l=n[i];l===-1&&(c=0);for(let f=0;f<c;++f)a.push(l),l+=s;for(let f=0;f<u-c;++f)a.push(-1)}if(o>0&&a.length!==t[o-1])throw new Error("Invalid row split size.");return a}calculateOutputIndexValueRowID(t,n,s,r){const o=t.length,a=[];if(o===0)return[];let i=0,u=t[0];if(u>=n.length)throw new Error(`Got currentValueRowId=${u}, which is not less than ${n.length}`);let c=n[u];a.push(c);for(let l=1;l<o;++l){const f=t[l];if(f===u)c>=0&&(++i,i<r?c+=s:c=-1);else{if(i=0,u=f,f>=n.length)throw new Error(`Got nextValueRowId=${f} which is not less than ${n.length}`);c=n[f]}a.push(c)}if(a.length!==t.length)throw new Error("Invalid row ids.");return a}calculateOutputIndex(t,n,s,r){const o=this.getRowPartitionTensor(t),a=this.getRowPartitionTypeByDimension(t);switch(a){case Ln.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(o,n,s,r);case Ln.ROW_SPLITS:if(o.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${o.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(o,n,s,r);default:throw new Error(`Unsupported partition type: ${Ln[a]}`)}}getFirstDimensionSize(){const t=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case Ln.FIRST_DIM_SIZE:return t[0];case Ln.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Ln.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Ln[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),s=this.calculateOutputSize(n),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let u=r.length-2;u>=0;--u)r[u]=r[u+1]*s[u+1];const o=yp(s,!1),a=je(this.valuesDType,Nt(o));if(r[0]*s[0]>0){let u=this.calculateFirstParentOutputIndex(n,r[0],s[0]);for(let c=1;c<=this.raggedRank;++c)u=this.calculateOutputIndex(c-1,u,r[c],s[c]);this.setOutput(this.raggedRank,u,a,o)}return[o,a]}setOutput(t,n,s,r){if(s.length===0)return;const o=this.values,a=s;let i=r.slice();i=i.slice(t+1);const u=Nt(i),c=n.length;let l=this.defaultValue;if(l.length!==u&&l.length!==1){const g=this.defaultValueShape;de(()=>{const b=gt(l,g);l=fa(b,i).dataSync()})}let f=0,d=0,m=0;for(let g=0;g<=c;++g){let b=g<c?n[g]:-1;if(b===m){++m;continue}if(d<m){const y=o.subarray(f*u),v=a.subarray(d*u),I=(m-d)*u;gp(v,y,I)}if(g>=c){const y=s.length;b=Math.floor(y/u)}if(b>m)if(this.defaultValue.length===1)a.subarray(m*u,b*u).fill(this.defaultValue[0]),m=b;else for(;b>m;){const y=a.slice(m*u);gp(y,l,u),++m}b<0?(f=g+1,d=m):(f=g,d=m,m=d+1)}}}function gp(e,t,n){for(let s=0;s<n;s++)e[s]=t[s]}function yp(e,t){const n=[];for(let s of e){if(s<0){if(!t)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}n.push(s)}return n}function lD(e,t,n,s,r,o,a,i,u,c){return new tu(e,t,n,s,r,o,a,i,u,c).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fD(e,t,n,s){const r=e===t,o=e<t&&n<0,a=t<e&&n>1;if(r||o||a)return sn(0,s);const i=Math.abs(Math.ceil((t-e)/n)),u=sn(i,s);t<e&&n===1&&(n=-1),u[0]=e;for(let c=1;c<u.length;c++)u[c]=u[c-1]+n;return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hD=yr(e=>1/Math.sqrt(e)),dD=br(zf,hD),pD={kernelName:zf,backendName:"cpu",kernelFunc:dD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bo(e,t,n,s,r,o,a,i,u,c){const l=[s/r,r],f=e.values,d=t.values;if(s===0)return ie(n,t.dtype);const m=u instanceof Ke?u:ie(l,t.dtype);typeof u=="string"||typeof u=="number"?m.values.fill(u):typeof u=="boolean"&&m.values.fill(+u);for(let g=0;g<o;g++){const b=[];let y=0;for(let v=0;v<a;v++){const I=f[g*a+v];b.push(I),y+=I*i[v]}if(y<0||y>=s/r)throw new Error(`Invalid indices: ${b} does not index into ${n}`);for(let v=0;v<r;v++)c?m.values[y*r+v]+=d[g*r+v]:m.values[y*r+v]=t.rank===0?d[0]:d[g*r+v]}return m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cb=ye(Hf,e=>1/(1+Math.exp(-e))),mD={kernelName:Hf,backendName:"cpu",kernelFunc:Cb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gD(e,t,n,s,r){const o=y2(s,t,n),a=Nt(n),i=Xt(s);if(o){const f=b2(t,i);return r==="string"?e.slice(f,f+a):e.subarray(f,f+a)}const u=r==="string"?Oa(e):e,c=ie(s,r,u),l=ie(n,r);for(let f=0;f<l.size;++f){const d=l.indexToLoc(f),m=d.map((g,b)=>g+t[b]);l.set(c.get(...m),...d)}return r==="string"?l$(l.values):l.values}function Yr(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{begin:o,size:a}=s;jt(r,"slice");const[i,u]=w2(r,o,a);m2(r,i,u);const c=n.data.get(r.dataId).values,l=gD(c,i,u,r.shape,r.dtype);return n.makeTensorInfo(u,r.dtype,l)}const yD={kernelName:Eg,backendName:"cpu",kernelFunc:Yr};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bD(e,t,n,s,r,o,a){const i=t[0],u=o[0],c=new Array(u),l=new Array(i),f=t[1];if(u===0){if(i!==0)throw new Error(Q2(i));const y=je(n,0),v=je(r,0);return[y,[0,f],v,c,l]}let d=!0,m=0;const g=new Array(u).fill(0);for(let y=0;y<i;++y){const v=e[y*f];if(v<0)throw new Error(J2(y,v));if(v>=u)throw new Error(t$(y,v,u));++g[v],d=d&&v>=m,m=v}let b=!0;for(let y=0;y<u;++y){const v=g[y]===0;c[y]=v,b=b&&!v,g[y]=Math.max(g[y],1),y>0&&(g[y]+=g[y-1])}if(b&&d){const y=e,v=s;for(let I=0;I<i;++I)l[I]=I;return[y,[i,f],v,c,l]}else{const y=g[u-1],v=je(n,y*f),I=je(r,y),_=new Array(u).fill(0);for(let N=0;N<i;++N){const C=e[N*f],F=_[C],z=(C===0?0:g[C-1])+F;_[C]++;for(let P=0;P<f;++P)v[z*f+P]=e[N*f+P];I[z]=s[N],l[N]=z}for(let N=0;N<u;++N)if(_[N]===0){const F=N===0?0:g[N-1];v[F*f+0]=N;for(let z=1;z<f;++z)v[F*f+z]=0;I[F]=a}return[v,[y,f],I,c,l]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wD(e,t,n,s,r){const o=Nt(s),a=t[0],i=r.length,u=[];let c=1,l=-1;for(let y=0;y<i;++y){const v=r[y];if(v===-1){if(l!==-1)throw new Error(e$(l,y));l=y,u.push(1)}else{if(v<0)throw new Error(n$(y,v));c*=v,u.push(v)}}if(l!==-1){if(c<=0)throw new Error(s$());const y=Math.trunc(o/c);if(c*y!==o)throw new Error(r$(s,u));u[l]=y}if(Nt(u)!==o)throw new Error(o$(s,u));const d=s.length,m=[];if(d>0){m[d-1]=1;for(let y=d-2;y>=0;--y)m[y]=m[y+1]*s[y+1]}const g=[];if(i>0){g[i-1]=1;for(let y=i-2;y>=0;--y)g[y]=g[y+1]*u[y+1]}const b=je(n,a*i);for(let y=0;y<a;++y){let v=0;for(let I=0;I<d;++I)v+=e[y*d+I]*m[I];for(let I=0;I<i;++I)b[y*i+I]=Math.trunc(v/g[I]),v%=g[I]}return[b,[a,i],u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ab(e,t,n,s,r,o=!1,a=0){const i=s.length,u=[t[0],e.length/t[0]],c=u[1],f=i>0?r[i-1]+1:0;if(f<0)throw new Error(rp());const d=t.slice();d[0]=f;const m=d.reduce((_,N)=>_*N,1),g=je(n,m);if(i===0)return f>0&&g.fill(a),[g,d];if(f<=0)throw new Error(rp());let b=0,y=1,v=0,I=r[b];for(;;){let _=0;if(y<i){if(_=r[y],I===_){++y;continue}if(I>=_)throw new Error(a$())}if(I<0||I>=f)throw new Error(i$(I,f));I>v&&g.fill(a,v*c,I*c);for(let N=b;N<y;++N){const C=s[N];if(C<0||C>=u[0])throw new Error(u$(N,s[N],u[0]));for(let F=0;F<c;F++)g[I*c+F]+=e[C*c+F]}if(o)for(let N=0;N<c;N++)g[I*c+N]/=y-b;if(b=y,++y,v=I+1,I=_,y>i)break}return v<f&&g.fill(a,v*c,f*c),[g,d]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vD=ye(Kf,e=>Math.sqrt(e)),kD={kernelName:Kf,backendName:"cpu",kernelFunc:vD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xD=Ve(((e,t)=>{const n=e-t;return n*n})),SD=Ue(Uf,xD),ID={kernelName:Uf,backendName:"cpu",kernelFunc:SD};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ND=yr((e,t)=>{const{pattern:n,replaceGlobal:s,rewrite:r}=t;return e.replace(new RegExp(n,s?"g":""),r)}),_D=br(Gf,ND),TD={kernelName:Gf,backendName:"cpu",kernelFunc:_D};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ED(e,t,n,s){const r=ie(e,t.dtype);for(let o=0;o<r.size;o++){const a=r.indexToLoc(o),i=new Array(a.length);for(let u=0;u<i.length;u++)i[u]=a[u]*n[u]+s[u];r.set(t.get(...i),...a)}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $D{constructor(t,n,s,r,o,a){this.separator=Mr(t),this.nGramWidths=n,this.leftPad=Mr(s),this.rightPad=Mr(r),this.padWidth=o,this.preserveShort=a}getPadWidth(t){return Math.min(this.padWidth<0?t-1:this.padWidth,t-1)}getNumNGrams(t,n){const s=this.getPadWidth(n);return Math.max(0,t+2*s-n+1)}createNGrams(t,n,s,r,o,a){for(let i=0;i<o;++i){const u=this.getPadWidth(a),c=Math.max(0,u-i),l=Math.max(0,u-(o-(i+1))),f=a-(c+l),d=n+(c>0?0:i-u);let m=0;m+=c*this.leftPad.length;for(let I=0;I<f;++I)m+=t[d+I].length;m+=l*this.rightPad.length;const g=c+l+f-1;m+=g*this.separator.length,s[r+i]=new Uint8Array(m);const b=s[r+i];let y=0;const v=I=>I.forEach(_=>b[y++]=_);for(let I=0;I<c;++I)v(this.leftPad),v(this.separator);for(let I=0;I<f-1;++I)v(t[d+I]),v(this.separator);if(f>0){v(t[d+f-1]);for(let I=0;I<l;++I)v(this.separator),v(this.rightPad)}else{for(let I=0;I<l-1;++I)v(this.rightPad),v(this.separator);v(this.rightPad)}}}compute(t,n){const s=t.length,r=n.length;if(r>0){let u=n[0];if(u!==0)throw new Error(`First split value must be 0, got ${u}`);for(let c=1;c<r;++c){let l=n[c]>=u;if(l=l&&n[c]<=s,!l)throw new Error(`Invalid split value ${n[c]}, must be in [${u}, ${s}]`);u=n[c]}if(u!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${u}`)}const o=r-1,a=je("int32",r);if(s===0||r===0){const u=new Array(s);for(let c=0;c<=o;++c)a[c]=0;return[u,a]}a[0]=0;for(let u=1;u<=o;++u){const c=n[u]-n[u-1];let l=0;this.nGramWidths.forEach(f=>{l+=this.getNumNGrams(c,f)}),this.preserveShort&&c>0&&l===0&&(l=1),a[u]=a[u-1]+l}const i=new Array(a[o]);for(let u=0;u<o;++u){const c=n[u];let l=a[u];if(this.nGramWidths.forEach(f=>{const d=n[u+1]-n[u],m=this.getNumNGrams(d,f);this.createNGrams(t,c,i,l,m,f),l+=m}),this.preserveShort&&l===a[u]){const f=n[u+1]-n[u];if(f===0)continue;const d=f+2*this.padWidth;this.createNGrams(t,c,i,l,1,d)}}return[i,a]}}function CD(e,t,n,s,r,o,a,i){return new $D(n,s,r,o,a,i).compute(e,t)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AD(e,t,n,s){if(!e.length)return;if(t.length===0){for(let o=0;o<e.length;++o)s.push(e.subarray(o,o+1));return}if(t.length===1){const o=t[0];let a=e.indexOf(o);for(;a!==-1;){const i=e.subarray(0,a);(!n||i.length!==0)&&s.push(i),e=e.subarray(a+1),a=e.indexOf(o)}(!n||e.length!==0)&&s.push(e);return}let r=0;for(let o=0;o<e.length+1;o++)if(o===e.length||t.indexOf(e[o])!==-1){const a=e.subarray(r,o);(!n||a.length!==0)&&s.push(a),r=o+1}}function DD(e,t,n){const s=e.length,r=[];let o=0,a=0;const i=new Array(s);for(let d=0;d<s;++d){const m=r.length;AD(e[d],t,n,r);const g=r.length-m;i[d]=g,o+=g,a=Math.max(a,g)}const u=je("int32",o*2),c=new Array(o),l=[s,a];let f=0;for(let d=0;d<s;++d)for(let m=0;m<i[d];++m)u[f*2]=d,u[f*2+1]=m,c[f]=r[f],++f;return[u,c,l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OD(e,t){const n=je("int32",e.length);for(let s=0;s<e.length;++s)n[s]=Ev(e[s]).modulo(t).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FD=Ve(((e,t)=>e-t)),RD=xh(((e,t,n,s)=>({real:e-n,imag:t-s}))),Sh=Ue(Xf,FD,RD),PD={kernelName:Xf,backendName:"cpu",kernelFunc:Sh};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MD(e,t){const n=new Array(e.rank);for(let r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];const s=ie(n,e.dtype);for(let r=0;r<s.values.length;++r){const o=s.indexToLoc(r),a=new Array(e.rank);for(let u=0;u<a.length;u++)a[u]=o[u]%e.shape[u];const i=e.locToIndex(a);s.values[r]=e.values[i]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ua=(e,t)=>{const n=t.value-e.value;return n===0?e.index-t.index:n};function Db(e,t,n=0,s=e.length-1){for(;s>n;){if(s-n>600){const i=s-n+1,u=t-n+1,c=Math.log(i),l=.5*Math.exp(2*c/3),f=.5*Math.sqrt(c*l*(i-l)/i)*Math.sign(u-i/2),d=Math.max(n,Math.floor(t-u*l/i+f)),m=Math.min(s,Math.floor(t+(i-u)*l/i+f));Db(e,t,d,m)}const r=e[t];let o=n,a=s;for(ta(e,n,t),ua(e[s],r)>0&&ta(e,n,s);o<a;){for(ta(e,o,a),o++,a--;ua(e[o],r)<0;)o=o+1;for(;ua(e[a],r)>0;)a=a-1}ua(e[n],r)===0?ta(e,n,a):(a=a+1,ta(e,a,s)),a<=t&&(n=a+1),t<=a&&(s=a-1)}}function LD(e,t,n,s,r){const o=t[t.length-1],[a,i]=[e.length/o,o],u=mn(n,a*s),c=mn("int32",a*s);for(let f=0;f<a;f++){const d=f*i,m=e.subarray(d,d+i);let g=new Array(m.length);m.forEach((I,_)=>g[_]={value:I,index:_}),s<g.length&&(Db(g,s),g=g.slice(0,s)),r&&g.sort(ua);const b=f*s,y=u.subarray(b,b+s),v=c.subarray(b,b+s);for(let I=0;I<s;I++)y[I]=g[I].value,v[I]=g[I].index}const l=t.slice();return l[l.length-1]=s,[ie(l,n,u),ie(l,"int32",c)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zD(e,t,n,s){const r=Ye(t,n)[0],o=[1,n[0],1];for(let g=0;g<r;g++)o[0]*=n[g];o[1]=n[r];for(let g=r+1;g<n.length;g++)o[2]*=n[g];const a=new Map,i=new Int32Array(n[r]),u=new Ke(o,s,e),c=[],l=o[0]===1&&o[2]===1;for(let g=0;g<n[r];g++){let b;if(l)b=e[g].toString();else{const v=[];for(let I=0;I<o[0];I++)for(let _=0;_<o[2];_++)v.push(u.get(I,g,_));b=v.join(",")}const y=a.get(b);if(y!=null)i[g]=y;else{const v=a.size;a.set(b,v),i[g]=v,c.push(g)}}const f=o.slice();f[1]=a.size;const d=new Ke(f,s);c.forEach((g,b)=>{for(let y=0;y<o[0];y++)for(let v=0;v<o[2];v++)d.set(u.get(y,g,v),y,b,v)});const m=n.slice();return m[r]=f[1],{outputValues:d.values,outputShape:m,indices:i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Xv("cpu",()=>new $u,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ob=ye(cf,e=>e>=0?e:Math.exp(e)-1),VD={kernelName:cf,backendName:"cpu",kernelFunc:Ob};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fb(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{alpha:o}=s;jt([r],"leakyRelu");const a=Nt(r.shape),i=n.data.get(r.dataId).values,u=mn("float32",a);for(let c=0;c<i.length;c++)u[c]=i[c]<0?o*i[c]:i[c];return n.makeTensorInfo(r.shape,"float32",u)}const BD={kernelName:Gm,backendName:"cpu",kernelFunc:Fb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WD=Ve((e,t)=>e<0?t*e:e);function Rb(e){const{inputs:t,backend:n}=e,{x:s,alpha:r}=t;jt([s,r],"prelu");const o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,[i,u]=WD(s.shape,r.shape,o,a,"float32");return n.makeTensorInfo(u,"float32",i)}const jD={kernelName:dg,backendName:"cpu",kernelFunc:Rb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pb=ye(Pf,e=>Math.max(0,e)),HD={kernelName:Pf,backendName:"cpu",kernelFunc:Pb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mb=ye(Mf,e=>Math.min(Math.max(0,e),6)),qD={kernelName:Mf,backendName:"cpu",kernelFunc:Mb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eu(e,t,n,s,r){if(n==="linear")return gs({inputs:{x:t},backend:e});if(n==="relu")return Pb({inputs:{x:t},backend:e});if(n==="elu")return Ob({inputs:{x:t},backend:e});if(n==="relu6")return Mb({inputs:{x:t},backend:e});if(n==="prelu")return Rb({inputs:{x:t,alpha:s},backend:e});if(n==="leakyrelu")return Fb({inputs:{x:t},backend:e,attrs:{alpha:r}});if(n==="sigmoid")return Cb({inputs:{x:t},backend:e});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ne(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{shape:o}=s,a=Nt(r.shape),i=Kw(o,a),u=Nt(i);O(a===u,()=>`The new shape (${i}) has ${u} elements and the old shape (${r.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`),n.incRef(r.dataId);const c=n.data.get(r.dataId);if(c.complexTensorInfos!=null){const l=c.complexTensorInfos.real,f=c.complexTensorInfos.imag;l.shape=i,f.shape=i}return{dataId:r.dataId,shape:i,dtype:r.dtype}}const KD={kernelName:vg,backendName:"cpu",kernelFunc:Ne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lb(e){const{inputs:t,backend:n,attrs:s}=e,{a:r,b:o}=t,{transposeA:a,transposeB:i}=s;jt([r,o],"matMul");const u=r.shape.length,c=o.shape.length,l=a?r.shape[u-2]:r.shape[u-1],f=i?o.shape[c-1]:o.shape[c-2],d=a?r.shape[u-1]:r.shape[u-2],m=i?o.shape[c-2]:o.shape[c-1],g=r.shape.slice(0,-2),b=o.shape.slice(0,-2),y=Nt(g),v=Nt(b),_=Pe(r.shape.slice(0,-2),o.shape.slice(0,-2)).concat([d,m]);O(l===f,()=>`Error in matMul: inner shapes (${l}) and (${f}) of Tensors with shapes ${r.shape} and ${o.shape} and transposeA=${a} and transposeB=${i} must match.`);const N=a?[y,l,d]:[y,d,l],C=i?[v,m,f]:[v,f,m],F=Ne({inputs:{x:r},backend:n,attrs:{shape:N}}),z=Ne({inputs:{x:o},backend:n,attrs:{shape:C}}),P=a?F.shape[1]:F.shape[2],D=a?F.shape[2]:F.shape[1],L=i?z.shape[1]:z.shape[2],T=Math.max(y,v),K=n.data.get(F.dataId).values,Z=n.data.get(z.dataId).values,rt=Xt(F.shape),et=Xt(z.shape),[nt,it,tt]=a?[rt[0],1,rt[1]]:[rt[0],rt[1],1],[ut,ft,yt]=i?[1,et[1],et[0]]:[et[1],1,et[0]],pt=D*L,bt=ie([T,D,L],F.dtype),_t=bt.values,$t=n.blockSize;for(let Ot=0;Ot<T;Ot++){const Mt=Ot%y,qt=Ot%v;for(let Kt=0;Kt<D;Kt+=$t){const vt=Math.min(Kt+$t,D);for(let Jt=0;Jt<L;Jt+=$t){const R=Math.min(Jt+$t,L);for(let B=0;B<P;B+=$t){const ot=Math.min(B+$t,P);for(let lt=Kt;lt<vt;lt++)for(let ct=Jt;ct<R;ct++){let ht=0;for(let kt=B;kt<ot;kt++){const Tt=K[Mt*nt+lt*it+kt*tt],wt=Z[kt*ut+ct*ft+qt*yt];ht+=Tt*wt}_t[Ot*pt+(lt*L+ct)]+=ht}}}}}return n.disposeIntermediateTensorInfo(F),n.disposeIntermediateTensorInfo(z),n.makeTensorInfo(_,bt.dtype,bt.values)}const UD={kernelName:gm,backendName:"cpu",kernelFunc:Lb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GD(e){const{inputs:t,backend:n,attrs:s}=e,{a:r,b:o,bias:a,preluActivationWeights:i}=t,{transposeA:u,transposeB:c,activation:l,leakyreluAlpha:f}=s;let d,m,g;const b=[];d=Lb({inputs:{a:r,b:o},attrs:{transposeA:u,transposeB:c},backend:n}),a&&(m=Do({inputs:{a:d,b:a},backend:n}),b.push(d),d=m),l&&(g=eu(n,d,l,i,f),b.push(d),d=g);for(const v of b)n.disposeIntermediateTensorInfo(v);return d}const XD={kernelName:Gc,backendName:"cpu",kernelFunc:GD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YD=ye(Gl,e=>Math.acos(e)),ZD={kernelName:Gl,backendName:"cpu",kernelFunc:YD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QD=ye(Xl,e=>Math.acosh(e)),JD={kernelName:Xl,backendName:"cpu",kernelFunc:QD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tO(e){const{inputs:t,backend:n}=e,s=t;jt(t,"addN");const r=s.map(i=>n.data.get(i.dataId).values),o=ie(s[0].shape,s[0].dtype),a=o.values;for(let i=0;i<s.length;i++){const u=r[i];for(let c=0;c<a.length;c++)a[c]+=u[c]}return n.makeTensorInfo(o.shape,o.dtype,o.values)}const eO={kernelName:cm,backendName:"cpu",kernelFunc:tO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nO(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:o,keepDims:a}=s;jt(r,"all");const i=Ye(o,r.shape);let u=i;const c=vs(u,r.shape.length);let l=r;c!=null&&(l=In({inputs:{x:r},backend:n,attrs:{perm:c}}),u=ks(u.length,r.shape.length)),Jr("all",u,l.shape.length);const[f,d]=Ws(l.shape,u),m=Nt(d),g=sn(Nt(f),l.dtype),b=n.data.get(l.dataId).values;for(let v=0;v<g.length;++v){const I=v*m;let _=b[I];for(let N=0;N<m;++N){const C=b[I+N];_=_&&C}g[v]=_}c!=null&&n.disposeIntermediateTensorInfo(l);const y=n.makeTensorInfo(f,l.dtype,g);if(a){const v=ts(f,i),I=Ne({inputs:{x:y},backend:n,attrs:{shape:v}});return n.disposeIntermediateTensorInfo(y),I}return y}const sO={kernelName:lm,backendName:"cpu",kernelFunc:nO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rO(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:o,keepDims:a}=s;jt(r,"any");const i=Ye(o,r.shape);let u=i;const c=vs(u,r.shape.length);let l=r;c!=null&&(l=In({inputs:{x:r},backend:n,attrs:{perm:c}}),u=ks(u.length,r.shape.length)),Jr("any",u,l.shape.length);const[f,d]=Ws(l.shape,u),m=Nt(d),g=sn(Nt(f),l.dtype),b=n.data.get(l.dataId).values;for(let v=0;v<g.length;++v){const I=v*m;let _=b[I];for(let N=0;N<m;++N){const C=b[I+N];_=_||C}g[v]=_}c!=null&&n.disposeIntermediateTensorInfo(l);const y=n.makeTensorInfo(f,l.dtype,g);if(a){const v=ts(f,i),I=Ne({inputs:{x:y},backend:n,attrs:{shape:v}});return n.disposeIntermediateTensorInfo(y),I}return y}const oO={kernelName:fm,backendName:"cpu",kernelFunc:rO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aO(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:o}=s;jt(r,"argMax");let a=Ye(o,r.shape);const i=vs(a,r.shape.length);let u=r;const c=[];i!=null&&(u=In({inputs:{x:r},backend:n,attrs:{perm:i}}),c.push(u),a=ks(a.length,u.shape.length)),a=[a[0]],Jr("argMax",a,u.shape.length);const[l,f]=Ws(u.shape,a),d=Nt(l),m=sn(d,"int32"),g=Nt(f),b=n.data.get(u.dataId).values;for(let y=0;y<m.length;++y){const v=y*g;let I=b[v],_=0;for(let N=0;N<g;++N){const C=b[v+N];C>I&&(I=C,_=N)}m[y]=_}return c.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.makeTensorInfo(l,"int32",m)}const iO={kernelName:hm,backendName:"cpu",kernelFunc:aO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uO(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:o}=s;jt(r,"argMin");let a=Ye(o,r.shape);const i=vs(a,r.shape.length);let u=r;const c=[];i!=null&&(u=In({inputs:{x:r},backend:n,attrs:{perm:i}}),c.push(u),a=ks(a.length,u.shape.length)),a=[a[0]],Jr("argMin",a,u.shape.length);const[l,f]=Ws(u.shape,a),d=Nt(l),m=sn(d,"int32"),g=Nt(f),b=n.data.get(u.dataId).values;for(let y=0;y<m.length;++y){const v=y*g;let I=b[v],_=0;for(let N=0;N<g;++N){const C=b[v+N];C<I&&(I=C,_=N)}m[y]=_}return c.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.makeTensorInfo(l,"int32",m)}const cO={kernelName:dm,backendName:"cpu",kernelFunc:uO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lO=ye(Yl,e=>Math.asin(e)),fO={kernelName:Yl,backendName:"cpu",kernelFunc:lO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hO=ye(Zl,e=>Math.asinh(e)),dO={kernelName:Zl,backendName:"cpu",kernelFunc:hO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pO=ye(Ql,e=>Math.atan(e)),mO={kernelName:Ql,backendName:"cpu",kernelFunc:pO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gO=Ve((e,t)=>Math.atan2(e,t)),yO=Ue(tf,gO),bO={kernelName:tf,backendName:"cpu",kernelFunc:yO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wO=ye(Jl,e=>Math.atanh(e)),vO={kernelName:Jl,backendName:"cpu",kernelFunc:wO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ih(e,t,n,s,r,o){const a=r.strideHeight,i=r.strideWidth,u=r.dilationHeight,c=r.dilationWidth,l=r.effectiveFilterHeight,f=r.effectiveFilterWidth,d=r.padInfo.top,m=r.padInfo.left,g=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=ie(r.outShape,n),y=b.values,v=r.outShape[1]*r.outShape[2]*r.outShape[3],I=r.outShape[2]*r.outShape[3],_=r.outShape[3];for(let N=0;N<r.batchSize;++N){const C=N*v,F=N*s[0];for(let z=0;z<r.inChannels;++z)for(let P=0;P<r.outHeight;++P){const D=P*a-d,L=Math.max(0,D),T=Math.min(r.inHeight,l+D),K=C+P*I;for(let Z=0;Z<r.outWidth;++Z){const rt=Z*i-m,et=Math.max(0,rt),nt=Math.min(r.inWidth,f+rt);let it=g,tt=0,ut=0;for(let yt=L;yt<T;yt+=u){const pt=F+yt*s[1];for(let bt=et;bt<nt;bt+=c){const _t=pt+bt*s[2],$t=e[_t+z];o==="max"&&$t>it?it=$t:o==="avg"&&(tt+=$t,ut++)}if(isNaN(it))break}const ft=K+Z*_+z;y[ft]=o==="avg"?tt/ut:it}}}return b}function zb(e,t,n,s,r=!1,o=!1){const a=ie(s.outShape,"int32"),i=s.strideHeight,u=s.strideWidth,c=s.dilationHeight,l=s.dilationWidth,f=s.effectiveFilterHeight,d=s.effectiveFilterWidth,m=s.padInfo.top,g=s.padInfo.left,b=ie(t,n,e);for(let y=0;y<s.batchSize;++y)for(let v=0;v<s.inChannels;++v)for(let I=0;I<s.outHeight;++I){const _=I*i-m;let N=_;for(;N<0;)N+=c;const C=Math.min(s.inHeight,f+_);for(let F=0;F<s.outWidth;++F){const z=F*u-g;let P=z;for(;P<0;)P+=l;const D=Math.min(s.inWidth,d+z);let L=Number.NEGATIVE_INFINITY,T=-1;for(let K=N;K<C;K+=c){const Z=K-_;for(let rt=P;rt<D;rt+=l){const et=rt-z,nt=b.get(y,K,rt,v);nt>L&&(L=nt,r?T=o?((y*s.inHeight+K)*s.inWidth+rt)*s.inChannels+v:(K*s.inWidth+rt)*s.inChannels+v:T=Z*d+et)}}a.set(T,y,I,F,v)}}return a}function Vb(e,t,n,s,r,o){const a=r.strideDepth,i=r.strideHeight,u=r.strideWidth,c=r.dilationDepth,l=r.dilationHeight,f=r.dilationWidth,d=r.effectiveFilterDepth,m=r.effectiveFilterHeight,g=r.effectiveFilterWidth,b=r.padInfo.front,y=r.padInfo.top,v=r.padInfo.left,I=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,_=ie(r.outShape,n),N=_.values,C=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],F=r.outShape[2]*r.outShape[3]*r.outShape[4],z=r.outShape[3]*r.outShape[4],P=r.outShape[4];for(let D=0;D<r.batchSize;++D){const L=D*C,T=D*s[0];for(let K=0;K<r.inChannels;++K)for(let Z=0;Z<r.outDepth;++Z){const rt=Z*a-b;let et=rt;for(;et<0;)et+=c;const nt=Math.min(r.inDepth,d+rt),it=L+Z*F;for(let tt=0;tt<r.outHeight;++tt){const ut=tt*i-y;let ft=ut;for(;ft<0;)ft+=l;const yt=Math.min(r.inHeight,m+ut),pt=it+tt*z;for(let bt=0;bt<r.outWidth;++bt){const _t=bt*u-v;let $t=_t;for(;$t<0;)$t+=f;const Ot=Math.min(r.inWidth,g+_t),Mt=pt+bt*P;let qt=I,Kt=0,vt=0;for(let R=et;R<nt;R+=c){const B=T+R*s[1];for(let ot=ft;ot<yt;ot+=l){const lt=B+ot*s[2];for(let ct=$t;ct<Ot;ct+=f){const ht=lt+ct*s[3],kt=e[ht+K];if(o==="max"&&kt>qt?qt=kt:o==="avg"&&(Kt+=kt,vt++),isNaN(qt))break}if(isNaN(qt))break}if(isNaN(qt))break}const Jt=Mt+K;N[Jt]=o==="avg"?Kt/Math.max(vt,1):qt}}}}return _}function kO(e,t){const n=ie(t.outShape,"int32"),s=t.strideDepth,r=t.strideHeight,o=t.strideWidth,a=t.dilationDepth,i=t.dilationHeight,u=t.dilationWidth,c=t.effectiveFilterDepth,l=t.effectiveFilterHeight,f=t.effectiveFilterWidth,d=t.padInfo.front,m=t.padInfo.top,g=t.padInfo.left;for(let b=0;b<t.batchSize;++b)for(let y=0;y<t.inChannels;++y)for(let v=0;v<t.outDepth;++v){const I=v*s-d;let _=I;for(;_<0;)_+=a;const N=Math.min(t.inDepth,c+I);for(let C=0;C<t.outHeight;++C){const F=C*r-m;let z=F;for(;z<0;)z+=i;const P=Math.min(t.inHeight,l+F);for(let D=0;D<t.outWidth;++D){const L=D*o-g;let T=L;for(;T<0;)T+=u;const K=Math.min(t.inWidth,f+L);let Z=Number.NEGATIVE_INFINITY,rt=-1;for(let et=_;et<N;et+=a){const nt=et-I;for(let it=z;it<P;it+=i){const tt=it-F;for(let ut=T;ut<K;ut+=u){const ft=ut-L,yt=e.get(b,et,it,ut,y);yt>=Z&&(Z=yt,rt=nt*l*f+tt*l+ft)}}}n.set(rt,b,v,C,D,y)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xO(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t;jt(r,"avgPool");const{filterSize:o,strides:a,pad:i,dimRoundingMode:u}=s,c=1;O(Qn(a,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${c}'`);const l=Wo(r.shape,o,a,c,i,u);let f;if(l.filterWidth===1&&l.filterHeight===1&&qn(l.inShape,l.outShape))f=gs({inputs:{x:r},backend:n});else{const d=n.data.get(r.dataId).values,m=Xt(r.shape),g=Ih(d,r.shape,r.dtype,m,l,"avg");f=n.makeTensorInfo(l.outShape,r.dtype,g.values)}return f}const SO={kernelName:pm,backendName:"cpu",kernelFunc:xO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IO(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{filterSize:o,strides:a,pad:i,dimRoundingMode:u,dataFormat:c}=s;jt(r,"avgPool3d");const l=wu(r.shape,o,a,1,i,u,c),f=n.data.get(r.dataId).values,d=Vb(f,r.shape,r.dtype,Xt(r.shape),l,"avg");return n.makeTensorInfo(d.shape,"float32",d.values)}const NO={kernelName:mm,backendName:"cpu",kernelFunc:IO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _O(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,input:o}=t,{filterSize:a,strides:i,pad:u,dimRoundingMode:c}=s;jt([r,o],"avgPool3DGrad");const l=wu(o.shape,a,i,1,u,c),f=l.strideDepth,d=l.strideHeight,m=l.strideWidth,g=l.filterDepth,b=l.filterHeight,y=l.filterWidth,v=l.dilationDepth,I=l.dilationHeight,_=l.dilationWidth,N=l.effectiveFilterDepth,C=l.effectiveFilterHeight,F=l.effectiveFilterWidth,z=N-1-l.padInfo.front,P=F-1-l.padInfo.left,D=C-1-l.padInfo.top,L=ie(o.shape,"float32"),T=1/(g*b*y),K=n.bufferSync(r);for(let Z=0;Z<l.batchSize;++Z)for(let rt=0;rt<l.inChannels;++rt)for(let et=0;et<l.inDepth;++et)for(let nt=0;nt<l.inHeight;++nt)for(let it=0;it<l.inWidth;++it){const tt=et-z,ut=nt-D,ft=it-P;let yt=0;for(let pt=0;pt<N;pt+=v){const bt=(tt+pt)/f;if(!(bt<0||bt>=l.outDepth||Math.floor(bt)!==bt))for(let _t=0;_t<C;_t+=I){const $t=(ut+_t)/d;if(!($t<0||$t>=l.outHeight||Math.floor($t)!==$t))for(let Ot=0;Ot<F;Ot+=_){const Mt=(ft+Ot)/m;if(Mt<0||Mt>=l.outWidth||Math.floor(Mt)!==Mt)continue;const qt=K.get(Z,bt,$t,Mt,rt);yt+=qt}}}L.set(yt*T,Z,et,nt,it,rt)}return n.makeTensorInfo(L.shape,L.dtype,L.values)}const TO={kernelName:uv,backendName:"cpu",kernelFunc:_O};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EO(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,input:o}=t,a=o;jt([r,o],"avgPoolGrad");const{filterSize:i,strides:u,pad:c}=s,l=Wo(a.shape,i,u,1,c),f=l.strideHeight,d=l.strideWidth,m=l.filterHeight,g=l.filterWidth,b=l.dilationHeight,y=l.dilationWidth,v=l.effectiveFilterHeight,I=l.effectiveFilterWidth,_=I-1-l.padInfo.left,N=v-1-l.padInfo.top,C=ie(a.shape,"float32"),F=1/(m*g),z=n.data.get(r.dataId).values,P=ie(r.shape,"float32",z);for(let D=0;D<l.batchSize;++D)for(let L=0;L<l.inChannels;++L)for(let T=0;T<l.inHeight;++T)for(let K=0;K<l.inWidth;++K){const Z=T-N,rt=K-_;let et=0;for(let nt=0;nt<v;nt+=b){const it=(Z+nt)/f;if(!(it<0||it>=l.outHeight||Math.floor(it)!==it))for(let tt=0;tt<I;tt+=y){const ut=(rt+tt)/d;if(ut<0||ut>=l.outWidth||Math.floor(ut)!==ut)continue;const ft=P.get(D,it,ut,L);et+=ft}}C.set(et*F,D,T,K,L)}return n.makeTensorInfo(C.shape,C.dtype,C.values)}const $O={kernelName:iv,backendName:"cpu",kernelFunc:EO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CO(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,scale:o,offset:a,mean:i,variance:u}=t;O(i.shape.length===u.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),O(a==null||i.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),O(o==null||i.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),jt([r,i,u,o,a],"batchNorm");let{varianceEpsilon:c}=s;c==null&&(c=.001);const l=n.data.get(r.dataId).values,f=n.data.get(i.dataId).values,d=n.data.get(u.dataId).values,m=o?n.data.get(o.dataId).values:new Float32Array([1]),g=a?n.data.get(a.dataId).values:new Float32Array([0]),b=new Float32Array(l.length),y=g.length,v=m.length,I=d.length,_=f.length;let N=0,C=0,F=0,z=0;for(let P=0;P<l.length;++P)b[P]=g[N++]+(l[P]-f[C++])*m[F++]/Math.sqrt(d[z++]+c),N>=y&&(N=0),C>=_&&(C=0),F>=v&&(F=0),z>=I&&(z=0);return n.makeTensorInfo(r.shape,r.dtype,b)}const AO={kernelName:jm,backendName:"cpu",kernelFunc:CO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DO(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{blockShape:o,crops:a}=s;jt([r],"batchToSpaceND");const i=o.reduce((v,I)=>v*I),u=bb(r.shape,o,i),c=wb(u.length,o.length),l=vb(r.shape,o,i),f=E2(a,o.length),d=$2(l,a,o.length),m=Ne({inputs:{x:r},backend:n,attrs:{shape:u}}),g=In({inputs:{x:m},backend:n,attrs:{perm:c}}),b=Ne({inputs:{x:g},backend:n,attrs:{shape:l}}),y=Yr({inputs:{x:b},backend:n,attrs:{begin:f,size:d}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(b),y}const OO={kernelName:ym,backendName:"cpu",kernelFunc:DO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FO(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,weights:o}=t,{size:a}=s,i=n.data.get(r.dataId).values,u=n.data.get(o.dataId).values,c=Nb(i,u,o.dtype,o.shape,a);return n.makeTensorInfo([a],o.dtype,c)}const RO={kernelName:bm,backendName:"cpu",kernelFunc:FO};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PO(e){const{inputs:t,backend:n}=e,{s0:s,s1:r}=t,o=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,i=Pe(Array.from(o),Array.from(a));return n.makeTensorInfo([i.length],"int32",Int32Array.from(i))}const MO={kernelName:wm,backendName:"cpu",kernelFunc:PO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LO=ye(rf,(e,t)=>{const n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e}),zO={kernelName:rf,backendName:"cpu",kernelFunc:LO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VO=e=>{const{x:t}=e.inputs,n=e.backend,s=new Float32Array(Nt(t.shape)),r=n.data.get(t.dataId),o=r.complexTensorInfos.real,a=r.complexTensorInfos.imag,i=n.data.get(o.dataId).values,u=n.data.get(a.dataId).values;for(let c=0;c<i.length;c++){const l=i[c],f=u[c];s[c]=Math.hypot(l,f)}return n.makeOutput(s,t.shape,"float32")},BO={kernelName:km,backendName:"cpu",kernelFunc:VO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oo(e){const{inputs:t,backend:n}=e,{input:s}=t,r=n.data.get(s.dataId).complexTensorInfos.imag,o=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,o)}const WO={kernelName:Um,backendName:"cpu",kernelFunc:Oo};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fo(e){const{inputs:t,backend:n,attrs:s}=e,{axis:r}=s,o=Ye(r,t[0].shape)[0],a=t.map(b=>b.shape);x2(a,o);let i=Oc(t.map(b=>b.shape),o);if(Nt(i)===0)return n.makeTensorInfo(i,t[0].dtype,[]);const u=t.filter(b=>Nt(b.shape)>0);if(u.length===1)return gs({inputs:{x:u[0]},backend:n});if(u[0].dtype==="complex64"){const b=u.map(N=>Xr({inputs:{input:N},backend:n})),y=u.map(N=>Oo({inputs:{input:N},backend:n})),v=Fo({inputs:b,backend:n,attrs:{axis:o}}),I=Fo({inputs:y,backend:n,attrs:{axis:o}}),_=$n({inputs:{real:v,imag:I},backend:n});return b.forEach(N=>n.disposeIntermediateTensorInfo(N)),y.forEach(N=>n.disposeIntermediateTensorInfo(N)),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(I),_}const c=u.map(b=>{const v=[-1,Nt(b.shape.slice(o))];return Ne({inputs:{x:b},backend:n,attrs:{shape:v}})}),l=c.map(b=>({vals:n.data.get(b.dataId).values,shape:b.shape}));i=Oc(c.map(b=>b.shape),1);const f=c[0].shape[0]===1,d=oA(l,i,t[0].dtype,f),m=Oc(u.map(b=>b.shape),o),g=n.makeTensorInfo(m,t[0].dtype,d);return c.forEach(b=>n.disposeIntermediateTensorInfo(b)),g}const jO={kernelName:xm,backendName:"cpu",kernelFunc:Fo};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bb(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:o}=t,{strides:a,pad:i,dataFormat:u,dilations:c,dimRoundingMode:l}=s;jt([r,o],"conv2d");const f=ku(u),d=ws(r.shape,o.shape,a,c,i,l,!1,f),m=d.filterHeight,g=d.filterWidth,b=d.dilationHeight,y=d.dilationWidth,v=d.padInfo.left,I=d.padInfo.top,_=d.dataFormat==="channelsLast",N=new Ke(d.outShape,r.dtype),C=Xt(r.shape),F=Xt(o.shape),z=C[0],P=_?C[1]:C[2],D=_?C[2]:1,L=_?1:C[1],T=N.strides[0],K=_?N.strides[1]:N.strides[2],Z=_?N.strides[2]:1,rt=_?1:N.strides[1],et=n.data.get(r.dataId).values,nt=n.data.get(o.dataId).values,it=N.values;for(let tt=0;tt<d.batchSize;++tt){const ut=tt*z,ft=tt*T;for(let yt=0;yt<d.outHeight;++yt){const pt=ft+yt*K,bt=yt*d.strideHeight-I;for(let _t=0;_t<m;++_t){const $t=bt+_t*b;if($t<0||$t>=d.inHeight)continue;const Ot=_t*F[0],Mt=ut+$t*P;for(let qt=0;qt<d.outWidth;++qt){const Kt=pt+qt*Z,vt=qt*d.strideWidth-v;for(let Jt=0;Jt<g;++Jt){const R=vt+Jt*y;if(R<0||R>=d.inWidth)continue;const B=Ot+Jt*F[1],ot=Mt+R*D;let lt=B;for(let ct=0;ct<d.inChannels;++ct){const ht=et[ot+ct*L];for(let kt=0;kt<d.outChannels;++kt)it[Kt+kt*rt]+=ht*nt[lt+kt];lt+=d.outChannels}}}}}}return n.makeTensorInfo(N.shape,N.dtype,it)}const HO={kernelName:Sm,backendName:"cpu",kernelFunc:Bb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qO(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,dy:o}=t,{strides:a,pad:i,dataFormat:u,dimRoundingMode:c,filterShape:l}=s;jt([r,o],"conv2dBackpropFilter");const f=ku(u),d=ws(r.shape,l,a,1,i,c,!1,f),{strideHeight:m,strideWidth:g,filterHeight:b,filterWidth:y}=d,v=d.dataFormat==="channelsLast",I=new Ke(d.filterShape,"float32"),_=d.padInfo.left,N=d.padInfo.top,C=n.data.get(r.dataId).values,F=n.data.get(o.dataId).values,z=new Ke(r.shape,r.dtype,C),P=new Ke(o.shape,o.dtype,F);for(let D=0;D<b;++D){const L=Math.max(0,Math.ceil((N-D)/m)),T=Math.min(d.outHeight,(d.inHeight+N-D)/m);for(let K=0;K<y;++K){const Z=Math.max(0,Math.ceil((_-K)/g)),rt=Math.min(d.outWidth,(d.inWidth+_-K)/g);for(let et=0;et<d.inChannels;++et)for(let nt=0;nt<d.outChannels;++nt){let it=0;for(let tt=0;tt<d.batchSize;++tt)for(let ut=L;ut<T;++ut){const ft=D+ut*m-N;for(let yt=Z;yt<rt;++yt){const pt=K+yt*g-_;v?it+=z.get(tt,ft,pt,et)*P.get(tt,ut,yt,nt):it+=z.get(tt,et,ft,pt)*P.get(tt,nt,ut,yt)}}I.set(it,D,K,et,nt)}}}return n.makeTensorInfo(I.shape,I.dtype,I.values)}const KO={kernelName:Im,backendName:"cpu",kernelFunc:qO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UO(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,filter:o}=t,{inputShape:a,strides:i,pad:u,dataFormat:c,dimRoundingMode:l}=s;jt([r,o],"conv2dBackpropInput");const f=Xt(o.shape),d=Xt(r.shape);let m=ku(c);const g=ws(a,o.shape,i,1,u,l,!1,m),b=new Ke(g.inShape,"float32"),y=b.values,v=n.data.get(r.dataId).values,I=n.data.get(o.dataId).values,[_,N,C]=f,{batchSize:F,filterHeight:z,filterWidth:P,inChannels:D,inHeight:L,inWidth:T,outChannels:K,outHeight:Z,outWidth:rt,strideHeight:et,strideWidth:nt}=g;m=g.dataFormat;const it=z-1-g.padInfo.top,tt=P-1-g.padInfo.left,ut=m==="channelsLast",ft=b.strides[0],yt=ut?b.strides[1]:b.strides[2],pt=ut?b.strides[2]:1,bt=ut?1:b.strides[1],_t=d[0],$t=ut?d[1]:d[2],Ot=ut?d[2]:1,Mt=ut?1:d[1];for(let qt=0;qt<F;++qt)for(let Kt=0;Kt<D;++Kt)for(let vt=0;vt<L;++vt){const Jt=vt-it,R=Math.max(0,Math.ceil(Jt/et)),B=Math.min(Z,(z+Jt)/et);for(let ot=0;ot<T;++ot){const lt=ot-tt,ct=Math.max(0,Math.ceil(lt/nt)),ht=Math.min(rt,(P+lt)/nt);let kt=0;for(let wt=R;wt<B;++wt){const mt=wt*et-Jt;for(let Bt=ct;Bt<ht;++Bt){const Ct=Bt*nt-lt,zt=_t*qt+$t*wt+Ot*Bt,Ht=_*(z-1-mt)+N*(P-1-Ct)+C*Kt;for(let Ut=0;Ut<K;++Ut){const te=v[zt+Mt*Ut],ne=I[Ht+Ut];kt+=te*ne}}}const Tt=ft*qt+yt*vt+pt*ot+bt*Kt;y[Tt]=kt}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const GO={kernelName:Nm,backendName:"cpu",kernelFunc:UO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XO(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:o}=t,{strides:a,pad:i,dilations:u}=s;jt([r,o],"conv3d");const c=vu(r.shape,o.shape,a,u,i),{filterDepth:l,filterHeight:f,filterWidth:d,dilationDepth:m,dilationHeight:g,dilationWidth:b,padInfo:y}=c,v=y.front,I=y.left,_=y.top,N=new Ke(c.outShape,r.dtype),C=n.data.get(r.dataId).values,F=n.data.get(o.dataId).values,z=N.values,P=Xt(r.shape),D=Xt(o.shape);for(let L=0;L<c.batchSize;++L){const T=L*P[0],K=L*N.strides[0];for(let Z=0;Z<c.outDepth;++Z){const rt=K+Z*N.strides[1],et=Z*c.strideDepth-v;for(let nt=0;nt<l;++nt){const it=et+nt*m;if(it<0||it>=c.inDepth)continue;const tt=nt*D[0],ut=T+it*P[1];for(let ft=0;ft<c.outHeight;++ft){const yt=rt+ft*N.strides[2],pt=ft*c.strideHeight-_;for(let bt=0;bt<f;++bt){const _t=pt+bt*g;if(_t<0||_t>=c.inHeight)continue;const $t=tt+bt*D[1],Ot=ut+_t*P[2];for(let Mt=0;Mt<c.outWidth;++Mt){const qt=yt+Mt*c.outChannels,Kt=Mt*c.strideWidth-I;for(let vt=0;vt<d;++vt){const Jt=Kt+vt*b;if(Jt<0||Jt>=c.inWidth)continue;const R=$t+vt*D[2],B=Ot+Jt*c.inChannels;let ot=R;for(let lt=0;lt<c.inChannels;++lt){const ct=C[B+lt];for(let ht=0;ht<c.outChannels;++ht)z[qt+ht]+=ct*F[ot+ht];ot+=c.outChannels}}}}}}}}return n.makeTensorInfo(N.shape,N.dtype,N.values)}const YO={kernelName:_m,backendName:"cpu",kernelFunc:XO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZO(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,dy:o}=t,{strides:a,pad:i,filterShape:u}=s;jt([r,o],"conv3dBackpropFilterV2");const c=Xt(r.shape),l=Xt(o.shape),f=vu(r.shape,u,a,1,i),d=f.strideDepth,m=f.strideHeight,g=f.strideWidth,b=f.filterDepth,y=f.filterHeight,v=f.filterWidth,I=new Ke(f.filterShape,"float32"),_=I.values,[N,C,F,z]=I.strides,P=n.data.get(o.dataId).values,[D,L,T,K]=l,Z=n.data.get(r.dataId).values,[rt,et,nt,it]=c,tt=f.padInfo.front,ut=f.padInfo.left,ft=f.padInfo.top;for(let yt=0;yt<b;++yt){const pt=Math.max(0,Math.ceil((tt-yt)/d)),bt=Math.min(f.outDepth,(f.inDepth+tt-yt)/d),_t=yt*N;for(let $t=0;$t<y;++$t){const Ot=Math.max(0,Math.ceil((ft-$t)/m)),Mt=Math.min(f.outHeight,(f.inHeight+ft-$t)/m),qt=$t*C+_t;for(let Kt=0;Kt<v;++Kt){const vt=Math.max(0,Math.ceil((ut-Kt)/g)),Jt=Math.min(f.outWidth,(f.inWidth+ut-Kt)/g),R=Kt*F+qt;for(let B=0;B<f.inChannels;++B){const ot=B*z+R;for(let lt=0;lt<f.outChannels;++lt){let ct=0;for(let ht=0;ht<f.batchSize;++ht){const kt=ht*rt,Tt=ht*D;for(let wt=pt;wt<bt;++wt){const Bt=(yt+wt*d-tt)*et+kt,Ct=wt*L+Tt;for(let zt=Ot;zt<Mt;++zt){const Ut=($t+zt*m-ft)*nt+Bt,te=zt*T+Ct;for(let ne=vt;ne<Jt;++ne){const Me=(Kt+ne*g-ut)*it+Ut,Ge=ne*K+te;ct+=Z[Me+B]*P[Ge+lt]}}}}_[ot+lt]=ct}}}}}return n.makeTensorInfo(I.shape,I.dtype,I.values)}const QO={kernelName:cv,backendName:"cpu",kernelFunc:ZO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JO(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,filter:o}=t,{pad:a,strides:i,inputShape:u}=s;jt([r],"conv3dBackpropInputV2");const c=Xt(r.shape),l=Xt(o.shape),f=vu(u,o.shape,i,1,a),d=new Ke(f.inShape,"float32"),m=d.values,[g,b,y,v]=d.strides,I=n.data.get(r.dataId).values,[_,N,C,F]=c,z=n.data.get(o.dataId).values,[P,D,L,T]=l,{batchSize:K,filterDepth:Z,filterHeight:rt,filterWidth:et,inChannels:nt,inDepth:it,inHeight:tt,inWidth:ut,outChannels:ft,outDepth:yt,outHeight:pt,outWidth:bt,strideDepth:_t,strideHeight:$t,strideWidth:Ot}=f,Mt=Z-1-f.padInfo.front,qt=rt-1-f.padInfo.top,Kt=et-1-f.padInfo.left;for(let vt=0;vt<K;++vt)for(let Jt=0;Jt<nt;++Jt)for(let R=0;R<it;++R){const B=R-Mt,ot=Math.max(0,Math.ceil(B/_t)),lt=Math.min(yt,(Z+B)/_t);for(let ct=0;ct<tt;++ct){const ht=ct-qt,kt=Math.max(0,Math.ceil(ht/$t)),Tt=Math.min(pt,(rt+ht)/$t);for(let wt=0;wt<ut;++wt){const mt=wt-Kt,Bt=Math.max(0,Math.ceil(mt/Ot)),Ct=Math.min(bt,(et+mt)/Ot);let zt=0;for(let Ht=ot;Ht<lt;++Ht){const Ut=Ht*_t-B;for(let te=kt;te<Tt;++te){const ne=te*$t-ht;for(let _e=Bt;_e<Ct;++_e){const Me=_e*Ot-mt,Ge=_*vt+N*Ht+C*te+F*_e,qe=P*(Z-1-Ut)+D*(rt-1-ne)+L*(et-1-Me)+T*Jt;for(let gn=0;gn<ft;++gn){const Ks=I[Ge+gn],Ce=z[qe+gn];zt+=Ks*Ce}}}}m[g*vt+b*R+y*ct+v*wt+Jt]=zt}}}return n.makeTensorInfo(d.shape,d.dtype,d.values)}const t3={kernelName:Tm,backendName:"cpu",kernelFunc:JO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e3=ye(of,e=>Math.cos(e)),n3={kernelName:of,backendName:"cpu",kernelFunc:e3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s3=ye(af,e=>Math.cosh(e)),r3={kernelName:af,backendName:"cpu",kernelFunc:s3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o3(e){const{inputs:t,backend:n,attrs:s}=e,{image:r,boxes:o,boxInd:a}=t,{cropSize:i,method:u,extrapolationValue:c}=s,[l,f,d,m]=r.shape,g=o.shape[0],[b,y]=i,v=ie([g,b,y,m],"float32"),I=n.data.get(o.dataId).values,_=n.data.get(a.dataId).values,N=n.data.get(r.dataId).values,C=Xt(r.shape),F=Xt(v.shape);for(let z=0;z<g;z++){const P=z*4,D=I[P],L=I[P+1],T=I[P+2],K=I[P+3],Z=_[z];if(Z>=l)continue;const rt=b>1?(T-D)*(f-1)/(b-1):0,et=y>1?(K-L)*(d-1)/(y-1):0;for(let nt=0;nt<b;nt++){const it=b>1?D*(f-1)+nt*rt:.5*(D+T)*(f-1);if(it<0||it>f-1){for(let tt=0;tt<y;tt++)for(let ut=0;ut<m;ut++){const ft=ut+tt*F[2]+nt*F[1]+z*F[0];v.values[ft]=c}continue}if(u==="bilinear"){const tt=Math.floor(it),ut=Math.ceil(it),ft=it-tt;for(let yt=0;yt<y;yt++){const pt=y>1?L*(d-1)+yt*et:.5*(L+K)*(d-1);if(pt<0||pt>d-1){for(let Ot=0;Ot<m;Ot++){const Mt=Ot+yt*F[2]+nt*F[1]+z*F[0];v.values[Mt]=c}continue}const bt=Math.floor(pt),_t=Math.ceil(pt),$t=pt-bt;for(let Ot=0;Ot<m;Ot++){let Mt=Ot+bt*C[2]+tt*C[1]+Z*C[0];const qt=N[Mt];Mt=Ot+_t*C[2]+tt*C[1]+Z*C[0];const Kt=N[Mt];Mt=Ot+bt*C[2]+ut*C[1]+Z*C[0];const vt=N[Mt];Mt=Ot+_t*C[2]+ut*C[1]+Z*C[0];const Jt=N[Mt],R=qt+(Kt-qt)*$t,B=vt+(Jt-vt)*$t;Mt=Ot+yt*F[2]+nt*F[1]+z*F[0],v.values[Mt]=R+(B-R)*ft}}}else for(let tt=0;tt<y;++tt){const ut=y>1?L*(d-1)+tt*et:.5*(L+K)*(d-1);if(ut<0||ut>d-1){for(let pt=0;pt<m;pt++){const bt=pt+tt*F[2]+nt*F[1]+z*F[0];v.values[bt]=c}continue}const ft=Math.round(ut),yt=Math.round(it);for(let pt=0;pt<m;pt++){const bt=pt+ft*C[2]+yt*C[1]+Z*C[0],_t=pt+tt*F[2]+nt*F[1]+z*F[0];v.values[_t]=N[bt]}}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const a3={kernelName:Cm,backendName:"cpu",kernelFunc:o3};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i3(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:o,exclusive:a,reverse:i}=s;jt(r,"cumprod");const u=vs([o],r.shape.length);let c=r;u!=null&&(c=In({inputs:{x:r},backend:n,attrs:{perm:u}}));const l=ks(1,r.shape.length)[0];if(l!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${l}`);const f=Bo(c.dtype,"int32"),d=Kl(Nt(c.shape),f),m=n.data.get(c.dataId).values,g=c.shape[c.shape.length-1],b=i?(v,I)=>v+g-I-1:(v,I)=>v+I;for(let v=0;v<m.length;v+=g)for(let I=0;I<g;I++){const _=b(v,I);if(I===0)d[_]=a?1:m[_];else{const N=b(v,I-1);d[_]=a?m[N]*d[N]:m[_]*d[N]}}const y=n.makeTensorInfo(c.shape,f,d);if(u!=null){const v=Dy(u),I=In({inputs:{x:y},backend:n,attrs:{perm:v}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(c),I}return y}const u3={kernelName:Em,backendName:"cpu",kernelFunc:i3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c3(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:o,exclusive:a,reverse:i}=s;jt(r,"cumsum");const u=vs([o],r.shape.length);let c=r;u!=null&&(c=In({inputs:{x:r},backend:n,attrs:{perm:u}}));const l=ks(1,r.shape.length)[0];if(l!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${l}`);const f=Bo(c.dtype,"int32"),d=sn(Nt(c.shape),f),m=n.data.get(c.dataId).values,g=c.shape[c.shape.length-1],b=i?(v,I)=>v+g-I-1:(v,I)=>v+I;for(let v=0;v<m.length;v+=g)for(let I=0;I<g;I++){const _=b(v,I);if(I===0)d[_]=a?0:m[_];else{const N=b(v,I-1);d[_]=a?m[N]+d[N]:m[_]+d[N]}}const y=n.makeTensorInfo(c.shape,f,d);if(u!=null){const v=Dy(u),I=In({inputs:{x:y},backend:n,attrs:{perm:v}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(c),I}return y}const l3={kernelName:$m,backendName:"cpu",kernelFunc:c3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f3(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,weights:o}=t,{size:a,binaryOutput:i}=s;if(r.shape.length===1){const u=n.data.get(r.dataId).values,c=n.data.get(o.dataId).values,l=Nb(u,c,o.dtype,o.shape,a);return n.makeTensorInfo([a],o.dtype,l)}else if(r.shape.length===2){const u=n.bufferSync(r),c=n.bufferSync(o),l=QC(u,c,a,i);return n.makeTensorInfo(l.shape,o.dtype,l.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const h3={kernelName:Am,backendName:"cpu",kernelFunc:f3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d3(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{blockSize:o,dataFormat:a}=s;O(a==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${a}`);const i=r.shape[0],u=r.shape[1],c=r.shape[2],l=r.shape[3],f=u*o,d=c*o,m=l/(o*o),g=n.data.get(r.dataId).values,b=new Float32Array(i*f*d*m);let y=0;for(let v=0;v<i;++v)for(let I=0;I<f;++I){const _=Math.floor(I/o),N=I%o;for(let C=0;C<d;++C){const F=Math.floor(C/o),z=C%o,P=(N*o+z)*m;for(let D=0;D<m;++D){const T=D+P+l*(F+c*(_+u*v));b[y++]=g[T]}}}return n.makeTensorInfo([i,f,d,m],r.dtype,b)}const p3={kernelName:Dm,backendName:"cpu",kernelFunc:d3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wb(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:o}=t,{strides:a,pad:i,dilations:u,dimRoundingMode:c}=s;jt([r,o],"depthwiseConv2DNative");const l=Xt(r.shape),f=Xt(o.shape);let d=u;d==null&&(d=[1,1]),O(Qn(a,d),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${a} and dilations '${d}'`);const m=ws(r.shape,o.shape,a,d,i,c,!0),{filterHeight:g,filterWidth:b,dilationHeight:y,dilationWidth:v,padInfo:I}=m,_=I.left,N=I.top,C=m.outChannels/m.inChannels,F=new Ke(m.outShape,r.dtype),z=n.data.get(r.dataId).values,P=n.data.get(o.dataId).values,D=F.values;for(let L=0;L<m.batchSize;++L){const T=L*l[0],K=L*F.strides[0];for(let Z=0;Z<m.outHeight;++Z){const rt=K+Z*F.strides[1],et=Z*m.strideHeight-N;for(let nt=0;nt<g;++nt){const it=et+nt*y;if(it<0||it>=m.inHeight)continue;const tt=nt*f[0],ut=T+it*l[1];for(let ft=0;ft<m.outWidth;++ft){const yt=rt+ft*F.strides[2],pt=ft*m.strideWidth-_;for(let bt=0;bt<b;++bt){const _t=pt+bt*v;if(_t<0||_t>=m.inWidth)continue;const $t=tt+bt*f[1],Ot=ut+_t*m.inChannels;let Mt=yt,qt=$t;for(let Kt=0;Kt<m.inChannels;++Kt){const vt=z[Ot+Kt];for(let Jt=0;Jt<C;++Jt)D[Mt+Jt]+=vt*P[qt+Jt];Mt+=C,qt+=C}}}}}}return n.makeTensorInfo(F.shape,F.dtype,F.values)}const m3={kernelName:Om,backendName:"cpu",kernelFunc:Wb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g3(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,dy:o}=t,{strides:a,dilations:i,pad:u,dimRoundingMode:c,filterShape:l}=s;jt([r,o],"depthwiseConv2dNativeBackpropFilter");const f=ws(r.shape,l,a,i,u,c,!0),{strideHeight:d,strideWidth:m,filterHeight:g,filterWidth:b}=f,y=new Ke(f.filterShape,"float32"),v=f.padInfo.left,I=f.padInfo.top,_=f.outChannels/f.inChannels,N=n.data.get(r.dataId).values,C=new Ke(r.shape,r.dtype,N),F=n.data.get(o.dataId).values,z=new Ke(o.shape,o.dtype,F);for(let P=0;P<g;++P){const D=Math.max(0,Math.ceil((I-P)/d)),L=Math.min(f.outHeight,(f.inHeight+I-P)/d);for(let T=0;T<b;++T){const K=Math.max(0,Math.ceil((v-T)/m)),Z=Math.min(f.outWidth,(f.inWidth+v-T)/m);for(let rt=0;rt<f.outChannels;++rt){const et=Math.trunc(rt/_),nt=rt%_;let it=0;for(let tt=0;tt<f.batchSize;++tt)for(let ut=D;ut<L;++ut){const ft=P+ut*d-I;for(let yt=K;yt<Z;++yt){const pt=T+yt*m-v;it+=C.get(tt,ft,pt,et)*z.get(tt,ut,yt,rt)}}y.set(it,P,T,et,nt)}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const y3={kernelName:Fm,backendName:"cpu",kernelFunc:g3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b3(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,filter:o}=t,{strides:a,dilations:i,pad:u,dimRoundingMode:c,inputShape:l}=s;jt([r,o],"depthwiseConv2DNativeBackpropInput");const f=Xt(r.shape),d=Xt(o.shape),m=ws(l,o.shape,a,i,u,c,!0),g=new Ke(m.inShape,"float32"),b=g.values,[y,v,I]=g.strides,_=n.data.get(r.dataId).values,[N,C,F]=f,z=n.data.get(o.dataId).values,[P,D,L]=d,{batchSize:T,filterHeight:K,filterWidth:Z,inChannels:rt,inHeight:et,inWidth:nt,outChannels:it,outHeight:tt,outWidth:ut,strideHeight:ft,strideWidth:yt}=m,pt=K-1-m.padInfo.top,bt=Z-1-m.padInfo.left,_t=it/rt;for(let $t=0;$t<T;++$t)for(let Ot=0;Ot<rt;++Ot)for(let Mt=0;Mt<et;++Mt){const qt=Mt-pt,Kt=Math.max(0,Math.ceil(qt/ft)),vt=Math.min(tt,(K+qt)/ft);for(let Jt=0;Jt<nt;++Jt){const R=Jt-bt,B=Math.max(0,Math.ceil(R/yt)),ot=Math.min(ut,(Z+R)/yt);let lt=0;for(let ct=Kt;ct<vt;++ct){const ht=ct*ft-qt;for(let kt=B;kt<ot;++kt){const Tt=kt*yt-R,wt=N*$t+C*ct+F*kt,mt=P*(K-1-ht)+D*(Z-1-Tt)+L*Ot;for(let Bt=0;Bt<_t;++Bt){const Ct=Ot*_t+Bt,zt=_[wt+Ct],Ht=z[mt+Bt];lt+=zt*Ht}}}b[y*$t+v*Mt+I*Jt+Ot]=lt}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const w3={kernelName:Rm,backendName:"cpu",kernelFunc:b3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v3(e){const{inputs:t,backend:n}=e,{x:s}=t,r=Nt(s.shape),o=n.data.get(s.dataId).values,a=ie([r,r],s.dtype),i=a.values;for(let c=0;c<o.length;c++)i[c*r+c]=o[c];const u=[...s.shape,...s.shape];return n.makeTensorInfo(u,a.dtype,a.values)}const k3={kernelName:Pm,backendName:"cpu",kernelFunc:v3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x3={kernelName:Mm,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:s,filter:r}=e,{strides:o,pad:a,dilations:i}=n,u=t,c=u.data.get(s.dataId).values,l=s.shape.length,f=u.data.get(r.dataId).values,d=r.shape.length,{batchSize:m,inHeight:g,inWidth:b,inChannels:y,outHeight:v,outWidth:I,padInfo:_,strideHeight:N,strideWidth:C,filterHeight:F,filterWidth:z,dilationHeight:P,dilationWidth:D,outShape:L}=sh(s.shape,r.shape,o,a,"NHWC",i),T=Nt(L),K=L.length,Z=je(s.dtype,T);for(let et=0;et<m;++et)for(let nt=0;nt<v;++nt){const it=nt*N-_.top;for(let tt=0;tt<I;++tt){const ut=tt*C-_.left;for(let ft=0;ft<y;++ft){let yt=Number.MIN_SAFE_INTEGER;for(let bt=0;bt<F;++bt){const _t=it+bt*P;if(_t>=0&&_t<g)for(let $t=0;$t<z;++$t){const Ot=ut+$t*D;if(Ot>=0&&Ot<b){const Mt=ls([et,_t,Ot,ft],l,Xt(s.shape)),qt=ls([bt,$t,ft],d,Xt(r.shape)),Kt=c[Mt]+f[qt];Kt>yt&&(yt=Kt)}}}const pt=ls([et,nt,tt,ft],K,Xt(L));Z[pt]=yt}}}return{dataId:u.write(Qr(Z,s.dtype),L,s.dtype),shape:L,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S3={kernelName:Ed,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:s,filter:r,dy:o}=e,{strides:a,pad:i,dilations:u}=n,c=t,l=Wn(s.shape,c.data.get(s.dataId).values),f=Wn(r.shape,c.data.get(r.dataId).values),{batchSize:d,inHeight:m,inWidth:g,inChannels:b,outHeight:y,outWidth:v,padInfo:I,strideHeight:_,strideWidth:N,filterHeight:C,filterWidth:F,dilationHeight:z,dilationWidth:P,outShape:D}=sh(s.shape,r.shape,a,i,"NHWC",u);O(o.rank===D.length,()=>`Error in ${Ed}, dy must have the same rank as output ${D.length}, but got ${o.rank}`);const L=Wn(D,c.data.get(o.dataId).values),T=om(r.shape,r.dtype);for(let Z=0;Z<d;++Z)for(let rt=0;rt<y;++rt){const et=rt*_-I.top;for(let nt=0;nt<v;++nt){const it=nt*N-I.left;for(let tt=0;tt<b;++tt){let ut=Number.MIN_SAFE_INTEGER,ft=0,yt=0;for(let pt=0;pt<C;++pt){const bt=et+pt*z;if(bt>=0&&bt<m)for(let _t=0;_t<F;++_t){const $t=it+_t*P;if($t>=0&&$t<g){const Ot=l[Z][bt][$t][tt]+f[pt][_t][tt];Ot>ut&&(ut=Ot,ft=pt,yt=_t)}}}T[ft][yt][tt]+=L[Z][rt][nt][tt]}}}return{dataId:c.write(Qr(T,s.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I3={kernelName:Td,backendName:"cpu",kernelFunc:({inputs:e,backend:t,attrs:n})=>{const{x:s,filter:r,dy:o}=e,{strides:a,pad:i,dilations:u}=n,c=t,l=Wn(s.shape,c.data.get(s.dataId).values),f=Wn(r.shape,c.data.get(r.dataId).values),{batchSize:d,inHeight:m,inWidth:g,inChannels:b,outHeight:y,outWidth:v,padInfo:I,strideHeight:_,strideWidth:N,filterHeight:C,filterWidth:F,dilationHeight:z,dilationWidth:P,outShape:D}=sh(s.shape,r.shape,a,i,"NHWC",u);O(o.rank===D.length,()=>`Error in ${Td}, dy must have the same rank as output ${D.length}, but got ${o.rank}`);const L=Wn(D,c.data.get(o.dataId).values),T=om(s.shape,s.dtype);for(let Z=0;Z<d;++Z)for(let rt=0;rt<y;++rt){const et=rt*_-I.top;for(let nt=0;nt<v;++nt){const it=nt*N-I.left;for(let tt=0;tt<b;++tt){let ut=Number.MIN_SAFE_INTEGER,ft=et<0?0:et,yt=it<0?0:it;for(let pt=0;pt<C;++pt){const bt=et+pt*z;if(bt>=0&&bt<m)for(let _t=0;_t<F;++_t){const $t=it+_t*P;if($t>=0&&$t<g){const Ot=l[Z][bt][$t][tt]+f[pt][_t][tt];Ot>ut&&(ut=Ot,ft=bt,yt=$t)}}}T[Z][ft][yt][tt]+=L[Z][rt][nt][tt]}}}return{dataId:c.write(Qr(T,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N3(e){const{inputs:t,backend:n,attrs:s}=e,{image:r}=t,{canvas:o,options:a}=s,{contextOptions:i,imageOptions:u}=a||{},c=(u==null?void 0:u.alpha)||1,l=(i==null?void 0:i.contextType)||"2d";if(l!=="2d")throw new Error(`Context type ${i.contextType} is not supported by the CPU backend.`);const f=o.getContext(l,(i==null?void 0:i.contextAttributes)||{});if(f==null)throw new Error(`Could not get the context with ${l} type.`);const[d,m]=r.shape.slice(0,2),g=r.shape.length===2?1:r.shape[2],b=n.data.get(r.dataId).values,y=r.dtype==="float32"?255:1,v=new Uint8ClampedArray(m*d*4);for(let _=0;_<d*m;++_){const N=[0,0,0,255*c];for(let F=0;F<g;F++){const z=b[_*g+F];if(r.dtype==="float32"){if(z<0||z>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${z}.`)}else if(r.dtype==="int32"&&(z<0||z>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${z}.`);g===1?(N[0]=z*y,N[1]=z*y,N[2]=z*y):N[F]=z*y}const C=_*4;v[C+0]=Math.round(N[0]),v[C+1]=Math.round(N[1]),v[C+2]=Math.round(N[2]),v[C+3]=Math.round(N[3])}o.width=m,o.height=d;const I=new ImageData(v,m,d);return f.putImageData(I,0,0),r}const _3={kernelName:lv,backendName:"cpu",kernelFunc:N3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ha(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:o,keepDims:a}=s;jt(r,"sum");let i;r.dtype==="bool"?i=dr({inputs:{x:r},backend:n,attrs:{dtype:"int32"}}):i=gs({inputs:{x:r},backend:n});const u=i.shape.length,c=Ye(o,i.shape),l=vs(c,u);let f=c,d=i;l!=null&&(d=In({inputs:{x:i},backend:n,attrs:{perm:l}}),f=ks(f.length,u)),Jr("sum",f,d.shape.length);const[m,g]=Ws(d.shape,f),b=Bo(d.dtype,"int32");let y=Ji(n,m,b);const v=Nt(g),I=n.data.get(y.dataId).values,_=n.data.get(d.dataId).values;for(let N=0;N<I.length;++N){const C=N*v;let F=0;for(let z=0;z<v;++z)F+=_[C+z];I[N]=F}if(a){const N=ts(y.shape,c),C=y;y=Ne({inputs:{x:y},backend:n,attrs:{shape:N}}),n.disposeIntermediateTensorInfo(C)}return n.disposeIntermediateTensorInfo(i),l!=null&&n.disposeIntermediateTensorInfo(d),y}const T3={kernelName:$g,backendName:"cpu",kernelFunc:Ha};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E3(e){const{inputs:t,backend:n,attrs:s}=e,{equation:r}=s,o=t,{allDims:a,summedDims:i,idDims:u}=q2(r,o.length);U2(a.length,u,o);const{path:c,steps:l}=G2(i,u),f=l.length;let d=null,m=a.length;const g=[];for(let b=0;b<f;++b){for(const y of l[b]){const{permutationIndices:v,expandDims:I}=K2(m,u[y]);let _;X2(v)?_=o[y]:(_=In({inputs:{x:o[y]},backend:n,attrs:{perm:v}}),g.push(_));const N=_.shape.slice();for(let C=0;C<I.length;++C)N.splice(I[C],0,1);qn(_.shape,N)||(_=Ne({inputs:{x:_},backend:n,attrs:{shape:N}}),g.push(_)),d===null?d=_:(d=Cu({inputs:{a:_,b:d},backend:n}),g.push(d))}b<f-1&&(c[b]>=0&&(d=Ha({inputs:{x:d},backend:n,attrs:{axis:c[b]-(a.length-m),keepDims:!1}}),g.push(d)),m--)}for(const b of g)b!==d&&n.disposeIntermediateTensorInfo(b);return d}const $3={kernelName:Lm,backendName:"cpu",kernelFunc:E3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C3(e){const{inputs:t,backend:n}=e,{dy:s,y:r}=t;jt([s,r],"eluGrad");const o=new Float32Array(Nt(r.shape)),a=n.data.get(r.dataId).values,i=n.data.get(s.dataId).values;for(let u=0;u<a.length;++u){const c=a[u];c>=0?o[u]=i[u]:o[u]=i[u]*(c+1)}return n.makeTensorInfo(r.shape,"float32",o)}const A3={kernelName:fv,backendName:"cpu",kernelFunc:C3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D3=D2,O3=O2,F3=F2,R3=R2,P3=P2,M3=M2,L3=ye(lf,e=>{const t=Math.sign(e),n=Math.abs(e),s=1/(1+D3*n);return t*(1-((((M3*s+P3)*s+R3)*s+F3)*s+O3)*s*Math.exp(-n*n))}),z3={kernelName:lf,backendName:"cpu",kernelFunc:L3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nu(e){const{inputs:t,backend:n,attrs:s}=e,{input:r}=t,{dim:o}=s,a=r.shape.length,i=r.shape.slice();let u=o;return o<0&&(O(-(a+1)<=o,()=>`Axis must be in the interval [${-(a+1)}, ${a}]`),u=a+o+1),i.splice(u,0,1),Ne({inputs:{x:r},backend:n,attrs:{shape:i}})}const V3={kernelName:zm,backendName:"cpu",kernelFunc:nu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B3=Ve((e,t)=>e/t),Nh=Ue(uf,B3),Nl={kernelName:uf,backendName:"cpu",kernelFunc:Nh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jb(e,t,n){const s=e.shape,r=s[0],o=s[1],a=n.data.get(e.dataId),i=a.complexTensorInfos.real,u=a.complexTensorInfos.imag,c=[r,o],l=Nt(c),f=mn("float32",l),d=mn("float32",l);for(let y=0;y<r;y++){const v=Yr({inputs:{x:i},backend:n,attrs:{begin:[y,0],size:[1,o]}}),I=Yr({inputs:{x:u},backend:n,attrs:{begin:[y,0],size:[1,o]}}),_=$n({inputs:{real:v,imag:I},backend:n}),{real:N,imag:C}=W3(_,t,n),F=Ao(N,C);for(let z=0;z<o;z++){const P=kb(F,z);f[y*o+z]=P.real,d[y*o+z]=P.imag}n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(I),n.disposeIntermediateTensorInfo(_)}const m=n.makeTensorInfo(c,"float32",f),g=n.makeTensorInfo(c,"float32",d),b=$n({inputs:{real:m,imag:g},backend:n});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),b}function W3(e,t,n){const s=Nt(e.shape),r=n.data.get(e.dataId),o=n.data.get(r.complexTensorInfos.real.dataId).values,a=n.data.get(r.complexTensorInfos.imag.dataId).values;if(j3(s)){const i=_l(o,a,s,t,n),u=[e.shape[0],e.shape[1]];if(t){const c=n.makeTensorInfo(u,"float32",i.real),l=n.makeTensorInfo(u,"float32",i.imag),f=n.makeTensorInfo([],"float32",th(s,"float32")),d=gs({inputs:{x:f},backend:n}),m=Nl.kernelFunc({inputs:{a:c,b:f},backend:n}),g=Nl.kernelFunc({inputs:{a:l,b:d},backend:n}),b=n.data.get(m.dataId).values,y=n.data.get(g.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),{real:b,imag:y}}return i}else{const i=Ao(o,a),u=H3(i,s,t);return L2(u)}}function j3(e){return(e&e-1)===0}function _l(e,t,n,s,r){if(n===1)return{real:e,imag:t};const o=Ao(e,t),a=n/2,i=z2(o),u=i.real,c=i.imag,l=[u.length],f=r.makeTensorInfo(l,"float32",u),d=r.makeTensorInfo(l,"float32",c),m=$n({inputs:{real:f,imag:d},backend:r}),g=V2(o),b=g.real,y=g.imag,v=[b.length],I=r.makeTensorInfo(v,"float32",b),_=r.makeTensorInfo(v,"float32",y),N=$n({inputs:{real:I,imag:_},backend:r}),C=_l(u,c,a,s,r),F=C.real,z=C.imag,P=[F.length],D=r.makeTensorInfo(P,"float32",F),L=r.makeTensorInfo(P,"float32",z),T=$n({inputs:{real:D,imag:L},backend:r}),K=_l(b,y,a,s,r),Z=K.real,rt=K.imag,et=[Z.length],nt=r.makeTensorInfo(et,"float32",Z),it=r.makeTensorInfo(et,"float32",rt),tt=$n({inputs:{real:nt,imag:it},backend:r}),ut=W2(n,s),ft=[ut.real.length],yt=r.makeTensorInfo(ft,"float32",ut.real),pt=r.makeTensorInfo(ft,"float32",ut.imag),bt=$n({inputs:{real:yt,imag:pt},backend:r}),_t=Cu({inputs:{a:bt,b:tt},backend:r}),$t=Do({inputs:{a:T,b:_t},backend:r}),Ot=Sh({inputs:{a:T,b:_t},backend:r}),Mt=Xr({inputs:{input:$t},backend:r}),qt=Xr({inputs:{input:Ot},backend:r}),Kt=Oo({inputs:{input:$t},backend:r}),vt=Oo({inputs:{input:Ot},backend:r}),Jt=Fo({inputs:[Mt,qt],backend:r,attrs:{axis:0}}),R=Fo({inputs:[Kt,vt],backend:r,attrs:{axis:0}}),B=r.data.get(Jt.dataId).values,ot=r.data.get(R.dataId).values;return r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(I),r.disposeIntermediateTensorInfo(_),r.disposeIntermediateTensorInfo(N),r.disposeIntermediateTensorInfo(D),r.disposeIntermediateTensorInfo(L),r.disposeIntermediateTensorInfo(T),r.disposeIntermediateTensorInfo(nt),r.disposeIntermediateTensorInfo(it),r.disposeIntermediateTensorInfo(tt),r.disposeIntermediateTensorInfo(yt),r.disposeIntermediateTensorInfo(pt),r.disposeIntermediateTensorInfo(bt),r.disposeIntermediateTensorInfo(_t),r.disposeIntermediateTensorInfo($t),r.disposeIntermediateTensorInfo(Ot),r.disposeIntermediateTensorInfo(Mt),r.disposeIntermediateTensorInfo(Kt),r.disposeIntermediateTensorInfo(qt),r.disposeIntermediateTensorInfo(vt),r.disposeIntermediateTensorInfo(Jt),r.disposeIntermediateTensorInfo(R),{real:B,imag:ot}}function H3(e,t,n){const s=new Float32Array(t*2);for(let r=0;r<t;r++){let o=0,a=0;for(let i=0;i<t;i++){const u=j2(r*i,t,n),c=kb(e,i);o+=c.real*u.real-c.imag*u.imag,a+=c.real*u.imag+c.imag*u.real}n&&(o/=t,a/=t),B2(s,o,a,r)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q3(e){const{inputs:t,backend:n}=e,{input:s}=t,r=Nt(s.shape),o=s.shape[s.shape.length-1],a=r/o,i=Ne({inputs:{x:s},backend:n,attrs:{shape:[a,o]}}),u=jb(i,!1,n),c=Ne({inputs:{x:u},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(u),c}const K3={kernelName:Vm,backendName:"cpu",kernelFunc:q3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _h(e){const{backend:t,attrs:n}=e,{shape:s,value:r,dtype:o}=n,a=o||Va(r),i=je(a,Nt(s));return G3(i,r,a),t.makeTensorInfo(s,a,i)}const U3={kernelName:Bm,backendName:"cpu",kernelFunc:_h};function G3(e,t,n){e.fill(t)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X3={kernelName:Wm,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{image:s}=e,r=n,o=mn(s.dtype,Nt(s.shape)),[a,i,u,c]=s.shape,l=r.data.get(s.dataId).values;for(let d=0;d<a;d++){const m=d*u*i*c;for(let g=0;g<i;g++){const b=g*(u*c);for(let y=0;y<u;y++){const v=y*c;for(let I=0;I<c;I++){const _=Math.round(u-y-1),N=m+b+v+I;let C=l[N];if(_>=0&&_<u){const F=_*c,z=m+b+F+I;C=l[z]}o[N]=C}}}}return{dataId:r.write(o,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y3(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:o,bias:a,preluActivationWeights:i}=t,{strides:u,pad:c,dataFormat:l,dilations:f,dimRoundingMode:d,activation:m,leakyreluAlpha:g}=s;let b=Bb({inputs:{x:r,filter:o},backend:n,attrs:{strides:u,pad:c,dataFormat:l,dilations:f,dimRoundingMode:d}});if(a){const y=b;if(l==="NCHW"&&a.shape.length===1&&a.shape[0]!==1){const v=Ne({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});b=Do({inputs:{a:b,b:v},backend:n}),n.disposeIntermediateTensorInfo(v)}else b=Do({inputs:{a:b,b:a},backend:n});n.disposeIntermediateTensorInfo(y)}if(m){const y=b;if(l==="NCHW"&&m==="prelu"&&i.shape.length===1&&i.shape[0]!==1){const v=Ne({inputs:{x:i},backend:n,attrs:{shape:[i.shape[0],1,1]}});b=eu(n,b,m,v,g),n.disposeIntermediateTensorInfo(v)}else b=eu(n,b,m,i,g);n.disposeIntermediateTensorInfo(y)}return b}const Z3={kernelName:Xc,backendName:"cpu",kernelFunc:Y3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q3(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,filter:o,bias:a,preluActivationWeights:i}=t,{strides:u,pad:c,dataFormat:l,dilations:f,dimRoundingMode:d,activation:m,leakyreluAlpha:g}=s;let b=Wb({inputs:{x:r,filter:o},backend:n,attrs:{strides:u,pad:c,dataFormat:l,dilations:f,dimRoundingMode:d}});if(a){const y=b;b=Do({inputs:{a:b,b:a},backend:n}),n.disposeIntermediateTensorInfo(y)}if(m){const y=b;b=eu(n,b,m,i,g),n.disposeIntermediateTensorInfo(y)}return b}const J3={kernelName:Yc,backendName:"cpu",kernelFunc:Q3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tF(e){const{inputs:t,backend:n}=e,{params:s,indices:r}=t,o=Nt(s.shape),a=r.shape,i=a[a.length-1],[u,c,l,f]=d2(s,r);if(c===0)return n.makeTensorInfo(u,s.dtype,[]);const d=n.data.get(r.dataId).values,m=n.bufferSync(s),g=wA(d,m,s.dtype,c,i,l,f,s.shape,o);return n.makeTensorInfo(u,s.dtype,g.values)}const eF={kernelName:qm,backendName:"cpu",kernelFunc:tF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nF(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,indices:o}=t,{axis:a,batchDims:i}=s;jt([r,o],"gatherV2");const u=Ye(a,r.shape)[0],c=n.data.get(o.dataId).values,l=r.shape[u];for(let N=0;N<c.length;++N){const C=c[N];O(C<=l-1&&C>=0,()=>`GatherV2: the index value ${C} is not in [0, ${l-1}]`)}let f=i;i==null&&(f=0);const d=Nt(o.shape),m=c$(r,o,u,f),g=Ne({inputs:{x:r},backend:n,attrs:{shape:[m.batchSize,m.outerSize,m.dimSize,m.sliceSize]}}),b=Ne({inputs:{x:o},backend:n,attrs:{shape:[m.batchSize,d/m.batchSize]}}),y=[m.batchSize,m.outerSize,d/m.batchSize,m.sliceSize],v=n.bufferSync(b),I=n.bufferSync(g),_=vA(I,v,y);return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(b),n.makeTensorInfo(m.outputShape,_.dtype,_.values)}const sF={kernelName:Hm,backendName:"cpu",kernelFunc:nF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rF(e){const{inputs:t,backend:n}=e,{input:s}=t,r=Nt(s.shape),o=s.shape[s.shape.length-1],a=r/o,i=Ne({inputs:{x:s},backend:n,attrs:{shape:[a,o]}}),u=jb(i,!0,n),c=Ne({inputs:{x:u},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(u),c}const oF={kernelName:Km,backendName:"cpu",kernelFunc:rF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aF=ye(wf,e=>Number.isFinite(e)?1:0,"bool"),iF={kernelName:wf,backendName:"cpu",kernelFunc:aF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uF=ye(vf,e=>Math.abs(e)===1/0?1:0,"bool"),cF={kernelName:vf,backendName:"cpu",kernelFunc:uF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lF=ye(kf,e=>Number.isNaN(e)?1:0,"bool"),fF={kernelName:kf,backendName:"cpu",kernelFunc:lF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hF(e){const{backend:t,attrs:n}=e,{start:s,stop:r,num:o}=n,a=OA(s,r,o);return t.makeTensorInfo([a.length],"float32",a)}const dF={kernelName:Xm,backendName:"cpu",kernelFunc:hF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pF=ye(Nf,e=>Math.log1p(e)),mF={kernelName:Nf,backendName:"cpu",kernelFunc:pF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gF=Ve((e,t)=>e&&t),yF=Ue(_f,gF,null,"bool"),bF={kernelName:_f,backendName:"cpu",kernelFunc:yF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wF=ye(Tf,e=>e?0:1,"bool"),vF={kernelName:Tf,backendName:"cpu",kernelFunc:wF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kF=Ve((e,t)=>e||t),xF=Ue(Ef,kF,null,"bool"),SF={kernelName:Ef,backendName:"cpu",kernelFunc:xF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IF(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{depthRadius:o,bias:a,alpha:i,beta:u}=s;jt(r,"LRN");const c=r.shape[3],l=c-1,f=n.data.get(r.dataId).values,d=Nt(r.shape),m=new Float32Array(d);function g(b){const y=b%c;let v=b-y+Math.max(0,y-o);const I=b-y+Math.min(y+o,l);let _=0;for(;v<=I;v++){const N=f[v];_+=N*N}return _}for(let b=0;b<d;b++){const y=g(b),v=f[b]*Math.pow(a+i*y,-u);m[b]=v}return n.makeTensorInfo(r.shape,r.dtype,m)}const NF={kernelName:Ym,backendName:"cpu",kernelFunc:IF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _F(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,y:o,dy:a}=t,{depthRadius:i,bias:u,alpha:c,beta:l}=s;jt(a,"LRNGrad");const f=Nt(a.shape),d=a.shape[3],m=n.data.get(a.dataId).values,g=n.data.get(r.dataId).values,b=n.data.get(o.dataId).values,y=new Float32Array(f),v=f;for(let I=0;I<v;I++){const _=I%d,N=I-_+Math.max(0,_-i),C=I-_+Math.min(d,_+i+1);let F=0;for(let z=N;z<C;z++)F+=Math.pow(g[z],2);F=c*F+u;for(let z=N;z<C;z++){let P=-2*c*l*g[z]*b[I]/F;I===z&&(P+=Math.pow(F,-l)),P*=m[I],y[z]+=P}}return n.makeTensorInfo(a.shape,r.dtype,y)}const TF={kernelName:hv,backendName:"cpu",kernelFunc:_F};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hb(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{reductionIndices:o,keepDims:a}=s,i=n;let u=r.shape;const c=u.length,l=Ye(o,u);let f=l;const d=vs(f,c);let m=i.data.get(r.dataId).values;if(d!=null){const N=new Array(c);for(let C=0;C<N.length;C++)N[C]=u[d[C]];m=$b(m,u,r.dtype,d,N),f=ks(f.length,c),u=N}jt(r,"max"),Jr("max",f,c);const[g,b]=Ws(u,f),y=Nt(b),v=MA(m,y,g,r.dtype),I=i.write(v,g,r.dtype);let _=g;return a&&(_=ts(g,l)),{dataId:I,shape:_,dtype:r.dtype}}const EF={kernelName:Zm,backendName:"cpu",kernelFunc:Hb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $F(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t;jt(r,"maxPool");const{filterSize:o,strides:a,pad:i,dimRoundingMode:u}=s,c=1;O(Qn(a,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${c}'`);const l=Wo(r.shape,o,a,c,i,u);let f;if(l.filterWidth===1&&l.filterHeight===1&&qn(l.inShape,l.outShape))f=gs({inputs:{x:r},backend:n});else{const d=n.data.get(r.dataId).values,m=Xt(r.shape),g=Ih(d,r.shape,r.dtype,m,l,"max");f=n.makeTensorInfo(l.outShape,r.dtype,g.values)}return f}const CF={kernelName:Qm,backendName:"cpu",kernelFunc:$F};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AF(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{filterSize:o,strides:a,pad:i,dimRoundingMode:u,dataFormat:c}=s;jt(r,"maxPool3d");const l=wu(r.shape,o,a,1,i,u,c),f=n.data.get(r.dataId).values,d=Vb(f,r.shape,r.dtype,Xt(r.shape),l,"max");return n.makeTensorInfo(d.shape,"float32",d.values)}const DF={kernelName:Jm,backendName:"cpu",kernelFunc:AF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OF(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,input:o}=t,{filterSize:a,strides:i,pad:u,dimRoundingMode:c}=s;jt([r,o],"maxPool3DGrad");const l=wu(o.shape,a,i,1,u,c),f=n.bufferSync(o),d=kO(f,l),m=l.strideDepth,g=l.strideHeight,b=l.strideWidth,y=l.dilationDepth,v=l.dilationHeight,I=l.dilationWidth,_=l.effectiveFilterDepth,N=l.effectiveFilterHeight,C=l.effectiveFilterWidth,F=_-1-l.padInfo.front,z=C-1-l.padInfo.left,P=N-1-l.padInfo.top,D=ie(o.shape,"float32"),L=n.bufferSync(r);for(let T=0;T<l.batchSize;++T)for(let K=0;K<l.inChannels;++K)for(let Z=0;Z<l.inDepth;++Z)for(let rt=0;rt<l.inHeight;++rt)for(let et=0;et<l.inWidth;++et){const nt=Z-F,it=rt-P,tt=et-z;let ut=0;for(let ft=0;ft<_;ft+=y){const yt=(nt+ft)/m;if(!(yt<0||yt>=l.outDepth||Math.floor(yt)!==yt))for(let pt=0;pt<N;pt+=v){const bt=(it+pt)/g;if(!(bt<0||bt>=l.outHeight||Math.floor(bt)!==bt))for(let _t=0;_t<C;_t+=I){const $t=(tt+_t)/b;if($t<0||$t>=l.outWidth||Math.floor($t)!==$t)continue;const Ot=_*N*C-1-d.get(T,yt,bt,$t,K),Mt=ft*N*C+pt*C+_t,qt=Ot===Mt?1:0;if(qt===0)continue;const Kt=L.get(T,yt,bt,$t,K);ut+=Kt*qt}}}D.set(ut,T,Z,rt,et,K)}return n.makeTensorInfo(D.shape,D.dtype,D.values)}const FF={kernelName:pv,backendName:"cpu",kernelFunc:OF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RF(e){const{inputs:t,backend:n,attrs:s}=e,{dy:r,input:o,output:a}=t,i=o;jt([o,a],"maxPoolGrad");const{filterSize:u,strides:c,pad:l,dimRoundingMode:f}=s,d=Wo(i.shape,u,c,1,l,f),m=n.data.get(i.dataId).values,g=ie(d.outShape,i.dtype,zb(m,i.shape,i.dtype,d).values),b=d.strideHeight,y=d.strideWidth,v=d.dilationHeight,I=d.dilationWidth,_=d.effectiveFilterHeight,N=d.effectiveFilterWidth,C=N-1-d.padInfo.left,F=_-1-d.padInfo.top,z=ie(i.shape,"float32"),P=n.data.get(r.dataId).values,D=ie(r.shape,"float32",P);for(let L=0;L<d.batchSize;++L)for(let T=0;T<d.inChannels;++T)for(let K=0;K<d.inHeight;++K)for(let Z=0;Z<d.inWidth;++Z){const rt=K-F,et=Z-C;let nt=0;for(let it=0;it<_;it+=v){const tt=(rt+it)/b;if(!(tt<0||tt>=d.outHeight||Math.floor(tt)!==tt))for(let ut=0;ut<N;ut+=I){const ft=(et+ut)/y;if(ft<0||ft>=d.outWidth||Math.floor(ft)!==ft)continue;const yt=_*N-1-g.get(L,tt,ft,T),pt=it*N+ut,bt=yt===pt?1:0;if(bt===0)continue;const _t=D.get(L,tt,ft,T);nt+=_t*bt}}z.set(nt,L,K,Z,T)}return n.makeTensorInfo(z.shape,z.dtype,z.values)}const PF={kernelName:dv,backendName:"cpu",kernelFunc:RF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MF(e,t,n,s,r){const o=Xt(t),a=Ih(e,t,n,o,r,"max"),i=zb(e,t,n,r,!0,s);return[a.values,i.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LF={kernelName:tg,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{x:s}=e,{filterSize:r,strides:o,pad:a,includeBatchInIndex:i}=t,u=n;jt(s,"MaxPoolWithArgmax");const c=u.data.get(s.dataId).values,l=Wo(s.shape,r,o,[1,1],a),[f,d]=MF(c,s.shape,s.dtype,i,l),m=u.write(f,l.outShape,s.dtype),g=u.write(d,l.outShape,s.dtype);return[{dataId:m,shape:l.outShape,dtype:s.dtype},{dataId:g,shape:l.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zF(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:o,keepDims:a}=s,i=Ye(o,r.shape),c=Ws(r.shape,i)[1],l=Nt(c),f=[],d=n.makeTensorInfo([],"float32",new Float32Array([l]));f.push(d);const m=dr({inputs:{x:r},backend:n,attrs:{dtype:"float32"}});f.push(m);const g=Nh({inputs:{a:m,b:d},backend:n});f.push(g);const b=Ha({inputs:{x:g},backend:n,attrs:{axis:o,keepDims:a}});return f.forEach(y=>n.disposeIntermediateTensorInfo(y)),b}const VF={kernelName:eg,backendName:"cpu",kernelFunc:zF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BF(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{axis:o,keepDims:a}=s;jt(r,"min");const i=Ye(o,r.shape);let u=i;const c=vs(u,r.shape.length);let l=r;c!=null&&(l=In({inputs:{x:r},backend:n,attrs:{perm:c}}),u=ks(u.length,r.shape.length)),Jr("min",u,l.shape.length);const[f,d]=Ws(l.shape,u),m=Nt(d),g=sn(Nt(f),l.dtype),b=n.data.get(l.dataId).values;for(let v=0;v<g.length;++v){const I=v*m;let _=b[I];for(let N=0;N<m;++N){const C=b[I+N];(Number.isNaN(C)||C<_)&&(_=C)}g[v]=_}c!=null&&n.disposeIntermediateTensorInfo(l);const y=n.makeTensorInfo(f,l.dtype,g);if(a){const v=ts(f,i),I=Ne({inputs:{x:y},backend:n,attrs:{shape:v}});return n.disposeIntermediateTensorInfo(y),I}return y}const WF={kernelName:ng,backendName:"cpu",kernelFunc:BF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jF(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{paddings:o,mode:a}=s;jt(r,"mirrorPad");const i=o.map((_,N)=>_[0]+r.shape[N]+_[1]),u=o.map(_=>_[0]),c=o.map((_,N)=>_[0]+r.shape[N]),l=a==="reflect"?0:1,f=n.data.get(r.dataId).values,d=r.shape.length,m=Xt(r.shape),g=Nt(i),b=i.length,y=Xt(i),v=mn(r.dtype,g);for(let _=0;_<g;_++){let N=Vo(_,b,y);for(let F=0;F<b;F++)N[F]<u[F]?N[F]=u[F]*2-N[F]-l:N[F]>=c[F]&&(N[F]=(c[F]-1)*2-N[F]+l);N=N.map((F,z)=>F-u[z]);const C=ls(N,d,m);v[_]=f[C]}return{dataId:n.write(v,i,r.dtype),shape:i,dtype:r.dtype}}const HF={kernelName:sg,backendName:"cpu",kernelFunc:jF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qF=Ve(((e,t)=>{const n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t})),KF=Ue(Af,qF),UF={kernelName:Af,backendName:"cpu",kernelFunc:KF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qb(e){const{inputs:t,backend:n,attrs:s}=e,{logits:r}=t,{dim:o}=s,a=r.shape.length;let i=o;if(i===-1&&(i=a-1),i!==a-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${a} and dim was ${i}`);const u=Ye([i],r.shape),c=Hb({inputs:{x:r},backend:n,attrs:{reductionIndices:u,keepDims:!1}}),l=ts(c.shape,u),f=Ne({inputs:{x:c},backend:n,attrs:{shape:l}}),d=Sh({inputs:{a:r,b:f},backend:n}),m=Tb({inputs:{x:d},backend:n}),g=Ha({inputs:{x:m},backend:n,attrs:{axis:u,keepDims:!1}}),b=Ne({inputs:{x:g},backend:n,attrs:{shape:l}}),y=Nh({inputs:{a:m,b},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(b),y}const GF={kernelName:Dg,backendName:"cpu",kernelFunc:qb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XF(e){const{inputs:t,backend:n,attrs:s}=e,{logits:r}=t,{numSamples:o,seed:a,normalized:i}=s;jt(r,"multinomial");const u=i?r:qb({inputs:{logits:r},backend:n,attrs:{dim:-1}}),c=u.shape[0],l=u.shape[1],f=n.data.get(u.dataId).values,d=[c,o],m=sn(Nt(d),"int32");for(let g=0;g<c;++g){const b=g*l,y=new Float32Array(l-1);y[0]=f[b];for(let _=1;_<y.length;++_)y[_]=y[_-1]+f[b+_];const v=Tu.alea(a.toString()),I=g*o;for(let _=0;_<o;++_){const N=v();m[I+_]=y.length;for(let C=0;C<y.length;C++)if(N<y[C]){m[I+_]=C;break}}}return i||n.disposeIntermediateTensorInfo(u),n.makeTensorInfo(d,"int32",m)}const YF={kernelName:rg,backendName:"cpu",kernelFunc:XF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZF=ub;function QF(e){const{inputs:t,backend:n,attrs:s}=e,{boxes:r,scores:o}=t,{maxOutputSize:a,iouThreshold:i,scoreThreshold:u}=s;jt(r,"NonMaxSuppression");const c=n.data.get(r.dataId).values,l=n.data.get(o.dataId).values,{selectedIndices:f}=ZF(c,l,a,i,u);return n.makeTensorInfo([f.length],"int32",new Int32Array(f))}const JF={kernelName:ag,backendName:"cpu",kernelFunc:QF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tR=cb;function eR(e){const{inputs:t,backend:n,attrs:s}=e,{boxes:r,scores:o}=t,{maxOutputSize:a,iouThreshold:i,scoreThreshold:u,padToMaxOutputSize:c}=s;jt(r,"NonMaxSuppressionPadded");const l=n.data.get(r.dataId).values,f=n.data.get(o.dataId).values,{selectedIndices:d,validOutputs:m}=tR(l,f,a,i,u,c);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([m]))]}const nR={kernelName:ig,backendName:"cpu",kernelFunc:eR};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sR=lb;function rR(e){const{inputs:t,backend:n,attrs:s}=e,{boxes:r,scores:o}=t,{maxOutputSize:a,iouThreshold:i,scoreThreshold:u,softNmsSigma:c}=s;jt(r,"NonMaxSuppressionWithScore");const l=n.data.get(r.dataId).values,f=n.data.get(o.dataId).values,d=a,m=i,g=u,b=c,{selectedIndices:y,selectedScores:v}=sR(l,f,d,m,g,b);return[n.makeTensorInfo([y.length],"int32",new Int32Array(y)),n.makeTensorInfo([v.length],"float32",new Float32Array(v))]}const oR={kernelName:ug,backendName:"cpu",kernelFunc:rR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aR(e){const{inputs:t,backend:n,attrs:s}=e,{indices:r}=t,{dtype:o,depth:a,onValue:i,offValue:u}=s;jt(r,"oneHot");const c=Nt(r.shape),l=new Float32Array(c*a);l.fill(u);const f=n.data.get(r.dataId).values;for(let d=0;d<c;++d)f[d]>=0&&f[d]<a&&(l[d*a+f[d]]=i);return n.makeTensorInfo([...r.shape,a],o,l)}const iR={kernelName:lg,backendName:"cpu",kernelFunc:aR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function su(e){const{inputs:t,backend:n}=e,{x:s}=t;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const r=Xr({inputs:{input:s},backend:n}),o=su({inputs:{x:r},backend:n}),a=Oo({inputs:{input:s},backend:n}),i=su({inputs:{x:a},backend:n}),u=$n({inputs:{real:o,imag:i},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),u}else return _h({backend:n,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const uR={kernelName:Ug,backendName:"cpu",kernelFunc:su};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kb(e){const{inputs:t,backend:n}=e,{x:s}=t;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const r=Xr({inputs:{input:s},backend:n}),o=Kb({inputs:{x:r},backend:n}),a=Oo({inputs:{input:s},backend:n}),i=su({inputs:{x:a},backend:n}),u=$n({inputs:{real:o,imag:i},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),u}else return _h({backend:n,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const cR={kernelName:cg,backendName:"cpu",kernelFunc:Kb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ub(e){const{inputs:t,backend:n,attrs:s}=e,{axis:r}=s;if(t.length===1)return nu({inputs:{input:t[0]},backend:n,attrs:{dim:r}});const o=t[0].shape,a=t[0].dtype;t.forEach(l=>{Rn(o,l.shape,"All tensors passed to stack must have matching shapes"),O(a===l.dtype,()=>"All tensors passed to stack must have matching dtypes")});const i=[],u=t.map(l=>{const f=nu({inputs:{input:l},backend:n,attrs:{dim:r}});return i.push(f),f}),c=Fo({inputs:u,backend:n,attrs:{axis:r}});return i.forEach(l=>n.disposeIntermediateTensorInfo(l)),c}const lR={kernelName:fg,backendName:"cpu",kernelFunc:Ub};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fR(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{paddings:o,constantValue:a}=s;jt(r,"pad");const i=o.map((I,_)=>I[0]+r.shape[_]+I[1]),u=o.map(I=>I[0]),c=n.data.get(r.dataId).values,l=Nt(r.shape),f=r.shape.length,d=Xt(r.shape),m=Nt(i),g=i.length,b=Xt(i),y=mn(r.dtype,m);a!==0&&y.fill(a);for(let I=0;I<l;I++){const N=Vo(I,f,d).map((F,z)=>F+u[z]),C=ls(N,g,b);y[C]=c[I]}return{dataId:n.write(y,i,r.dtype),shape:i,dtype:r.dtype}}const Gb={kernelName:hg,backendName:"cpu",kernelFunc:fR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hR=Ve((e,t)=>Math.pow(e,t)),dR=Ue(Ff,hR),pR={kernelName:Ff,backendName:"cpu",kernelFunc:dR};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mR(e){const{inputs:t,backend:n,attrs:s}=e,{paramsNestedSplits:r,paramsDenseValues:o,indices:a}=t,{outputRaggedRank:i}=s,u=r.map(v=>n.data.get(v.dataId).values),c=r.map(v=>v.shape),l=n.data.get(o.dataId).values,f=n.data.get(a.dataId).values,[d,m,g]=uD(u,c,l,o.shape,o.dtype,f,a.shape),b=d.map(v=>n.makeTensorInfo([v.length],"int32",v)),y=n.makeTensorInfo(g,o.dtype,m);return b.concat([y])}const gR={kernelName:mg,backendName:"cpu",kernelFunc:mR};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yR(e){const{inputs:t,backend:n}=e,{starts:s,limits:r,deltas:o}=t,a=n.data.get(s.dataId).values,i=n.data.get(r.dataId).values,u=n.data.get(o.dataId).values,[c,l]=cD(a,s.shape,s.dtype,i,r.shape,u,o.shape),f=n.makeTensorInfo([c.length],"int32",c),d=n.makeTensorInfo([l.length],s.dtype,l);return[f,d]}const bR={kernelName:gg,backendName:"cpu",kernelFunc:yR};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wR(e){const{inputs:t,backend:n,attrs:s}=e,{shape:r,values:o,defaultValue:a,rowPartitionTensors:i}=t,{rowPartitionTypes:u}=s,c=n.data.get(r.dataId).values,l=n.data.get(o.dataId).values,f=n.data.get(a.dataId).values,d=i.map(y=>n.data.get(y.dataId).values),m=i.map(y=>y.shape),[g,b]=lD(c,r.shape,l,o.shape,o.dtype,f,a.shape,d,m,u);return n.makeTensorInfo(g,o.dtype,b)}const vR={kernelName:yg,backendName:"cpu",kernelFunc:wR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kR(e){const{backend:t,attrs:n}=e,{start:s,stop:r,dtype:o,step:a}=n,i=fD(s,r,a,o);return t.makeTensorInfo([i.length],o,i)}const xR={kernelName:bg,backendName:"cpu",kernelFunc:kR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SR=ye(Rf,e=>1/e),IR={kernelName:Rf,backendName:"cpu",kernelFunc:SR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NR(e){const{inputs:t,backend:n,attrs:s}=e,{images:r}=t,{alignCorners:o,halfPixelCenters:a,size:i}=s;jt(r,"resizeBilinear");const u=Xt(r.shape),[c,l]=i,[f,d,m,g]=r.shape,b=n.data.get(r.dataId).values,y=new Float32Array(Nt([f,c,l,g])),v=[o&&c>1?d-1:d,o&&l>1?m-1:m],I=[o&&c>1?c-1:c,o&&l>1?l-1:l];let _=0;const N=v[0]/I[0],C=v[1]/I[1];for(let F=0;F<f;F++)for(let z=0;z<c;z++){let P;a?P=N*(z+.5)-.5:P=N*z;const D=Math.max(0,Math.floor(P)),L=P-D,T=Math.min(d-1,Math.ceil(P)),K=F*u[0]+D*u[1],Z=F*u[0]+T*u[1];for(let rt=0;rt<l;rt++){let et;a?et=C*(rt+.5)-.5:et=C*rt;const nt=Math.max(0,Math.floor(et)),it=et-nt,tt=Math.min(m-1,Math.ceil(et)),ut=K+nt*u[2],ft=Z+nt*u[2],yt=K+tt*u[2],pt=Z+tt*u[2];for(let bt=0;bt<g;bt++){const _t=b[ut+bt],$t=b[ft+bt],Ot=b[yt+bt],Mt=b[pt+bt],qt=_t+(Ot-_t)*it,Kt=$t+(Mt-$t)*it,vt=qt+(Kt-qt)*L;y[_++]=vt}}}return n.makeTensorInfo([f,c,l,g],"float32",y)}const _R={kernelName:xg,backendName:"cpu",kernelFunc:NR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TR(e){const{inputs:t,backend:n,attrs:s}=e,{images:r,dy:o}=t,{alignCorners:a}=s;jt([o,r],"resizeBilinearGrad");const i=Xt(r.shape),[u,c,l,f]=r.shape,[,d,m]=o.shape,g=new Float32Array(u*c*l*f),b=[a&&d>1?c-1:c,a&&m>1?l-1:l],y=[a&&d>1?d-1:d,a&&m>1?m-1:m],v=b[0]/y[0],I=b[1]/y[1],_=n.data.get(o.dataId).values;let N=0;for(let C=0;C<u;C++){const F=C*i[0];for(let z=0;z<d;z++){const P=z*v,D=Math.floor(P),L=Math.min(Math.ceil(P),c-1),T=F+D*i[1],K=F+L*i[1],Z=P-D,rt=1-Z;for(let et=0;et<m;et++){const nt=et*I,it=Math.floor(nt),tt=Math.min(Math.ceil(nt),l-1),ut=nt-it,ft=1-ut,yt=T+it*i[2],pt=T+tt*i[2],bt=K+it*i[2],_t=K+tt*i[2],$t=rt*ft,Ot=rt*ut,Mt=Z*ft,qt=Z*ut;for(let Kt=0;Kt<f;Kt++){const vt=_[N++];g[yt+Kt]+=vt*$t,g[pt+Kt]+=vt*Ot,g[bt+Kt]+=vt*Mt,g[_t+Kt]+=vt*qt}}}}return n.makeTensorInfo([u,l,c,f],"float32",g)}const ER={kernelName:gv,backendName:"cpu",kernelFunc:TR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $R(e){const{inputs:t,backend:n,attrs:s}=e,{images:r}=t,{alignCorners:o,halfPixelCenters:a,size:i}=s;jt(r,"resizeNearestNeighbor");const u=Xt(r.shape),[c,l]=i,[f,d,m,g]=r.shape,b=n.data.get(r.dataId).values,y=new Float32Array(f*c*l*g),v=[o&&c>1?d-1:d,o&&l>1?m-1:m],I=[o&&c>1?c-1:c,o&&l>1?l-1:l],_=v[0]/I[0],N=v[1]/I[1];let C=0;for(let F=0;F<f;F++){const z=F*u[0];for(let P=0;P<c;P++){const D=a?_*(P+.5):_*P;let L=Math.min(d-1,o?Math.round(D):Math.floor(D));a&&(L=Math.max(0,L));const T=z+L*u[1];for(let K=0;K<l;K++){const Z=a?N*(K+.5):N*K;let rt=Math.min(m-1,o?Math.round(Z):Math.floor(Z));a&&(rt=Math.max(0,rt));const et=T+rt*u[2];for(let nt=0;nt<g;nt++){const it=b[et+nt];y[C++]=it}}}}return n.makeTensorInfo([f,c,l,g],r.dtype,y)}const CR={kernelName:kg,backendName:"cpu",kernelFunc:$R};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AR(e){const{inputs:t,backend:n,attrs:s}=e,{images:r,dy:o}=t,{alignCorners:a}=s;jt([o,r],"resizeNearestNeighborGrad");const i=Xt(r.shape),u=Xt(o.shape),[c,l,f,d]=r.shape,[,m,g]=o.shape,b=new Float32Array(c*l*f*d),y=n.data.get(o.dataId).values,v=[a&&m>1?l-1:l,a&&g>1?f-1:f],I=[a&&m>1?m-1:m,a&&g>1?g-1:g],_=v[0]/I[0],N=v[1]/I[1],C=1/_,F=1/N,z=Math.ceil(C)*2+2,P=Math.ceil(F)*2+2;for(let D=0;D<c;D++){const L=D*i[0];for(let T=0;T<l;T++){const K=L+T*i[1],Z=Math.floor(T*C),rt=Math.floor(Z-z/2);for(let et=0;et<f;et++){const nt=K+et*i[2],it=Math.floor(et*F),tt=Math.floor(it-P/2);for(let ut=0;ut<d;ut++){let ft=0;for(let yt=0;yt<z;yt++){const pt=yt+rt;if(pt<0||pt>=m)continue;const bt=L+pt*u[1],_t=pt*_,$t=Math.min(l-1,a?Math.round(_t):Math.floor(_t));if(T===$t)for(let Ot=0;Ot<P;Ot++){const Mt=Ot+tt;if(Mt<0||Mt>=g)continue;const qt=bt+Mt*u[2],Kt=Mt*N,vt=Math.min(f-1,a?Math.round(Kt):Math.floor(Kt));et===vt&&(ft+=y[qt+ut])}}b[nt+ut]=ft}}}}return n.makeTensorInfo(r.shape,r.dtype,b)}const DR={kernelName:mv,backendName:"cpu",kernelFunc:AR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OR(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{dims:o}=s;jt(r,"reverse");const a=r.shape.length,i=Ye(o,r.shape);if(a===0)return gs({inputs:{x:r},backend:n});const u=new Ke(r.shape,r.dtype),c=n.bufferSync(r);for(let l=0;l<u.size;l++){const f=u.indexToLoc(l),d=f.slice();i.forEach(m=>d[m]=r.shape[m]-1-d[m]),u.set(c.get(...d),...f)}return n.makeTensorInfo(u.shape,u.dtype,u.values)}const FR={kernelName:Sg,backendName:"cpu",kernelFunc:OR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RR={kernelName:Gg,backendName:"cpu",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{image:s}=e,{radians:r,fillValue:o,center:a}=t,i=n,u=mn(s.dtype,Nt(s.shape)),[c,l,f,d]=s.shape,[m,g]=T2(a,l,f),b=255,y=Math.sin(r),v=Math.cos(r),I=i.data.get(s.dataId).values;for(let N=0;N<c;N++){const C=N*f*l*d;for(let F=0;F<l;F++){const z=F*(f*d);for(let P=0;P<f;P++){const D=P*d;for(let L=0;L<d;L++){const T=[c,F,P,L],K=T[2],Z=T[1];let rt=(K-m)*v-(Z-g)*y,et=(K-m)*y+(Z-g)*v;rt=Math.round(rt+m),et=Math.round(et+g);let nt=o;if(typeof o!="number"&&(L===3?nt=b:nt=o[L]),rt>=0&&rt<f&&et>=0&&et<l){const tt=et*(f*d),ut=rt*d,ft=C+tt+ut+L;nt=I[ft]}const it=C+z+D+L;u[it]=nt}}}}return{dataId:i.write(u,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PR=ye(Lf,e=>{const t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1}),MR={kernelName:Lf,backendName:"cpu",kernelFunc:PR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LR(e){const{inputs:t,backend:n,attrs:s}=e,{indices:r,updates:o}=t,{shape:a}=s,{sliceRank:i,numUpdates:u,sliceSize:c,strides:l,outputSize:f}=hh(o,r,a),d=!0,m=n.bufferSync(r),g=n.bufferSync(o),b=bo(m,g,a,f,c,u,i,l,0,d);return n.makeTensorInfo(a,b.dtype,b.values)}const zR={kernelName:Ig,backendName:"cpu",kernelFunc:LR};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VR(e,t){let n=0,s=e.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),e[r]<t?n=r+1:s=r;return s}function BR(e,t){let n=0,s=e.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),e[r]<=t?n=r+1:s=r;return s}function WR(e,t,n,s,r,o){const a=je("int32",n*r);for(let i=0;i<n;++i){const u=e.slice(i*s,(i+1)*s),c=i*r;for(let l=0;l<r;++l)a[c+l]=o==="left"?VR(u,t[l+c]):BR(u,t[l+c])}return a}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jR(e){const{inputs:t,backend:n,attrs:s}=e,{sortedSequence:r,values:o}=t,{side:a}=s,i=n.data.get(r.dataId).values,u=n.data.get(o.dataId).values,c=WR(i,u,r.shape[0],r.shape[1],o.shape[1],a);return n.makeTensorInfo(o.shape,"int32",c)}const HR={kernelName:_g,backendName:"cpu",kernelFunc:jR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qR(e){const{inputs:t,backend:n}=e,{condition:s,t:r,e:o}=t;jt([s,r,o],"select");const a=s.shape.length,i=n.data.get(s.dataId).values,u=n.data.get(r.dataId).values,c=n.data.get(o.dataId).values,l=Bo(r.dtype,o.dtype),f=sn(Nt(r.shape),l);let d=0;const m=a===0||a>1||r.shape.length===1?1:Nt(r.shape.slice(1));for(let g=0;g<i.length;g++)for(let b=0;b<m;b++)i[g]===1?f[d++]=u[g]:f[d++]=c[g];return n.makeTensorInfo(r.shape,l,f)}const KR={kernelName:Tg,backendName:"cpu",kernelFunc:qR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UR=C2,GR=A2,XR=ye(Vf,e=>e>=0?GR*e:UR*(Math.exp(e)-1)),YR={kernelName:Vf,backendName:"cpu",kernelFunc:XR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZR=ye(jf,e=>e<0?-1:e>0?1:0),QR={kernelName:jf,backendName:"cpu",kernelFunc:ZR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JR=ye(Bf,e=>Math.sin(e)),tP={kernelName:Bf,backendName:"cpu",kernelFunc:JR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eP=ye(Wf,e=>Math.sinh(e)),nP={kernelName:Wf,backendName:"cpu",kernelFunc:eP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sP=11920928955078125e-23,bp=Math.log(sP)+2,rP=ye(qf,e=>{const t=e>-bp,n=e<bp,s=Math.exp(e);let r;return n?r=s:t?r=e:r=Math.log(1+s),r}),oP={kernelName:qf,backendName:"cpu",kernelFunc:rP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aP(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{blockShape:o,paddings:a}=s;jt([r],"spaceToBatchND");const i=Nt(o),u=[[0,0]];u.push(...a);for(let F=1+o.length;F<r.shape.length;++F)u.push([0,0]);const c=Gb.kernelFunc({inputs:{x:r},backend:n,attrs:{paddings:u,constantValue:0}}),l=bb(c.shape,o,i,!1),f=wb(l.length,o.length,!1),d=vb(c.shape,o,i,!1),b=Ne({inputs:{x:c},backend:n,attrs:{shape:l}}),I=In({inputs:{x:b},backend:n,attrs:{perm:f}}),C=Ne({inputs:{x:I},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(I),C}const iP={kernelName:Cg,backendName:"cpu",kernelFunc:aP};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uP(e){const{inputs:t,backend:n}=e,{indices:s,values:r,denseShape:o,defaultValue:a}=t;if(o.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${o.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${r.shape}`);if(a.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${a.shape}`);const i=n.data.get(s.dataId).values,u=n.data.get(r.dataId).values,c=n.data.get(o.dataId).values,l=n.data.get(a.dataId).values[0],[f,d,m,g,b]=bD(i,s.shape,s.dtype,u,r.dtype,c,l);return[n.makeTensorInfo(d,s.dtype,f),n.makeTensorInfo([d[0]],r.dtype,m),n.makeTensorInfo([g.length],"bool",new Uint8Array(g.map(y=>Number(y)))),n.makeTensorInfo([b.length],s.dtype,new Int32Array(b))]}const cP={kernelName:Og,backendName:"cpu",kernelFunc:uP};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lP(e){const{inputs:t,backend:n}=e,{inputIndices:s,inputShape:r,newShape:o}=t;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${r.shape}`);if(o.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);const a=Array.from(n.data.get(r.dataId).values),i=n.data.get(s.dataId).values,u=Array.from(n.data.get(o.dataId).values),[c,l,f]=wD(i,s.shape,s.dtype,a,u);return[n.makeTensorInfo(l,s.dtype,c),n.makeTensorInfo([f.length],o.dtype,new Int32Array(f))]}const fP={kernelName:Fg,backendName:"cpu",kernelFunc:lP};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hP(e){const{inputs:t,backend:n}=e,{data:s,indices:r,segmentIds:o}=t;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${r.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${o.shape}`);if(r.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const a=n.data.get(s.dataId).values,i=n.data.get(r.dataId).values,u=n.data.get(o.dataId).values,[c,l]=Ab(a,s.shape,s.dtype,i,u,!0);return n.makeTensorInfo(l,s.dtype,c)}const dP={kernelName:Rg,backendName:"cpu",kernelFunc:hP};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pP(e){const{inputs:t,backend:n}=e,{data:s,indices:r,segmentIds:o}=t;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${r.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${o.shape}`);if(r.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const a=n.data.get(s.dataId).values,i=n.data.get(r.dataId).values,u=n.data.get(o.dataId).values,[c,l]=Ab(a,s.shape,s.dtype,i,u);return n.makeTensorInfo(l,s.dtype,c)}const mP={kernelName:Pg,backendName:"cpu",kernelFunc:pP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gP(e){const{inputs:t,backend:n,attrs:s}=e,{sparseIndices:r,sparseValues:o,defaultValue:a}=t,{outputShape:i}=s,{sliceRank:u,numUpdates:c,sliceSize:l,strides:f,outputSize:d}=hh(o,r,i),m=!1,g=n.bufferSync(r);let b;switch(o.dtype){case"bool":{const y=n.bufferSync(o),v=!!n.data.get(a.dataId).values[0];b=bo(g,y,i,d,l,c,u,f,v,m);break}case"float32":{const y=n.bufferSync(o),v=n.data.get(a.dataId).values[0];b=bo(g,y,i,d,l,c,u,f,v,m);break}case"int32":{const y=n.bufferSync(o),v=n.data.get(a.dataId).values[0];b=bo(g,y,i,d,l,c,u,f,v,m);break}case"string":{const y=n.bufferSync(o),v=Ia(n.data.get(a.dataId).values[0]);b=bo(g,y,i,d,l,c,u,f,v,m);break}default:throw new Error(`Unsupported type ${o.dtype}`)}return n.makeTensorInfo(i,b.dtype,b.values)}const yP={kernelName:Mg,backendName:"cpu",kernelFunc:gP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bP(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{numOrSizeSplits:o,axis:a}=s,i=Ye(a,r.shape)[0],u=Z2(r,o,i),c=new Array(r.shape.length).fill(0),l=r.shape.slice();return u.map(f=>{const d=[...l];d[i]=f;const m=Yr({inputs:{x:r},backend:n,attrs:{begin:c,size:d}});return c[i]+=f,m})}const wP={kernelName:Ag,backendName:"cpu",kernelFunc:bP};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vP={kernelName:yv,backendName:"cpu",kernelFunc:({inputs:e,backend:t})=>{const{x:n}=e,s=t;jt(n,"square");const r=s.data.get(n.dataId).values,o=new Float32Array(r.length);for(let i=0;i<r.length;++i){const u=r[i];o[i]=u*u}return{dataId:s.write(o,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kP=ye(Jf,(e,t)=>{const n=t;return isNaN(e)?NaN:e>0?1:n.alpha}),xP={kernelName:Jf,backendName:"cpu",kernelFunc:kP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SP(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{begin:o,end:a,strides:i,beginMask:u,endMask:c,ellipsisMask:l,newAxisMask:f,shrinkAxisMask:d}=s;jt(r,"stridedSlice");const{finalShapeSparse:m,finalShape:g,isIdentity:b,sliceDim0:y,isSimpleSlice:v,begin:I,end:_,strides:N}=v2(r.shape,o,a,i,u,c,l,f,d);let C;if(b)C=Ne({inputs:{x:r},backend:n,attrs:{shape:g}});else if(y||v){O(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const F=g2(I,_,N),z=Yr({inputs:{x:r},backend:n,attrs:{begin:I,size:F}});C=Ne({inputs:{x:z},backend:n,attrs:{shape:g}}),n.disposeIntermediateTensorInfo(z)}else{const F=n.bufferSync(r),z=ED(m,F,N,I);C=n.makeTensorInfo(g,z.dtype,z.values)}return C}const IP={kernelName:Lg,backendName:"cpu",kernelFunc:SP};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NP(e){const{inputs:t,backend:n,attrs:s}=e,{separator:r,nGramWidths:o,leftPad:a,rightPad:i,padWidth:u,preserveShortSequences:c}=s,{data:l,dataSplits:f}=t,d=n.data.get(l.dataId).values,m=n.data.get(f.dataId).values,[g,b]=CD(d,m,r,o,a,i,u,c);return[n.makeTensorInfo([g.length],"string",g),n.makeTensorInfo(f.shape,"int32",b)]}const _P={kernelName:zg,backendName:"cpu",kernelFunc:NP};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TP(e){const{inputs:t,backend:n,attrs:s}=e,{skipEmpty:r}=s,{input:o,delimiter:a}=t;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(a.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${a.shape}`);const i=n.data.get(o.dataId).values,u=n.data.get(a.dataId).values[0],[c,l,f]=DD(i,u,r),d=l.length;return[n.makeTensorInfo([d,2],"int32",c),n.makeTensorInfo([d],"string",l),n.makeTensorInfo([2],"int32",new Int32Array(f))]}const EP={kernelName:Vg,backendName:"cpu",kernelFunc:TP};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $P(e){const{inputs:t,backend:n,attrs:s}=e,{numBuckets:r}=s,{input:o}=t;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const a=n.data.get(o.dataId).values,i=OD(a,r);return n.makeTensorInfo(o.shape,"int32",i)}const CP={kernelName:Bg,backendName:"cpu",kernelFunc:$P};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AP=ye(Yf,e=>Math.tan(e)),DP={kernelName:Yf,backendName:"cpu",kernelFunc:AP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OP=ye(Zf,e=>Math.tanh(e)),FP={kernelName:Zf,backendName:"cpu",kernelFunc:OP};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RP(e){const{inputs:t,backend:n}=e,{tensor:s,indices:r,updates:o}=t,{sliceRank:a,numUpdates:i,sliceSize:u,strides:c,outputSize:l}=hh(o,r,s.shape),f=!1,d=n.bufferSync(r),m=n.bufferSync(o),g=n.bufferSync(s),b=bo(d,m,s.shape,l,u,i,a,c,g,f);return n.makeTensorInfo(s.shape,b.dtype,b.values)}const PP={kernelName:Ng,backendName:"cpu",kernelFunc:RP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MP(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{reps:o}=s;jt(r,"tile");const a=MD(n.bufferSync(r),o);return n.makeTensorInfo(a.shape,a.dtype,a.values)}const LP={kernelName:Qf,backendName:"cpu",kernelFunc:MP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zP(e){const{inputs:t,backend:n,attrs:s}=e,{x:r}=t,{k:o,sorted:a}=s;jt(r,"topk");const i=n.data.get(r.dataId).values,[u,c]=LD(i,r.shape,r.dtype,o,a);return[n.makeTensorInfo(u.shape,u.dtype,u.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}const VP={kernelName:Wg,backendName:"cpu",kernelFunc:zP};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BP(e){const{inputs:t,attrs:n,backend:s}=e,{image:r,transforms:o}=t,{interpolation:a,fillMode:i,fillValue:u,outputShape:c}=n,[l,f,d,m]=r.shape,[g,b]=c??[f,d],y=[l,g,b,m],v=Xt(r.shape),I=v[0],_=v[1],N=v[2],C=Xt(y),F=C[0],z=C[1],P=C[2],D=mn(r.dtype,Nt(y));D.fill(u);const L=s.data.get(r.dataId).values,T=s.data.get(o.dataId).values;for(let Z=0;Z<l;++Z){const rt=o.shape[0]===1?T:T.subarray(Z*8,Z*8+8);for(let et=0;et<g;++et)for(let nt=0;nt<b;++nt)for(let it=0;it<m;++it){let tt;const ut=rt[6]*nt+rt[7]*et+1;if(ut===0)continue;const ft=(rt[0]*nt+rt[1]*et+rt[2])/ut,yt=(rt[3]*nt+rt[4]*et+rt[5])/ut,pt=wp(ft,d,i),bt=wp(yt,f,i);switch(a){case"nearest":tt=UP(L,f,d,I,_,N,Z,bt,pt,it,u);break;case"bilinear":tt=GP(L,f,d,I,_,N,Z,bt,pt,it,u);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${a}`)}const _t=Z*F+et*z+nt*P+it;D[_t]=tt}return s.makeTensorInfo(y,r.dtype,D)}return{dataId:s.write(D,y,r.dtype),shape:r.shape,dtype:r.dtype}}const WP={kernelName:jg,backendName:"cpu",kernelFunc:BP};function wp(e,t,n){switch(n){case"reflect":return jP(e,t);case"wrap":return HP(e,t);case"nearest":return KP(e,t);case"constant":default:return qP(e)}}function jP(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const s=2*t;n<s&&(n=s*Math.trunc(-n/s)+n),n=n<-t?n+s:-n-1}else if(n>t-1)if(t<=1)n=0;else{const s=2*t;n-=s*Math.trunc(n/s),n>=t&&(n=s-n-1)}return ql(0,n,t-1)}function HP(e,t){let n=e;if(n<0)if(t<=1)n=0;else{const s=t-1;n+=t*(Math.trunc(-n/s)+1)}else if(n>t-1)if(t<=1)n=0;else{const s=t-1;n-=t*Math.trunc(n/s)}return ql(0,n,t-1)}function qP(e,t){return e}function KP(e,t){return ql(0,e,t-1)}function ca(e,t,n,s,r,o,a,i,u,c,l){const f=a*s+i*r+u*o+c;return 0<=i&&i<t&&0<=u&&u<n?e[f]:l}function UP(e,t,n,s,r,o,a,i,u,c,l){const f=Math.round(i),d=Math.round(u);return ca(e,t,n,s,r,o,a,f,d,c,l)}function GP(e,t,n,s,r,o,a,i,u,c,l){const f=Math.floor(i),d=Math.floor(u),m=f+1,g=d+1,b=(g-u)*ca(e,t,n,s,r,o,a,f,d,c,l)+(u-d)*ca(e,t,n,s,r,o,a,f,g,c,l),y=(g-u)*ca(e,t,n,s,r,o,a,m,d,c,l)+(u-d)*ca(e,t,n,s,r,o,a,m,g,c,l);return(m-i)*b+(i-f)*y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XP(e){const{inputs:t,attrs:n,backend:s}=e,{axis:r}=n,{x:o}=t;jt(o,"unique");const a=s.data.get(o.dataId).values,{outputValues:i,outputShape:u,indices:c}=zD(a,r,o.shape,o.dtype);return[s.makeTensorInfo(u,o.dtype,i),s.makeTensorInfo([c.length],"int32",c)]}const YP={kernelName:Hg,backendName:"cpu",kernelFunc:XP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZP(e){const{inputs:t,backend:n,attrs:s}=e,{value:r}=t;let{axis:o}=s;o<0&&(o+=r.shape.length);const a=r.shape.length,i=r.shape[o],u=new Array(a-1);let c=0;for(let m=0;m<a;m++)m!==o&&(u[c++]=r.shape[m]);const l=new Array(a).fill(0),f=r.shape.slice();f[o]=1;const d=new Array(i);for(let m=0;m<d.length;m++){l[o]=m;const g=Yr({inputs:{x:r},backend:n,attrs:{begin:l,size:f}});d[m]=Ne({inputs:{x:g},backend:n,attrs:{shape:u}}),n.disposeIntermediateTensorInfo(g)}return d}const QP={kernelName:qg,backendName:"cpu",kernelFunc:ZP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JP(e){const{inputs:t,backend:n,attrs:s}=e,{x:r,segmentIds:o}=t,{numSegments:a}=s;jt(r,"unsortedSegmentSum");const i=r.shape.length,u=o.shape.length,c=[],l=[],f=i-u;let d=o;for(let g=0;g<f;++g){const b=nu({inputs:{input:d},backend:n,attrs:{dim:g+1}});d=b,l.push(b)}for(let g=0;g<a;++g){const b=th(g,"int32"),y=n.makeTensorInfo([],"int32",b),v=_b({inputs:{a:y,b:d},backend:n}),I=dr({inputs:{x:v},backend:n,attrs:{dtype:"float32"}}),_=Cu({inputs:{a:I,b:r},backend:n}),N=Ha({inputs:{x:_},backend:n,attrs:{axis:0,keepDims:!1}});c.push(N),l.push(y),l.push(v),l.push(I),l.push(_),l.push(N)}const m=Ub({inputs:c,backend:n,attrs:{axis:0}});return l.forEach(g=>n.disposeIntermediateTensorInfo(g)),m}const tM={kernelName:Kg,backendName:"cpu",kernelFunc:JP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eM=[XD,jC,ZD,JD,ZC,eO,sO,oO,iO,cO,fO,dO,mO,bO,vO,SO,NO,TO,$O,UD,AO,OO,RO,eA,MO,GC,rA,zO,HC,BO,jO,HO,KO,GO,YO,QO,t3,n3,r3,a3,u3,l3,h3,p3,m3,y3,w3,k3,x3,S3,I3,_3,$3,VD,A3,iA,z3,cA,V3,hA,K3,U3,X3,mA,bA,Z3,J3,eF,sF,SA,_A,qC,oF,WO,iF,cF,fF,BD,$A,DA,dF,PA,mF,bF,vF,SF,NF,TF,EF,VA,CF,DF,FF,PF,LF,VF,WF,jA,HF,UF,YF,qA,GA,JF,nR,oR,ZA,iR,cR,lR,Gb,pR,jD,eD,gR,bR,vR,xR,KC,Nl,IR,HD,qD,KD,_R,ER,CR,DR,FR,RR,MR,pD,zR,HR,KR,YR,mD,QR,tP,nP,yD,GF,oP,iP,cP,fP,dP,mP,yP,wP,kD,vP,ID,TD,xP,IP,_P,EP,CP,PD,T3,DP,FP,PP,LP,VP,WP,QA,YP,QP,tM,uR];for(const e of eM)wv(e);var nM=class{constructor(e){tr(this,"model");tr(this,"dict",[]);tr(this,"canvas");tr(this,"ctx");tr(this,"modelPath");tr(this,"dictPath");tr(this,"backend");this.modelPath=e.modelPath,this.dictPath=e.dictPath,this.backend=e.backend||"cpu",this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=64,this.ctx=this.canvas.getContext("2d",{willReadFrequently:!0})}async initialize(e){const t=await fetch(this.dictPath).then(n=>n.text());return this.dict=t.split(`
`),this.model=await LC(this.modelPath,{streamWeights:!0,onProgress:e==null?void 0:e.onProgress}),this.backend==="webgl"?(await zd("webgl"),await Uv(),await this.recognize([10,10,0,20,20,1])):await zd("cpu"),!0}async recognize(e){if(!this.model)throw new Error("Model not initialized");const{canvas:t,ctx:n,model:s,dict:r}=this;n.fillStyle="white",n.fillRect(0,0,t.width,t.height);const o=e.length/3,a=Array.from({length:o},(v,I)=>({x:e[3*I],y:e[3*I+1],isEnd:e[3*I+2]===1}));let i=1/0,u=1/0,c=-1/0,l=-1/0;for(const{x:v,y:I}of a)v<i&&(i=v),v>c&&(c=v),I<u&&(u=I),I>l&&(l=I);const f=c-i||1,d=l-u||1,m=(i+c)/2,g=(u+l)/2,b=Math.min(t.width*.9/f,t.height*.9/d);n.strokeStyle="black",n.lineWidth=2,n.lineCap="round",n.lineJoin="round";let y=null;for(const v of a){const I=t.width/2+(v.x-m)*b,_=t.height/2+(v.y-g)*b;y&&!y.isEnd?(n.beginPath(),n.moveTo(t.width/2+(y.x-m)*b,t.height/2+(y.y-g)*b),n.lineTo(I,_),n.stroke()):(n.beginPath(),n.moveTo(I,_)),y=v}return de(()=>{const v=h2(t,3),I=ze(v,"float32"),_=Ie(I,255),N=_s(_,0),C=s.predict(N).dataSync();return Array.from(C.keys()).sort((z,P)=>C[P]-C[z]).slice(0,10).map(z=>z<r.length?r[z]:"").filter(Boolean)})}async close(){var e;(e=this.model)==null||e.dispose(),this.model=void 0}};/**
* @vue/shared v3.5.28
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Th(e){const t=Object.create(null);for(const n of e.split(","))t[n]=1;return n=>n in t}const pe={},So=[],ds=()=>{},Xb=()=>!1,Au=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),Eh=e=>e.startsWith("onUpdate:"),tn=Object.assign,$h=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},sM=Object.prototype.hasOwnProperty,ge=(e,t)=>sM.call(e,t),Zt=Array.isArray,Io=e=>qa(e)==="[object Map]",Du=e=>qa(e)==="[object Set]",vp=e=>qa(e)==="[object Date]",ee=e=>typeof e=="function",He=e=>typeof e=="string",ys=e=>typeof e=="symbol",we=e=>e!==null&&typeof e=="object",Yb=e=>(we(e)||ee(e))&&ee(e.then)&&ee(e.catch),Zb=Object.prototype.toString,qa=e=>Zb.call(e),rM=e=>qa(e).slice(8,-1),Qb=e=>qa(e)==="[object Object]",Ch=e=>He(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,pa=Th(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ou=e=>{const t=Object.create(null);return(n=>t[n]||(t[n]=e(n)))},oM=/-\w/g,Ls=Ou(e=>e.replace(oM,t=>t.slice(1).toUpperCase())),aM=/\B([A-Z])/g,wr=Ou(e=>e.replace(aM,"-$1").toLowerCase()),Jb=Ou(e=>e.charAt(0).toUpperCase()+e.slice(1)),Pc=Ou(e=>e?`on${Jb(e)}`:""),En=(e,t)=>!Object.is(e,t),Mi=(e,...t)=>{for(let n=0;n<e.length;n++)e[n](...t)},t0=(e,t,n,s=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:s,value:n})},Ah=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let kp;const Fu=()=>kp||(kp=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Ro(e){if(Zt(e)){const t={};for(let n=0;n<e.length;n++){const s=e[n],r=He(s)?lM(s):Ro(s);if(r)for(const o in r)t[o]=r[o]}return t}else if(He(e)||we(e))return e}const iM=/;(?![^(]*\))/g,uM=/:([^]+)/,cM=/\/\*[^]*?\*\//g;function lM(e){const t={};return e.replace(cM,"").split(iM).forEach(n=>{if(n){const s=n.split(uM);s.length>1&&(t[s[0].trim()]=s[1].trim())}}),t}function cr(e){let t="";if(He(e))t=e;else if(Zt(e))for(let n=0;n<e.length;n++){const s=cr(e[n]);s&&(t+=s+" ")}else if(we(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const fM="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",hM=Th(fM);function e0(e){return!!e||e===""}function dM(e,t){if(e.length!==t.length)return!1;let n=!0;for(let s=0;n&&s<e.length;s++)n=Zr(e[s],t[s]);return n}function Zr(e,t){if(e===t)return!0;let n=vp(e),s=vp(t);if(n||s)return n&&s?e.getTime()===t.getTime():!1;if(n=ys(e),s=ys(t),n||s)return e===t;if(n=Zt(e),s=Zt(t),n||s)return n&&s?dM(e,t):!1;if(n=we(e),s=we(t),n||s){if(!n||!s)return!1;const r=Object.keys(e).length,o=Object.keys(t).length;if(r!==o)return!1;for(const a in e){const i=e.hasOwnProperty(a),u=t.hasOwnProperty(a);if(i&&!u||!i&&u||!Zr(e[a],t[a]))return!1}}return String(e)===String(t)}function n0(e,t){return e.findIndex(n=>Zr(n,t))}const s0=e=>!!(e&&e.__v_isRef===!0),hn=e=>He(e)?e:e==null?"":Zt(e)||we(e)&&(e.toString===Zb||!ee(e.toString))?s0(e)?hn(e.value):JSON.stringify(e,r0,2):String(e),r0=(e,t)=>s0(t)?r0(e,t.value):Io(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[s,r],o)=>(n[Mc(s,o)+" =>"]=r,n),{})}:Du(t)?{[`Set(${t.size})`]:[...t.values()].map(n=>Mc(n))}:ys(t)?Mc(t):we(t)&&!Zt(t)&&!Qb(t)?String(t):t,Mc=(e,t="")=>{var n;return ys(e)?`Symbol(${(n=e.description)!=null?n:t})`:e};/**
* @vue/reactivity v3.5.28
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let an;class pM{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.__v_skip=!0,this.parent=an,!t&&an&&(this.index=(an.scopes||(an.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].pause();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].resume();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].resume()}}run(t){if(this._active){const n=an;try{return an=this,t()}finally{an=n}}}on(){++this._on===1&&(this.prevScope=an,an=this)}off(){this._on>0&&--this._on===0&&(an=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let n,s;for(n=0,s=this.effects.length;n<s;n++)this.effects[n].stop();for(this.effects.length=0,n=0,s=this.cleanups.length;n<s;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,s=this.scopes.length;n<s;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0}}}function o0(){return an}function mM(e,t=!1){an&&an.cleanups.push(e)}let Ee;const Lc=new WeakSet;class a0{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,an&&an.active&&an.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Lc.has(this)&&(Lc.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||u0(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,xp(this),c0(this);const t=Ee,n=Xn;Ee=this,Xn=!0;try{return this.fn()}finally{l0(this),Ee=t,Xn=n,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)Fh(t);this.deps=this.depsTail=void 0,xp(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Lc.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Tl(this)&&this.run()}get dirty(){return Tl(this)}}let i0=0,ma,ga;function u0(e,t=!1){if(e.flags|=8,t){e.next=ga,ga=e;return}e.next=ma,ma=e}function Dh(){i0++}function Oh(){if(--i0>0)return;if(ga){let t=ga;for(ga=void 0;t;){const n=t.next;t.next=void 0,t.flags&=-9,t=n}}let e;for(;ma;){let t=ma;for(ma=void 0;t;){const n=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(s){e||(e=s)}t=n}}if(e)throw e}function c0(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function l0(e){let t,n=e.depsTail,s=n;for(;s;){const r=s.prevDep;s.version===-1?(s===n&&(n=r),Fh(s),gM(s)):t=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=r}e.deps=t,e.depsTail=n}function Tl(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(f0(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function f0(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===Fa)||(e.globalVersion=Fa,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!Tl(e))))return;e.flags|=2;const t=e.dep,n=Ee,s=Xn;Ee=e,Xn=!0;try{c0(e);const r=e.fn(e._value);(t.version===0||En(r,e._value))&&(e.flags|=128,e._value=r,t.version++)}catch(r){throw t.version++,r}finally{Ee=n,Xn=s,l0(e),e.flags&=-3}}function Fh(e,t=!1){const{dep:n,prevSub:s,nextSub:r}=e;if(s&&(s.nextSub=r,e.prevSub=void 0),r&&(r.prevSub=s,e.nextSub=void 0),n.subs===e&&(n.subs=s,!s&&n.computed)){n.computed.flags&=-5;for(let o=n.computed.deps;o;o=o.nextDep)Fh(o,!0)}!t&&!--n.sc&&n.map&&n.map.delete(n.key)}function gM(e){const{prevDep:t,nextDep:n}=e;t&&(t.nextDep=n,e.prevDep=void 0),n&&(n.prevDep=t,e.nextDep=void 0)}let Xn=!0;const h0=[];function zs(){h0.push(Xn),Xn=!1}function Vs(){const e=h0.pop();Xn=e===void 0?!0:e}function xp(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const n=Ee;Ee=void 0;try{t()}finally{Ee=n}}}let Fa=0;class yM{constructor(t,n){this.sub=t,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Ru{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!Ee||!Xn||Ee===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==Ee)n=this.activeLink=new yM(Ee,this),Ee.deps?(n.prevDep=Ee.depsTail,Ee.depsTail.nextDep=n,Ee.depsTail=n):Ee.deps=Ee.depsTail=n,d0(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const s=n.nextDep;s.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=s),n.prevDep=Ee.depsTail,n.nextDep=void 0,Ee.depsTail.nextDep=n,Ee.depsTail=n,Ee.deps===n&&(Ee.deps=s)}return n}trigger(t){this.version++,Fa++,this.notify(t)}notify(t){Dh();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{Oh()}}}function d0(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let s=t.deps;s;s=s.nextDep)d0(s)}const n=e.dep.subs;n!==e&&(e.prevSub=n,n&&(n.nextSub=e)),e.dep.subs=e}}const El=new WeakMap,Lr=Symbol(""),$l=Symbol(""),Ra=Symbol("");function fn(e,t,n){if(Xn&&Ee){let s=El.get(e);s||El.set(e,s=new Map);let r=s.get(n);r||(s.set(n,r=new Ru),r.map=s,r.key=n),r.track()}}function As(e,t,n,s,r,o){const a=El.get(e);if(!a){Fa++;return}const i=u=>{u&&u.trigger()};if(Dh(),t==="clear")a.forEach(i);else{const u=Zt(e),c=u&&Ch(n);if(u&&n==="length"){const l=Number(s);a.forEach((f,d)=>{(d==="length"||d===Ra||!ys(d)&&d>=l)&&i(f)})}else switch((n!==void 0||a.has(void 0))&&i(a.get(n)),c&&i(a.get(Ra)),t){case"add":u?c&&i(a.get("length")):(i(a.get(Lr)),Io(e)&&i(a.get($l)));break;case"delete":u||(i(a.get(Lr)),Io(e)&&i(a.get($l)));break;case"set":Io(e)&&i(a.get(Lr));break}}Oh()}function fo(e){const t=me(e);return t===e?t:(fn(t,"iterate",Ra),jn(e)?t:t.map(Yn))}function Pu(e){return fn(e=me(e),"iterate",Ra),e}function er(e,t){return Bs(e)?Po(zr(e)?Yn(t):t):Yn(t)}const bM={__proto__:null,[Symbol.iterator](){return zc(this,Symbol.iterator,e=>er(this,e))},concat(...e){return fo(this).concat(...e.map(t=>Zt(t)?fo(t):t))},entries(){return zc(this,"entries",e=>(e[1]=er(this,e[1]),e))},every(e,t){return Is(this,"every",e,t,void 0,arguments)},filter(e,t){return Is(this,"filter",e,t,n=>n.map(s=>er(this,s)),arguments)},find(e,t){return Is(this,"find",e,t,n=>er(this,n),arguments)},findIndex(e,t){return Is(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return Is(this,"findLast",e,t,n=>er(this,n),arguments)},findLastIndex(e,t){return Is(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return Is(this,"forEach",e,t,void 0,arguments)},includes(...e){return Vc(this,"includes",e)},indexOf(...e){return Vc(this,"indexOf",e)},join(e){return fo(this).join(e)},lastIndexOf(...e){return Vc(this,"lastIndexOf",e)},map(e,t){return Is(this,"map",e,t,void 0,arguments)},pop(){return sa(this,"pop")},push(...e){return sa(this,"push",e)},reduce(e,...t){return Sp(this,"reduce",e,t)},reduceRight(e,...t){return Sp(this,"reduceRight",e,t)},shift(){return sa(this,"shift")},some(e,t){return Is(this,"some",e,t,void 0,arguments)},splice(...e){return sa(this,"splice",e)},toReversed(){return fo(this).toReversed()},toSorted(e){return fo(this).toSorted(e)},toSpliced(...e){return fo(this).toSpliced(...e)},unshift(...e){return sa(this,"unshift",e)},values(){return zc(this,"values",e=>er(this,e))}};function zc(e,t,n){const s=Pu(e),r=s[t]();return s!==e&&!jn(e)&&(r._next=r.next,r.next=()=>{const o=r._next();return o.done||(o.value=n(o.value)),o}),r}const wM=Array.prototype;function Is(e,t,n,s,r,o){const a=Pu(e),i=a!==e&&!jn(e),u=a[t];if(u!==wM[t]){const f=u.apply(e,o);return i?Yn(f):f}let c=n;a!==e&&(i?c=function(f,d){return n.call(this,er(e,f),d,e)}:n.length>2&&(c=function(f,d){return n.call(this,f,d,e)}));const l=u.call(a,c,s);return i&&r?r(l):l}function Sp(e,t,n,s){const r=Pu(e);let o=n;return r!==e&&(jn(e)?n.length>3&&(o=function(a,i,u){return n.call(this,a,i,u,e)}):o=function(a,i,u){return n.call(this,a,er(e,i),u,e)}),r[t](o,...s)}function Vc(e,t,n){const s=me(e);fn(s,"iterate",Ra);const r=s[t](...n);return(r===-1||r===!1)&&Lh(n[0])?(n[0]=me(n[0]),s[t](...n)):r}function sa(e,t,n=[]){zs(),Dh();const s=me(e)[t].apply(e,n);return Oh(),Vs(),s}const vM=Th("__proto__,__v_isRef,__isVue"),p0=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(ys));function kM(e){ys(e)||(e=String(e));const t=me(this);return fn(t,"has",e),t.hasOwnProperty(e)}class m0{constructor(t=!1,n=!1){this._isReadonly=t,this._isShallow=n}get(t,n,s){if(n==="__v_skip")return t.__v_skip;const r=this._isReadonly,o=this._isShallow;if(n==="__v_isReactive")return!r;if(n==="__v_isReadonly")return r;if(n==="__v_isShallow")return o;if(n==="__v_raw")return s===(r?o?AM:w0:o?b0:y0).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(s)?t:void 0;const a=Zt(t);if(!r){let u;if(a&&(u=bM[n]))return u;if(n==="hasOwnProperty")return kM}const i=Reflect.get(t,n,pn(t)?t:s);if((ys(n)?p0.has(n):vM(n))||(r||fn(t,"get",n),o))return i;if(pn(i)){const u=a&&Ch(n)?i:i.value;return r&&we(u)?Al(u):u}return we(i)?r?Al(i):Ph(i):i}}class g0 extends m0{constructor(t=!1){super(!1,t)}set(t,n,s,r){let o=t[n];const a=Zt(t)&&Ch(n);if(!this._isShallow){const c=Bs(o);if(!jn(s)&&!Bs(s)&&(o=me(o),s=me(s)),!a&&pn(o)&&!pn(s))return c||(o.value=s),!0}const i=a?Number(n)<t.length:ge(t,n),u=Reflect.set(t,n,s,pn(t)?t:r);return t===me(r)&&(i?En(s,o)&&As(t,"set",n,s):As(t,"add",n,s)),u}deleteProperty(t,n){const s=ge(t,n);t[n];const r=Reflect.deleteProperty(t,n);return r&&s&&As(t,"delete",n,void 0),r}has(t,n){const s=Reflect.has(t,n);return(!ys(n)||!p0.has(n))&&fn(t,"has",n),s}ownKeys(t){return fn(t,"iterate",Zt(t)?"length":Lr),Reflect.ownKeys(t)}}class xM extends m0{constructor(t=!1){super(!0,t)}set(t,n){return!0}deleteProperty(t,n){return!0}}const SM=new g0,IM=new xM,NM=new g0(!0);const Cl=e=>e,ki=e=>Reflect.getPrototypeOf(e);function _M(e,t,n){return function(...s){const r=this.__v_raw,o=me(r),a=Io(o),i=e==="entries"||e===Symbol.iterator&&a,u=e==="keys"&&a,c=r[e](...s),l=n?Cl:t?Po:Yn;return!t&&fn(o,"iterate",u?$l:Lr),tn(Object.create(c),{next(){const{value:f,done:d}=c.next();return d?{value:f,done:d}:{value:i?[l(f[0]),l(f[1])]:l(f),done:d}}})}}function xi(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function TM(e,t){const n={get(r){const o=this.__v_raw,a=me(o),i=me(r);e||(En(r,i)&&fn(a,"get",r),fn(a,"get",i));const{has:u}=ki(a),c=t?Cl:e?Po:Yn;if(u.call(a,r))return c(o.get(r));if(u.call(a,i))return c(o.get(i));o!==a&&o.get(r)},get size(){const r=this.__v_raw;return!e&&fn(me(r),"iterate",Lr),r.size},has(r){const o=this.__v_raw,a=me(o),i=me(r);return e||(En(r,i)&&fn(a,"has",r),fn(a,"has",i)),r===i?o.has(r):o.has(r)||o.has(i)},forEach(r,o){const a=this,i=a.__v_raw,u=me(i),c=t?Cl:e?Po:Yn;return!e&&fn(u,"iterate",Lr),i.forEach((l,f)=>r.call(o,c(l),c(f),a))}};return tn(n,e?{add:xi("add"),set:xi("set"),delete:xi("delete"),clear:xi("clear")}:{add(r){!t&&!jn(r)&&!Bs(r)&&(r=me(r));const o=me(this);return ki(o).has.call(o,r)||(o.add(r),As(o,"add",r,r)),this},set(r,o){!t&&!jn(o)&&!Bs(o)&&(o=me(o));const a=me(this),{has:i,get:u}=ki(a);let c=i.call(a,r);c||(r=me(r),c=i.call(a,r));const l=u.call(a,r);return a.set(r,o),c?En(o,l)&&As(a,"set",r,o):As(a,"add",r,o),this},delete(r){const o=me(this),{has:a,get:i}=ki(o);let u=a.call(o,r);u||(r=me(r),u=a.call(o,r)),i&&i.call(o,r);const c=o.delete(r);return u&&As(o,"delete",r,void 0),c},clear(){const r=me(this),o=r.size!==0,a=r.clear();return o&&As(r,"clear",void 0,void 0),a}}),["keys","values","entries",Symbol.iterator].forEach(r=>{n[r]=_M(r,e,t)}),n}function Rh(e,t){const n=TM(e,t);return(s,r,o)=>r==="__v_isReactive"?!e:r==="__v_isReadonly"?e:r==="__v_raw"?s:Reflect.get(ge(n,r)&&r in s?n:s,r,o)}const EM={get:Rh(!1,!1)},$M={get:Rh(!1,!0)},CM={get:Rh(!0,!1)};const y0=new WeakMap,b0=new WeakMap,w0=new WeakMap,AM=new WeakMap;function DM(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function OM(e){return e.__v_skip||!Object.isExtensible(e)?0:DM(rM(e))}function Ph(e){return Bs(e)?e:Mh(e,!1,SM,EM,y0)}function FM(e){return Mh(e,!1,NM,$M,b0)}function Al(e){return Mh(e,!0,IM,CM,w0)}function Mh(e,t,n,s,r){if(!we(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const o=OM(e);if(o===0)return e;const a=r.get(e);if(a)return a;const i=new Proxy(e,o===2?s:n);return r.set(e,i),i}function zr(e){return Bs(e)?zr(e.__v_raw):!!(e&&e.__v_isReactive)}function Bs(e){return!!(e&&e.__v_isReadonly)}function jn(e){return!!(e&&e.__v_isShallow)}function Lh(e){return e?!!e.__v_raw:!1}function me(e){const t=e&&e.__v_raw;return t?me(t):e}function RM(e){return!ge(e,"__v_skip")&&Object.isExtensible(e)&&t0(e,"__v_skip",!0),e}const Yn=e=>we(e)?Ph(e):e,Po=e=>we(e)?Al(e):e;function pn(e){return e?e.__v_isRef===!0:!1}function Se(e){return v0(e,!1)}function ru(e){return v0(e,!0)}function v0(e,t){return pn(e)?e:new PM(e,t)}class PM{constructor(t,n){this.dep=new Ru,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?t:me(t),this._value=n?t:Yn(t),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(t){const n=this._rawValue,s=this.__v_isShallow||jn(t)||Bs(t);t=s?t:me(t),En(t,n)&&(this._rawValue=t,this._value=s?t:Yn(t),this.dep.trigger())}}function Cn(e){return pn(e)?e.value:e}function lr(e){return ee(e)?e():Cn(e)}const MM={get:(e,t,n)=>t==="__v_raw"?e:Cn(Reflect.get(e,t,n)),set:(e,t,n,s)=>{const r=e[t];return pn(r)&&!pn(n)?(r.value=n,!0):Reflect.set(e,t,n,s)}};function k0(e){return zr(e)?e:new Proxy(e,MM)}class LM{constructor(t){this.__v_isRef=!0,this._value=void 0;const n=this.dep=new Ru,{get:s,set:r}=t(n.track.bind(n),n.trigger.bind(n));this._get=s,this._set=r}get value(){return this._value=this._get()}set value(t){this._set(t)}}function zM(e){return new LM(e)}class VM{constructor(t,n,s){this.fn=t,this.setter=n,this._value=void 0,this.dep=new Ru(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Fa-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&Ee!==this)return u0(this,!0),!0}get value(){const t=this.dep.track();return f0(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function BM(e,t,n=!1){let s,r;return ee(e)?s=e:(s=e.get,r=e.set),new VM(s,r,n)}const Si={},ou=new WeakMap;let Cr;function WM(e,t=!1,n=Cr){if(n){let s=ou.get(n);s||ou.set(n,s=[]),s.push(e)}}function jM(e,t,n=pe){const{immediate:s,deep:r,once:o,scheduler:a,augmentJob:i,call:u}=n,c=N=>r?N:jn(N)||r===!1||r===0?Ds(N,1):Ds(N);let l,f,d,m,g=!1,b=!1;if(pn(e)?(f=()=>e.value,g=jn(e)):zr(e)?(f=()=>c(e),g=!0):Zt(e)?(b=!0,g=e.some(N=>zr(N)||jn(N)),f=()=>e.map(N=>{if(pn(N))return N.value;if(zr(N))return c(N);if(ee(N))return u?u(N,2):N()})):ee(e)?t?f=u?()=>u(e,2):e:f=()=>{if(d){zs();try{d()}finally{Vs()}}const N=Cr;Cr=l;try{return u?u(e,3,[m]):e(m)}finally{Cr=N}}:f=ds,t&&r){const N=f,C=r===!0?1/0:r;f=()=>Ds(N(),C)}const y=o0(),v=()=>{l.stop(),y&&y.active&&$h(y.effects,l)};if(o&&t){const N=t;t=(...C)=>{N(...C),v()}}let I=b?new Array(e.length).fill(Si):Si;const _=N=>{if(!(!(l.flags&1)||!l.dirty&&!N))if(t){const C=l.run();if(r||g||(b?C.some((F,z)=>En(F,I[z])):En(C,I))){d&&d();const F=Cr;Cr=l;try{const z=[C,I===Si?void 0:b&&I[0]===Si?[]:I,m];I=C,u?u(t,3,z):t(...z)}finally{Cr=F}}}else l.run()};return i&&i(_),l=new a0(f),l.scheduler=a?()=>a(_,!1):_,m=N=>WM(N,!1,l),d=l.onStop=()=>{const N=ou.get(l);if(N){if(u)u(N,4);else for(const C of N)C();ou.delete(l)}},t?s?_(!0):I=l.run():a?a(_.bind(null,!0),!0):l.run(),v.pause=l.pause.bind(l),v.resume=l.resume.bind(l),v.stop=v,v}function Ds(e,t=1/0,n){if(t<=0||!we(e)||e.__v_skip||(n=n||new Map,(n.get(e)||0)>=t))return e;if(n.set(e,t),t--,pn(e))Ds(e.value,t,n);else if(Zt(e))for(let s=0;s<e.length;s++)Ds(e[s],t,n);else if(Du(e)||Io(e))e.forEach(s=>{Ds(s,t,n)});else if(Qb(e)){for(const s in e)Ds(e[s],t,n);for(const s of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,s)&&Ds(e[s],t,n)}return e}/**
* @vue/runtime-core v3.5.28
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Ka(e,t,n,s){try{return s?e(...s):e()}catch(r){Mu(r,t,n)}}function bs(e,t,n,s){if(ee(e)){const r=Ka(e,t,n,s);return r&&Yb(r)&&r.catch(o=>{Mu(o,t,n)}),r}if(Zt(e)){const r=[];for(let o=0;o<e.length;o++)r.push(bs(e[o],t,n,s));return r}}function Mu(e,t,n,s=!0){const r=t?t.vnode:null,{errorHandler:o,throwUnhandledErrorInProduction:a}=t&&t.appContext.config||pe;if(t){let i=t.parent;const u=t.proxy,c=`https://vuejs.org/error-reference/#runtime-${n}`;for(;i;){const l=i.ec;if(l){for(let f=0;f<l.length;f++)if(l[f](e,u,c)===!1)return}i=i.parent}if(o){zs(),Ka(o,null,10,[e,u,c]),Vs();return}}HM(e,n,r,s,a)}function HM(e,t,n,s=!0,r=!1){if(r)throw e;console.error(e)}const bn=[];let os=-1;const No=[];let nr=null,yo=0;const x0=Promise.resolve();let au=null;function Pa(e){const t=au||x0;return e?t.then(this?e.bind(this):e):t}function qM(e){let t=os+1,n=bn.length;for(;t<n;){const s=t+n>>>1,r=bn[s],o=Ma(r);o<e||o===e&&r.flags&2?t=s+1:n=s}return t}function zh(e){if(!(e.flags&1)){const t=Ma(e),n=bn[bn.length-1];!n||!(e.flags&2)&&t>=Ma(n)?bn.push(e):bn.splice(qM(t),0,e),e.flags|=1,S0()}}function S0(){au||(au=x0.then(N0))}function KM(e){Zt(e)?No.push(...e):nr&&e.id===-1?nr.splice(yo+1,0,e):e.flags&1||(No.push(e),e.flags|=1),S0()}function Ip(e,t,n=os+1){for(;n<bn.length;n++){const s=bn[n];if(s&&s.flags&2){if(e&&s.id!==e.uid)continue;bn.splice(n,1),n--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function I0(e){if(No.length){const t=[...new Set(No)].sort((n,s)=>Ma(n)-Ma(s));if(No.length=0,nr){nr.push(...t);return}for(nr=t,yo=0;yo<nr.length;yo++){const n=nr[yo];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}nr=null,yo=0}}const Ma=e=>e.id==null?e.flags&2?-1:1/0:e.id;function N0(e){try{for(os=0;os<bn.length;os++){const t=bn[os];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Ka(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;os<bn.length;os++){const t=bn[os];t&&(t.flags&=-2)}os=-1,bn.length=0,I0(),au=null,(bn.length||No.length)&&N0()}}let Bn=null,_0=null;function iu(e){const t=Bn;return Bn=e,_0=e&&e.type.__scopeId||null,t}function UM(e,t=Bn,n){if(!t||e._n)return e;const s=(...r)=>{s._d&&Mp(-1);const o=iu(t);let a;try{a=e(...r)}finally{iu(o),s._d&&Mp(1)}return a};return s._n=!0,s._c=!0,s._d=!0,s}function as(e,t){if(Bn===null)return e;const n=Ku(Bn),s=e.dirs||(e.dirs=[]);for(let r=0;r<t.length;r++){let[o,a,i,u=pe]=t[r];o&&(ee(o)&&(o={mounted:o,updated:o}),o.deep&&Ds(a),s.push({dir:o,instance:n,value:a,oldValue:void 0,arg:i,modifiers:u}))}return e}function Tr(e,t,n,s){const r=e.dirs,o=t&&t.dirs;for(let a=0;a<r.length;a++){const i=r[a];o&&(i.oldValue=o[a].value);let u=i.dir[s];u&&(zs(),bs(u,n,8,[e.el,i,e,t]),Vs())}}function GM(e,t){if(vn){let n=vn.provides;const s=vn.parent&&vn.parent.provides;s===n&&(n=vn.provides=Object.create(s)),n[e]=t}}function Li(e,t,n=!1){const s=qu();if(s||_o){let r=_o?_o._context.provides:s?s.parent==null||s.ce?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(r&&e in r)return r[e];if(arguments.length>1)return n&&ee(t)?t.call(s&&s.proxy):t}}const XM=Symbol.for("v-scx"),YM=()=>Li(XM);function Lu(e,t){return zu(e,null,t)}function ZM(e,t){return zu(e,null,{flush:"sync"})}function ps(e,t,n){return zu(e,t,n)}function zu(e,t,n=pe){const{immediate:s,deep:r,flush:o,once:a}=n,i=tn({},n),u=t&&s||!t&&o!=="post";let c;if(za){if(o==="sync"){const m=YM();c=m.__watcherHandles||(m.__watcherHandles=[])}else if(!u){const m=()=>{};return m.stop=ds,m.resume=ds,m.pause=ds,m}}const l=vn;i.call=(m,g,b)=>bs(m,l,g,b);let f=!1;o==="post"?i.scheduler=m=>{on(m,l&&l.suspense)}:o!=="sync"&&(f=!0,i.scheduler=(m,g)=>{g?m():zh(m)}),i.augmentJob=m=>{t&&(m.flags|=4),f&&(m.flags|=2,l&&(m.id=l.uid,m.i=l))};const d=jM(e,t,i);return za&&(c?c.push(d):u&&d()),d}function QM(e,t,n){const s=this.proxy,r=He(e)?e.includes(".")?T0(s,e):()=>s[e]:e.bind(s,s);let o;ee(t)?o=t:(o=t.handler,n=t);const a=Ga(this),i=zu(r,o.bind(s),n);return a(),i}function T0(e,t){const n=t.split(".");return()=>{let s=e;for(let r=0;r<n.length&&s;r++)s=s[n[r]];return s}}const E0=Symbol("_vte"),JM=e=>e.__isTeleport,ya=e=>e&&(e.disabled||e.disabled===""),Np=e=>e&&(e.defer||e.defer===""),_p=e=>typeof SVGElement<"u"&&e instanceof SVGElement,Tp=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,Dl=(e,t)=>{const n=e&&e.to;return He(n)?t?t(n):null:n},$0={name:"Teleport",__isTeleport:!0,process(e,t,n,s,r,o,a,i,u,c){const{mc:l,pc:f,pbc:d,o:{insert:m,querySelector:g,createText:b,createComment:y}}=c,v=ya(t.props);let{shapeFlag:I,children:_,dynamicChildren:N}=t;if(e==null){const C=t.el=b(""),F=t.anchor=b("");m(C,n,s),m(F,n,s);const z=(D,L)=>{I&16&&l(_,D,L,r,o,a,i,u)},P=()=>{const D=t.target=Dl(t.props,g),L=Ol(D,t,b,m);D&&(a!=="svg"&&_p(D)?a="svg":a!=="mathml"&&Tp(D)&&(a="mathml"),r&&r.isCE&&(r.ce._teleportTargets||(r.ce._teleportTargets=new Set)).add(D),v||(z(D,L),zi(t,!1)))};v&&(z(n,F),zi(t,!0)),Np(t.props)?(t.el.__isMounted=!1,on(()=>{P(),delete t.el.__isMounted},o)):P()}else{if(Np(t.props)&&e.el.__isMounted===!1){on(()=>{$0.process(e,t,n,s,r,o,a,i,u,c)},o);return}t.el=e.el,t.targetStart=e.targetStart;const C=t.anchor=e.anchor,F=t.target=e.target,z=t.targetAnchor=e.targetAnchor,P=ya(e.props),D=P?n:F,L=P?C:z;if(a==="svg"||_p(F)?a="svg":(a==="mathml"||Tp(F))&&(a="mathml"),N?(d(e.dynamicChildren,N,D,r,o,a,i),jh(e,t,!0)):u||f(e,t,D,L,r,o,a,i,!1),v)P?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):Ii(t,n,C,c,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const T=t.target=Dl(t.props,g);T&&Ii(t,T,null,c,0)}else P&&Ii(t,F,z,c,1);zi(t,v)}},remove(e,t,n,{um:s,o:{remove:r}},o){const{shapeFlag:a,children:i,anchor:u,targetStart:c,targetAnchor:l,target:f,props:d}=e;if(f&&(r(c),r(l)),o&&r(u),a&16){const m=o||!ya(d);for(let g=0;g<i.length;g++){const b=i[g];s(b,t,n,m,!!b.dynamicChildren)}}},move:Ii,hydrate:tL};function Ii(e,t,n,{o:{insert:s},m:r},o=2){o===0&&s(e.targetAnchor,t,n);const{el:a,anchor:i,shapeFlag:u,children:c,props:l}=e,f=o===2;if(f&&s(a,t,n),(!f||ya(l))&&u&16)for(let d=0;d<c.length;d++)r(c[d],t,n,2);f&&s(i,t,n)}function tL(e,t,n,s,r,o,{o:{nextSibling:a,parentNode:i,querySelector:u,insert:c,createText:l}},f){function d(y,v){let I=v;for(;I;){if(I&&I.nodeType===8){if(I.data==="teleport start anchor")t.targetStart=I;else if(I.data==="teleport anchor"){t.targetAnchor=I,y._lpa=t.targetAnchor&&a(t.targetAnchor);break}}I=a(I)}}function m(y,v){v.anchor=f(a(y),v,i(y),n,s,r,o)}const g=t.target=Dl(t.props,u),b=ya(t.props);if(g){const y=g._lpa||g.firstChild;t.shapeFlag&16&&(b?(m(e,t),d(g,y),t.targetAnchor||Ol(g,t,l,c,i(e)===g?e:null)):(t.anchor=a(e),d(g,y),t.targetAnchor||Ol(g,t,l,c),f(y&&a(y),t,g,n,s,r,o))),zi(t,b)}else b&&t.shapeFlag&16&&(m(e,t),t.targetStart=e,t.targetAnchor=a(e));return t.anchor&&a(t.anchor)}const eL=$0;function zi(e,t){const n=e.ctx;if(n&&n.ut){let s,r;for(t?(s=e.el,r=e.anchor):(s=e.targetStart,r=e.targetAnchor);s&&s!==r;)s.nodeType===1&&s.setAttribute("data-v-owner",n.uid),s=s.nextSibling;n.ut()}}function Ol(e,t,n,s,r=null){const o=t.targetStart=n(""),a=t.targetAnchor=n("");return o[E0]=a,e&&(s(o,e,r),s(a,e,r)),a}const nL=Symbol("_leaveCb");function Vh(e,t){e.shapeFlag&6&&e.component?(e.transition=t,Vh(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Hs(e,t){return ee(e)?tn({name:e.name},t,{setup:e}):e}function C0(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function Ep(e,t){let n;return!!((n=Object.getOwnPropertyDescriptor(e,t))&&!n.configurable)}const uu=new WeakMap;function ba(e,t,n,s,r=!1){if(Zt(e)){e.forEach((b,y)=>ba(b,t&&(Zt(t)?t[y]:t),n,s,r));return}if(wa(s)&&!r){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&ba(e,t,n,s.component.subTree);return}const o=s.shapeFlag&4?Ku(s.component):s.el,a=r?null:o,{i,r:u}=e,c=t&&t.r,l=i.refs===pe?i.refs={}:i.refs,f=i.setupState,d=me(f),m=f===pe?Xb:b=>Ep(l,b)?!1:ge(d,b),g=(b,y)=>!(y&&Ep(l,y));if(c!=null&&c!==u){if($p(t),He(c))l[c]=null,m(c)&&(f[c]=null);else if(pn(c)){const b=t;g(c,b.k)&&(c.value=null),b.k&&(l[b.k]=null)}}if(ee(u))Ka(u,i,12,[a,l]);else{const b=He(u),y=pn(u);if(b||y){const v=()=>{if(e.f){const I=b?m(u)?f[u]:l[u]:g()||!e.k?u.value:l[e.k];if(r)Zt(I)&&$h(I,o);else if(Zt(I))I.includes(o)||I.push(o);else if(b)l[u]=[o],m(u)&&(f[u]=l[u]);else{const _=[o];g(u,e.k)&&(u.value=_),e.k&&(l[e.k]=_)}}else b?(l[u]=a,m(u)&&(f[u]=a)):y&&(g(u,e.k)&&(u.value=a),e.k&&(l[e.k]=a))};if(a){const I=()=>{v(),uu.delete(e)};I.id=-1,uu.set(e,I),on(I,n)}else $p(e),v()}}}function $p(e){const t=uu.get(e);t&&(t.flags|=8,uu.delete(e))}Fu().requestIdleCallback;Fu().cancelIdleCallback;const wa=e=>!!e.type.__asyncLoader,A0=e=>e.type.__isKeepAlive;function sL(e,t){D0(e,"a",t)}function rL(e,t){D0(e,"da",t)}function D0(e,t,n=vn){const s=e.__wdc||(e.__wdc=()=>{let r=n;for(;r;){if(r.isDeactivated)return;r=r.parent}return e()});if(Vu(t,s,n),n){let r=n.parent;for(;r&&r.parent;)A0(r.parent.vnode)&&oL(s,t,n,r),r=r.parent}}function oL(e,t,n,s){const r=Vu(t,e,s,!0);Wu(()=>{$h(s[t],r)},n)}function Vu(e,t,n=vn,s=!1){if(n){const r=n[e]||(n[e]=[]),o=t.__weh||(t.__weh=(...a)=>{zs();const i=Ga(n),u=bs(t,n,e,a);return i(),Vs(),u});return s?r.unshift(o):r.push(o),o}}const qs=e=>(t,n=vn)=>{(!za||e==="sp")&&Vu(e,(...s)=>t(...s),n)},aL=qs("bm"),Ua=qs("m"),iL=qs("bu"),uL=qs("u"),Bu=qs("bum"),Wu=qs("um"),cL=qs("sp"),lL=qs("rtg"),fL=qs("rtc");function hL(e,t=vn){Vu("ec",e,t)}const dL=Symbol.for("v-ndc");function ms(e,t,n,s){let r;const o=n,a=Zt(e);if(a||He(e)){const i=a&&zr(e);let u=!1,c=!1;i&&(u=!jn(e),c=Bs(e),e=Pu(e)),r=new Array(e.length);for(let l=0,f=e.length;l<f;l++)r[l]=t(u?c?Po(Yn(e[l])):Yn(e[l]):e[l],l,void 0,o)}else if(typeof e=="number"){r=new Array(e);for(let i=0;i<e;i++)r[i]=t(i+1,i,void 0,o)}else if(we(e))if(e[Symbol.iterator])r=Array.from(e,(i,u)=>t(i,u,void 0,o));else{const i=Object.keys(e);r=new Array(i.length);for(let u=0,c=i.length;u<c;u++){const l=i[u];r[u]=t(e[l],l,u,o)}}else r=[];return r}const Fl=e=>e?ew(e)?Ku(e):Fl(e.parent):null,va=tn(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Fl(e.parent),$root:e=>Fl(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>F0(e),$forceUpdate:e=>e.f||(e.f=()=>{zh(e.update)}),$nextTick:e=>e.n||(e.n=Pa.bind(e.proxy)),$watch:e=>QM.bind(e)}),Bc=(e,t)=>e!==pe&&!e.__isScriptSetup&&ge(e,t),pL={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:n,setupState:s,data:r,props:o,accessCache:a,type:i,appContext:u}=e;if(t[0]!=="$"){const d=a[t];if(d!==void 0)switch(d){case 1:return s[t];case 2:return r[t];case 4:return n[t];case 3:return o[t]}else{if(Bc(s,t))return a[t]=1,s[t];if(r!==pe&&ge(r,t))return a[t]=2,r[t];if(ge(o,t))return a[t]=3,o[t];if(n!==pe&&ge(n,t))return a[t]=4,n[t];Pl&&(a[t]=0)}}const c=va[t];let l,f;if(c)return t==="$attrs"&&fn(e.attrs,"get",""),c(e);if((l=i.__cssModules)&&(l=l[t]))return l;if(n!==pe&&ge(n,t))return a[t]=4,n[t];if(f=u.config.globalProperties,ge(f,t))return f[t]},set({_:e},t,n){const{data:s,setupState:r,ctx:o}=e;return Bc(r,t)?(r[t]=n,!0):s!==pe&&ge(s,t)?(s[t]=n,!0):ge(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(o[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:s,appContext:r,props:o,type:a}},i){let u;return!!(n[i]||e!==pe&&i[0]!=="$"&&ge(e,i)||Bc(t,i)||ge(o,i)||ge(s,i)||ge(va,i)||ge(r.config.globalProperties,i)||(u=a.__cssModules)&&u[i])},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:ge(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function cu(e){return Zt(e)?e.reduce((t,n)=>(t[n]=null,t),{}):e}function Rl(e,t){return!e||!t?e||t:Zt(e)&&Zt(t)?e.concat(t):tn({},cu(e),cu(t))}let Pl=!0;function mL(e){const t=F0(e),n=e.proxy,s=e.ctx;Pl=!1,t.beforeCreate&&Cp(t.beforeCreate,e,"bc");const{data:r,computed:o,methods:a,watch:i,provide:u,inject:c,created:l,beforeMount:f,mounted:d,beforeUpdate:m,updated:g,activated:b,deactivated:y,beforeDestroy:v,beforeUnmount:I,destroyed:_,unmounted:N,render:C,renderTracked:F,renderTriggered:z,errorCaptured:P,serverPrefetch:D,expose:L,inheritAttrs:T,components:K,directives:Z,filters:rt}=t;if(c&&gL(c,s,null),a)for(const it in a){const tt=a[it];ee(tt)&&(s[it]=tt.bind(n))}if(r){const it=r.call(n,n);we(it)&&(e.data=Ph(it))}if(Pl=!0,o)for(const it in o){const tt=o[it],ut=ee(tt)?tt.bind(n,n):ee(tt.get)?tt.get.bind(n,n):ds,ft=!ee(tt)&&ee(tt.set)?tt.set.bind(n):ds,yt=kn({get:ut,set:ft});Object.defineProperty(s,it,{enumerable:!0,configurable:!0,get:()=>yt.value,set:pt=>yt.value=pt})}if(i)for(const it in i)O0(i[it],s,n,it);if(u){const it=ee(u)?u.call(n):u;Reflect.ownKeys(it).forEach(tt=>{GM(tt,it[tt])})}l&&Cp(l,e,"c");function nt(it,tt){Zt(tt)?tt.forEach(ut=>it(ut.bind(n))):tt&&it(tt.bind(n))}if(nt(aL,f),nt(Ua,d),nt(iL,m),nt(uL,g),nt(sL,b),nt(rL,y),nt(hL,P),nt(fL,F),nt(lL,z),nt(Bu,I),nt(Wu,N),nt(cL,D),Zt(L))if(L.length){const it=e.exposed||(e.exposed={});L.forEach(tt=>{Object.defineProperty(it,tt,{get:()=>n[tt],set:ut=>n[tt]=ut,enumerable:!0})})}else e.exposed||(e.exposed={});C&&e.render===ds&&(e.render=C),T!=null&&(e.inheritAttrs=T),K&&(e.components=K),Z&&(e.directives=Z),D&&C0(e)}function gL(e,t,n=ds){Zt(e)&&(e=Ml(e));for(const s in e){const r=e[s];let o;we(r)?"default"in r?o=Li(r.from||s,r.default,!0):o=Li(r.from||s):o=Li(r),pn(o)?Object.defineProperty(t,s,{enumerable:!0,configurable:!0,get:()=>o.value,set:a=>o.value=a}):t[s]=o}}function Cp(e,t,n){bs(Zt(e)?e.map(s=>s.bind(t.proxy)):e.bind(t.proxy),t,n)}function O0(e,t,n,s){let r=s.includes(".")?T0(n,s):()=>n[s];if(He(e)){const o=t[e];ee(o)&&ps(r,o)}else if(ee(e))ps(r,e.bind(n));else if(we(e))if(Zt(e))e.forEach(o=>O0(o,t,n,s));else{const o=ee(e.handler)?e.handler.bind(n):t[e.handler];ee(o)&&ps(r,o,e)}}function F0(e){const t=e.type,{mixins:n,extends:s}=t,{mixins:r,optionsCache:o,config:{optionMergeStrategies:a}}=e.appContext,i=o.get(t);let u;return i?u=i:!r.length&&!n&&!s?u=t:(u={},r.length&&r.forEach(c=>lu(u,c,a,!0)),lu(u,t,a)),we(t)&&o.set(t,u),u}function lu(e,t,n,s=!1){const{mixins:r,extends:o}=t;o&&lu(e,o,n,!0),r&&r.forEach(a=>lu(e,a,n,!0));for(const a in t)if(!(s&&a==="expose")){const i=yL[a]||n&&n[a];e[a]=i?i(e[a],t[a]):t[a]}return e}const yL={data:Ap,props:Dp,emits:Dp,methods:la,computed:la,beforeCreate:yn,created:yn,beforeMount:yn,mounted:yn,beforeUpdate:yn,updated:yn,beforeDestroy:yn,beforeUnmount:yn,destroyed:yn,unmounted:yn,activated:yn,deactivated:yn,errorCaptured:yn,serverPrefetch:yn,components:la,directives:la,watch:wL,provide:Ap,inject:bL};function Ap(e,t){return t?e?function(){return tn(ee(e)?e.call(this,this):e,ee(t)?t.call(this,this):t)}:t:e}function bL(e,t){return la(Ml(e),Ml(t))}function Ml(e){if(Zt(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function yn(e,t){return e?[...new Set([].concat(e,t))]:t}function la(e,t){return e?tn(Object.create(null),e,t):t}function Dp(e,t){return e?Zt(e)&&Zt(t)?[...new Set([...e,...t])]:tn(Object.create(null),cu(e),cu(t??{})):t}function wL(e,t){if(!e)return t;if(!t)return e;const n=tn(Object.create(null),e);for(const s in t)n[s]=yn(e[s],t[s]);return n}function R0(){return{app:null,config:{isNativeTag:Xb,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let vL=0;function kL(e,t){return function(s,r=null){ee(s)||(s=tn({},s)),r!=null&&!we(r)&&(r=null);const o=R0(),a=new WeakSet,i=[];let u=!1;const c=o.app={_uid:vL++,_component:s,_props:r,_container:null,_context:o,_instance:null,version:YL,get config(){return o.config},set config(l){},use(l,...f){return a.has(l)||(l&&ee(l.install)?(a.add(l),l.install(c,...f)):ee(l)&&(a.add(l),l(c,...f))),c},mixin(l){return o.mixins.includes(l)||o.mixins.push(l),c},component(l,f){return f?(o.components[l]=f,c):o.components[l]},directive(l,f){return f?(o.directives[l]=f,c):o.directives[l]},mount(l,f,d){if(!u){const m=c._ceVNode||Hn(s,r);return m.appContext=o,d===!0?d="svg":d===!1&&(d=void 0),e(m,l,d),u=!0,c._container=l,l.__vue_app__=c,Ku(m.component)}},onUnmount(l){i.push(l)},unmount(){u&&(bs(i,c._instance,16),e(null,c._container),delete c._container.__vue_app__)},provide(l,f){return o.provides[l]=f,c},runWithContext(l){const f=_o;_o=c;try{return l()}finally{_o=f}}};return c}}let _o=null;function P0(e,t,n=pe){const s=qu(),r=Ls(t),o=wr(t),a=M0(e,r),i=zM((u,c)=>{let l,f=pe,d;return ZM(()=>{const m=e[r];En(l,m)&&(l=m,c())}),{get(){return u(),n.get?n.get(l):l},set(m){const g=n.set?n.set(m):m;if(!En(g,l)&&!(f!==pe&&En(m,f)))return;const b=s.vnode.props;b&&(t in b||r in b||o in b)&&(`onUpdate:${t}`in b||`onUpdate:${r}`in b||`onUpdate:${o}`in b)||(l=m,c()),s.emit(`update:${t}`,g),En(m,g)&&En(m,f)&&!En(g,d)&&c(),f=m,d=g}}});return i[Symbol.iterator]=()=>{let u=0;return{next(){return u<2?{value:u++?a||pe:i,done:!1}:{done:!0}}}},i}const M0=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${Ls(t)}Modifiers`]||e[`${wr(t)}Modifiers`];function xL(e,t,...n){if(e.isUnmounted)return;const s=e.vnode.props||pe;let r=n;const o=t.startsWith("update:"),a=o&&M0(s,t.slice(7));a&&(a.trim&&(r=n.map(l=>He(l)?l.trim():l)),a.number&&(r=n.map(Ah)));let i,u=s[i=Pc(t)]||s[i=Pc(Ls(t))];!u&&o&&(u=s[i=Pc(wr(t))]),u&&bs(u,e,6,r);const c=s[i+"Once"];if(c){if(!e.emitted)e.emitted={};else if(e.emitted[i])return;e.emitted[i]=!0,bs(c,e,6,r)}}const SL=new WeakMap;function L0(e,t,n=!1){const s=n?SL:t.emitsCache,r=s.get(e);if(r!==void 0)return r;const o=e.emits;let a={},i=!1;if(!ee(e)){const u=c=>{const l=L0(c,t,!0);l&&(i=!0,tn(a,l))};!n&&t.mixins.length&&t.mixins.forEach(u),e.extends&&u(e.extends),e.mixins&&e.mixins.forEach(u)}return!o&&!i?(we(e)&&s.set(e,null),null):(Zt(o)?o.forEach(u=>a[u]=null):tn(a,o),we(e)&&s.set(e,a),a)}function ju(e,t){return!e||!Au(t)?!1:(t=t.slice(2).replace(/Once$/,""),ge(e,t[0].toLowerCase()+t.slice(1))||ge(e,wr(t))||ge(e,t))}function Op(e){const{type:t,vnode:n,proxy:s,withProxy:r,propsOptions:[o],slots:a,attrs:i,emit:u,render:c,renderCache:l,props:f,data:d,setupState:m,ctx:g,inheritAttrs:b}=e,y=iu(e);let v,I;try{if(n.shapeFlag&4){const N=r||s,C=N;v=us(c.call(C,N,l,f,m,d,g)),I=i}else{const N=t;v=us(N.length>1?N(f,{attrs:i,slots:a,emit:u}):N(f,null)),I=t.props?i:IL(i)}}catch(N){ka.length=0,Mu(N,e,1),v=Hn(pr)}let _=v;if(I&&b!==!1){const N=Object.keys(I),{shapeFlag:C}=_;N.length&&C&7&&(o&&N.some(Eh)&&(I=NL(I,o)),_=Mo(_,I,!1,!0))}return n.dirs&&(_=Mo(_,null,!1,!0),_.dirs=_.dirs?_.dirs.concat(n.dirs):n.dirs),n.transition&&Vh(_,n.transition),v=_,iu(y),v}const IL=e=>{let t;for(const n in e)(n==="class"||n==="style"||Au(n))&&((t||(t={}))[n]=e[n]);return t},NL=(e,t)=>{const n={};for(const s in e)(!Eh(s)||!(s.slice(9)in t))&&(n[s]=e[s]);return n};function _L(e,t,n){const{props:s,children:r,component:o}=e,{props:a,children:i,patchFlag:u}=t,c=o.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&u>=0){if(u&1024)return!0;if(u&16)return s?Fp(s,a,c):!!a;if(u&8){const l=t.dynamicProps;for(let f=0;f<l.length;f++){const d=l[f];if(z0(a,s,d)&&!ju(c,d))return!0}}}else return(r||i)&&(!i||!i.$stable)?!0:s===a?!1:s?a?Fp(s,a,c):!0:!!a;return!1}function Fp(e,t,n){const s=Object.keys(t);if(s.length!==Object.keys(e).length)return!0;for(let r=0;r<s.length;r++){const o=s[r];if(z0(t,e,o)&&!ju(n,o))return!0}return!1}function z0(e,t,n){const s=e[n],r=t[n];return n==="style"&&we(s)&&we(r)?!Zr(s,r):s!==r}function TL({vnode:e,parent:t},n){for(;t;){const s=t.subTree;if(s.suspense&&s.suspense.activeBranch===e&&(s.el=e.el),s===e)(e=t.vnode).el=n,t=t.parent;else break}}const V0={},B0=()=>Object.create(V0),W0=e=>Object.getPrototypeOf(e)===V0;function EL(e,t,n,s=!1){const r={},o=B0();e.propsDefaults=Object.create(null),j0(e,t,r,o);for(const a in e.propsOptions[0])a in r||(r[a]=void 0);n?e.props=s?r:FM(r):e.type.props?e.props=r:e.props=o,e.attrs=o}function $L(e,t,n,s){const{props:r,attrs:o,vnode:{patchFlag:a}}=e,i=me(r),[u]=e.propsOptions;let c=!1;if((s||a>0)&&!(a&16)){if(a&8){const l=e.vnode.dynamicProps;for(let f=0;f<l.length;f++){let d=l[f];if(ju(e.emitsOptions,d))continue;const m=t[d];if(u)if(ge(o,d))m!==o[d]&&(o[d]=m,c=!0);else{const g=Ls(d);r[g]=Ll(u,i,g,m,e,!1)}else m!==o[d]&&(o[d]=m,c=!0)}}}else{j0(e,t,r,o)&&(c=!0);let l;for(const f in i)(!t||!ge(t,f)&&((l=wr(f))===f||!ge(t,l)))&&(u?n&&(n[f]!==void 0||n[l]!==void 0)&&(r[f]=Ll(u,i,f,void 0,e,!0)):delete r[f]);if(o!==i)for(const f in o)(!t||!ge(t,f))&&(delete o[f],c=!0)}c&&As(e.attrs,"set","")}function j0(e,t,n,s){const[r,o]=e.propsOptions;let a=!1,i;if(t)for(let u in t){if(pa(u))continue;const c=t[u];let l;r&&ge(r,l=Ls(u))?!o||!o.includes(l)?n[l]=c:(i||(i={}))[l]=c:ju(e.emitsOptions,u)||(!(u in s)||c!==s[u])&&(s[u]=c,a=!0)}if(o){const u=me(n),c=i||pe;for(let l=0;l<o.length;l++){const f=o[l];n[f]=Ll(r,u,f,c[f],e,!ge(c,f))}}return a}function Ll(e,t,n,s,r,o){const a=e[n];if(a!=null){const i=ge(a,"default");if(i&&s===void 0){const u=a.default;if(a.type!==Function&&!a.skipFactory&&ee(u)){const{propsDefaults:c}=r;if(n in c)s=c[n];else{const l=Ga(r);s=c[n]=u.call(null,t),l()}}else s=u;r.ce&&r.ce._setProp(n,s)}a[0]&&(o&&!i?s=!1:a[1]&&(s===""||s===wr(n))&&(s=!0))}return s}const CL=new WeakMap;function H0(e,t,n=!1){const s=n?CL:t.propsCache,r=s.get(e);if(r)return r;const o=e.props,a={},i=[];let u=!1;if(!ee(e)){const l=f=>{u=!0;const[d,m]=H0(f,t,!0);tn(a,d),m&&i.push(...m)};!n&&t.mixins.length&&t.mixins.forEach(l),e.extends&&l(e.extends),e.mixins&&e.mixins.forEach(l)}if(!o&&!u)return we(e)&&s.set(e,So),So;if(Zt(o))for(let l=0;l<o.length;l++){const f=Ls(o[l]);Rp(f)&&(a[f]=pe)}else if(o)for(const l in o){const f=Ls(l);if(Rp(f)){const d=o[l],m=a[f]=Zt(d)||ee(d)?{type:d}:tn({},d),g=m.type;let b=!1,y=!0;if(Zt(g))for(let v=0;v<g.length;++v){const I=g[v],_=ee(I)&&I.name;if(_==="Boolean"){b=!0;break}else _==="String"&&(y=!1)}else b=ee(g)&&g.name==="Boolean";m[0]=b,m[1]=y,(b||ge(m,"default"))&&i.push(f)}}const c=[a,i];return we(e)&&s.set(e,c),c}function Rp(e){return e[0]!=="$"&&!pa(e)}const Bh=e=>e==="_"||e==="_ctx"||e==="$stable",Wh=e=>Zt(e)?e.map(us):[us(e)],AL=(e,t,n)=>{if(t._n)return t;const s=UM((...r)=>Wh(t(...r)),n);return s._c=!1,s},q0=(e,t,n)=>{const s=e._ctx;for(const r in e){if(Bh(r))continue;const o=e[r];if(ee(o))t[r]=AL(r,o,s);else if(o!=null){const a=Wh(o);t[r]=()=>a}}},K0=(e,t)=>{const n=Wh(t);e.slots.default=()=>n},U0=(e,t,n)=>{for(const s in t)(n||!Bh(s))&&(e[s]=t[s])},DL=(e,t,n)=>{const s=e.slots=B0();if(e.vnode.shapeFlag&32){const r=t._;r?(U0(s,t,n),n&&t0(s,"_",r,!0)):q0(t,s)}else t&&K0(e,t)},OL=(e,t,n)=>{const{vnode:s,slots:r}=e;let o=!0,a=pe;if(s.shapeFlag&32){const i=t._;i?n&&i===1?o=!1:U0(r,t,n):(o=!t.$stable,q0(t,r)),a=t}else t&&(K0(e,t),a={default:1});if(o)for(const i in r)!Bh(i)&&a[i]==null&&delete r[i]},on=LL;function FL(e){return RL(e)}function RL(e,t){const n=Fu();n.__VUE__=!0;const{insert:s,remove:r,patchProp:o,createElement:a,createText:i,createComment:u,setText:c,setElementText:l,parentNode:f,nextSibling:d,setScopeId:m=ds,insertStaticContent:g}=e,b=(R,B,ot,lt=null,ct=null,ht=null,kt=void 0,Tt=null,wt=!!B.dynamicChildren)=>{if(R===B)return;R&&!ra(R,B)&&(lt=Mt(R),pt(R,ct,ht,!0),R=null),B.patchFlag===-2&&(wt=!1,B.dynamicChildren=null);const{type:mt,ref:Bt,shapeFlag:Ct}=B;switch(mt){case Hu:y(R,B,ot,lt);break;case pr:v(R,B,ot,lt);break;case jc:R==null&&I(B,ot,lt,kt);break;case Oe:K(R,B,ot,lt,ct,ht,kt,Tt,wt);break;default:Ct&1?C(R,B,ot,lt,ct,ht,kt,Tt,wt):Ct&6?Z(R,B,ot,lt,ct,ht,kt,Tt,wt):(Ct&64||Ct&128)&&mt.process(R,B,ot,lt,ct,ht,kt,Tt,wt,vt)}Bt!=null&&ct?ba(Bt,R&&R.ref,ht,B||R,!B):Bt==null&&R&&R.ref!=null&&ba(R.ref,null,ht,R,!0)},y=(R,B,ot,lt)=>{if(R==null)s(B.el=i(B.children),ot,lt);else{const ct=B.el=R.el;B.children!==R.children&&c(ct,B.children)}},v=(R,B,ot,lt)=>{R==null?s(B.el=u(B.children||""),ot,lt):B.el=R.el},I=(R,B,ot,lt)=>{[R.el,R.anchor]=g(R.children,B,ot,lt,R.el,R.anchor)},_=({el:R,anchor:B},ot,lt)=>{let ct;for(;R&&R!==B;)ct=d(R),s(R,ot,lt),R=ct;s(B,ot,lt)},N=({el:R,anchor:B})=>{let ot;for(;R&&R!==B;)ot=d(R),r(R),R=ot;r(B)},C=(R,B,ot,lt,ct,ht,kt,Tt,wt)=>{if(B.type==="svg"?kt="svg":B.type==="math"&&(kt="mathml"),R==null)F(B,ot,lt,ct,ht,kt,Tt,wt);else{const mt=R.el&&R.el._isVueCE?R.el:null;try{mt&&mt._beginPatch(),D(R,B,ct,ht,kt,Tt,wt)}finally{mt&&mt._endPatch()}}},F=(R,B,ot,lt,ct,ht,kt,Tt)=>{let wt,mt;const{props:Bt,shapeFlag:Ct,transition:zt,dirs:Ht}=R;if(wt=R.el=a(R.type,ht,Bt&&Bt.is,Bt),Ct&8?l(wt,R.children):Ct&16&&P(R.children,wt,null,lt,ct,Wc(R,ht),kt,Tt),Ht&&Tr(R,null,lt,"created"),z(wt,R,R.scopeId,kt,lt),Bt){for(const te in Bt)te!=="value"&&!pa(te)&&o(wt,te,null,Bt[te],ht,lt);"value"in Bt&&o(wt,"value",null,Bt.value,ht),(mt=Bt.onVnodeBeforeMount)&&rs(mt,lt,R)}Ht&&Tr(R,null,lt,"beforeMount");const Ut=PL(ct,zt);Ut&&zt.beforeEnter(wt),s(wt,B,ot),((mt=Bt&&Bt.onVnodeMounted)||Ut||Ht)&&on(()=>{mt&&rs(mt,lt,R),Ut&&zt.enter(wt),Ht&&Tr(R,null,lt,"mounted")},ct)},z=(R,B,ot,lt,ct)=>{if(ot&&m(R,ot),lt)for(let ht=0;ht<lt.length;ht++)m(R,lt[ht]);if(ct){let ht=ct.subTree;if(B===ht||Y0(ht.type)&&(ht.ssContent===B||ht.ssFallback===B)){const kt=ct.vnode;z(R,kt,kt.scopeId,kt.slotScopeIds,ct.parent)}}},P=(R,B,ot,lt,ct,ht,kt,Tt,wt=0)=>{for(let mt=wt;mt<R.length;mt++){const Bt=R[mt]=Tt?$s(R[mt]):us(R[mt]);b(null,Bt,B,ot,lt,ct,ht,kt,Tt)}},D=(R,B,ot,lt,ct,ht,kt)=>{const Tt=B.el=R.el;let{patchFlag:wt,dynamicChildren:mt,dirs:Bt}=B;wt|=R.patchFlag&16;const Ct=R.props||pe,zt=B.props||pe;let Ht;if(ot&&Er(ot,!1),(Ht=zt.onVnodeBeforeUpdate)&&rs(Ht,ot,B,R),Bt&&Tr(B,R,ot,"beforeUpdate"),ot&&Er(ot,!0),(Ct.innerHTML&&zt.innerHTML==null||Ct.textContent&&zt.textContent==null)&&l(Tt,""),mt?L(R.dynamicChildren,mt,Tt,ot,lt,Wc(B,ct),ht):kt||tt(R,B,Tt,null,ot,lt,Wc(B,ct),ht,!1),wt>0){if(wt&16)T(Tt,Ct,zt,ot,ct);else if(wt&2&&Ct.class!==zt.class&&o(Tt,"class",null,zt.class,ct),wt&4&&o(Tt,"style",Ct.style,zt.style,ct),wt&8){const Ut=B.dynamicProps;for(let te=0;te<Ut.length;te++){const ne=Ut[te],_e=Ct[ne],Me=zt[ne];(Me!==_e||ne==="value")&&o(Tt,ne,_e,Me,ct,ot)}}wt&1&&R.children!==B.children&&l(Tt,B.children)}else!kt&&mt==null&&T(Tt,Ct,zt,ot,ct);((Ht=zt.onVnodeUpdated)||Bt)&&on(()=>{Ht&&rs(Ht,ot,B,R),Bt&&Tr(B,R,ot,"updated")},lt)},L=(R,B,ot,lt,ct,ht,kt)=>{for(let Tt=0;Tt<B.length;Tt++){const wt=R[Tt],mt=B[Tt],Bt=wt.el&&(wt.type===Oe||!ra(wt,mt)||wt.shapeFlag&198)?f(wt.el):ot;b(wt,mt,Bt,null,lt,ct,ht,kt,!0)}},T=(R,B,ot,lt,ct)=>{if(B!==ot){if(B!==pe)for(const ht in B)!pa(ht)&&!(ht in ot)&&o(R,ht,B[ht],null,ct,lt);for(const ht in ot){if(pa(ht))continue;const kt=ot[ht],Tt=B[ht];kt!==Tt&&ht!=="value"&&o(R,ht,Tt,kt,ct,lt)}"value"in ot&&o(R,"value",B.value,ot.value,ct)}},K=(R,B,ot,lt,ct,ht,kt,Tt,wt)=>{const mt=B.el=R?R.el:i(""),Bt=B.anchor=R?R.anchor:i("");let{patchFlag:Ct,dynamicChildren:zt,slotScopeIds:Ht}=B;Ht&&(Tt=Tt?Tt.concat(Ht):Ht),R==null?(s(mt,ot,lt),s(Bt,ot,lt),P(B.children||[],ot,Bt,ct,ht,kt,Tt,wt)):Ct>0&&Ct&64&&zt&&R.dynamicChildren&&R.dynamicChildren.length===zt.length?(L(R.dynamicChildren,zt,ot,ct,ht,kt,Tt),(B.key!=null||ct&&B===ct.subTree)&&jh(R,B,!0)):tt(R,B,ot,Bt,ct,ht,kt,Tt,wt)},Z=(R,B,ot,lt,ct,ht,kt,Tt,wt)=>{B.slotScopeIds=Tt,R==null?B.shapeFlag&512?ct.ctx.activate(B,ot,lt,kt,wt):rt(B,ot,lt,ct,ht,kt,wt):et(R,B,wt)},rt=(R,B,ot,lt,ct,ht,kt)=>{const Tt=R.component=HL(R,lt,ct);if(A0(R)&&(Tt.ctx.renderer=vt),qL(Tt,!1,kt),Tt.asyncDep){if(ct&&ct.registerDep(Tt,nt,kt),!R.el){const wt=Tt.subTree=Hn(pr);v(null,wt,B,ot),R.placeholder=wt.el}}else nt(Tt,R,B,ot,ct,ht,kt)},et=(R,B,ot)=>{const lt=B.component=R.component;if(_L(R,B,ot))if(lt.asyncDep&&!lt.asyncResolved){it(lt,B,ot);return}else lt.next=B,lt.update();else B.el=R.el,lt.vnode=B},nt=(R,B,ot,lt,ct,ht,kt)=>{const Tt=()=>{if(R.isMounted){let{next:Ct,bu:zt,u:Ht,parent:Ut,vnode:te}=R;{const qe=G0(R);if(qe){Ct&&(Ct.el=te.el,it(R,Ct,kt)),qe.asyncDep.then(()=>{on(()=>{R.isUnmounted||mt()},ct)});return}}let ne=Ct,_e;Er(R,!1),Ct?(Ct.el=te.el,it(R,Ct,kt)):Ct=te,zt&&Mi(zt),(_e=Ct.props&&Ct.props.onVnodeBeforeUpdate)&&rs(_e,Ut,Ct,te),Er(R,!0);const Me=Op(R),Ge=R.subTree;R.subTree=Me,b(Ge,Me,f(Ge.el),Mt(Ge),R,ct,ht),Ct.el=Me.el,ne===null&&TL(R,Me.el),Ht&&on(Ht,ct),(_e=Ct.props&&Ct.props.onVnodeUpdated)&&on(()=>rs(_e,Ut,Ct,te),ct)}else{let Ct;const{el:zt,props:Ht}=B,{bm:Ut,m:te,parent:ne,root:_e,type:Me}=R,Ge=wa(B);Er(R,!1),Ut&&Mi(Ut),!Ge&&(Ct=Ht&&Ht.onVnodeBeforeMount)&&rs(Ct,ne,B),Er(R,!0);{_e.ce&&_e.ce._hasShadowRoot()&&_e.ce._injectChildStyle(Me);const qe=R.subTree=Op(R);b(null,qe,ot,lt,R,ct,ht),B.el=qe.el}if(te&&on(te,ct),!Ge&&(Ct=Ht&&Ht.onVnodeMounted)){const qe=B;on(()=>rs(Ct,ne,qe),ct)}(B.shapeFlag&256||ne&&wa(ne.vnode)&&ne.vnode.shapeFlag&256)&&R.a&&on(R.a,ct),R.isMounted=!0,B=ot=lt=null}};R.scope.on();const wt=R.effect=new a0(Tt);R.scope.off();const mt=R.update=wt.run.bind(wt),Bt=R.job=wt.runIfDirty.bind(wt);Bt.i=R,Bt.id=R.uid,wt.scheduler=()=>zh(Bt),Er(R,!0),mt()},it=(R,B,ot)=>{B.component=R;const lt=R.vnode.props;R.vnode=B,R.next=null,$L(R,B.props,lt,ot),OL(R,B.children,ot),zs(),Ip(R),Vs()},tt=(R,B,ot,lt,ct,ht,kt,Tt,wt=!1)=>{const mt=R&&R.children,Bt=R?R.shapeFlag:0,Ct=B.children,{patchFlag:zt,shapeFlag:Ht}=B;if(zt>0){if(zt&128){ft(mt,Ct,ot,lt,ct,ht,kt,Tt,wt);return}else if(zt&256){ut(mt,Ct,ot,lt,ct,ht,kt,Tt,wt);return}}Ht&8?(Bt&16&&Ot(mt,ct,ht),Ct!==mt&&l(ot,Ct)):Bt&16?Ht&16?ft(mt,Ct,ot,lt,ct,ht,kt,Tt,wt):Ot(mt,ct,ht,!0):(Bt&8&&l(ot,""),Ht&16&&P(Ct,ot,lt,ct,ht,kt,Tt,wt))},ut=(R,B,ot,lt,ct,ht,kt,Tt,wt)=>{R=R||So,B=B||So;const mt=R.length,Bt=B.length,Ct=Math.min(mt,Bt);let zt;for(zt=0;zt<Ct;zt++){const Ht=B[zt]=wt?$s(B[zt]):us(B[zt]);b(R[zt],Ht,ot,null,ct,ht,kt,Tt,wt)}mt>Bt?Ot(R,ct,ht,!0,!1,Ct):P(B,ot,lt,ct,ht,kt,Tt,wt,Ct)},ft=(R,B,ot,lt,ct,ht,kt,Tt,wt)=>{let mt=0;const Bt=B.length;let Ct=R.length-1,zt=Bt-1;for(;mt<=Ct&&mt<=zt;){const Ht=R[mt],Ut=B[mt]=wt?$s(B[mt]):us(B[mt]);if(ra(Ht,Ut))b(Ht,Ut,ot,null,ct,ht,kt,Tt,wt);else break;mt++}for(;mt<=Ct&&mt<=zt;){const Ht=R[Ct],Ut=B[zt]=wt?$s(B[zt]):us(B[zt]);if(ra(Ht,Ut))b(Ht,Ut,ot,null,ct,ht,kt,Tt,wt);else break;Ct--,zt--}if(mt>Ct){if(mt<=zt){const Ht=zt+1,Ut=Ht<Bt?B[Ht].el:lt;for(;mt<=zt;)b(null,B[mt]=wt?$s(B[mt]):us(B[mt]),ot,Ut,ct,ht,kt,Tt,wt),mt++}}else if(mt>zt)for(;mt<=Ct;)pt(R[mt],ct,ht,!0),mt++;else{const Ht=mt,Ut=mt,te=new Map;for(mt=Ut;mt<=zt;mt++){const Ce=B[mt]=wt?$s(B[mt]):us(B[mt]);Ce.key!=null&&te.set(Ce.key,mt)}let ne,_e=0;const Me=zt-Ut+1;let Ge=!1,qe=0;const gn=new Array(Me);for(mt=0;mt<Me;mt++)gn[mt]=0;for(mt=Ht;mt<=Ct;mt++){const Ce=R[mt];if(_e>=Me){pt(Ce,ct,ht,!0);continue}let Lt;if(Ce.key!=null)Lt=te.get(Ce.key);else for(ne=Ut;ne<=zt;ne++)if(gn[ne-Ut]===0&&ra(Ce,B[ne])){Lt=ne;break}Lt===void 0?pt(Ce,ct,ht,!0):(gn[Lt-Ut]=mt+1,Lt>=qe?qe=Lt:Ge=!0,b(Ce,B[Lt],ot,null,ct,ht,kt,Tt,wt),_e++)}const Ks=Ge?ML(gn):So;for(ne=Ks.length-1,mt=Me-1;mt>=0;mt--){const Ce=Ut+mt,Lt=B[Ce],Us=B[Ce+1],es=Ce+1<Bt?Us.el||X0(Us):lt;gn[mt]===0?b(null,Lt,ot,es,ct,ht,kt,Tt,wt):Ge&&(ne<0||mt!==Ks[ne]?yt(Lt,ot,es,2):ne--)}}},yt=(R,B,ot,lt,ct=null)=>{const{el:ht,type:kt,transition:Tt,children:wt,shapeFlag:mt}=R;if(mt&6){yt(R.component.subTree,B,ot,lt);return}if(mt&128){R.suspense.move(B,ot,lt);return}if(mt&64){kt.move(R,B,ot,vt);return}if(kt===Oe){s(ht,B,ot);for(let Ct=0;Ct<wt.length;Ct++)yt(wt[Ct],B,ot,lt);s(R.anchor,B,ot);return}if(kt===jc){_(R,B,ot);return}if(lt!==2&&mt&1&&Tt)if(lt===0)Tt.beforeEnter(ht),s(ht,B,ot),on(()=>Tt.enter(ht),ct);else{const{leave:Ct,delayLeave:zt,afterLeave:Ht}=Tt,Ut=()=>{R.ctx.isUnmounted?r(ht):s(ht,B,ot)},te=()=>{ht._isLeaving&&ht[nL](!0),Ct(ht,()=>{Ut(),Ht&&Ht()})};zt?zt(ht,Ut,te):te()}else s(ht,B,ot)},pt=(R,B,ot,lt=!1,ct=!1)=>{const{type:ht,props:kt,ref:Tt,children:wt,dynamicChildren:mt,shapeFlag:Bt,patchFlag:Ct,dirs:zt,cacheIndex:Ht}=R;if(Ct===-2&&(ct=!1),Tt!=null&&(zs(),ba(Tt,null,ot,R,!0),Vs()),Ht!=null&&(B.renderCache[Ht]=void 0),Bt&256){B.ctx.deactivate(R);return}const Ut=Bt&1&&zt,te=!wa(R);let ne;if(te&&(ne=kt&&kt.onVnodeBeforeUnmount)&&rs(ne,B,R),Bt&6)$t(R.component,ot,lt);else{if(Bt&128){R.suspense.unmount(ot,lt);return}Ut&&Tr(R,null,B,"beforeUnmount"),Bt&64?R.type.remove(R,B,ot,vt,lt):mt&&!mt.hasOnce&&(ht!==Oe||Ct>0&&Ct&64)?Ot(mt,B,ot,!1,!0):(ht===Oe&&Ct&384||!ct&&Bt&16)&&Ot(wt,B,ot),lt&&bt(R)}(te&&(ne=kt&&kt.onVnodeUnmounted)||Ut)&&on(()=>{ne&&rs(ne,B,R),Ut&&Tr(R,null,B,"unmounted")},ot)},bt=R=>{const{type:B,el:ot,anchor:lt,transition:ct}=R;if(B===Oe){_t(ot,lt);return}if(B===jc){N(R);return}const ht=()=>{r(ot),ct&&!ct.persisted&&ct.afterLeave&&ct.afterLeave()};if(R.shapeFlag&1&&ct&&!ct.persisted){const{leave:kt,delayLeave:Tt}=ct,wt=()=>kt(ot,ht);Tt?Tt(R.el,ht,wt):wt()}else ht()},_t=(R,B)=>{let ot;for(;R!==B;)ot=d(R),r(R),R=ot;r(B)},$t=(R,B,ot)=>{const{bum:lt,scope:ct,job:ht,subTree:kt,um:Tt,m:wt,a:mt}=R;Pp(wt),Pp(mt),lt&&Mi(lt),ct.stop(),ht&&(ht.flags|=8,pt(kt,R,B,ot)),Tt&&on(Tt,B),on(()=>{R.isUnmounted=!0},B)},Ot=(R,B,ot,lt=!1,ct=!1,ht=0)=>{for(let kt=ht;kt<R.length;kt++)pt(R[kt],B,ot,lt,ct)},Mt=R=>{if(R.shapeFlag&6)return Mt(R.component.subTree);if(R.shapeFlag&128)return R.suspense.next();const B=d(R.anchor||R.el),ot=B&&B[E0];return ot?d(ot):B};let qt=!1;const Kt=(R,B,ot)=>{let lt;R==null?B._vnode&&(pt(B._vnode,null,null,!0),lt=B._vnode.component):b(B._vnode||null,R,B,null,null,null,ot),B._vnode=R,qt||(qt=!0,Ip(lt),I0(),qt=!1)},vt={p:b,um:pt,m:yt,r:bt,mt:rt,mc:P,pc:tt,pbc:L,n:Mt,o:e};return{render:Kt,hydrate:void 0,createApp:kL(Kt)}}function Wc({type:e,props:t},n){return n==="svg"&&e==="foreignObject"||n==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function Er({effect:e,job:t},n){n?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function PL(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function jh(e,t,n=!1){const s=e.children,r=t.children;if(Zt(s)&&Zt(r))for(let o=0;o<s.length;o++){const a=s[o];let i=r[o];i.shapeFlag&1&&!i.dynamicChildren&&((i.patchFlag<=0||i.patchFlag===32)&&(i=r[o]=$s(r[o]),i.el=a.el),!n&&i.patchFlag!==-2&&jh(a,i)),i.type===Hu&&(i.patchFlag===-1&&(i=r[o]=$s(i)),i.el=a.el),i.type===pr&&!i.el&&(i.el=a.el)}}function ML(e){const t=e.slice(),n=[0];let s,r,o,a,i;const u=e.length;for(s=0;s<u;s++){const c=e[s];if(c!==0){if(r=n[n.length-1],e[r]<c){t[s]=r,n.push(s);continue}for(o=0,a=n.length-1;o<a;)i=o+a>>1,e[n[i]]<c?o=i+1:a=i;c<e[n[o]]&&(o>0&&(t[s]=n[o-1]),n[o]=s)}}for(o=n.length,a=n[o-1];o-- >0;)n[o]=a,a=t[a];return n}function G0(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:G0(t)}function Pp(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}function X0(e){if(e.placeholder)return e.placeholder;const t=e.component;return t?X0(t.subTree):null}const Y0=e=>e.__isSuspense;function LL(e,t){t&&t.pendingBranch?Zt(e)?t.effects.push(...e):t.effects.push(e):KM(e)}const Oe=Symbol.for("v-fgt"),Hu=Symbol.for("v-txt"),pr=Symbol.for("v-cmt"),jc=Symbol.for("v-stc"),ka=[];let On=null;function Yt(e=!1){ka.push(On=e?null:[])}function zL(){ka.pop(),On=ka[ka.length-1]||null}let La=1;function Mp(e,t=!1){La+=e,e<0&&On&&t&&(On.hasOnce=!0)}function Z0(e){return e.dynamicChildren=La>0?On||So:null,zL(),La>0&&On&&On.push(e),e}function se(e,t,n,s,r,o){return Z0(It(e,t,n,s,r,o,!0))}function sr(e,t,n,s,r){return Z0(Hn(e,t,n,s,r,!0))}function Q0(e){return e?e.__v_isVNode===!0:!1}function ra(e,t){return e.type===t.type&&e.key===t.key}const J0=({key:e})=>e??null,Vi=({ref:e,ref_key:t,ref_for:n})=>(typeof e=="number"&&(e=""+e),e!=null?He(e)||pn(e)||ee(e)?{i:Bn,r:e,k:t,f:!!n}:e:null);function It(e,t=null,n=null,s=0,r=null,o=e===Oe?0:1,a=!1,i=!1){const u={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&J0(t),ref:t&&Vi(t),scopeId:_0,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:o,patchFlag:s,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:Bn};return i?(Hh(u,n),o&128&&e.normalize(u)):n&&(u.shapeFlag|=He(n)?8:16),La>0&&!a&&On&&(u.patchFlag>0||o&6)&&u.patchFlag!==32&&On.push(u),u}const Hn=VL;function VL(e,t=null,n=null,s=0,r=null,o=!1){if((!e||e===dL)&&(e=pr),Q0(e)){const i=Mo(e,t,!0);return n&&Hh(i,n),La>0&&!o&&On&&(i.shapeFlag&6?On[On.indexOf(e)]=i:On.push(i)),i.patchFlag=-2,i}if(XL(e)&&(e=e.__vccOpts),t){t=BL(t);let{class:i,style:u}=t;i&&!He(i)&&(t.class=cr(i)),we(u)&&(Lh(u)&&!Zt(u)&&(u=tn({},u)),t.style=Ro(u))}const a=He(e)?1:Y0(e)?128:JM(e)?64:we(e)?4:ee(e)?2:0;return It(e,t,n,s,r,a,o,!0)}function BL(e){return e?Lh(e)||W0(e)?tn({},e):e:null}function Mo(e,t,n=!1,s=!1){const{props:r,ref:o,patchFlag:a,children:i,transition:u}=e,c=t?tw(r||{},t):r,l={__v_isVNode:!0,__v_skip:!0,type:e.type,props:c,key:c&&J0(c),ref:t&&t.ref?n&&o?Zt(o)?o.concat(Vi(t)):[o,Vi(t)]:Vi(t):o,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:i,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Oe?a===-1?16:a|16:a,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:u,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Mo(e.ssContent),ssFallback:e.ssFallback&&Mo(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return u&&s&&Vh(l,u.clone(l)),l}function fu(e=" ",t=0){return Hn(Hu,null,e,t)}function Vr(e="",t=!1){return t?(Yt(),sr(pr,null,e)):Hn(pr,null,e)}function us(e){return e==null||typeof e=="boolean"?Hn(pr):Zt(e)?Hn(Oe,null,e.slice()):Q0(e)?$s(e):Hn(Hu,null,String(e))}function $s(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Mo(e)}function Hh(e,t){let n=0;const{shapeFlag:s}=e;if(t==null)t=null;else if(Zt(t))n=16;else if(typeof t=="object")if(s&65){const r=t.default;r&&(r._c&&(r._d=!1),Hh(e,r()),r._c&&(r._d=!0));return}else{n=32;const r=t._;!r&&!W0(t)?t._ctx=Bn:r===3&&Bn&&(Bn.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else ee(t)?(t={default:t,_ctx:Bn},n=32):(t=String(t),s&64?(n=16,t=[fu(t)]):n=8);e.children=t,e.shapeFlag|=n}function tw(...e){const t={};for(let n=0;n<e.length;n++){const s=e[n];for(const r in s)if(r==="class")t.class!==s.class&&(t.class=cr([t.class,s.class]));else if(r==="style")t.style=Ro([t.style,s.style]);else if(Au(r)){const o=t[r],a=s[r];a&&o!==a&&!(Zt(o)&&o.includes(a))&&(t[r]=o?[].concat(o,a):a)}else r!==""&&(t[r]=s[r])}return t}function rs(e,t,n,s=null){bs(e,t,7,[n,s])}const WL=R0();let jL=0;function HL(e,t,n){const s=e.type,r=(t?t.appContext:e.appContext)||WL,o={uid:jL++,vnode:e,type:s,parent:t,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new pM(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(r.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:H0(s,r),emitsOptions:L0(s,r),emit:null,emitted:null,propsDefaults:pe,inheritAttrs:s.inheritAttrs,ctx:pe,data:pe,props:pe,attrs:pe,slots:pe,refs:pe,setupState:pe,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return o.ctx={_:o},o.root=t?t.root:o,o.emit=xL.bind(null,o),e.ce&&e.ce(o),o}let vn=null;const qu=()=>vn||Bn;let hu,zl;{const e=Fu(),t=(n,s)=>{let r;return(r=e[n])||(r=e[n]=[]),r.push(s),o=>{r.length>1?r.forEach(a=>a(o)):r[0](o)}};hu=t("__VUE_INSTANCE_SETTERS__",n=>vn=n),zl=t("__VUE_SSR_SETTERS__",n=>za=n)}const Ga=e=>{const t=vn;return hu(e),e.scope.on(),()=>{e.scope.off(),hu(t)}},Lp=()=>{vn&&vn.scope.off(),hu(null)};function ew(e){return e.vnode.shapeFlag&4}let za=!1;function qL(e,t=!1,n=!1){t&&zl(t);const{props:s,children:r}=e.vnode,o=ew(e);EL(e,s,o,t),DL(e,r,n||t);const a=o?KL(e,t):void 0;return t&&zl(!1),a}function KL(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,pL);const{setup:s}=n;if(s){zs();const r=e.setupContext=s.length>1?GL(e):null,o=Ga(e),a=Ka(s,e,0,[e.props,r]),i=Yb(a);if(Vs(),o(),(i||e.sp)&&!wa(e)&&C0(e),i){if(a.then(Lp,Lp),t)return a.then(u=>{zp(e,u)}).catch(u=>{Mu(u,e,0)});e.asyncDep=a}else zp(e,a)}else nw(e)}function zp(e,t,n){ee(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:we(t)&&(e.setupState=k0(t)),nw(e)}function nw(e,t,n){const s=e.type;e.render||(e.render=s.render||ds);{const r=Ga(e);zs();try{mL(e)}finally{Vs(),r()}}}const UL={get(e,t){return fn(e,"get",""),e[t]}};function GL(e){const t=n=>{e.exposed=n||{}};return{attrs:new Proxy(e.attrs,UL),slots:e.slots,emit:e.emit,expose:t}}function Ku(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(k0(RM(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in va)return va[n](e)},has(t,n){return n in t||n in va}})):e.proxy}function XL(e){return ee(e)&&"__vccOpts"in e}const kn=(e,t)=>BM(e,t,za),YL="3.5.28";/**
* @vue/runtime-dom v3.5.28
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Vl;const Vp=typeof window<"u"&&window.trustedTypes;if(Vp)try{Vl=Vp.createPolicy("vue",{createHTML:e=>e})}catch{}const sw=Vl?e=>Vl.createHTML(e):e=>e,ZL="http://www.w3.org/2000/svg",QL="http://www.w3.org/1998/Math/MathML",Ns=typeof document<"u"?document:null,Bp=Ns&&Ns.createElement("template"),JL={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,s)=>{const r=t==="svg"?Ns.createElementNS(ZL,e):t==="mathml"?Ns.createElementNS(QL,e):n?Ns.createElement(e,{is:n}):Ns.createElement(e);return e==="select"&&s&&s.multiple!=null&&r.setAttribute("multiple",s.multiple),r},createText:e=>Ns.createTextNode(e),createComment:e=>Ns.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Ns.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,s,r,o){const a=n?n.previousSibling:t.lastChild;if(r&&(r===o||r.nextSibling))for(;t.insertBefore(r.cloneNode(!0),n),!(r===o||!(r=r.nextSibling)););else{Bp.innerHTML=sw(s==="svg"?`<svg>${e}</svg>`:s==="mathml"?`<math>${e}</math>`:e);const i=Bp.content;if(s==="svg"||s==="mathml"){const u=i.firstChild;for(;u.firstChild;)i.appendChild(u.firstChild);i.removeChild(u)}t.insertBefore(i,n)}return[a?a.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},tz=Symbol("_vtc");function ez(e,t,n){const s=e[tz];s&&(t=(t?[t,...s]:[...s]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}const du=Symbol("_vod"),rw=Symbol("_vsh"),ow={name:"show",beforeMount(e,{value:t},{transition:n}){e[du]=e.style.display==="none"?"":e.style.display,n&&t?n.beforeEnter(e):oa(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:s}){!t!=!n&&(s?t?(s.beforeEnter(e),oa(e,!0),s.enter(e)):s.leave(e,()=>{oa(e,!1)}):oa(e,t))},beforeUnmount(e,{value:t}){oa(e,t)}};function oa(e,t){e.style.display=t?e[du]:"none",e[rw]=!t}const nz=Symbol(""),sz=/(?:^|;)\s*display\s*:/;function rz(e,t,n){const s=e.style,r=He(n);let o=!1;if(n&&!r){if(t)if(He(t))for(const a of t.split(";")){const i=a.slice(0,a.indexOf(":")).trim();n[i]==null&&Bi(s,i,"")}else for(const a in t)n[a]==null&&Bi(s,a,"");for(const a in n)a==="display"&&(o=!0),Bi(s,a,n[a])}else if(r){if(t!==n){const a=s[nz];a&&(n+=";"+a),s.cssText=n,o=sz.test(n)}}else t&&e.removeAttribute("style");du in e&&(e[du]=o?s.display:"",e[rw]&&(s.display="none"))}const Wp=/\s*!important$/;function Bi(e,t,n){if(Zt(n))n.forEach(s=>Bi(e,t,s));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const s=oz(e,t);Wp.test(n)?e.setProperty(wr(s),n.replace(Wp,""),"important"):e[s]=n}}const jp=["Webkit","Moz","ms"],Hc={};function oz(e,t){const n=Hc[t];if(n)return n;let s=Ls(t);if(s!=="filter"&&s in e)return Hc[t]=s;s=Jb(s);for(let r=0;r<jp.length;r++){const o=jp[r]+s;if(o in e)return Hc[t]=o}return t}const Hp="http://www.w3.org/1999/xlink";function qp(e,t,n,s,r,o=hM(t)){s&&t.startsWith("xlink:")?n==null?e.removeAttributeNS(Hp,t.slice(6,t.length)):e.setAttributeNS(Hp,t,n):n==null||o&&!e0(n)?e.removeAttribute(t):e.setAttribute(t,o?"":ys(n)?String(n):n)}function Kp(e,t,n,s,r){if(t==="innerHTML"||t==="textContent"){n!=null&&(e[t]=t==="innerHTML"?sw(n):n);return}const o=e.tagName;if(t==="value"&&o!=="PROGRESS"&&!o.includes("-")){const i=o==="OPTION"?e.getAttribute("value")||"":e.value,u=n==null?e.type==="checkbox"?"on":"":String(n);(i!==u||!("_value"in e))&&(e.value=u),n==null&&e.removeAttribute(t),e._value=n;return}let a=!1;if(n===""||n==null){const i=typeof e[t];i==="boolean"?n=e0(n):n==null&&i==="string"?(n="",a=!0):i==="number"&&(n=0,a=!0)}try{e[t]=n}catch{}a&&e.removeAttribute(r||t)}function rr(e,t,n,s){e.addEventListener(t,n,s)}function az(e,t,n,s){e.removeEventListener(t,n,s)}const Up=Symbol("_vei");function iz(e,t,n,s,r=null){const o=e[Up]||(e[Up]={}),a=o[t];if(s&&a)a.value=s;else{const[i,u]=uz(t);if(s){const c=o[t]=fz(s,r);rr(e,i,c,u)}else a&&(az(e,i,a,u),o[t]=void 0)}}const Gp=/(?:Once|Passive|Capture)$/;function uz(e){let t;if(Gp.test(e)){t={};let s;for(;s=e.match(Gp);)e=e.slice(0,e.length-s[0].length),t[s[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):wr(e.slice(2)),t]}let qc=0;const cz=Promise.resolve(),lz=()=>qc||(cz.then(()=>qc=0),qc=Date.now());function fz(e,t){const n=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=n.attached)return;bs(hz(s,n.value),t,5,[s])};return n.value=e,n.attached=lz(),n}function hz(e,t){if(Zt(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(s=>r=>!r._stopped&&s&&s(r))}else return t}const Xp=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,dz=(e,t,n,s,r,o)=>{const a=r==="svg";t==="class"?ez(e,s,a):t==="style"?rz(e,n,s):Au(t)?Eh(t)||iz(e,t,n,s,o):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):pz(e,t,s,a))?(Kp(e,t,s),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&qp(e,t,s,a,o,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!He(s))?Kp(e,Ls(t),s,o,t):(t==="true-value"?e._trueValue=s:t==="false-value"&&(e._falseValue=s),qp(e,t,s,a))};function pz(e,t,n,s){if(s)return!!(t==="innerHTML"||t==="textContent"||t in e&&Xp(t)&&ee(n));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="sandbox"&&e.tagName==="IFRAME"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const r=e.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return Xp(t)&&He(n)?!1:t in e}const Lo=e=>{const t=e.props["onUpdate:modelValue"]||!1;return Zt(t)?n=>Mi(t,n):t};function mz(e){e.target.composing=!0}function Yp(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Fs=Symbol("_assign");function Zp(e,t,n){return t&&(e=e.trim()),n&&(e=Ah(e)),e}const ho={created(e,{modifiers:{lazy:t,trim:n,number:s}},r){e[Fs]=Lo(r);const o=s||r.props&&r.props.type==="number";rr(e,t?"change":"input",a=>{a.target.composing||e[Fs](Zp(e.value,n,o))}),(n||o)&&rr(e,"change",()=>{e.value=Zp(e.value,n,o)}),t||(rr(e,"compositionstart",mz),rr(e,"compositionend",Yp),rr(e,"change",Yp))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:n,modifiers:{lazy:s,trim:r,number:o}},a){if(e[Fs]=Lo(a),e.composing)return;const i=(o||e.type==="number")&&!/^0\d/.test(e.value)?Ah(e.value):e.value,u=t??"";i!==u&&(document.activeElement===e&&e.type!=="range"&&(s&&t===n||r&&e.value.trim()===u)||(e.value=u))}},gz={deep:!0,created(e,t,n){e[Fs]=Lo(n),rr(e,"change",()=>{const s=e._modelValue,r=aw(e),o=e.checked,a=e[Fs];if(Zt(s)){const i=n0(s,r),u=i!==-1;if(o&&!u)a(s.concat(r));else if(!o&&u){const c=[...s];c.splice(i,1),a(c)}}else if(Du(s)){const i=new Set(s);o?i.add(r):i.delete(r),a(i)}else a(iw(e,o))})},mounted:Qp,beforeUpdate(e,t,n){e[Fs]=Lo(n),Qp(e,t,n)}};function Qp(e,{value:t,oldValue:n},s){e._modelValue=t;let r;if(Zt(t))r=n0(t,s.props.value)>-1;else if(Du(t))r=t.has(s.props.value);else{if(t===n)return;r=Zr(t,iw(e,!0))}e.checked!==r&&(e.checked=r)}const yz={created(e,{value:t},n){e.checked=Zr(t,n.props.value),e[Fs]=Lo(n),rr(e,"change",()=>{e[Fs](aw(e))})},beforeUpdate(e,{value:t,oldValue:n},s){e[Fs]=Lo(s),t!==n&&(e.checked=Zr(t,s.props.value))}};function aw(e){return"_value"in e?e._value:e.value}function iw(e,t){const n=t?"_trueValue":"_falseValue";return n in e?e[n]:t}const bz=["ctrl","shift","alt","meta"],wz={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>bz.some(n=>e[`${n}Key`]&&!t.includes(n))},ve=(e,t)=>{if(!e)return e;const n=e._withMods||(e._withMods={}),s=t.join(".");return n[s]||(n[s]=((r,...o)=>{for(let a=0;a<t.length;a++){const i=wz[t[a]];if(i&&i(r,t))return}return e(r,...o)}))},vz=tn({patchProp:dz},JL);let Jp;function kz(){return Jp||(Jp=FL(vz))}const xz=((...e)=>{const t=kz().createApp(...e),{mount:n}=t;return t.mount=s=>{const r=Iz(s);if(!r)return;const o=t._component;!ee(o)&&!o.render&&!o.template&&(o.template=r.innerHTML),r.nodeType===1&&(r.textContent="");const a=n(r,!1,Sz(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),a},t});function Sz(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function Iz(e){return He(e)?document.querySelector(e):e}var Nz=Object.defineProperty,_z=(e,t,n)=>t in e?Nz(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,nn=(e,t,n)=>_z(e,typeof t!="symbol"?t+"":t,n);function Uu(e){return o0()?(mM(e),!0):!1}const Tz=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Ez=e=>e!=null,$z=Object.prototype.toString,Cz=e=>$z.call(e)==="[object Object]",Bl=()=>{};function Az(e,t){function n(...s){return new Promise((r,o)=>{Promise.resolve(e(()=>t.apply(this,s),{fn:t,thisArg:this,args:s})).then(r).catch(o)})}return n}function Dz(e,t={}){let n,s,r=Bl;const o=i=>{clearTimeout(i),r(),r=Bl};let a;return i=>{const u=lr(e),c=lr(t.maxWait);return n&&o(n),u<=0||c!==void 0&&c<=0?(s&&(o(s),s=void 0),Promise.resolve(i())):new Promise((l,f)=>{r=t.rejectOnCancel?f:l,a=i,c&&!s&&(s=setTimeout(()=>{n&&o(n),s=void 0,l(a())},c)),n=setTimeout(()=>{s&&o(s),s=void 0,l(i())},u)})}}function xa(e){return Array.isArray(e)?e:[e]}function Oz(e){return qu()}function Fz(e,t=200,n={}){return Az(Dz(t,n),e)}function Rz(e,t=!0,n){Oz()?Ua(e,n):t?e():Pa(e)}function Pz(e,t,n){return ps(e,t,{...n,immediate:!0})}const Ho=Tz?window:void 0;function Os(e){var t;const n=lr(e);return(t=n==null?void 0:n.$el)!=null?t:n}function pu(...e){const t=[],n=()=>{t.forEach(i=>i()),t.length=0},s=(i,u,c,l)=>(i.addEventListener(u,c,l),()=>i.removeEventListener(u,c,l)),r=kn(()=>{const i=xa(lr(e[0])).filter(u=>u!=null);return i.every(u=>typeof u!="string")?i:void 0}),o=Pz(()=>{var i,u;return[(u=(i=r.value)==null?void 0:i.map(c=>Os(c)))!=null?u:[Ho].filter(c=>c!=null),xa(lr(r.value?e[1]:e[0])),xa(Cn(r.value?e[2]:e[1])),lr(r.value?e[3]:e[2])]},([i,u,c,l])=>{if(n(),!(i!=null&&i.length)||!(u!=null&&u.length)||!(c!=null&&c.length))return;const f=Cz(l)?{...l}:l;t.push(...i.flatMap(d=>u.flatMap(m=>c.map(g=>s(d,m,g,f)))))},{flush:"post"}),a=()=>{o(),n()};return Uu(n),a}function Mz(){const e=ru(!1),t=qu();return t&&Ua(()=>{e.value=!0},t),e}function uw(e){const t=Mz();return kn(()=>(t.value,!!e()))}function Lz(e,t,n={}){const{window:s=Ho,...r}=n;let o;const a=uw(()=>s&&"MutationObserver"in s),i=()=>{o&&(o.disconnect(),o=void 0)},u=kn(()=>{const d=lr(e),m=xa(d).map(Os).filter(Ez);return new Set(m)}),c=ps(u,d=>{i(),a.value&&d.size&&(o=new MutationObserver(t),d.forEach(m=>o.observe(m,r)))},{immediate:!0,flush:"post"}),l=()=>o==null?void 0:o.takeRecords(),f=()=>{c(),i()};return Uu(f),{isSupported:a,stop:f,takeRecords:l}}function zz(e,t,n={}){const{window:s=Ho,document:r=s==null?void 0:s.document,flush:o="sync"}=n;if(!s||!r)return Bl;let a;const i=l=>{a==null||a(),a=l},u=Lu(()=>{const l=Os(e);if(l){const{stop:f}=Lz(r,d=>{d.map(m=>[...m.removedNodes]).flat().some(m=>m===l||m.contains(l))&&t(d)},{window:s,childList:!0,subtree:!0});i(f)}},{flush:o}),c=()=>{u(),i()};return Uu(c),c}function Vz(e={}){var t;const{window:n=Ho,deep:s=!0,triggerOnRemoval:r=!1}=e,o=(t=e.document)!=null?t:n==null?void 0:n.document,a=()=>{var c;let l=o==null?void 0:o.activeElement;if(s)for(;l!=null&&l.shadowRoot;)l=(c=l==null?void 0:l.shadowRoot)==null?void 0:c.activeElement;return l},i=ru(),u=()=>{i.value=a()};if(n){const c={capture:!0,passive:!0};pu(n,"blur",l=>{l.relatedTarget===null&&u()},c),pu(n,"focus",u,c)}return r&&zz(i,u,{document:o}),u(),i}function Bz(e,t,n={}){const{window:s=Ho,...r}=n;let o;const a=uw(()=>s&&"ResizeObserver"in s),i=()=>{o&&(o.disconnect(),o=void 0)},u=kn(()=>{const f=lr(e);return Array.isArray(f)?f.map(d=>Os(d)):[Os(f)]}),c=ps(u,f=>{if(i(),a.value&&s){o=new ResizeObserver(t);for(const d of f)d&&o.observe(d,r)}},{immediate:!0,flush:"post"}),l=()=>{i(),c()};return Uu(l),{isSupported:a,stop:l}}function cw(e,t={width:0,height:0},n={}){const{window:s=Ho,box:r="content-box"}=n,o=kn(()=>{var f,d;return(d=(f=Os(e))==null?void 0:f.namespaceURI)==null?void 0:d.includes("svg")}),a=ru(t.width),i=ru(t.height),{stop:u}=Bz(e,([f])=>{const d=r==="border-box"?f.borderBoxSize:r==="content-box"?f.contentBoxSize:f.devicePixelContentBoxSize;if(s&&o.value){const m=Os(e);if(m){const g=m.getBoundingClientRect();a.value=g.width,i.value=g.height}}else if(d){const m=xa(d);a.value=m.reduce((g,{inlineSize:b})=>g+b,0),i.value=m.reduce((g,{blockSize:b})=>g+b,0)}else a.value=f.contentRect.width,i.value=f.contentRect.height},n);Rz(()=>{const f=Os(e);f&&(a.value="offsetWidth"in f?f.offsetWidth:t.width,i.value="offsetHeight"in f?f.offsetHeight:t.height)});const c=ps(()=>Os(e),f=>{a.value=f?t.width:0,i.value=f?t.height:0});function l(){u(),c()}return{width:a,height:i,stop:l}}var Wz=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function jz(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Wl={exports:{}},Hz=Wl.exports,tm;function qz(){return tm||(tm=1,(function(e,t){((n,s)=>{e.exports=s()})(Hz,function(){var n=function(h,p){return(n=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(w,k){w.__proto__=k}:function(w,k){for(var S in k)Object.prototype.hasOwnProperty.call(k,S)&&(w[S]=k[S])}))(h,p)},s=function(){return(s=Object.assign||function(h){for(var p,w=1,k=arguments.length;w<k;w++)for(var S in p=arguments[w])Object.prototype.hasOwnProperty.call(p,S)&&(h[S]=p[S]);return h}).apply(this,arguments)};function r(h,p,w){for(var k,S=0,E=p.length;S<E;S++)!k&&S in p||((k=k||Array.prototype.slice.call(p,0,S))[S]=p[S]);return h.concat(k||Array.prototype.slice.call(p))}var o=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Wz,a=Object.keys,i=Array.isArray;function u(h,p){return typeof p=="object"&&a(p).forEach(function(w){h[w]=p[w]}),h}typeof Promise>"u"||o.Promise||(o.Promise=Promise);var c=Object.getPrototypeOf,l={}.hasOwnProperty;function f(h,p){return l.call(h,p)}function d(h,p){typeof p=="function"&&(p=p(c(h))),(typeof Reflect>"u"?a:Reflect.ownKeys)(p).forEach(function(w){g(h,w,p[w])})}var m=Object.defineProperty;function g(h,p,w,k){m(h,p,u(w&&f(w,"get")&&typeof w.get=="function"?{get:w.get,set:w.set,configurable:!0}:{value:w,configurable:!0,writable:!0},k))}function b(h){return{from:function(p){return h.prototype=Object.create(p.prototype),g(h.prototype,"constructor",h),{extend:d.bind(null,h.prototype)}}}}var y=Object.getOwnPropertyDescriptor,v=[].slice;function I(h,p,w){return v.call(h,p,w)}function _(h,p){return p(h)}function N(h){if(!h)throw new Error("Assertion Failed")}function C(h){o.setImmediate?setImmediate(h):setTimeout(h,0)}function F(h,p){if(typeof p=="string"&&f(h,p))return h[p];if(!p)return h;if(typeof p!="string"){for(var w=[],k=0,S=p.length;k<S;++k){var E=F(h,p[k]);w.push(E)}return w}var A,M=p.indexOf(".");return M===-1||(A=h[p.substr(0,M)])==null?void 0:F(A,p.substr(M+1))}function z(h,p,w){if(h&&p!==void 0&&!("isFrozen"in Object&&Object.isFrozen(h)))if(typeof p!="string"&&"length"in p){N(typeof w!="string"&&"length"in w);for(var k=0,S=p.length;k<S;++k)z(h,p[k],w[k])}else{var E,A,M=p.indexOf(".");M!==-1?(E=p.substr(0,M),(M=p.substr(M+1))===""?w===void 0?i(h)&&!isNaN(parseInt(E))?h.splice(E,1):delete h[E]:h[E]=w:z(A=(A=h[E])&&f(h,E)?A:h[E]={},M,w)):w===void 0?i(h)&&!isNaN(parseInt(p))?h.splice(p,1):delete h[p]:h[p]=w}}function P(h){var p,w={};for(p in h)f(h,p)&&(w[p]=h[p]);return w}var D=[].concat;function L(h){return D.apply([],h)}var pt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(L([8,16,32,64].map(function(h){return["Int","Uint","Float"].map(function(p){return p+h+"Array"})}))).filter(function(h){return o[h]}),T=new Set(pt.map(function(h){return o[h]})),K=null;function Z(h){return K=new WeakMap,h=(function p(w){if(!w||typeof w!="object")return w;var k=K.get(w);if(k)return k;if(i(w)){k=[],K.set(w,k);for(var S=0,E=w.length;S<E;++S)k.push(p(w[S]))}else if(T.has(w.constructor))k=w;else{var A,M=c(w);for(A in k=M===Object.prototype?{}:Object.create(M),K.set(w,k),w)f(w,A)&&(k[A]=p(w[A]))}return k})(h),K=null,h}var rt={}.toString;function et(h){return rt.call(h).slice(8,-1)}var nt=typeof Symbol<"u"?Symbol.iterator:"@@iterator",it=typeof nt=="symbol"?function(h){var p;return h!=null&&(p=h[nt])&&p.apply(h)}:function(){return null};function tt(h,p){p=h.indexOf(p),0<=p&&h.splice(p,1)}var ut={};function ft(h){var p,w,k,S;if(arguments.length===1){if(i(h))return h.slice();if(this===ut&&typeof h=="string")return[h];if(S=it(h))for(w=[];!(k=S.next()).done;)w.push(k.value);else{if(h==null)return[h];if(typeof(p=h.length)!="number")return[h];for(w=new Array(p);p--;)w[p]=h[p]}}else for(p=arguments.length,w=new Array(p);p--;)w[p]=arguments[p];return w}var yt=typeof Symbol<"u"?function(h){return h[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},pt=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Ut=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(pt),bt={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function _t(h,p){this.name=h,this.message=p}function $t(h,p){return h+". Errors: "+Object.keys(p).map(function(w){return p[w].toString()}).filter(function(w,k,S){return S.indexOf(w)===k}).join(`
`)}function Ot(h,p,w,k){this.failures=p,this.failedKeys=k,this.successCount=w,this.message=$t(h,p)}function Mt(h,p){this.name="BulkError",this.failures=Object.keys(p).map(function(w){return p[w]}),this.failuresByPos=p,this.message=$t(h,this.failures)}b(_t).from(Error).extend({toString:function(){return this.name+": "+this.message}}),b(Ot).from(_t),b(Mt).from(_t);var qt=Ut.reduce(function(h,p){return h[p]=p+"Error",h},{}),Kt=_t,vt=Ut.reduce(function(h,p){var w=p+"Error";function k(S,E){this.name=w,S?typeof S=="string"?(this.message="".concat(S).concat(E?`
 `+E:""),this.inner=E||null):typeof S=="object"&&(this.message="".concat(S.name," ").concat(S.message),this.inner=S):(this.message=bt[p]||w,this.inner=null)}return b(k).from(Kt),h[p]=k,h},{}),Jt=(vt.Syntax=SyntaxError,vt.Type=TypeError,vt.Range=RangeError,pt.reduce(function(h,p){return h[p+"Error"]=vt[p],h},{}));pt=Ut.reduce(function(h,p){return["Syntax","Type","Range"].indexOf(p)===-1&&(h[p+"Error"]=vt[p]),h},{});function R(){}function B(h){return h}function ot(h,p){return h==null||h===B?p:function(w){return p(h(w))}}function lt(h,p){return function(){h.apply(this,arguments),p.apply(this,arguments)}}function ct(h,p){return h===R?p:function(){var w=h.apply(this,arguments),k=(w!==void 0&&(arguments[0]=w),this.onsuccess),S=this.onerror,E=(this.onsuccess=null,this.onerror=null,p.apply(this,arguments));return k&&(this.onsuccess=this.onsuccess?lt(k,this.onsuccess):k),S&&(this.onerror=this.onerror?lt(S,this.onerror):S),E!==void 0?E:w}}function ht(h,p){return h===R?p:function(){h.apply(this,arguments);var w=this.onsuccess,k=this.onerror;this.onsuccess=this.onerror=null,p.apply(this,arguments),w&&(this.onsuccess=this.onsuccess?lt(w,this.onsuccess):w),k&&(this.onerror=this.onerror?lt(k,this.onerror):k)}}function kt(h,p){return h===R?p:function(S){var k=h.apply(this,arguments),S=(u(S,k),this.onsuccess),E=this.onerror,A=(this.onsuccess=null,this.onerror=null,p.apply(this,arguments));return S&&(this.onsuccess=this.onsuccess?lt(S,this.onsuccess):S),E&&(this.onerror=this.onerror?lt(E,this.onerror):E),k===void 0?A===void 0?void 0:A:u(k,A)}}function Tt(h,p){return h===R?p:function(){return p.apply(this,arguments)!==!1&&h.apply(this,arguments)}}function wt(h,p){return h===R?p:function(){var w=h.apply(this,arguments);if(w&&typeof w.then=="function"){for(var k=this,S=arguments.length,E=new Array(S);S--;)E[S]=arguments[S];return w.then(function(){return p.apply(k,E)})}return p.apply(this,arguments)}}pt.ModifyError=Ot,pt.DexieError=_t,pt.BulkError=Mt;var mt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Bt(h){mt=h}var Ct={},zt=100,Ht=typeof Promise>"u"?[]:(Ut=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[Ht=crypto.subtle.digest("SHA-512",new Uint8Array([0])),c(Ht),Ut]:[Ut,c(Ut),Ut]),Ut=Ht[0],co=Ht[1],co=co&&co.then,te=Ut&&Ut.constructor,ne=!!Ht[2],_e=function(h,p){Us.push([h,p]),Ge&&(queueMicrotask(mw),Ge=!1)},Me=!0,Ge=!0,qe=[],gn=[],Ks=B,Ce={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:R,pgp:!1,env:{},finalize:R},Lt=Ce,Us=[],es=0,Xa=[];function Rt(h){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var p=this._PSD=Lt;if(typeof h!="function"){if(h!==Ct)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Yu(this,this._value)}else this._state=null,this._value=null,++p.ref,(function w(k,S){try{S(function(E){if(k._state===null){if(E===k)throw new TypeError("A promise cannot be resolved with itself.");var A=k._lib&&no();E&&typeof E.then=="function"?w(k,function(M,G){E instanceof Rt?E._then(M,G):E.then(M,G)}):(k._state=!0,k._value=E,Gh(k)),A&&so()}},Yu.bind(null,k))}catch(E){Yu(k,E)}})(this,h)}var Xu={get:function(){var h=Lt,p=Ja;function w(k,S){var E=this,A=!h.global&&(h!==Lt||p!==Ja),M=A&&!Xs(),G=new Rt(function(J,U){Zu(E,new Uh(Yh(k,h,A,M),Yh(S,h,A,M),J,U,h))});return this._consoleTask&&(G._consoleTask=this._consoleTask),G}return w.prototype=Ct,w},set:function(h){g(this,"then",h&&h.prototype===Ct?Xu:{get:function(){return h},set:Xu.set})}};function Uh(h,p,w,k,S){this.onFulfilled=typeof h=="function"?h:null,this.onRejected=typeof p=="function"?p:null,this.resolve=w,this.reject=k,this.psd=S}function Yu(h,p){var w,k;gn.push(p),h._state===null&&(w=h._lib&&no(),p=Ks(p),h._state=!1,h._value=p,k=h,qe.some(function(S){return S._value===k._value})||qe.push(k),Gh(h),w)&&so()}function Gh(h){var p=h._listeners;h._listeners=[];for(var w=0,k=p.length;w<k;++w)Zu(h,p[w]);var S=h._PSD;--S.ref||S.finalize(),es===0&&(++es,_e(function(){--es==0&&Qu()},[]))}function Zu(h,p){if(h._state===null)h._listeners.push(p);else{var w=h._state?p.onFulfilled:p.onRejected;if(w===null)return(h._state?p.resolve:p.reject)(h._value);++p.psd.ref,++es,_e(pw,[w,h,p])}}function pw(h,p,w){try{var k,S=p._value;!p._state&&gn.length&&(gn=[]),k=mt&&p._consoleTask?p._consoleTask.run(function(){return h(S)}):h(S),p._state||gn.indexOf(S)!==-1||(E=>{for(var A=qe.length;A;)if(qe[--A]._value===E._value)return qe.splice(A,1)})(p),w.resolve(k)}catch(E){w.reject(E)}finally{--es==0&&Qu(),--w.psd.ref||w.psd.finalize()}}function mw(){vr(Ce,function(){no()&&so()})}function no(){var h=Me;return Ge=Me=!1,h}function so(){var h,p,w;do for(;0<Us.length;)for(h=Us,Us=[],w=h.length,p=0;p<w;++p){var k=h[p];k[0].apply(null,k[1])}while(0<Us.length);Ge=Me=!0}function Qu(){for(var h=qe,p=(qe=[],h.forEach(function(k){k._PSD.onunhandled.call(null,k._value,k)}),Xa.slice(0)),w=p.length;w;)p[--w]()}function Ya(h){return new Rt(Ct,!1,h)}function Ae(h,p){var w=Lt;return function(){var k=no(),S=Lt;try{return Ys(w,!0),h.apply(this,arguments)}catch(E){p&&p(E)}finally{Ys(S,!1),k&&so()}}}d(Rt.prototype,{then:Xu,_then:function(h,p){Zu(this,new Uh(null,null,h,p,Lt))},catch:function(h){var p,w;return arguments.length===1?this.then(null,h):(p=h,w=arguments[1],typeof p=="function"?this.then(null,function(k){return(k instanceof p?w:Ya)(k)}):this.then(null,function(k){return(k&&k.name===p?w:Ya)(k)}))},finally:function(h){return this.then(function(p){return Rt.resolve(h()).then(function(){return p})},function(p){return Rt.resolve(h()).then(function(){return Ya(p)})})},timeout:function(h,p){var w=this;return h<1/0?new Rt(function(k,S){var E=setTimeout(function(){return S(new vt.Timeout(p))},h);w.then(k,S).finally(clearTimeout.bind(null,E))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&g(Rt.prototype,Symbol.toStringTag,"Dexie.Promise"),Ce.env=Xh(),d(Rt,{all:function(){var h=ft.apply(null,arguments).map(ti);return new Rt(function(p,w){h.length===0&&p([]);var k=h.length;h.forEach(function(S,E){return Rt.resolve(S).then(function(A){h[E]=A,--k||p(h)},w)})})},resolve:function(h){return h instanceof Rt?h:h&&typeof h.then=="function"?new Rt(function(p,w){h.then(p,w)}):new Rt(Ct,!0,h)},reject:Ya,race:function(){var h=ft.apply(null,arguments).map(ti);return new Rt(function(p,w){h.map(function(k){return Rt.resolve(k).then(p,w)})})},PSD:{get:function(){return Lt},set:function(h){return Lt=h}},totalEchoes:{get:function(){return Ja}},newPSD:Gs,usePSD:vr,scheduler:{get:function(){return _e},set:function(h){_e=h}},rejectionMapper:{get:function(){return Ks},set:function(h){Ks=h}},follow:function(h,p){return new Rt(function(w,k){return Gs(function(S,E){var A=Lt;A.unhandleds=[],A.onunhandled=E,A.finalize=lt(function(){var M,G=this;M=function(){G.unhandleds.length===0?S():E(G.unhandleds[0])},Xa.push(function J(){M(),Xa.splice(Xa.indexOf(J),1)}),++es,_e(function(){--es==0&&Qu()},[])},A.finalize),h()},p,w,k)})}}),te&&(te.allSettled&&g(Rt,"allSettled",function(){var h=ft.apply(null,arguments).map(ti);return new Rt(function(p){h.length===0&&p([]);var w=h.length,k=new Array(w);h.forEach(function(S,E){return Rt.resolve(S).then(function(A){return k[E]={status:"fulfilled",value:A}},function(A){return k[E]={status:"rejected",reason:A}}).then(function(){return--w||p(k)})})})}),te.any&&typeof AggregateError<"u"&&g(Rt,"any",function(){var h=ft.apply(null,arguments).map(ti);return new Rt(function(p,w){h.length===0&&w(new AggregateError([]));var k=h.length,S=new Array(k);h.forEach(function(E,A){return Rt.resolve(E).then(function(M){return p(M)},function(M){S[A]=M,--k||w(new AggregateError(S))})})})}),te.withResolvers)&&(Rt.withResolvers=te.withResolvers);var Ze={awaits:0,echoes:0,id:0},gw=0,Za=[],Qa=0,Ja=0,yw=0;function Gs(h,A,w,k){var S=Lt,E=Object.create(S),A=(E.parent=S,E.ref=0,E.global=!1,E.id=++yw,Ce.env,E.env=ne?{Promise:Rt,PromiseProp:{value:Rt,configurable:!0,writable:!0},all:Rt.all,race:Rt.race,allSettled:Rt.allSettled,any:Rt.any,resolve:Rt.resolve,reject:Rt.reject}:{},A&&u(E,A),++S.ref,E.finalize=function(){--this.parent.ref||this.parent.finalize()},vr(E,h,w,k));return E.ref===0&&E.finalize(),A}function ro(){return Ze.id||(Ze.id=++gw),++Ze.awaits,Ze.echoes+=zt,Ze.id}function Xs(){return!!Ze.awaits&&(--Ze.awaits==0&&(Ze.id=0),Ze.echoes=Ze.awaits*zt,!0)}function ti(h){return Ze.echoes&&h&&h.constructor===te?(ro(),h.then(function(p){return Xs(),p},function(p){return Xs(),Be(p)})):h}function bw(){var h=Za[Za.length-1];Za.pop(),Ys(h,!1)}function Ys(h,p){var w,k,S=Lt;(p?!Ze.echoes||Qa++&&h===Lt:!Qa||--Qa&&h===Lt)||queueMicrotask(p?(function(E){++Ja,Ze.echoes&&--Ze.echoes!=0||(Ze.echoes=Ze.awaits=Ze.id=0),Za.push(Lt),Ys(E,!0)}).bind(null,h):bw),h!==Lt&&(Lt=h,S===Ce&&(Ce.env=Xh()),ne)&&(w=Ce.env.Promise,k=h.env,S.global||h.global)&&(Object.defineProperty(o,"Promise",k.PromiseProp),w.all=k.all,w.race=k.race,w.resolve=k.resolve,w.reject=k.reject,k.allSettled&&(w.allSettled=k.allSettled),k.any)&&(w.any=k.any)}function Xh(){var h=o.Promise;return ne?{Promise:h,PromiseProp:Object.getOwnPropertyDescriptor(o,"Promise"),all:h.all,race:h.race,allSettled:h.allSettled,any:h.any,resolve:h.resolve,reject:h.reject}:{}}function vr(h,p,w,k,S){var E=Lt;try{return Ys(h,!0),p(w,k,S)}finally{Ys(E,!1)}}function Yh(h,p,w,k){return typeof h!="function"?h:function(){var S=Lt;w&&ro(),Ys(p,!0);try{return h.apply(this,arguments)}finally{Ys(S,!1),k&&queueMicrotask(Xs)}}}function Ju(h){Promise===te&&Ze.echoes===0?Qa===0?h():enqueueNativeMicroTask(h):setTimeout(h,0)}(""+co).indexOf("[native code]")===-1&&(ro=Xs=R);var Be=Rt.reject,kr="",xs="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Zh="String expected.",oo=[],ei="__dbnames",tc="readonly",ec="readwrite";function xr(h,p){return h?p?function(){return h.apply(this,arguments)&&p.apply(this,arguments)}:h:p}var Qh={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function ni(h){return typeof h!="string"||/\./.test(h)?function(p){return p}:function(p){return p[h]===void 0&&h in p&&delete(p=Z(p))[h],p}}function Jh(){throw vt.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function ue(h,p){try{var w=td(h),k=td(p);if(w!==k)return w==="Array"?1:k==="Array"?-1:w==="binary"?1:k==="binary"?-1:w==="string"?1:k==="string"?-1:w==="Date"?1:k!=="Date"?NaN:-1;switch(w){case"number":case"Date":case"string":return p<h?1:h<p?-1:0;case"binary":for(var S=ed(h),E=ed(p),A=S.length,M=E.length,G=A<M?A:M,J=0;J<G;++J)if(S[J]!==E[J])return S[J]<E[J]?-1:1;return A===M?0:A<M?-1:1;case"Array":for(var U=h,j=p,X=U.length,Y=j.length,q=X<Y?X:Y,H=0;H<q;++H){var st=ue(U[H],j[H]);if(st!==0)return st}return X===Y?0:X<Y?-1:1}}catch{}return NaN}function td(h){var p=typeof h;return p=="object"&&(ArrayBuffer.isView(h)||(p=et(h))==="ArrayBuffer")?"binary":p}function ed(h){return h instanceof Uint8Array?h:ArrayBuffer.isView(h)?new Uint8Array(h.buffer,h.byteOffset,h.byteLength):new Uint8Array(h)}function si(h,p,w){var k=h.schema.yProps;return k?(p&&0<w.numFailures&&(p=p.filter(function(S,E){return!w.failures[E]})),Promise.all(k.map(function(S){return S=S.updatesTable,p?h.db.table(S).where("k").anyOf(p).delete():h.db.table(S).clear()})).then(function(){return w})):w}nd.prototype.execute=function(h){var p=this["@@propmod"];if(p.add!==void 0){var w=p.add;if(i(w))return r(r([],i(h)?h:[],!0),w).sort();if(typeof w=="number")return(Number(h)||0)+w;if(typeof w=="bigint")try{return BigInt(h)+w}catch{return BigInt(0)+w}throw new TypeError("Invalid term ".concat(w))}if(p.remove!==void 0){var k=p.remove;if(i(k))return i(h)?h.filter(function(S){return!k.includes(S)}).sort():[];if(typeof k=="number")return Number(h)-k;if(typeof k=="bigint")try{return BigInt(h)-k}catch{return BigInt(0)-k}throw new TypeError("Invalid subtrahend ".concat(k))}return w=(w=p.replacePrefix)==null?void 0:w[0],w&&typeof h=="string"&&h.startsWith(w)?p.replacePrefix[1]+h.substring(w.length):h};var qo=nd;function nd(h){this["@@propmod"]=h}function sd(h,p){for(var w=a(p),k=w.length,S=!1,E=0;E<k;++E){var A=w[E],M=p[A],G=F(h,A);M instanceof qo?(z(h,A,M.execute(G)),S=!0):G!==M&&(z(h,A,M),S=!0)}return S}Te.prototype._trans=function(h,p,w){var k=this._tx||Lt.trans,S=this.name,E=mt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(h==="readonly"?"read":"write"," ").concat(this.name));function A(J,U,j){if(j.schema[S])return p(j.idbtrans,j);throw new vt.NotFound("Table "+S+" not part of transaction")}var M=no();try{var G=k&&k.db._novip===this.db._novip?k===Lt.trans?k._promise(h,A,w):Gs(function(){return k._promise(h,A,w)},{trans:k,transless:Lt.transless||Lt}):(function J(U,j,X,Y){if(U.idbdb&&(U._state.openComplete||Lt.letThrough||U._vip)){var q=U._createTransaction(j,X,U._dbSchema);try{q.create(),U._state.PR1398_maxLoop=3}catch(H){return H.name===qt.InvalidState&&U.isOpen()&&0<--U._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),U.close({disableAutoOpen:!1}),U.open().then(function(){return J(U,j,X,Y)})):Be(H)}return q._promise(j,function(H,st){return Gs(function(){return Lt.trans=q,Y(H,st,q)})}).then(function(H){if(j==="readwrite")try{q.idbtrans.commit()}catch{}return j==="readonly"?H:q._completion.then(function(){return H})})}if(U._state.openComplete)return Be(new vt.DatabaseClosed(U._state.dbOpenError));if(!U._state.isBeingOpened){if(!U._state.autoOpen)return Be(new vt.DatabaseClosed);U.open().catch(R)}return U._state.dbReadyPromise.then(function(){return J(U,j,X,Y)})})(this.db,h,[this.name],A);return E&&(G._consoleTask=E,G=G.catch(function(J){return console.trace(J),Be(J)})),G}finally{M&&so()}},Te.prototype.get=function(h,p){var w=this;return h&&h.constructor===Object?this.where(h).first(p):h==null?Be(new vt.Type("Invalid argument to Table.get()")):this._trans("readonly",function(k){return w.core.get({trans:k,key:h}).then(function(S){return w.hook.reading.fire(S)})}).then(p)},Te.prototype.where=function(h){if(typeof h=="string")return new this.db.WhereClause(this,h);if(i(h))return new this.db.WhereClause(this,"[".concat(h.join("+"),"]"));var p=a(h);if(p.length===1)return this.where(p[0]).equals(h[p[0]]);var w=this.schema.indexes.concat(this.schema.primKey).filter(function(M){if(M.compound&&p.every(function(J){return 0<=M.keyPath.indexOf(J)})){for(var G=0;G<p.length;++G)if(p.indexOf(M.keyPath[G])===-1)return!1;return!0}return!1}).sort(function(M,G){return M.keyPath.length-G.keyPath.length})[0];if(w&&this.db._maxKey!==kr)return A=w.keyPath.slice(0,p.length),this.where(A).equals(A.map(function(M){return h[M]}));!w&&mt&&console.warn("The query ".concat(JSON.stringify(h)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(p.join("+"),"]"));var k=this.schema.idxByName;function S(M,G){return ue(M,G)===0}var A=p.reduce(function(U,G){var J=U[0],U=U[1],j=k[G],X=h[G];return[J||j,J||!j?xr(U,j&&j.multi?function(Y){return Y=F(Y,G),i(Y)&&Y.some(function(q){return S(X,q)})}:function(Y){return S(X,F(Y,G))}):U]},[null,null]),E=A[0],A=A[1];return E?this.where(E.name).equals(h[E.keyPath]).filter(A):w?this.filter(A):this.where(p).equals("")},Te.prototype.filter=function(h){return this.toCollection().and(h)},Te.prototype.count=function(h){return this.toCollection().count(h)},Te.prototype.offset=function(h){return this.toCollection().offset(h)},Te.prototype.limit=function(h){return this.toCollection().limit(h)},Te.prototype.each=function(h){return this.toCollection().each(h)},Te.prototype.toArray=function(h){return this.toCollection().toArray(h)},Te.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Te.prototype.orderBy=function(h){return new this.db.Collection(new this.db.WhereClause(this,i(h)?"[".concat(h.join("+"),"]"):h))},Te.prototype.reverse=function(){return this.toCollection().reverse()},Te.prototype.mapToClass=function(h){for(var p=this.db,w=this.name,k=((this.schema.mappedClass=h).prototype instanceof Jh&&(h=(A=>{var M=U,G=A;if(typeof G!="function"&&G!==null)throw new TypeError("Class extends value "+String(G)+" is not a constructor or null");function J(){this.constructor=M}function U(){return A!==null&&A.apply(this,arguments)||this}return n(M,G),M.prototype=G===null?Object.create(G):(J.prototype=G.prototype,new J),Object.defineProperty(U.prototype,"db",{get:function(){return p},enumerable:!1,configurable:!0}),U.prototype.table=function(){return w},U})(h)),new Set),S=h.prototype;S;S=c(S))Object.getOwnPropertyNames(S).forEach(function(A){return k.add(A)});function E(A){if(!A)return A;var M,G=Object.create(h.prototype);for(M in A)if(!k.has(M))try{G[M]=A[M]}catch{}return G}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=E,this.hook("reading",E),h},Te.prototype.defineClass=function(){return this.mapToClass(function(h){u(this,h)})},Te.prototype.add=function(h,p){var w=this,k=this.schema.primKey,S=k.auto,E=k.keyPath,A=h;return E&&S&&(A=ni(E)(h)),this._trans("readwrite",function(M){return w.core.mutate({trans:M,type:"add",keys:p!=null?[p]:null,values:[A]})}).then(function(M){return M.numFailures?Rt.reject(M.failures[0]):M.lastResult}).then(function(M){if(E)try{z(h,E,M)}catch{}return M})},Te.prototype.upsert=function(h,p){var w=this,k=this.schema.primKey.keyPath;return this._trans("readwrite",function(S){return w.core.get({trans:S,key:h}).then(function(E){var A=E??{};return sd(A,p),k&&z(A,k,h),w.core.mutate({trans:S,type:"put",values:[A],keys:[h],upsert:!0,updates:{keys:[h],changeSpecs:[p]}}).then(function(M){return M.numFailures?Rt.reject(M.failures[0]):!!E})})})},Te.prototype.update=function(h,p){return typeof h!="object"||i(h)?this.where(":id").equals(h).modify(p):(h=F(h,this.schema.primKey.keyPath))===void 0?Be(new vt.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(h).modify(p)},Te.prototype.put=function(h,p){var w=this,k=this.schema.primKey,S=k.auto,E=k.keyPath,A=h;return E&&S&&(A=ni(E)(h)),this._trans("readwrite",function(M){return w.core.mutate({trans:M,type:"put",values:[A],keys:p!=null?[p]:null})}).then(function(M){return M.numFailures?Rt.reject(M.failures[0]):M.lastResult}).then(function(M){if(E)try{z(h,E,M)}catch{}return M})},Te.prototype.delete=function(h){var p=this;return this._trans("readwrite",function(w){return p.core.mutate({trans:w,type:"delete",keys:[h]}).then(function(k){return si(p,[h],k)}).then(function(k){return k.numFailures?Rt.reject(k.failures[0]):void 0})})},Te.prototype.clear=function(){var h=this;return this._trans("readwrite",function(p){return h.core.mutate({trans:p,type:"deleteRange",range:Qh}).then(function(w){return si(h,null,w)})}).then(function(p){return p.numFailures?Rt.reject(p.failures[0]):void 0})},Te.prototype.bulkGet=function(h){var p=this;return this._trans("readonly",function(w){return p.core.getMany({keys:h,trans:w}).then(function(k){return k.map(function(S){return p.hook.reading.fire(S)})})})},Te.prototype.bulkAdd=function(h,p,w){var k=this,S=Array.isArray(p)?p:void 0,E=(w=w||(S?void 0:p))?w.allKeys:void 0;return this._trans("readwrite",function(A){var M=k.schema.primKey,J=M.auto,M=M.keyPath;if(M&&S)throw new vt.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(S&&S.length!==h.length)throw new vt.InvalidArgument("Arguments objects and keys must have the same length");var G=h.length,J=M&&J?h.map(ni(M)):h;return k.core.mutate({trans:A,type:"add",keys:S,values:J,wantResults:E}).then(function(U){var j=U.numFailures,X=U.failures;if(j===0)return E?U.results:U.lastResult;throw new Mt("".concat(k.name,".bulkAdd(): ").concat(j," of ").concat(G," operations failed"),X)})})},Te.prototype.bulkPut=function(h,p,w){var k=this,S=Array.isArray(p)?p:void 0,E=(w=w||(S?void 0:p))?w.allKeys:void 0;return this._trans("readwrite",function(A){var M=k.schema.primKey,J=M.auto,M=M.keyPath;if(M&&S)throw new vt.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(S&&S.length!==h.length)throw new vt.InvalidArgument("Arguments objects and keys must have the same length");var G=h.length,J=M&&J?h.map(ni(M)):h;return k.core.mutate({trans:A,type:"put",keys:S,values:J,wantResults:E}).then(function(U){var j=U.numFailures,X=U.failures;if(j===0)return E?U.results:U.lastResult;throw new Mt("".concat(k.name,".bulkPut(): ").concat(j," of ").concat(G," operations failed"),X)})})},Te.prototype.bulkUpdate=function(h){var p=this,w=this.core,k=h.map(function(A){return A.key}),S=h.map(function(A){return A.changes}),E=[];return this._trans("readwrite",function(A){return w.getMany({trans:A,keys:k,cache:"clone"}).then(function(M){var G=[],J=[],U=(h.forEach(function(j,X){var Y=j.key,q=j.changes,H=M[X];if(H){for(var st=0,at=Object.keys(q);st<at.length;st++){var Q=at[st],dt=q[Q];if(Q===p.schema.primKey.keyPath){if(ue(dt,Y)!==0)throw new vt.Constraint("Cannot update primary key in bulkUpdate()")}else z(H,Q,dt)}E.push(X),G.push(Y),J.push(H)}}),G.length);return w.mutate({trans:A,type:"put",keys:G,values:J,updates:{keys:k,changeSpecs:S}}).then(function(j){var X=j.numFailures,Y=j.failures;if(X===0)return U;for(var q=0,H=Object.keys(Y);q<H.length;q++){var st,at=H[q],Q=E[Number(at)];Q!=null&&(st=Y[at],delete Y[at],Y[Q]=st)}throw new Mt("".concat(p.name,".bulkUpdate(): ").concat(X," of ").concat(U," operations failed"),Y)})})})},Te.prototype.bulkDelete=function(h){var p=this,w=h.length;return this._trans("readwrite",function(k){return p.core.mutate({trans:k,type:"delete",keys:h}).then(function(S){return si(p,h,S)})}).then(function(k){var S=k.numFailures,E=k.failures;if(S===0)return k.lastResult;throw new Mt("".concat(p.name,".bulkDelete(): ").concat(S," of ").concat(w," operations failed"),E)})};var rd=Te;function Te(){}function Ko(h){function p(A,M){if(M){for(var G=arguments.length,J=new Array(G-1);--G;)J[G-1]=arguments[G];return w[A].subscribe.apply(null,J),h}if(typeof A=="string")return w[A]}var w={};p.addEventType=E;for(var k=1,S=arguments.length;k<S;++k)E(arguments[k]);return p;function E(A,M,G){var J,U;if(typeof A!="object")return M=M||Tt,U={subscribers:[],fire:G=G||R,subscribe:function(j){U.subscribers.indexOf(j)===-1&&(U.subscribers.push(j),U.fire=M(U.fire,j))},unsubscribe:function(j){U.subscribers=U.subscribers.filter(function(X){return X!==j}),U.fire=U.subscribers.reduce(M,G)}},w[A]=p[A]=U;a(J=A).forEach(function(j){var X=J[j];if(i(X))E(j,J[j][0],J[j][1]);else{if(X!=="asap")throw new vt.InvalidArgument("Invalid event config");var Y=E(j,B,function(){for(var q=arguments.length,H=new Array(q);q--;)H[q]=arguments[q];Y.subscribers.forEach(function(st){C(function(){st.apply(null,H)})})})}})}}function Uo(h,p){return b(p).from({prototype:h}),p}function ao(h,p){return!(h.filter||h.algorithm||h.or)&&(p?h.justLimit:!h.replayFilter)}function nc(h,p){h.filter=xr(h.filter,p)}function sc(h,p,w){var k=h.replayFilter;h.replayFilter=k?function(){return xr(k(),p())}:p,h.justLimit=w&&!k}function ri(h,p){if(h.isPrimKey)return p.primaryKey;var w=p.getIndexByKeyPath(h.index);if(w)return w;throw new vt.Schema("KeyPath "+h.index+" on object store "+p.name+" is not indexed")}function od(h,p,w){var k=ri(h,p.schema);return p.openCursor({trans:w,values:!h.keysOnly,reverse:h.dir==="prev",unique:!!h.unique,query:{index:k,range:h.range}})}function oi(h,p,w,k){var S,E,A=h.replayFilter?xr(h.filter,h.replayFilter()):h.filter;return h.or?(S={},E=function(M,G,J){var U,j;A&&!A(G,J,function(X){return G.stop(X)},function(X){return G.fail(X)})||((j=""+(U=G.primaryKey))=="[object ArrayBuffer]"&&(j=""+new Uint8Array(U)),f(S,j))||(S[j]=!0,p(M,G,J))},Promise.all([h.or._iterate(E,w),ad(od(h,k,w),h.algorithm,E,!h.keysOnly&&h.valueMapper)])):ad(od(h,k,w),xr(h.algorithm,A),p,!h.keysOnly&&h.valueMapper)}function ad(h,p,w,k){var S=Ae(k?function(E,A,M){return w(k(E),A,M)}:w);return h.then(function(E){if(E)return E.start(function(){var A=function(){return E.continue()};p&&!p(E,function(M){return A=M},function(M){E.stop(M),A=R},function(M){E.fail(M),A=R})||S(E.value,E,function(M){return A=M}),A()})})}fe.prototype._read=function(h,p){var w=this._ctx;return w.error?w.table._trans(null,Be.bind(null,w.error)):w.table._trans("readonly",h).then(p)},fe.prototype._write=function(h){var p=this._ctx;return p.error?p.table._trans(null,Be.bind(null,p.error)):p.table._trans("readwrite",h,"locked")},fe.prototype._addAlgorithm=function(h){var p=this._ctx;p.algorithm=xr(p.algorithm,h)},fe.prototype._iterate=function(h,p){return oi(this._ctx,h,p,this._ctx.table.core)},fe.prototype.clone=function(h){var p=Object.create(this.constructor.prototype),w=Object.create(this._ctx);return h&&u(w,h),p._ctx=w,p},fe.prototype.raw=function(){return this._ctx.valueMapper=null,this},fe.prototype.each=function(h){var p=this._ctx;return this._read(function(w){return oi(p,h,w,p.table.core)})},fe.prototype.count=function(h){var p=this;return this._read(function(w){var k,S=p._ctx,E=S.table.core;return ao(S,!0)?E.count({trans:w,query:{index:ri(S,E.schema),range:S.range}}).then(function(A){return Math.min(A,S.limit)}):(k=0,oi(S,function(){return++k,!1},w,E).then(function(){return k}))}).then(h)},fe.prototype.sortBy=function(h,p){var w=h.split(".").reverse(),k=w[0],S=w.length-1;function E(G,J){return J?E(G[w[J]],J-1):G[k]}var A=this._ctx.dir==="next"?1:-1;function M(G,J){return ue(E(G,S),E(J,S))*A}return this.toArray(function(G){return G.sort(M)}).then(p)},fe.prototype.toArray=function(h){var p=this;return this._read(function(w){var k,S,E,A=p._ctx;return A.dir==="next"&&ao(A,!0)&&0<A.limit?(k=A.valueMapper,S=ri(A,A.table.core.schema),A.table.core.query({trans:w,limit:A.limit,values:!0,query:{index:S,range:A.range}}).then(function(M){return M=M.result,k?M.map(k):M})):(E=[],oi(A,function(M){return E.push(M)},w,A.table.core).then(function(){return E}))},h)},fe.prototype.offset=function(h){var p=this._ctx;return h<=0||(p.offset+=h,ao(p)?sc(p,function(){var w=h;return function(k,S){return w===0||(w===1?--w:S(function(){k.advance(w),w=0}),!1)}}):sc(p,function(){var w=h;return function(){return--w<0}})),this},fe.prototype.limit=function(h){return this._ctx.limit=Math.min(this._ctx.limit,h),sc(this._ctx,function(){var p=h;return function(w,k,S){return--p<=0&&k(S),0<=p}},!0),this},fe.prototype.until=function(h,p){return nc(this._ctx,function(w,k,S){return!h(w.value)||(k(S),p)}),this},fe.prototype.first=function(h){return this.limit(1).toArray(function(p){return p[0]}).then(h)},fe.prototype.last=function(h){return this.reverse().first(h)},fe.prototype.filter=function(h){var p;return nc(this._ctx,function(w){return h(w.value)}),(p=this._ctx).isMatch=xr(p.isMatch,h),this},fe.prototype.and=function(h){return this.filter(h)},fe.prototype.or=function(h){return new this.db.WhereClause(this._ctx.table,h,this)},fe.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},fe.prototype.desc=function(){return this.reverse()},fe.prototype.eachKey=function(h){var p=this._ctx;return p.keysOnly=!p.isMatch,this.each(function(w,k){h(k.key,k)})},fe.prototype.eachUniqueKey=function(h){return this._ctx.unique="unique",this.eachKey(h)},fe.prototype.eachPrimaryKey=function(h){var p=this._ctx;return p.keysOnly=!p.isMatch,this.each(function(w,k){h(k.primaryKey,k)})},fe.prototype.keys=function(h){var p=this._ctx,w=(p.keysOnly=!p.isMatch,[]);return this.each(function(k,S){w.push(S.key)}).then(function(){return w}).then(h)},fe.prototype.primaryKeys=function(h){var p=this._ctx;if(p.dir==="next"&&ao(p,!0)&&0<p.limit)return this._read(function(k){var S=ri(p,p.table.core.schema);return p.table.core.query({trans:k,values:!1,limit:p.limit,query:{index:S,range:p.range}})}).then(function(k){return k.result}).then(h);p.keysOnly=!p.isMatch;var w=[];return this.each(function(k,S){w.push(S.primaryKey)}).then(function(){return w}).then(h)},fe.prototype.uniqueKeys=function(h){return this._ctx.unique="unique",this.keys(h)},fe.prototype.firstKey=function(h){return this.limit(1).keys(function(p){return p[0]}).then(h)},fe.prototype.lastKey=function(h){return this.reverse().firstKey(h)},fe.prototype.distinct=function(){var h,p=this._ctx,p=p.index&&p.table.schema.idxByName[p.index];return p&&p.multi&&(h={},nc(this._ctx,function(k){var k=k.primaryKey.toString(),S=f(h,k);return h[k]=!0,!S})),this},fe.prototype.modify=function(h){var p=this,w=this._ctx;return this._write(function(k){function S(H,st){var at=st.failures;X+=H-st.numFailures;for(var Q=0,dt=a(at);Q<dt.length;Q++){var xt=dt[Q];j.push(at[xt])}}var E=typeof h=="function"?h:function(H){return sd(H,h)},A=w.table.core,U=A.schema.primaryKey,M=U.outbound,G=U.extractKey,J=200,U=p.db._options.modifyChunkSize,j=(U&&(J=typeof U=="object"?U[A.name]||U["*"]||200:U),[]),X=0,Y=[],q=h===id;return p.clone().primaryKeys().then(function(H){function st(Q){var dt=Math.min(J,H.length-Q),xt=H.slice(Q,Q+dt);return(q?Promise.resolve([]):A.getMany({trans:k,keys:xt,cache:"immutable"})).then(function(At){var Dt=[],St=[],Vt=M?[]:null,Pt=q?xt:[];if(!q)for(var Et=0;Et<dt;++Et){var Wt=At[Et],le={value:Z(Wt),primKey:H[Q+Et]};E.call(le,le.value,le)!==!1&&(le.value==null?Pt.push(H[Q+Et]):M||ue(G(Wt),G(le.value))===0?(St.push(le.value),M&&Vt.push(H[Q+Et])):(Pt.push(H[Q+Et]),Dt.push(le.value)))}return Promise.resolve(0<Dt.length&&A.mutate({trans:k,type:"add",values:Dt}).then(function(he){for(var Gt in he.failures)Pt.splice(parseInt(Gt),1);S(Dt.length,he)})).then(function(){return(0<St.length||at&&typeof h=="object")&&A.mutate({trans:k,type:"put",keys:Vt,values:St,criteria:at,changeSpec:typeof h!="function"&&h,isAdditionalChunk:0<Q}).then(function(he){return S(St.length,he)})}).then(function(){return(0<Pt.length||at&&q)&&A.mutate({trans:k,type:"delete",keys:Pt,criteria:at,isAdditionalChunk:0<Q}).then(function(he){return si(w.table,Pt,he)}).then(function(he){return S(Pt.length,he)})}).then(function(){return H.length>Q+dt&&st(Q+J)})})}var at=ao(w)&&w.limit===1/0&&(typeof h!="function"||q)&&{index:w.index,range:w.range};return st(0).then(function(){if(0<j.length)throw new Ot("Error modifying one or more objects",j,X,Y);return H.length})})})},fe.prototype.delete=function(){var h=this._ctx,p=h.range;return!ao(h)||h.table.schema.yProps||!h.isPrimKey&&p.type!==3?this.modify(id):this._write(function(w){var k=h.table.core.schema.primaryKey,S=p;return h.table.core.count({trans:w,query:{index:k,range:S}}).then(function(E){return h.table.core.mutate({trans:w,type:"deleteRange",range:S}).then(function(G){var M=G.failures,G=G.numFailures;if(G)throw new Ot("Could not delete some values",Object.keys(M).map(function(J){return M[J]}),E-G);return E-G})})})};var ww=fe;function fe(){}var id=function(h,p){return p.value=null};function vw(h,p){return h<p?-1:h===p?0:1}function kw(h,p){return p<h?-1:h===p?0:1}function An(h,p,w){return h=h instanceof cd?new h.Collection(h):h,h._ctx.error=new(w||TypeError)(p),h}function io(h){return new h.Collection(h,function(){return ud("")}).limit(0)}function ai(Y,p,w,k){var S,E,A,M,G,J,U,j=w.length;if(!w.every(function(H){return typeof H=="string"}))return An(Y,Zh);function X(H){S=H==="next"?function(at){return at.toUpperCase()}:function(at){return at.toLowerCase()},E=H==="next"?function(at){return at.toLowerCase()}:function(at){return at.toUpperCase()},A=H==="next"?vw:kw;var st=w.map(function(at){return{lower:E(at),upper:S(at)}}).sort(function(at,Q){return A(at.lower,Q.lower)});M=st.map(function(at){return at.upper}),G=st.map(function(at){return at.lower}),U=(J=H)==="next"?"":k}X("next");var Y=new Y.Collection(Y,function(){return Zs(M[0],G[j-1]+k)}),q=(Y._ondirectionchange=function(H){X(H)},0);return Y._addAlgorithm(function(H,st,at){var Q=H.key;if(typeof Q=="string"){var dt=E(Q);if(p(dt,G,q))return!0;for(var xt=null,At=q;At<j;++At){var Dt=((St,Vt,Pt,Et,Wt,le)=>{for(var he=Math.min(St.length,Et.length),Gt=-1,re=0;re<he;++re){var Fe=Vt[re];if(Fe!==Et[re])return Wt(St[re],Pt[re])<0?St.substr(0,re)+Pt[re]+Pt.substr(re+1):Wt(St[re],Et[re])<0?St.substr(0,re)+Et[re]+Pt.substr(re+1):0<=Gt?St.substr(0,Gt)+Vt[Gt]+Pt.substr(Gt+1):null;Wt(St[re],Fe)<0&&(Gt=re)}return he<Et.length&&le==="next"?St+Pt.substr(St.length):he<St.length&&le==="prev"?St.substr(0,Pt.length):Gt<0?null:St.substr(0,Gt)+Et[Gt]+Pt.substr(Gt+1)})(Q,dt,M[At],G[At],A,J);Dt===null&&xt===null?q=At+1:(xt===null||0<A(xt,Dt))&&(xt=Dt)}st(xt!==null?function(){H.continue(xt+U)}:at)}return!1}),Y}function Zs(h,p,w,k){return{type:2,lower:h,upper:p,lowerOpen:w,upperOpen:k}}function ud(h){return{type:1,lower:h,upper:h}}Object.defineProperty(Qe.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Qe.prototype.between=function(h,p,w,k){w=w!==!1,k=k===!0;try{return 0<this._cmp(h,p)||this._cmp(h,p)===0&&(w||k)&&(!w||!k)?io(this):new this.Collection(this,function(){return Zs(h,p,!w,!k)})}catch{return An(this,xs)}},Qe.prototype.equals=function(h){return h==null?An(this,xs):new this.Collection(this,function(){return ud(h)})},Qe.prototype.above=function(h){return h==null?An(this,xs):new this.Collection(this,function(){return Zs(h,void 0,!0)})},Qe.prototype.aboveOrEqual=function(h){return h==null?An(this,xs):new this.Collection(this,function(){return Zs(h,void 0,!1)})},Qe.prototype.below=function(h){return h==null?An(this,xs):new this.Collection(this,function(){return Zs(void 0,h,!1,!0)})},Qe.prototype.belowOrEqual=function(h){return h==null?An(this,xs):new this.Collection(this,function(){return Zs(void 0,h)})},Qe.prototype.startsWith=function(h){return typeof h!="string"?An(this,Zh):this.between(h,h+kr,!0,!0)},Qe.prototype.startsWithIgnoreCase=function(h){return h===""?this.startsWith(h):ai(this,function(p,w){return p.indexOf(w[0])===0},[h],kr)},Qe.prototype.equalsIgnoreCase=function(h){return ai(this,function(p,w){return p===w[0]},[h],"")},Qe.prototype.anyOfIgnoreCase=function(){var h=ft.apply(ut,arguments);return h.length===0?io(this):ai(this,function(p,w){return w.indexOf(p)!==-1},h,"")},Qe.prototype.startsWithAnyOfIgnoreCase=function(){var h=ft.apply(ut,arguments);return h.length===0?io(this):ai(this,function(p,w){return w.some(function(k){return p.indexOf(k)===0})},h,kr)},Qe.prototype.anyOf=function(){var h,p,w=this,k=ft.apply(ut,arguments),S=this._cmp;try{k.sort(S)}catch{return An(this,xs)}return k.length===0?io(this):((h=new this.Collection(this,function(){return Zs(k[0],k[k.length-1])}))._ondirectionchange=function(E){S=E==="next"?w._ascending:w._descending,k.sort(S)},p=0,h._addAlgorithm(function(E,A,M){for(var G=E.key;0<S(G,k[p]);)if(++p===k.length)return A(M),!1;return S(G,k[p])===0||(A(function(){E.continue(k[p])}),!1)}),h)},Qe.prototype.notEqual=function(h){return this.inAnyRange([[-1/0,h],[h,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Qe.prototype.noneOf=function(){var h=ft.apply(ut,arguments);if(h.length===0)return new this.Collection(this);try{h.sort(this._ascending)}catch{return An(this,xs)}var p=h.reduce(function(w,k){return w?w.concat([[w[w.length-1][1],k]]):[[-1/0,k]]},null);return p.push([h[h.length-1],this.db._maxKey]),this.inAnyRange(p,{includeLowers:!1,includeUppers:!1})},Qe.prototype.inAnyRange=function(h,at){var w=this,k=this._cmp,S=this._ascending,E=this._descending,A=this._min,M=this._max;if(h.length===0)return io(this);if(!h.every(function(Q){return Q[0]!==void 0&&Q[1]!==void 0&&S(Q[0],Q[1])<=0}))return An(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",vt.InvalidArgument);var G=!at||at.includeLowers!==!1,J=at&&at.includeUppers===!0,U,j=S;function X(Q,dt){return j(Q[0],dt[0])}try{(U=h.reduce(function(Q,dt){for(var xt=0,At=Q.length;xt<At;++xt){var Dt=Q[xt];if(k(dt[0],Dt[1])<0&&0<k(dt[1],Dt[0])){Dt[0]=A(Dt[0],dt[0]),Dt[1]=M(Dt[1],dt[1]);break}}return xt===At&&Q.push(dt),Q},[])).sort(X)}catch{return An(this,xs)}var Y=0,q=J?function(Q){return 0<S(Q,U[Y][1])}:function(Q){return 0<=S(Q,U[Y][1])},H=G?function(Q){return 0<E(Q,U[Y][0])}:function(Q){return 0<=E(Q,U[Y][0])},st=q,at=new this.Collection(this,function(){return Zs(U[0][0],U[U.length-1][1],!G,!J)});return at._ondirectionchange=function(Q){j=Q==="next"?(st=q,S):(st=H,E),U.sort(X)},at._addAlgorithm(function(Q,dt,xt){for(var At,Dt=Q.key;st(Dt);)if(++Y===U.length)return dt(xt),!1;return!q(At=Dt)&&!H(At)||(w._cmp(Dt,U[Y][1])===0||w._cmp(Dt,U[Y][0])===0||dt(function(){j===S?Q.continue(U[Y][0]):Q.continue(U[Y][1])}),!1)}),at},Qe.prototype.startsWithAnyOf=function(){var h=ft.apply(ut,arguments);return h.every(function(p){return typeof p=="string"})?h.length===0?io(this):this.inAnyRange(h.map(function(p){return[p,p+kr]})):An(this,"startsWithAnyOf() only works with strings")};var cd=Qe;function Qe(){}function ns(h){return Ae(function(p){return Go(p),h(p.target.error),!1})}function Go(h){h.stopPropagation&&h.stopPropagation(),h.preventDefault&&h.preventDefault()}var Xo="storagemutated",rc="x-storagemutated-1",Qs=Ko(null,Xo),xw=(ss.prototype._lock=function(){return N(!Lt.global),++this._reculock,this._reculock!==1||Lt.global||(Lt.lockOwnerFor=this),this},ss.prototype._unlock=function(){if(N(!Lt.global),--this._reculock==0)for(Lt.global||(Lt.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var h=this._blockedFuncs.shift();try{vr(h[1],h[0])}catch{}}return this},ss.prototype._locked=function(){return this._reculock&&Lt.lockOwnerFor!==this},ss.prototype.create=function(h){var p=this;if(this.mode){var w=this.db.idbdb,k=this.db._state.dbOpenError;if(N(!this.idbtrans),!h&&!w)switch(k&&k.name){case"DatabaseClosedError":throw new vt.DatabaseClosed(k);case"MissingAPIError":throw new vt.MissingAPI(k.message,k);default:throw new vt.OpenFailed(k)}if(!this.active)throw new vt.TransactionInactive;N(this._completion._state===null),(h=this.idbtrans=h||(this.db.core||w).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Ae(function(S){Go(S),p._reject(h.error)}),h.onabort=Ae(function(S){Go(S),p.active&&p._reject(new vt.Abort(h.error)),p.active=!1,p.on("abort").fire(S)}),h.oncomplete=Ae(function(){p.active=!1,p._resolve(),"mutatedParts"in h&&Qs.storagemutated.fire(h.mutatedParts)})}return this},ss.prototype._promise=function(h,p,w){var k,S=this;return h==="readwrite"&&this.mode!=="readwrite"?Be(new vt.ReadOnly("Transaction is readonly")):this.active?this._locked()?new Rt(function(E,A){S._blockedFuncs.push([function(){S._promise(h,p,w).then(E,A)},Lt])}):w?Gs(function(){var E=new Rt(function(A,M){S._lock();var G=p(A,M,S);G&&G.then&&G.then(A,M)});return E.finally(function(){return S._unlock()}),E._lib=!0,E}):((k=new Rt(function(E,A){var M=p(E,A,S);M&&M.then&&M.then(E,A)}))._lib=!0,k):Be(new vt.TransactionInactive)},ss.prototype._root=function(){return this.parent?this.parent._root():this},ss.prototype.waitFor=function(h){var p,w=this._root(),k=Rt.resolve(h),S=(w._waitingFor?w._waitingFor=w._waitingFor.then(function(){return k}):(w._waitingFor=k,w._waitingQueue=[],p=w.idbtrans.objectStore(w.storeNames[0]),(function E(){for(++w._spinCount;w._waitingQueue.length;)w._waitingQueue.shift()();w._waitingFor&&(p.get(-1/0).onsuccess=E)})()),w._waitingFor);return new Rt(function(E,A){k.then(function(M){return w._waitingQueue.push(Ae(E.bind(null,M)))},function(M){return w._waitingQueue.push(Ae(A.bind(null,M)))}).finally(function(){w._waitingFor===S&&(w._waitingFor=null)})})},ss.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new vt.Abort))},ss.prototype.table=function(h){var p=this._memoizedTables||(this._memoizedTables={});if(f(p,h))return p[h];var w=this.schema[h];if(w)return(w=new this.db.Table(h,w,this)).core=this.db.core.table(h),p[h]=w;throw new vt.NotFound("Table "+h+" not part of transaction")},ss);function ss(){}function oc(h,p,w,k,S,E,A,M){return{name:h,keyPath:p,unique:w,multi:k,auto:S,compound:E,src:(w&&!A?"&":"")+(k?"*":"")+(S?"++":"")+ld(p),type:M}}function ld(h){return typeof h=="string"?h:h?"["+[].join.call(h,"+")+"]":""}function ac(h,p,w){return{name:h,primKey:p,indexes:w,mappedClass:null,idxByName:(k=function(S){return[S.name,S]},w.reduce(function(S,E,A){return E=k(E,A),E&&(S[E[0]]=E[1]),S},{}))};var k}var Yo=function(h){try{return h.only([[]]),Yo=function(){return[[]]},[[]]}catch{return Yo=function(){return kr},kr}};function ic(h){return h==null?function(){}:typeof h=="string"?(p=h).split(".").length===1?function(w){return w[p]}:function(w){return F(w,p)}:function(w){return F(w,h)};var p}function fd(h){return[].slice.call(h)}var Sw=0;function Zo(h){return h==null?":id":typeof h=="string"?h:"[".concat(h.join("+"),"]")}function Iw(h,p,G){function k(q){if(q.type===3)return null;if(q.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var j=q.lower,X=q.upper,Y=q.lowerOpen,q=q.upperOpen;return j===void 0?X===void 0?null:p.upperBound(X,!!q):X===void 0?p.lowerBound(j,!!Y):p.bound(j,X,!!Y,!!q)}function S(U){var j,X=U.name;return{name:X,schema:U,mutate:function(Y){var q=Y.trans,H=Y.type,st=Y.keys,at=Y.values,Q=Y.range;return new Promise(function(dt,xt){dt=Ae(dt);var At=q.objectStore(X),Dt=At.keyPath==null,St=H==="put"||H==="add";if(!St&&H!=="delete"&&H!=="deleteRange")throw new Error("Invalid operation type: "+H);var Vt,Pt=(st||at||{length:1}).length;if(st&&at&&st.length!==at.length)throw new Error("Given keys array must have same length as given values array.");if(Pt===0)return dt({numFailures:0,failures:{},results:[],lastResult:void 0});function Et(Le){++he,Go(Le)}var Wt=[],le=[],he=0;if(H==="deleteRange"){if(Q.type===4)return dt({numFailures:he,failures:le,results:[],lastResult:void 0});Q.type===3?Wt.push(Vt=At.clear()):Wt.push(Vt=At.delete(k(Q)))}else{var Dt=St?Dt?[at,st]:[at,null]:[st,null],Gt=Dt[0],re=Dt[1];if(St)for(var Fe=0;Fe<Pt;++Fe)Wt.push(Vt=re&&re[Fe]!==void 0?At[H](Gt[Fe],re[Fe]):At[H](Gt[Fe])),Vt.onerror=Et;else for(Fe=0;Fe<Pt;++Fe)Wt.push(Vt=At[H](Gt[Fe])),Vt.onerror=Et}function Mn(Le){Le=Le.target.result,Wt.forEach(function(Nr,Nc){return Nr.error!=null&&(le[Nc]=Nr.error)}),dt({numFailures:he,failures:le,results:H==="delete"?st:Wt.map(function(Nr){return Nr.result}),lastResult:Le})}Vt.onerror=function(Le){Et(Le),Mn(Le)},Vt.onsuccess=Mn})},getMany:function(Y){var q=Y.trans,H=Y.keys;return new Promise(function(st,at){st=Ae(st);for(var Q,dt=q.objectStore(X),xt=H.length,At=new Array(xt),Dt=0,St=0,Vt=function(Wt){Wt=Wt.target,At[Wt._pos]=Wt.result,++St===Dt&&st(At)},Pt=ns(at),Et=0;Et<xt;++Et)H[Et]!=null&&((Q=dt.get(H[Et]))._pos=Et,Q.onsuccess=Vt,Q.onerror=Pt,++Dt);Dt===0&&st(At)})},get:function(Y){var q=Y.trans,H=Y.key;return new Promise(function(st,at){st=Ae(st);var Q=q.objectStore(X).get(H);Q.onsuccess=function(dt){return st(dt.target.result)},Q.onerror=ns(at)})},query:(j=M,function(Y){return new Promise(function(q,H){q=Ae(q);var st,at,Q,St=Y.trans,dt=Y.values,xt=Y.limit,Dt=Y.query,At=xt===1/0?void 0:xt,Vt=Dt.index,Dt=Dt.range,St=St.objectStore(X),St=Vt.isPrimaryKey?St:St.index(Vt.name),Vt=k(Dt);if(xt===0)return q({result:[]});j?((Dt=dt?St.getAll(Vt,At):St.getAllKeys(Vt,At)).onsuccess=function(Pt){return q({result:Pt.target.result})},Dt.onerror=ns(H)):(st=0,at=!dt&&"openKeyCursor"in St?St.openKeyCursor(Vt):St.openCursor(Vt),Q=[],at.onsuccess=function(Pt){var Et=at.result;return!Et||(Q.push(dt?Et.value:Et.primaryKey),++st===xt)?q({result:Q}):void Et.continue()},at.onerror=ns(H))})}),openCursor:function(Y){var q=Y.trans,H=Y.values,st=Y.query,at=Y.reverse,Q=Y.unique;return new Promise(function(dt,xt){dt=Ae(dt);var St=st.index,At=st.range,Dt=q.objectStore(X),Dt=St.isPrimaryKey?Dt:Dt.index(St.name),St=at?Q?"prevunique":"prev":Q?"nextunique":"next",Vt=!H&&"openKeyCursor"in Dt?Dt.openKeyCursor(k(At),St):Dt.openCursor(k(At),St);Vt.onerror=ns(xt),Vt.onsuccess=Ae(function(Pt){var Et,Wt,le,he,Gt=Vt.result;Gt?(Gt.___id=++Sw,Gt.done=!1,Et=Gt.continue.bind(Gt),Wt=(Wt=Gt.continuePrimaryKey)&&Wt.bind(Gt),le=Gt.advance.bind(Gt),he=function(){throw new Error("Cursor not stopped")},Gt.trans=q,Gt.stop=Gt.continue=Gt.continuePrimaryKey=Gt.advance=function(){throw new Error("Cursor not started")},Gt.fail=Ae(xt),Gt.next=function(){var re=this,Fe=1;return this.start(function(){return Fe--?re.continue():re.stop()}).then(function(){return re})},Gt.start=function(re){function Fe(){if(Vt.result)try{re()}catch(Le){Gt.fail(Le)}else Gt.done=!0,Gt.start=function(){throw new Error("Cursor behind last entry")},Gt.stop()}var Mn=new Promise(function(Le,Nr){Le=Ae(Le),Vt.onerror=ns(Nr),Gt.fail=Nr,Gt.stop=function(Nc){Gt.stop=Gt.continue=Gt.continuePrimaryKey=Gt.advance=he,Le(Nc)}});return Vt.onsuccess=Ae(function(Le){Vt.onsuccess=Fe,Fe()}),Gt.continue=Et,Gt.continuePrimaryKey=Wt,Gt.advance=le,Fe(),Mn},dt(Gt)):dt(null)},xt)})},count:function(Y){var q=Y.query,H=Y.trans,st=q.index,at=q.range;return new Promise(function(Q,dt){var xt=H.objectStore(X),xt=st.isPrimaryKey?xt:xt.index(st.name),At=k(at),At=At?xt.count(At):xt.count();At.onsuccess=Ae(function(Dt){return Q(Dt.target.result)}),At.onerror=ns(dt)})}}}E=G,A=fd((G=h).objectStoreNames);var E,G={schema:{name:G.name,tables:A.map(function(U){return E.objectStore(U)}).map(function(U){var j=U.keyPath,X=U.autoIncrement,q=i(j),Y={},q={name:U.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:j==null,compound:q,keyPath:j,autoIncrement:X,unique:!0,extractKey:ic(j)},indexes:fd(U.indexNames).map(function(H){return U.index(H)}).map(function(Q){var dt=Q.name,st=Q.unique,at=Q.multiEntry,Q=Q.keyPath,dt={name:dt,compound:i(Q),keyPath:Q,unique:st,multiEntry:at,extractKey:ic(Q)};return Y[Zo(Q)]=dt}),getIndexByKeyPath:function(H){return Y[Zo(H)]}};return Y[":id"]=q.primaryKey,j!=null&&(Y[Zo(j)]=q.primaryKey),q})},hasGetAll:0<A.length&&"getAll"in E.objectStore(A[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},A=G.schema,M=G.hasGetAll,G=A.tables.map(S),J={};return G.forEach(function(U){return J[U.name]=U}),{stack:"dbcore",transaction:h.transaction.bind(h),table:function(U){if(J[U])return J[U];throw new Error("Table '".concat(U,"' not found"))},MIN_KEY:-1/0,MAX_KEY:Yo(p),schema:A}}function Nw(h,p,w,k){return w=w.IDBKeyRange,p=Iw(p,w,k),{dbcore:h.dbcore.reduce(function(S,E){return E=E.create,s(s({},S),E(S))},p)}}function ii(h,p){var w=p.db,w=Nw(h._middlewares,w,h._deps,p);h.core=w.dbcore,h.tables.forEach(function(k){var S=k.name;h.core.schema.tables.some(function(E){return E.name===S})&&(k.core=h.core.table(S),h[S]instanceof h.Table)&&(h[S].core=k.core)})}function ui(h,p,w,k){w.forEach(function(S){var E=k[S];p.forEach(function(A){var M=(function G(J,U){return y(J,U)||(J=c(J))&&G(J,U)})(A,S);(!M||"value"in M&&M.value===void 0)&&(A===h.Transaction.prototype||A instanceof h.Transaction?g(A,S,{get:function(){return this.table(S)},set:function(G){m(this,S,{value:G,writable:!0,configurable:!0,enumerable:!0})}}):A[S]=new h.Table(S,E))})})}function uc(h,p){p.forEach(function(w){for(var k in w)w[k]instanceof h.Table&&delete w[k]})}function _w(h,p){return h._cfg.version-p._cfg.version}function Tw(h,p,w,k){var S=h._dbSchema,E=(w.objectStoreNames.contains("$meta")&&!S.$meta&&(S.$meta=ac("$meta",dd("")[0],[]),h._storeNames.push("$meta")),h._createTransaction("readwrite",h._storeNames,S)),A=(E.create(w),E._completion.catch(k),E._reject.bind(E)),M=Lt.transless||Lt;Gs(function(){if(Lt.trans=E,Lt.transless=M,p!==0)return ii(h,w),J=p,((G=E).storeNames.includes("$meta")?G.table("$meta").get("version").then(function(U){return U??J}):Rt.resolve(J)).then(function(st){var j=h,X=st,Y=E,q=w,H=[],st=j._versions,at=j._dbSchema=li(0,j.idbdb,q);return(st=st.filter(function(Q){return Q._cfg.version>=X})).length===0?Rt.resolve():(st.forEach(function(Q){H.push(function(){var dt,xt,At,Dt=at,St=Q._cfg.dbschema,Vt=(fi(j,Dt,q),fi(j,St,q),at=j._dbSchema=St,cc(Dt,St)),Pt=(Vt.add.forEach(function(Et){lc(q,Et[0],Et[1].primKey,Et[1].indexes)}),Vt.change.forEach(function(Et){if(Et.recreate)throw new vt.Upgrade("Not yet support for changing primary key");var Wt=q.objectStore(Et.name);Et.add.forEach(function(le){return ci(Wt,le)}),Et.change.forEach(function(le){Wt.deleteIndex(le.name),ci(Wt,le)}),Et.del.forEach(function(le){return Wt.deleteIndex(le)})}),Q._cfg.contentUpgrade);if(Pt&&Q._cfg.version>X)return ii(j,q),Y._memoizedTables={},dt=P(St),Vt.del.forEach(function(Et){dt[Et]=Dt[Et]}),uc(j,[j.Transaction.prototype]),ui(j,[j.Transaction.prototype],a(dt),dt),Y.schema=dt,(xt=yt(Pt))&&ro(),St=Rt.follow(function(){var Et;(At=Pt(Y))&&xt&&(Et=Xs.bind(null,null),At.then(Et,Et))}),At&&typeof At.then=="function"?Rt.resolve(At):St.then(function(){return At})}),H.push(function(dt){var xt,At,Dt=Q._cfg.dbschema;xt=Dt,At=dt,[].slice.call(At.db.objectStoreNames).forEach(function(St){return xt[St]==null&&At.db.deleteObjectStore(St)}),uc(j,[j.Transaction.prototype]),ui(j,[j.Transaction.prototype],j._storeNames,j._dbSchema),Y.schema=j._dbSchema}),H.push(function(dt){j.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(j.idbdb.version/10)===Q._cfg.version?(j.idbdb.deleteObjectStore("$meta"),delete j._dbSchema.$meta,j._storeNames=j._storeNames.filter(function(xt){return xt!=="$meta"})):dt.objectStore("$meta").put(Q._cfg.version,"version"))})}),(function Q(){return H.length?Rt.resolve(H.shift()(Y.idbtrans)).then(Q):Rt.resolve()})().then(function(){hd(at,q)}))}).catch(A);var G,J;a(S).forEach(function(U){lc(w,U,S[U].primKey,S[U].indexes)}),ii(h,w),Rt.follow(function(){return h.on.populate.fire(E)}).catch(A)})}function Ew(h,p){hd(h._dbSchema,p),p.db.version%10!=0||p.objectStoreNames.contains("$meta")||p.db.createObjectStore("$meta").add(Math.ceil(p.db.version/10-1),"version");var w=li(0,h.idbdb,p);fi(h,h._dbSchema,p);for(var k=0,S=cc(w,h._dbSchema).change;k<S.length;k++){var E=(A=>{if(A.change.length||A.recreate)return console.warn("Unable to patch indexes of table ".concat(A.name," because it has changes on the type of index or primary key.")),{value:void 0};var M=p.objectStore(A.name);A.add.forEach(function(G){mt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(A.name,".").concat(G.src)),ci(M,G)})})(S[k]);if(typeof E=="object")return E.value}}function cc(h,p){var w,k={del:[],add:[],change:[]};for(w in h)p[w]||k.del.push(w);for(w in p){var S=h[w],E=p[w];if(S){var A={name:w,def:E,recreate:!1,del:[],add:[],change:[]};if(""+(S.primKey.keyPath||"")!=""+(E.primKey.keyPath||"")||S.primKey.auto!==E.primKey.auto)A.recreate=!0,k.change.push(A);else{var M=S.idxByName,G=E.idxByName,J=void 0;for(J in M)G[J]||A.del.push(J);for(J in G){var U=M[J],j=G[J];U?U.src!==j.src&&A.change.push(j):A.add.push(j)}(0<A.del.length||0<A.add.length||0<A.change.length)&&k.change.push(A)}}else k.add.push([w,E])}return k}function lc(h,p,w,k){var S=h.db.createObjectStore(p,w.keyPath?{keyPath:w.keyPath,autoIncrement:w.auto}:{autoIncrement:w.auto});k.forEach(function(E){return ci(S,E)})}function hd(h,p){a(h).forEach(function(w){p.db.objectStoreNames.contains(w)||(mt&&console.debug("Dexie: Creating missing table",w),lc(p,w,h[w].primKey,h[w].indexes))})}function ci(h,p){h.createIndex(p.name,p.keyPath,{unique:p.unique,multiEntry:p.multi})}function li(h,p,w){var k={};return I(p.objectStoreNames,0).forEach(function(S){for(var E=w.objectStore(S),A=oc(ld(J=E.keyPath),J||"",!0,!1,!!E.autoIncrement,J&&typeof J!="string",!0),M=[],G=0;G<E.indexNames.length;++G){var U=E.index(E.indexNames[G]),J=U.keyPath,U=oc(U.name,J,!!U.unique,!!U.multiEntry,!1,J&&typeof J!="string",!1);M.push(U)}k[S]=ac(S,A,M)}),k}function fi(h,p,w){for(var k=w.db.objectStoreNames,S=0;S<k.length;++S){var E=k[S],A=w.objectStore(E);h._hasGetAll="getAll"in A;for(var M=0;M<A.indexNames.length;++M){var G,J=A.indexNames[M],U=A.index(J).keyPath,U=typeof U=="string"?U:"["+I(U).join("+")+"]";p[E]&&(G=p[E].idxByName[U])&&(G.name=J,delete p[E].idxByName[U],p[E].idxByName[J]=G)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&o.WorkerGlobalScope&&o instanceof o.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(h._hasGetAll=!1)}function dd(h){return h.split(",").map(function(p,w){var S=p.split(":"),k=(k=S[1])==null?void 0:k.trim(),S=(p=S[0].trim()).replace(/([&*]|\+\+)/g,""),E=/^\[/.test(S)?S.match(/^\[(.*)\]$/)[1].split("+"):S;return oc(S,E||null,/\&/.test(p),/\*/.test(p),/\+\+/.test(p),i(E),w===0,k)})}uo.prototype._createTableSchema=ac,uo.prototype._parseIndexSyntax=dd,uo.prototype._parseStoresSpec=function(h,p){var w=this;a(h).forEach(function(k){if(h[k]!==null){var S=w._parseIndexSyntax(h[k]),E=S.shift();if(!E)throw new vt.Schema("Invalid schema for table "+k+": "+h[k]);if(E.unique=!0,E.multi)throw new vt.Schema("Primary key cannot be multiEntry*");S.forEach(function(A){if(A.auto)throw new vt.Schema("Only primary key can be marked as autoIncrement (++)");if(!A.keyPath)throw new vt.Schema("Index must have a name and cannot be an empty string")}),E=w._createTableSchema(k,E,S),p[k]=E}})},uo.prototype.stores=function(w){var p=this.db,w=(this._cfg.storesSource=this._cfg.storesSource?u(this._cfg.storesSource,w):w,p._versions),k={},S={};return w.forEach(function(E){u(k,E._cfg.storesSource),S=E._cfg.dbschema={},E._parseStoresSpec(k,S)}),p._dbSchema=S,uc(p,[p._allTables,p,p.Transaction.prototype]),ui(p,[p._allTables,p,p.Transaction.prototype,this._cfg.tables],a(S),S),p._storeNames=a(S),this},uo.prototype.upgrade=function(h){return this._cfg.contentUpgrade=wt(this._cfg.contentUpgrade||R,h),this};var $w=uo;function uo(){}function fc(h,p){var w=h._dbNamesDB;return w||(w=h._dbNamesDB=new Ss(ei,{addons:[],indexedDB:h,IDBKeyRange:p})).version(1).stores({dbnames:"name"}),w.table("dbnames")}function hc(h){return h&&typeof h.databases=="function"}function dc(h){return Gs(function(){return Lt.letThrough=!0,h()})}function pc(h){return!("from"in h)}var rn=function(h,p){var w;if(!this)return w=new rn,h&&"d"in h&&u(w,h),w;u(this,arguments.length?{d:1,from:h,to:1<arguments.length?p:h}:{d:0})};function Qo(h,p,w){var k=ue(p,w);if(!isNaN(k)){if(0<k)throw RangeError();if(pc(h))return u(h,{from:p,to:w,d:1});var k=h.l,S=h.r;if(ue(w,h.from)<0)return k?Qo(k,p,w):h.l={from:p,to:w,d:1,l:null,r:null},md(h);if(0<ue(p,h.to))return S?Qo(S,p,w):h.r={from:p,to:w,d:1,l:null,r:null},md(h);ue(p,h.from)<0&&(h.from=p,h.l=null,h.d=S?S.d+1:1),0<ue(w,h.to)&&(h.to=w,h.r=null,h.d=h.l?h.l.d+1:1),p=!h.r,k&&!h.l&&Jo(h,k),S&&p&&Jo(h,S)}}function Jo(h,p){pc(p)||(function w(k,S){var E=S.from,A=S.l,M=S.r;Qo(k,E,S.to),A&&w(k,A),M&&w(k,M)})(h,p)}function pd(h,p){var w=hi(p),k=w.next();if(!k.done)for(var S=k.value,E=hi(h),A=E.next(S.from),M=A.value;!k.done&&!A.done;){if(ue(M.from,S.to)<=0&&0<=ue(M.to,S.from))return!0;ue(S.from,M.from)<0?S=(k=w.next(M.from)).value:M=(A=E.next(S.from)).value}return!1}function hi(h){var p=pc(h)?null:{s:0,n:h};return{next:function(w){for(var k=0<arguments.length;p;)switch(p.s){case 0:if(p.s=1,k)for(;p.n.l&&ue(w,p.n.from)<0;)p={up:p,n:p.n.l,s:1};else for(;p.n.l;)p={up:p,n:p.n.l,s:1};case 1:if(p.s=2,!k||ue(w,p.n.to)<=0)return{value:p.n,done:!1};case 2:if(p.n.r){p.s=3,p={up:p,n:p.n.r,s:0};continue}case 3:p=p.up}return{done:!0}}}}function md(h){var p,w,k,S=(((S=h.r)==null?void 0:S.d)||0)-(((S=h.l)==null?void 0:S.d)||0),S=1<S?"r":S<-1?"l":"";S&&(p=S=="r"?"l":"r",w=s({},h),k=h[S],h.from=k.from,h.to=k.to,h[S]=k[S],w[S]=k[p],(h[p]=w).d=gd(w)),h.d=gd(h)}function gd(w){var p=w.r,w=w.l;return(p?w?Math.max(p.d,w.d):p.d:w?w.d:0)+1}function di(h,p){return a(p).forEach(function(w){h[w]?Jo(h[w],p[w]):h[w]=(function k(S){var E,A,M={};for(E in S)f(S,E)&&(A=S[E],M[E]=!A||typeof A!="object"||T.has(A.constructor)?A:k(A));return M})(p[w])}),h}function mc(h,p){return h.all||p.all||Object.keys(h).some(function(w){return p[w]&&pd(p[w],h[w])})}d(rn.prototype,((Ut={add:function(h){return Jo(this,h),this},addKey:function(h){return Qo(this,h,h),this},addKeys:function(h){var p=this;return h.forEach(function(w){return Qo(p,w,w)}),this},hasKey:function(h){var p=hi(this).next(h).value;return p&&ue(p.from,h)<=0&&0<=ue(p.to,h)}})[nt]=function(){return hi(this)},Ut));var Sr={},gc={},yc=!1;function pi(h){di(gc,h),yc||(yc=!0,setTimeout(function(){yc=!1,bc(gc,!(gc={}))},0))}function bc(h,p){p===void 0&&(p=!1);var w=new Set;if(h.all)for(var k=0,S=Object.values(Sr);k<S.length;k++)yd(M=S[k],h,w,p);else for(var E in h){var A,M,E=/^idb\:\/\/(.*)\/(.*)\//.exec(E);E&&(A=E[1],E=E[2],M=Sr["idb://".concat(A,"/").concat(E)])&&yd(M,h,w,p)}w.forEach(function(G){return G()})}function yd(h,p,w,k){for(var S=[],E=0,A=Object.entries(h.queries.query);E<A.length;E++){for(var M=A[E],G=M[0],J=[],U=0,j=M[1];U<j.length;U++){var X=j[U];mc(p,X.obsSet)?X.subscribers.forEach(function(st){return w.add(st)}):k&&J.push(X)}k&&S.push([G,J])}if(k)for(var Y=0,q=S;Y<q.length;Y++){var H=q[Y],G=H[0],J=H[1];h.queries.query[G]=J}}function Cw(h){var p=h._state,w=h._deps.indexedDB;if(p.isBeingOpened||h.idbdb)return p.dbReadyPromise.then(function(){return p.dbOpenError?Be(p.dbOpenError):h});p.isBeingOpened=!0,p.dbOpenError=null,p.openComplete=!1;var k=p.openCanceller,S=Math.round(10*h.verno),E=!1;function A(){if(p.openCanceller!==k)throw new vt.DatabaseClosed("db.open() was cancelled")}function M(){return new Rt(function(X,Y){if(A(),!w)throw new vt.MissingAPI;var q=h.name,H=p.autoSchema||!S?w.open(q):w.open(q,S);if(!H)throw new vt.MissingAPI;H.onerror=ns(Y),H.onblocked=Ae(h._fireOnBlocked),H.onupgradeneeded=Ae(function(st){var at;U=H.transaction,p.autoSchema&&!h._options.allowEmptyDB?(H.onerror=Go,U.abort(),H.result.close(),(at=w.deleteDatabase(q)).onsuccess=at.onerror=Ae(function(){Y(new vt.NoSuchDatabase("Database ".concat(q," doesnt exist")))})):(U.onerror=ns(Y),at=st.oldVersion>Math.pow(2,62)?0:st.oldVersion,j=at<1,h.idbdb=H.result,E&&Ew(h,U),Tw(h,at/10,U,Y))},Y),H.onsuccess=Ae(function(){U=null;var st,at,Q,dt,xt,At,Dt=h.idbdb=H.result,St=I(Dt.objectStoreNames);if(0<St.length)try{var Vt=Dt.transaction((xt=St).length===1?xt[0]:xt,"readonly");if(p.autoSchema)At=Dt,dt=Vt,(Q=h).verno=At.version/10,dt=Q._dbSchema=li(0,At,dt),Q._storeNames=I(At.objectStoreNames,0),ui(Q,[Q._allTables],a(dt),dt);else if(fi(h,h._dbSchema,Vt),at=Vt,((at=cc(li(0,(st=h).idbdb,at),st._dbSchema)).add.length||at.change.some(function(Pt){return Pt.add.length||Pt.change.length}))&&!E)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Dt.close(),S=Dt.version+1,E=!0,X(M());ii(h,Vt)}catch{}oo.push(h),Dt.onversionchange=Ae(function(Pt){p.vcFired=!0,h.on("versionchange").fire(Pt)}),Dt.onclose=Ae(function(){h.close({disableAutoOpen:!1})}),j&&(St=h._deps,xt=q,hc(At=St.indexedDB)||xt===ei||fc(At,St.IDBKeyRange).put({name:xt}).catch(R)),X()},Y)}).catch(function(X){switch(X==null?void 0:X.name){case"UnknownError":if(0<p.PR1398_maxLoop)return p.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),M();break;case"VersionError":if(0<S)return S=0,M()}return Rt.reject(X)})}var G,J=p.dbReadyResolve,U=null,j=!1;return Rt.race([k,(typeof navigator>"u"?Rt.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(X){function Y(){return indexedDB.databases().finally(X)}G=setInterval(Y,100),Y()}).finally(function(){return clearInterval(G)}):Promise.resolve()).then(M)]).then(function(){return A(),p.onReadyBeingFired=[],Rt.resolve(dc(function(){return h.on.ready.fire(h.vip)})).then(function X(){var Y;if(0<p.onReadyBeingFired.length)return Y=p.onReadyBeingFired.reduce(wt,R),p.onReadyBeingFired=[],Rt.resolve(dc(function(){return Y(h.vip)})).then(X)})}).finally(function(){p.openCanceller===k&&(p.onReadyBeingFired=null,p.isBeingOpened=!1)}).catch(function(X){p.dbOpenError=X;try{U&&U.abort()}catch{}return k===p.openCanceller&&h._close(),Be(X)}).finally(function(){p.openComplete=!0,J()}).then(function(){var X;return j&&(X={},h.tables.forEach(function(Y){Y.schema.indexes.forEach(function(q){q.name&&(X["idb://".concat(h.name,"/").concat(Y.name,"/").concat(q.name)]=new rn(-1/0,[[[]]]))}),X["idb://".concat(h.name,"/").concat(Y.name,"/")]=X["idb://".concat(h.name,"/").concat(Y.name,"/:dels")]=new rn(-1/0,[[[]]])}),Qs(Xo).fire(X),bc(X,!0)),h})}function wc(h){function p(E){return h.next(E)}var w=S(p),k=S(function(E){return h.throw(E)});function S(E){return function(M){var M=E(M),G=M.value;return M.done?G:G&&typeof G.then=="function"?G.then(w,k):i(G)?Promise.all(G).then(w,k):w(G)}}return S(p)()}function mi(h,p,w){for(var k=i(h)?h.slice():[h],S=0;S<w;++S)k.push(p);return k}var Aw={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(h){return s(s({},h),{table:function(k){var w=h.table(k),k=w.schema,S={},E=[];function A(X,Y,q){var Q=Zo(X),H=S[Q]=S[Q]||[],st=X==null?0:typeof X=="string"?1:X.length,at=0<Y,Q=s(s({},q),{name:at?"".concat(Q,"(virtual-from:").concat(q.name,")"):q.name,lowLevelIndex:q,isVirtual:at,keyTail:Y,keyLength:st,extractKey:ic(X),unique:!at&&q.unique});return H.push(Q),Q.isPrimaryKey||E.push(Q),1<st&&A(st===2?X[0]:X.slice(0,st-1),Y+1,q),H.sort(function(dt,xt){return dt.keyTail-xt.keyTail}),Q}var M=A(k.primaryKey.keyPath,0,k.primaryKey);S[":id"]=[M];for(var G=0,J=k.indexes;G<J.length;G++){var U=J[G];A(U.keyPath,0,U)}function j(X){var Y,q=X.query.index;return q.isVirtual?s(s({},X),{query:{index:q.lowLevelIndex,range:(Y=X.query.range,q=q.keyTail,{type:Y.type===1?2:Y.type,lower:mi(Y.lower,Y.lowerOpen?h.MAX_KEY:h.MIN_KEY,q),lowerOpen:!0,upper:mi(Y.upper,Y.upperOpen?h.MIN_KEY:h.MAX_KEY,q),upperOpen:!0})}}):X}return s(s({},w),{schema:s(s({},k),{primaryKey:M,indexes:E,getIndexByKeyPath:function(X){return(X=S[Zo(X)])&&X[0]}}),count:function(X){return w.count(j(X))},query:function(X){return w.query(j(X))},openCursor:function(X){var Y=X.query.index,q=Y.keyTail,H=Y.keyLength;return Y.isVirtual?w.openCursor(j(X)).then(function(at){return at&&st(at)}):w.openCursor(X);function st(at){return Object.create(at,{continue:{value:function(Q){Q!=null?at.continue(mi(Q,X.reverse?h.MAX_KEY:h.MIN_KEY,q)):X.unique?at.continue(at.key.slice(0,H).concat(X.reverse?h.MIN_KEY:h.MAX_KEY,q)):at.continue()}},continuePrimaryKey:{value:function(Q,dt){at.continuePrimaryKey(mi(Q,h.MAX_KEY,q),dt)}},primaryKey:{get:function(){return at.primaryKey}},key:{get:function(){var Q=at.key;return H===1?Q[0]:Q.slice(0,H)}},value:{get:function(){return at.value}}})}}})}})}};function vc(h,p,w,k){return w=w||{},k=k||"",a(h).forEach(function(S){var E,A,M;f(p,S)?(E=h[S],A=p[S],typeof E=="object"&&typeof A=="object"&&E&&A?(M=et(E))!==et(A)?w[k+S]=p[S]:M==="Object"?vc(E,A,w,k+S+"."):E!==A&&(w[k+S]=p[S]):E!==A&&(w[k+S]=p[S])):w[k+S]=void 0}),a(p).forEach(function(S){f(h,S)||(w[k+S]=p[S])}),w}function kc(h,p){return p.type==="delete"?p.keys:p.keys||p.values.map(h.extractKey)}var Dw={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(h){return s(s({},h),{table:function(p){var w=h.table(p),k=w.schema.primaryKey;return s(s({},w),{mutate:function(S){var E=Lt.trans,A=E.table(p).hook,M=A.deleting,G=A.creating,J=A.updating;switch(S.type){case"add":if(G.fire===R)break;return E._promise("readwrite",function(){return U(S)},!0);case"put":if(G.fire===R&&J.fire===R)break;return E._promise("readwrite",function(){return U(S)},!0);case"delete":if(M.fire===R)break;return E._promise("readwrite",function(){return U(S)},!0);case"deleteRange":if(M.fire===R)break;return E._promise("readwrite",function(){return(function j(X,Y,q){return w.query({trans:X,values:!1,query:{index:k,range:Y},limit:q}).then(function(H){var st=H.result;return U({type:"delete",keys:st,trans:X}).then(function(at){return 0<at.numFailures?Promise.reject(at.failures[0]):st.length<q?{failures:[],numFailures:0,lastResult:void 0}:j(X,s(s({},Y),{lower:st[st.length-1],lowerOpen:!0}),q)})})})(S.trans,S.range,1e4)},!0)}return w.mutate(S);function U(j){var X,Y,q,H=Lt.trans,st=j.keys||kc(k,j);if(st)return(j=j.type==="add"||j.type==="put"?s(s({},j),{keys:st}):s({},j)).type!=="delete"&&(j.values=r([],j.values)),j.keys&&(j.keys=r([],j.keys)),X=w,q=st,((Y=j).type==="add"?Promise.resolve([]):X.getMany({trans:Y.trans,keys:q,cache:"immutable"})).then(function(at){var Q=st.map(function(dt,xt){var At,Dt,St,Vt=at[xt],Pt={onerror:null,onsuccess:null};return j.type==="delete"?M.fire.call(Pt,dt,Vt,H):j.type==="add"||Vt===void 0?(At=G.fire.call(Pt,dt,j.values[xt],H),dt==null&&At!=null&&(j.keys[xt]=dt=At,k.outbound||z(j.values[xt],k.keyPath,dt))):(At=vc(Vt,j.values[xt]),(Dt=J.fire.call(Pt,At,dt,Vt,H))&&(St=j.values[xt],Object.keys(Dt).forEach(function(Et){f(St,Et)?St[Et]=Dt[Et]:z(St,Et,Dt[Et])}))),Pt});return w.mutate(j).then(function(dt){for(var xt=dt.failures,At=dt.results,Dt=dt.numFailures,dt=dt.lastResult,St=0;St<st.length;++St){var Vt=(At||st)[St],Pt=Q[St];Vt==null?Pt.onerror&&Pt.onerror(xt[St]):Pt.onsuccess&&Pt.onsuccess(j.type==="put"&&at[St]?j.values[St]:Vt)}return{failures:xt,results:At,numFailures:Dt,lastResult:dt}}).catch(function(dt){return Q.forEach(function(xt){return xt.onerror&&xt.onerror(dt)}),Promise.reject(dt)})});throw new Error("Keys missing")}}})}})}};function bd(h,p,w){try{if(!p||p.keys.length<h.length)return null;for(var k=[],S=0,E=0;S<p.keys.length&&E<h.length;++S)ue(p.keys[S],h[E])===0&&(k.push(w?Z(p.values[S]):p.values[S]),++E);return k.length===h.length?k:null}catch{return null}}var Ow={stack:"dbcore",level:-1,create:function(h){return{table:function(p){var w=h.table(p);return s(s({},w),{getMany:function(k){var S;return k.cache?(S=bd(k.keys,k.trans._cache,k.cache==="clone"))?Rt.resolve(S):w.getMany(k).then(function(E){return k.trans._cache={keys:k.keys,values:k.cache==="clone"?Z(E):E},E}):w.getMany(k)},mutate:function(k){return k.type!=="add"&&(k.trans._cache=null),w.mutate(k)}})}}}};function wd(h,p){return h.trans.mode==="readonly"&&!!h.subscr&&!h.trans.explicit&&h.trans.db._options.cache!=="disabled"&&!p.schema.primaryKey.outbound}function vd(h,p){switch(h){case"query":return p.values&&!p.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Fw={stack:"dbcore",level:0,name:"Observability",create:function(h){var p=h.schema.name,w=new rn(h.MIN_KEY,h.MAX_KEY);return s(s({},h),{transaction:function(k,S,E){if(Lt.subscr&&S!=="readonly")throw new vt.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Lt.querier));return h.transaction(k,S,E)},table:function(k){function S(st){var H,st=st.query;return[H=st.index,new rn((H=(st=st.range).lower)!=null?H:h.MIN_KEY,(H=st.upper)!=null?H:h.MAX_KEY)]}var E=h.table(k),A=E.schema,M=A.primaryKey,G=A.indexes,J=M.extractKey,U=M.outbound,j=M.autoIncrement&&G.filter(function(q){return q.compound&&q.keyPath.includes(M.keyPath)}),X=s(s({},E),{mutate:function(q){function H(Wt){return Wt="idb://".concat(p,"/").concat(k,"/").concat(Wt),xt[Wt]||(xt[Wt]=new rn)}var st,at,Q,dt=q.trans,xt=q.mutatedParts||(q.mutatedParts={}),At=H(""),Dt=H(":dels"),St=q.type,Pt=q.type==="deleteRange"?[q.range]:q.type==="delete"?[q.keys]:q.values.length<50?[kc(M,q).filter(function(Wt){return Wt}),q.values]:[],Vt=Pt[0],Pt=Pt[1],Et=q.trans._cache;return i(Vt)?(At.addKeys(Vt),(St=St==="delete"||Vt.length===Pt.length?bd(Vt,Et):null)||Dt.addKeys(Vt),(St||Pt)&&(st=H,at=St,Q=Pt,A.indexes.forEach(function(Wt){var le=st(Wt.name||"");function he(re){return re!=null?Wt.extractKey(re):null}function Gt(re){Wt.multiEntry&&i(re)?re.forEach(function(Fe){return le.addKey(Fe)}):le.addKey(re)}(at||Q).forEach(function(re,Le){var Mn=at&&he(at[Le]),Le=Q&&he(Q[Le]);ue(Mn,Le)!==0&&(Mn!=null&&Gt(Mn),Le!=null)&&Gt(Le)})}))):Vt?(Pt={from:(Et=Vt.lower)!=null?Et:h.MIN_KEY,to:(St=Vt.upper)!=null?St:h.MAX_KEY},Dt.add(Pt),At.add(Pt)):(At.add(w),Dt.add(w),A.indexes.forEach(function(Wt){return H(Wt.name).add(w)})),E.mutate(q).then(function(Wt){return!Vt||q.type!=="add"&&q.type!=="put"||(At.addKeys(Wt.results),j&&j.forEach(function(le){for(var he=q.values.map(function(Mn){return le.extractKey(Mn)}),Gt=le.keyPath.findIndex(function(Mn){return Mn===M.keyPath}),re=0,Fe=Wt.results.length;re<Fe;++re)he[re][Gt]=Wt.results[re];H(le.name).addKeys(he)})),dt.mutatedParts=di(dt.mutatedParts||{},xt),Wt})}}),Y={get:function(q){return[M,new rn(q.key)]},getMany:function(q){return[M,new rn().addKeys(q.keys)]},count:S,query:S,openCursor:S};return a(Y).forEach(function(q){X[q]=function(H){var st=Lt.subscr,at=!!st,Q=wd(Lt,E)&&vd(q,H)?H.obsSet={}:st;if(at){var dt,st=function(Pt){return Pt="idb://".concat(p,"/").concat(k,"/").concat(Pt),Q[Pt]||(Q[Pt]=new rn)},xt=st(""),At=st(":dels"),at=Y[q](H),Dt=at[0],at=at[1];if((q==="query"&&Dt.isPrimaryKey&&!H.values?At:st(Dt.name||"")).add(at),!Dt.isPrimaryKey){if(q!=="count")return dt=q==="query"&&U&&H.values&&E.query(s(s({},H),{values:!1})),E[q].apply(this,arguments).then(function(Pt){if(q==="query"){if(U&&H.values)return dt.then(function(he){return he=he.result,xt.addKeys(he),Pt});var Et=H.values?Pt.result.map(J):Pt.result;(H.values?xt:At).addKeys(Et)}else{var Wt,le;if(q==="openCursor")return le=H.values,(Wt=Pt)&&Object.create(Wt,{key:{get:function(){return At.addKey(Wt.primaryKey),Wt.key}},primaryKey:{get:function(){var he=Wt.primaryKey;return At.addKey(he),he}},value:{get:function(){return le&&xt.addKey(Wt.primaryKey),Wt.value}}})}return Pt});At.add(w)}}return E[q].apply(this,arguments)}}),X}})}};function kd(h,p,w){var k;return w.numFailures===0?p:p.type==="deleteRange"||(k=p.keys?p.keys.length:"values"in p&&p.values?p.values.length:1,w.numFailures===k)?null:(k=s({},p),i(k.keys)&&(k.keys=k.keys.filter(function(S,E){return!(E in w.failures)})),"values"in k&&i(k.values)&&(k.values=k.values.filter(function(S,E){return!(E in w.failures)})),k)}function xc(h,p){return w=h,((k=p).lower===void 0||(k.lowerOpen?0<ue(w,k.lower):0<=ue(w,k.lower)))&&(w=h,(k=p).upper===void 0||(k.upperOpen?ue(w,k.upper)<0:ue(w,k.upper)<=0));var w,k}function xd(h,p,w,k,S,E){var A,M,G,J,U,j;return!w||w.length===0||(A=p.query.index,M=A.multiEntry,G=p.query.range,J=k.schema.primaryKey.extractKey,U=A.extractKey,j=(A.lowLevelIndex||A).extractKey,(k=w.reduce(function(X,Y){var q=X,H=[];if(Y.type==="add"||Y.type==="put")for(var st=new rn,at=Y.values.length-1;0<=at;--at){var Q,dt=Y.values[at],xt=J(dt);!st.hasKey(xt)&&(Q=U(dt),M&&i(Q)?Q.some(function(Pt){return xc(Pt,G)}):xc(Q,G))&&(st.addKey(xt),H.push(dt))}switch(Y.type){case"add":var At=new rn().addKeys(p.values?X.map(function(Et){return J(Et)}):X),q=X.concat(p.values?H.filter(function(Et){return Et=J(Et),!At.hasKey(Et)&&(At.addKey(Et),!0)}):H.map(function(Et){return J(Et)}).filter(function(Et){return!At.hasKey(Et)&&(At.addKey(Et),!0)}));break;case"put":var Dt=new rn().addKeys(Y.values.map(function(Et){return J(Et)}));q=X.filter(function(Et){return!Dt.hasKey(p.values?J(Et):Et)}).concat(p.values?H:H.map(function(Et){return J(Et)}));break;case"delete":var St=new rn().addKeys(Y.keys);q=X.filter(function(Et){return!St.hasKey(p.values?J(Et):Et)});break;case"deleteRange":var Vt=Y.range;q=X.filter(function(Et){return!xc(J(Et),Vt)})}return q},h))===h)?h:(k.sort(function(X,Y){return ue(j(X),j(Y))||ue(J(X),J(Y))}),p.limit&&p.limit<1/0&&(k.length>p.limit?k.length=p.limit:h.length===p.limit&&k.length<p.limit&&(S.dirty=!0)),E?Object.freeze(k):k)}function Sd(h,p){return ue(h.lower,p.lower)===0&&ue(h.upper,p.upper)===0&&!!h.lowerOpen==!!p.lowerOpen&&!!h.upperOpen==!!p.upperOpen}function Rw(h,p){return((w,k,S,E)=>{if(w===void 0)return k!==void 0?-1:0;if(k===void 0)return 1;if((w=ue(w,k))===0){if(S&&E)return 0;if(S)return 1;if(E)return-1}return w})(h.lower,p.lower,h.lowerOpen,p.lowerOpen)<=0&&0<=((w,k,S,E)=>{if(w===void 0)return k!==void 0?1:0;if(k===void 0)return-1;if((w=ue(w,k))===0){if(S&&E)return 0;if(S)return-1;if(E)return 1}return w})(h.upper,p.upper,h.upperOpen,p.upperOpen)}function Pw(h,p,w,k){h.subscribers.add(w),k.addEventListener("abort",function(){var S,E;h.subscribers.delete(w),h.subscribers.size===0&&(S=h,E=p,setTimeout(function(){S.subscribers.size===0&&tt(E,S)},3e3))})}var Mw={stack:"dbcore",level:0,name:"Cache",create:function(h){var p=h.schema.name;return s(s({},h),{transaction:function(w,k,S){var E,A,M=h.transaction(w,k,S);return k==="readwrite"&&(S=(E=new AbortController).signal,M.addEventListener("abort",(A=function(G){return function(){if(E.abort(),k==="readwrite"){for(var J=new Set,U=0,j=w;U<j.length;U++){var X=j[U],Y=Sr["idb://".concat(p,"/").concat(X)];if(Y){var q=h.table(X),H=Y.optimisticOps.filter(function(Wt){return Wt.trans===M});if(M._explicit&&G&&M.mutatedParts)for(var st=0,at=Object.values(Y.queries.query);st<at.length;st++)for(var Q=0,dt=(Dt=at[st]).slice();Q<dt.length;Q++)mc((St=dt[Q]).obsSet,M.mutatedParts)&&(tt(Dt,St),St.subscribers.forEach(function(Wt){return J.add(Wt)}));else if(0<H.length){Y.optimisticOps=Y.optimisticOps.filter(function(Wt){return Wt.trans!==M});for(var xt=0,At=Object.values(Y.queries.query);xt<At.length;xt++)for(var Dt,St,Vt,Pt=0,Et=(Dt=At[xt]).slice();Pt<Et.length;Pt++)(St=Et[Pt]).res!=null&&M.mutatedParts&&(G&&!St.dirty?(Vt=Object.isFrozen(St.res),Vt=xd(St.res,St.req,H,q,St,Vt),St.dirty?(tt(Dt,St),St.subscribers.forEach(function(Wt){return J.add(Wt)})):Vt!==St.res&&(St.res=Vt,St.promise=Rt.resolve({result:Vt}))):(St.dirty&&tt(Dt,St),St.subscribers.forEach(function(Wt){return J.add(Wt)})))}}}J.forEach(function(Wt){return Wt()})}}})(!1),{signal:S}),M.addEventListener("error",A(!1),{signal:S}),M.addEventListener("complete",A(!0),{signal:S})),M},table:function(w){var k=h.table(w),S=k.schema.primaryKey;return s(s({},k),{mutate:function(E){var A,M=Lt.trans;return!S.outbound&&M.db._options.cache!=="disabled"&&!M.explicit&&M.idbtrans.mode==="readwrite"&&(A=Sr["idb://".concat(p,"/").concat(w)])?(M=k.mutate(E),E.type!=="add"&&E.type!=="put"||!(50<=E.values.length||kc(S,E).some(function(G){return G==null}))?(A.optimisticOps.push(E),E.mutatedParts&&pi(E.mutatedParts),M.then(function(G){0<G.numFailures&&(tt(A.optimisticOps,E),(G=kd(0,E,G))&&A.optimisticOps.push(G),E.mutatedParts)&&pi(E.mutatedParts)}),M.catch(function(){tt(A.optimisticOps,E),E.mutatedParts&&pi(E.mutatedParts)})):M.then(function(G){var J=kd(0,s(s({},E),{values:E.values.map(function(U,j){var X;return G.failures[j]?U:(z(X=(X=S.keyPath)!=null&&X.includes(".")?Z(U):s({},U),S.keyPath,G.results[j]),X)})}),G);A.optimisticOps.push(J),queueMicrotask(function(){return E.mutatedParts&&pi(E.mutatedParts)})}),M):k.mutate(E)},query:function(E){var A,M,G,J,U,j,X;return wd(Lt,k)&&vd("query",E)?(A=((G=Lt.trans)==null?void 0:G.db._options.cache)==="immutable",M=(G=Lt).requery,G=G.signal,j=((Y,q,H,st)=>{var at=Sr["idb://".concat(Y,"/").concat(q)];if(!at)return[];if(!(Y=at.queries[H]))return[null,!1,at,null];var Q=Y[(st.query?st.query.index.name:null)||""];if(!Q)return[null,!1,at,null];switch(H){case"query":var dt=Q.find(function(xt){return xt.req.limit===st.limit&&xt.req.values===st.values&&Sd(xt.req.query.range,st.query.range)});return dt?[dt,!0,at,Q]:[Q.find(function(xt){return("limit"in xt.req?xt.req.limit:1/0)>=st.limit&&(!st.values||xt.req.values)&&Rw(xt.req.query.range,st.query.range)}),!1,at,Q];case"count":return dt=Q.find(function(xt){return Sd(xt.req.query.range,st.query.range)}),[dt,!!dt,at,Q]}})(p,w,"query",E),X=j[0],J=j[2],U=j[3],X&&j[1]?X.obsSet=E.obsSet:(j=k.query(E).then(function(Y){var q=Y.result;if(X&&(X.res=q),A){for(var H=0,st=q.length;H<st;++H)Object.freeze(q[H]);Object.freeze(q)}else Y.result=Z(q);return Y}).catch(function(Y){return U&&X&&tt(U,X),Promise.reject(Y)}),X={obsSet:E.obsSet,promise:j,subscribers:new Set,type:"query",req:E,dirty:!1},U?U.push(X):(U=[X],(J=J||(Sr["idb://".concat(p,"/").concat(w)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[E.query.index.name||""]=U)),Pw(X,U,M,G),X.promise.then(function(Y){return{result:xd(Y.result,E,J==null?void 0:J.optimisticOps,k,X,A)}})):k.query(E)}})}})}};function gi(h,p){return new Proxy(h,{get:function(w,k,S){return k==="db"?p:Reflect.get(w,k,S)}})}We.prototype.version=function(h){if(isNaN(h)||h<.1)throw new vt.Type("Given version is not a positive number");if(h=Math.round(10*h)/10,this.idbdb||this._state.isBeingOpened)throw new vt.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,h);var p=this._versions,w=p.filter(function(k){return k._cfg.version===h})[0];return w||(w=new this.Version(h),p.push(w),p.sort(_w),w.stores({}),this._state.autoSchema=!1),w},We.prototype._whenReady=function(h){var p=this;return this.idbdb&&(this._state.openComplete||Lt.letThrough||this._vip)?h():new Rt(function(w,k){if(p._state.openComplete)return k(new vt.DatabaseClosed(p._state.dbOpenError));if(!p._state.isBeingOpened){if(!p._state.autoOpen)return void k(new vt.DatabaseClosed);p.open().catch(R)}p._state.dbReadyPromise.then(w,k)}).then(h)},We.prototype.use=function(S){var p=S.stack,w=S.create,k=S.level,S=S.name,E=(S&&this.unuse({stack:p,name:S}),this._middlewares[p]||(this._middlewares[p]=[]));return E.push({stack:p,create:w,level:k??10,name:S}),E.sort(function(A,M){return A.level-M.level}),this},We.prototype.unuse=function(h){var p=h.stack,w=h.name,k=h.create;return p&&this._middlewares[p]&&(this._middlewares[p]=this._middlewares[p].filter(function(S){return k?S.create!==k:!!w&&S.name!==w})),this},We.prototype.open=function(){var h=this;return vr(Ce,function(){return Cw(h)})},We.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var h=this._state,p=oo.indexOf(this);if(0<=p&&oo.splice(p,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}h.isBeingOpened||(h.dbReadyPromise=new Rt(function(w){h.dbReadyResolve=w}),h.openCanceller=new Rt(function(w,k){h.cancelOpen=k}))},We.prototype.close=function(p){var p=(p===void 0?{disableAutoOpen:!0}:p).disableAutoOpen,w=this._state;p?(w.isBeingOpened&&w.cancelOpen(new vt.DatabaseClosed),this._close(),w.autoOpen=!1,w.dbOpenError=new vt.DatabaseClosed):(this._close(),w.autoOpen=this._options.autoOpen||w.isBeingOpened,w.openComplete=!1,w.dbOpenError=null)},We.prototype.delete=function(h){var p=this,w=(h===void 0&&(h={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),k=this._state;return new Rt(function(S,E){function A(){p.close(h);var M=p._deps.indexedDB.deleteDatabase(p.name);M.onsuccess=Ae(function(){var G,J,U;G=p._deps,J=p.name,hc(U=G.indexedDB)||J===ei||fc(U,G.IDBKeyRange).delete(J).catch(R),S()}),M.onerror=ns(E),M.onblocked=p._fireOnBlocked}if(w)throw new vt.InvalidArgument("Invalid closeOptions argument to db.delete()");k.isBeingOpened?k.dbReadyPromise.then(A):A()})},We.prototype.backendDB=function(){return this.idbdb},We.prototype.isOpen=function(){return this.idbdb!==null},We.prototype.hasBeenClosed=function(){var h=this._state.dbOpenError;return h&&h.name==="DatabaseClosed"},We.prototype.hasFailed=function(){return this._state.dbOpenError!==null},We.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(We.prototype,"tables",{get:function(){var h=this;return a(this._allTables).map(function(p){return h._allTables[p]})},enumerable:!1,configurable:!0}),We.prototype.transaction=function(){var h=(function(p,w,k){var S=arguments.length;if(S<2)throw new vt.InvalidArgument("Too few arguments");for(var E=new Array(S-1);--S;)E[S-1]=arguments[S];return k=E.pop(),[p,L(E),k]}).apply(this,arguments);return this._transaction.apply(this,h)},We.prototype._transaction=function(h,p,w){var k,S,E=this,A=Lt.trans,M=(A&&A.db===this&&h.indexOf("!")===-1||(A=null),h.indexOf("?")!==-1);h=h.replace("!","").replace("?","");try{if(S=p.map(function(J){if(J=J instanceof E.Table?J.name:J,typeof J!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return J}),h=="r"||h===tc)k=tc;else{if(h!="rw"&&h!=ec)throw new vt.InvalidArgument("Invalid transaction mode: "+h);k=ec}if(A){if(A.mode===tc&&k===ec){if(!M)throw new vt.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");A=null}A&&S.forEach(function(J){if(A&&A.storeNames.indexOf(J)===-1){if(!M)throw new vt.SubTransaction("Table "+J+" not included in parent transaction.");A=null}}),M&&A&&!A.active&&(A=null)}}catch(J){return A?A._promise(null,function(U,j){j(J)}):Be(J)}var G=(function J(U,j,X,Y,q){return Rt.resolve().then(function(){var Q=Lt.transless||Lt,H=U._createTransaction(j,X,U._dbSchema,Y),Q=(H.explicit=!0,{trans:H,transless:Q});if(Y)H.idbtrans=Y.idbtrans;else try{H.create(),H.idbtrans._explicit=!0,U._state.PR1398_maxLoop=3}catch(dt){return dt.name===qt.InvalidState&&U.isOpen()&&0<--U._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),U.close({disableAutoOpen:!1}),U.open().then(function(){return J(U,j,X,null,q)})):Be(dt)}var st,at=yt(q),Q=(at&&ro(),Rt.follow(function(){var dt;(st=q.call(H,H))&&(at?(dt=Xs.bind(null,null),st.then(dt,dt)):typeof st.next=="function"&&typeof st.throw=="function"&&(st=wc(st)))},Q));return(st&&typeof st.then=="function"?Rt.resolve(st).then(function(dt){return H.active?dt:Be(new vt.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):Q.then(function(){return st})).then(function(dt){return Y&&H._resolve(),H._completion.then(function(){return dt})}).catch(function(dt){return H._reject(dt),Be(dt)})})}).bind(null,this,k,S,A,w);return A?A._promise(k,G,"lock"):Lt.trans?vr(Lt.transless,function(){return E._whenReady(G)}):this._whenReady(G)},We.prototype.table=function(h){if(f(this._allTables,h))return this._allTables[h];throw new vt.InvalidTable("Table ".concat(h," does not exist"))};var Ss=We;function We(h,p){var w,k,S,E,A,M=this,G=(this._middlewares={},this.verno=0,We.dependencies),G=(this._options=p=s({addons:We.addons,autoOpen:!0,indexedDB:G.indexedDB,IDBKeyRange:G.IDBKeyRange,cache:"cloned"},p),this._deps={indexedDB:p.indexedDB,IDBKeyRange:p.IDBKeyRange},p.addons),J=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:R,dbReadyPromise:null,cancelOpen:R,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:p.autoOpen}),U=(J.dbReadyPromise=new Rt(function(j){J.dbReadyResolve=j}),J.openCanceller=new Rt(function(j,X){J.cancelOpen=X}),this._state=J,this.name=h,this.on=Ko(this,"populate","blocked","versionchange","close",{ready:[wt,R]}),this.once=function(j,X){var Y=function(){for(var q=[],H=0;H<arguments.length;H++)q[H]=arguments[H];M.on(j).unsubscribe(Y),X.apply(M,q)};return M.on(j,Y)},this.on.ready.subscribe=_(this.on.ready.subscribe,function(j){return function(X,Y){We.vip(function(){var q,H=M._state;H.openComplete?(H.dbOpenError||Rt.resolve().then(X),Y&&j(X)):H.onReadyBeingFired?(H.onReadyBeingFired.push(X),Y&&j(X)):(j(X),q=M,Y||j(function st(){q.on.ready.unsubscribe(X),q.on.ready.unsubscribe(st)}))})}}),this.Collection=(w=this,Uo(ww.prototype,function(st,H){this.db=w;var Y=Qh,q=null;if(H)try{Y=H()}catch(Q){q=Q}var H=st._ctx,st=H.table,at=st.hook.reading.fire;this._ctx={table:st,index:H.index,isPrimKey:!H.index||st.schema.primKey.keyPath&&H.index===st.schema.primKey.name,range:Y,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:q,or:H.or,valueMapper:at!==B?at:null}})),this.Table=(k=this,Uo(rd.prototype,function(j,X,Y){this.db=k,this._tx=Y,this.name=j,this.schema=X,this.hook=k._allTables[j]?k._allTables[j].hook:Ko(null,{creating:[ct,R],reading:[ot,B],updating:[kt,R],deleting:[ht,R]})})),this.Transaction=(S=this,Uo(xw.prototype,function(j,X,Y,q,H){var st=this;j!=="readonly"&&X.forEach(function(at){at=(at=Y[at])==null?void 0:at.yProps,at&&(X=X.concat(at.map(function(Q){return Q.updatesTable})))}),this.db=S,this.mode=j,this.storeNames=X,this.schema=Y,this.chromeTransactionDurability=q,this.idbtrans=null,this.on=Ko(this,"complete","error","abort"),this.parent=H||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Rt(function(at,Q){st._resolve=at,st._reject=Q}),this._completion.then(function(){st.active=!1,st.on.complete.fire()},function(at){var Q=st.active;return st.active=!1,st.on.error.fire(at),st.parent?st.parent._reject(at):Q&&st.idbtrans&&st.idbtrans.abort(),Be(at)})})),this.Version=(E=this,Uo($w.prototype,function(j){this.db=E,this._cfg={version:j,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(A=this,Uo(cd.prototype,function(j,X,Y){if(this.db=A,this._ctx={table:j,index:X===":id"?null:X,or:Y},this._cmp=this._ascending=ue,this._descending=function(q,H){return ue(H,q)},this._max=function(q,H){return 0<ue(q,H)?q:H},this._min=function(q,H){return ue(q,H)<0?q:H},this._IDBKeyRange=A._deps.IDBKeyRange,!this._IDBKeyRange)throw new vt.MissingAPI})),this.on("versionchange",function(j){0<j.newVersion?console.warn("Another connection wants to upgrade database '".concat(M.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(M.name,"'. Closing db now to resume the delete request.")),M.close({disableAutoOpen:!1})}),this.on("blocked",function(j){!j.newVersion||j.newVersion<j.oldVersion?console.warn("Dexie.delete('".concat(M.name,"') was blocked")):console.warn("Upgrade '".concat(M.name,"' blocked by other connection holding version ").concat(j.oldVersion/10))}),this._maxKey=Yo(p.IDBKeyRange),this._createTransaction=function(j,X,Y,q){return new M.Transaction(j,X,Y,M._options.chromeTransactionDurability,q)},this._fireOnBlocked=function(j){M.on("blocked").fire(j),oo.filter(function(X){return X.name===M.name&&X!==M&&!X._state.vcFired}).map(function(X){return X.on("versionchange").fire(j)})},this.use(Ow),this.use(Mw),this.use(Fw),this.use(Aw),this.use(Dw),new Proxy(this,{get:function(j,X,Y){var q;return X==="_vip"||(X==="table"?function(H){return gi(M.table(H),U)}:(q=Reflect.get(j,X,Y))instanceof rd?gi(q,U):X==="tables"?q.map(function(H){return gi(H,U)}):X==="_createTransaction"?function(){return gi(q.apply(this,arguments),U)}:q)}}));this.vip=U,G.forEach(function(j){return j(M)})}var yi,co=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Lw=(Sc.prototype.subscribe=function(h,p,w){return this._subscribe(h&&typeof h!="function"?h:{next:h,error:p,complete:w})},Sc.prototype[co]=function(){return this},Sc);function Sc(h){this._subscribe=h}try{yi={indexedDB:o.indexedDB||o.mozIndexedDB||o.webkitIndexedDB||o.msIndexedDB,IDBKeyRange:o.IDBKeyRange||o.webkitIDBKeyRange}}catch{yi={indexedDB:null,IDBKeyRange:null}}function Id(h){var p,w=!1,k=new Lw(function(S){var E=yt(h),A,M=!1,G={},J={},U={get closed(){return M},unsubscribe:function(){M||(M=!0,A&&A.abort(),j&&Qs.storagemutated.unsubscribe(Y))}},j=(S.start&&S.start(U),!1),X=function(){return Ju(q)},Y=function(H){di(G,H),mc(J,G)&&X()},q=function(){var H,st,at;!M&&yi.indexedDB&&(G={},H={},A&&A.abort(),A=new AbortController,at=(Q=>{var dt=no();try{E&&ro();var xt=Gs(h,Q);return xt=E?xt.finally(Xs):xt}finally{dt&&so()}})(st={subscr:H,signal:A.signal,requery:X,querier:h,trans:null}),Promise.resolve(at).then(function(Q){w=!0,p=Q,M||st.signal.aborted||(G={},(dt=>{for(var xt in dt)if(f(dt,xt))return;return 1})(J=H)||j||(Qs(Xo,Y),j=!0),Ju(function(){return!M&&S.next&&S.next(Q)}))},function(Q){w=!1,["DatabaseClosedError","AbortError"].includes(Q==null?void 0:Q.name)||M||Ju(function(){M||S.error&&S.error(Q)})}))};return setTimeout(X,0),U});return k.hasValue=function(){return w},k.getValue=function(){return p},k}var Ir=Ss;function Ic(h){var p=Js;try{Js=!0,Qs.storagemutated.fire(h),bc(h,!0)}finally{Js=p}}d(Ir,s(s({},pt),{delete:function(h){return new Ir(h,{addons:[]}).delete()},exists:function(h){return new Ir(h,{addons:[]}).open().then(function(p){return p.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(h){try{return p=Ir.dependencies,w=p.indexedDB,p=p.IDBKeyRange,(hc(w)?Promise.resolve(w.databases()).then(function(k){return k.map(function(S){return S.name}).filter(function(S){return S!==ei})}):fc(w,p).toCollection().primaryKeys()).then(h)}catch{return Be(new vt.MissingAPI)}var p,w},defineClass:function(){return function(h){u(this,h)}},ignoreTransaction:function(h){return Lt.trans?vr(Lt.transless,h):h()},vip:dc,async:function(h){return function(){try{var p=wc(h.apply(this,arguments));return p&&typeof p.then=="function"?p:Rt.resolve(p)}catch(w){return Be(w)}}},spawn:function(h,p,w){try{var k=wc(h.apply(w,p||[]));return k&&typeof k.then=="function"?k:Rt.resolve(k)}catch(S){return Be(S)}},currentTransaction:{get:function(){return Lt.trans||null}},waitFor:function(h,p){return h=Rt.resolve(typeof h=="function"?Ir.ignoreTransaction(h):h).timeout(p||6e4),Lt.trans?Lt.trans.waitFor(h):h},Promise:Rt,debug:{get:function(){return mt},set:function(h){Bt(h)}},derive:b,extend:u,props:d,override:_,Events:Ko,on:Qs,liveQuery:Id,extendObservabilitySet:di,getByKeyPath:F,setByKeyPath:z,delByKeyPath:function(h,p){typeof p=="string"?z(h,p,void 0):"length"in p&&[].map.call(p,function(w){z(h,w,void 0)})},shallowClone:P,deepClone:Z,getObjectDiff:vc,cmp:ue,asap:C,minKey:-1/0,addons:[],connections:oo,errnames:qt,dependencies:yi,cache:Sr,semVer:"4.3.0",version:"4.3.0".split(".").map(function(h){return parseInt(h)}).reduce(function(h,p,w){return h+p/Math.pow(10,2*w)})})),Ir.maxKey=Yo(Ir.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Qs(Xo,function(h){Js||(h=new CustomEvent(rc,{detail:h}),Js=!0,dispatchEvent(h),Js=!1)}),addEventListener(rc,function(h){h=h.detail,Js||Ic(h)}));var lo,Js=!1,Nd=function(){};return typeof BroadcastChannel<"u"&&((Nd=function(){(lo=new BroadcastChannel(rc)).onmessage=function(h){return h.data&&Ic(h.data)}})(),typeof lo.unref=="function"&&lo.unref(),Qs(Xo,function(h){Js||lo.postMessage(h)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(h){if(!Ss.disableBfCache&&h.persisted){mt&&console.debug("Dexie: handling persisted pagehide"),lo!=null&&lo.close();for(var p=0,w=oo;p<w.length;p++)w[p].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(h){!Ss.disableBfCache&&h.persisted&&(mt&&console.debug("Dexie: handling persisted pageshow"),Nd(),Ic({all:new rn(-1/0,[[]])}))})),Rt.rejectionMapper=function(h,p){return!h||h instanceof _t||h instanceof TypeError||h instanceof SyntaxError||!h.name||!Jt[h.name]?h:(p=new Jt[h.name](p||h.message,h),"stack"in h&&g(p,"stack",{get:function(){return this.inner.stack}}),p)},Bt(mt),s(Ss,Object.freeze({__proto__:null,Dexie:Ss,Entity:Jh,PropModification:qo,RangeSet:rn,add:function(h){return new qo({add:h})},cmp:ue,default:Ss,liveQuery:Id,mergeRanges:Jo,rangesOverlap:pd,remove:function(h){return new qo({remove:h})},replacePrefix:function(h,p){return new qo({replacePrefix:[h,p]})}}),{default:Ss}),Ss})})(Wl)),Wl.exports}var Kz=qz();const jl=jz(Kz),em=Symbol.for("Dexie"),mu=globalThis[em]||(globalThis[em]=jl);if(jl.semVer!==mu.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${jl.semVer} and ${mu.semVer}`);const{liveQuery:J6,mergeRanges:tU,rangesOverlap:eU,RangeSet:nU,cmp:sU,Entity:rU,PropModification:oU,replacePrefix:aU,add:iU,remove:uU,DexieYProvider:cU}=mu;var Uz="",Gz="",Xz="",Yz="",Zz="",Qz="",Jz="",tV="",eV="",nV="",sV="",rV="",oV="",aV="",iV="",uV="",cV="",lV="",fV="",hV="",dV="",pV="",mV="",gV="",yV="",bV="",wV="",vV="",kV="",xV="",SV="",IV="",NV="",_V="",TV="",EV="",$V="",CV="",AV="",DV="",OV="",FV="",RV="",PV="",MV="",LV="",zV="",VV="",BV="",WV="",jV="",HV="",qV="",KV="",UV="",GV="",XV="",YV="",ZV="",QV="",JV="",tB="",eB="",nB="",sB="",rB="",oB="",aB="",iB="",uB="",cB="",lB="",fB="",hB="",dB="",pB="",mB="",gB="",yB="",bB="",wB="",vB="",kB="",xB="",SB="",IB="",NB="",_B="",TB="",EB="",$B="",CB="",AB="",DB="",OB="",FB="",RB="",PB="",MB="",LB="",zB="",VB="",BB="",WB="",jB="",HB="",qB="",KB="",UB="",GB="",XB="",YB="",ZB="",QB="",JB="",tW="",eW="",nW="",sW="",rW="",oW="",aW="",iW="",uW="",cW="",lW="",fW="",hW="",dW="",pW="",mW="",gW="",yW="",bW="",wW="",vW="",kW="",xW="",SW="",IW="",NW="",_W="",TW="",EW="",$W="",CW="",AW="",DW="",OW="",FW="",RW="",PW="",MW="",LW="",zW="",VW="",BW="",WW="",jW="",HW="",qW="",KW="",UW="",GW="",XW="",YW="",ZW="",QW="",JW="",t4="",e4="",n4="",s4="",r4="",o4="",a4="",i4="",u4="",c4="",l4="",f4="",h4="",d4="",p4="",m4="",g4="",y4="",b4="",w4="",v4="",k4="",x4="",S4="",I4="",N4="",_4="",T4="",E4="",$4="",C4="",A4="",D4="",O4="",F4="",R4="",P4="",M4="",L4="",z4="",V4="",B4="",W4="",j4="",H4="",q4="",K4="",U4="",G4="",X4="",Y4="",Z4="",Q4="",J4="",tj="",ej="",nj="",sj="",rj="",oj="",aj="",ij="",uj="",cj="",lj="",fj="",hj="",dj="",pj="",mj="",gj="",yj="",bj="",wj="",vj="",kj="",xj="",Sj="",Ij="",Nj="",_j="",Tj="",Ej="",$j="",Cj="",Aj="",Dj="",Oj="",Fj="",Rj="",Pj="",Mj="",Lj="",zj="",Vj="",Bj="",Wj="",jj="",Hj="",qj="",Kj="",Uj="",Gj="",Xj="",Yj="",Zj="",Qj="",Jj="",tH="",eH="",nH="",sH="",rH="",oH="",aH="",iH="",uH="",cH="",lH="",fH="",hH="",dH="",pH="",mH="",gH="",yH="",bH="",wH="",vH="",kH="",xH="",SH="",IH="",NH="",_H="",TH="",EH="",$H="",CH="",AH="",DH="",OH="",FH="",RH="",PH="",MH="",LH="",zH="",VH="",BH="",WH="",jH="",HH="",qH="",KH="",UH="",GH="",XH="",YH="",ZH="",QH="",JH="",tq="",eq="",nq="",sq="",rq="",oq="",aq="",iq="",uq="",cq="",lq="",fq="",hq="",dq="",pq="",mq="",gq="",yq="",bq="",wq="",vq="",kq="",xq="",Sq="",Iq="",Nq="",_q="",Tq="",Eq="",$q="",Cq="",Aq="",Dq="",Oq="",Fq="",Rq="",Pq="",Mq="",Lq="",zq="",Vq="",Bq="",Wq="",jq="",Hq="",qq="",Kq="",Uq="",Gq="",Xq="",Yq="",Zq="",Qq="",Jq="",tK="",eK="",nK="",sK="",rK="",oK="",aK="",iK="",uK="",cK="",lK="",fK="",hK="",dK="",pK="",mK="",gK="",yK="",bK="",wK={a:Uz,e:Gz,ai:Xz,ei:Yz,xi:Zz,yi:Qz,an:Jz,han:tV,ang:eV,ao:nV,wa:sV,yu:rV,niu:oV,o:aV,ba:iV,pa:uV,pi:cV,bi:lV,bai:fV,bo:hV,bei:dV,ban:pV,pan:mV,bin:gV,bang:yV,pang:bV,beng:wV,bao:vV,bu:kV,pu:xV,mian:SV,po:IV,fan:NV,fu:_V,ben:TV,feng:EV,bian:$V,pian:CV,zhen:AV,biao:DV,piao:OV,huo:FV,bie:RV,min:PV,fen:MV,bing:LV,geng:zV,fang:VV,xian:BV,fou:WV,ca:jV,cha:HV,cai:qV,can:KV,shen:UV,cen:GV,san:XV,cang:YV,zang:ZV,chen:QV,cao:JV,ce:tB,ze:eB,zhai:nB,dao:sB,ceng:rB,zha:oB,chai:aB,ci:iB,zi:uB,cuo:cB,chan:lB,shan:fB,zhan:hB,xin:dB,lian:pB,chang:mB,zhang:gB,chao:yB,zhao:bB,zhou:wB,che:vB,ju:kB,cheng:xB,rong:SB,sheng:IB,deng:NB,zhi:_B,zheng:TB,tang:EB,chi:$B,shi:CB,qi:AB,chuai:DB,tuo:OB,duo:FB,xue:RB,chong:PB,chou:MB,qiu:LB,xiu:zB,chu:VB,tuan:BB,zhui:WB,chuan:jB,zhuan:HB,yuan:qB,cuan:KB,chuang:UB,zhuang:GB,chui:XB,chun:YB,zhun:ZB,cu:QB,dun:JB,qu:tW,xu:eW,chuo:nW,zu:sW,ji:rW,cong:oW,zong:aW,cou:iW,cui:uW,wei:cW,cun:lW,zuo:fW,zuan:hW,da:dW,dai:pW,tai:mW,ta:gW,dan:yW,lu:bW,tan:wW,ren:vW,jie:kW,yan:xW,dang:SW,tao:IW,tiao:NW,te:_W,de:TW,dei:EW,di:$W,ti:CW,tui:AW,you:DW,dian:OW,tian:FW,zhu:RW,nian:PW,diao:MW,yao:LW,die:zW,she:VW,ye:BW,xie:WW,zhe:jW,ding:HW,diu:qW,ting:KW,dong:UW,tong:GW,zhong:XW,dou:YW,du:ZW,duan:QW,dui:JW,rui:t4,yue:e4,tun:n4,hui:s4,wu:r4,ya:o4,he:a4,wo:i4,en:u4,n:c4,er:l4,fa:f4,quan:h4,fei:d4,pei:p4,ping:m4,fo:g4,hu:y4,ga:b4,ge:w4,ha:v4,xia:k4,gai:x4,hai:S4,gan:I4,gang:N4,jiang:_4,hang:T4,gong:E4,hong:$4,guang:C4,qiong:A4,gao:D4,hao:O4,li:F4,jia:R4,luo:P4,ke:M4,qia:L4,gei:z4,gen:V4,hen:B4,gou:W4,kou:j4,gu:H4,pai:q4,gua:K4,tou:U4,guai:G4,kuai:X4,guan:Y4,wan:Z4,ne:Q4,gui:J4,jun:tj,jiong:ej,jue:nj,gun:sj,hun:rj,guo:oj,hei:aj,kan:ij,heng:uj,mo:cj,peng:lj,hou:fj,hua:hj,huai:dj,huan:pj,xun:mj,huang:gj,nai:yj,luan:bj,qie:wj,jian:vj,nan:kj,qian:xj,qiang:Sj,xiang:Ij,jiao:Nj,zhuo:_j,qiao:Tj,xiao:Ej,si:$j,kai:Cj,jin:Aj,qin:Dj,jing:Oj,ying:Fj,jiu:Rj,zui:Pj,juan:Mj,suan:Lj,yun:zj,qun:Vj,ka:Bj,kang:Wj,keng:jj,kao:Hj,ken:qj,yin:Kj,kong:Uj,ku:Gj,kua:Xj,kui:Yj,kuan:Zj,kuang:Qj,que:Jj,kun:tH,kuo:eH,la:nH,lai:sH,lan:rH,lin:oH,lang:aH,liang:iH,lao:uH,mu:cH,le:lH,lei:fH,sui:hH,lie:dH,leng:pH,ling:mH,lia:gH,liao:yH,liu:bH,lun:wH,lv:vH,lou:kH,mao:xH,long:SH,nong:IH,shuang:NH,shu:_H,shuai:TH,lve:EH,ma:$H,me:CH,mai:AH,man:DH,mi:OH,men:FH,mang:RH,meng:PH,miao:MH,mou:LH,miu:zH,mei:VH,wen:BH,mie:WH,ming:jH,na:HH,nei:qH,nuo:KH,ruo:UH,nang:GH,nao:XH,ni:YH,nen:ZH,neng:QH,nin:JH,niao:tq,nie:eq,niang:nq,ning:sq,nu:rq,nv:oq,ru:aq,nuan:iq,nve:uq,re:cq,ou:lq,pao:fq,pou:hq,pen:dq,pie:pq,pin:mq,se:gq,qing:yq,zan:bq,shao:wq,sao:vq,sha:kq,xuan:xq,ran:Sq,rang:Iq,rao:Nq,reng:_q,ri:Tq,rou:Eq,ruan:$q,run:Cq,sa:Aq,suo:Dq,sai:Oq,shui:Fq,sang:Rq,sen:Pq,seng:Mq,shai:Lq,shang:zq,xing:Vq,shou:Bq,shuo:Wq,su:jq,shua:Hq,shuan:qq,shun:Kq,song:Uq,sou:Gq,sun:Xq,teng:Yq,tie:Zq,tu:Qq,wai:Jq,wang:tK,weng:eK,zhua:nK,yang:sK,xiong:rK,yo:oK,yong:aK,za:iK,zai:uK,zao:cK,zei:lK,zen:fK,zeng:hK,zhei:dK,zou:pK,zhuai:mK,zun:gK,dia:yK,nou:bK};const vK=5;var kK=class{constructor(){nn(this,"currentInput",""),nn(this,"candidates",[]),nn(this,"db"),nn(this,"pinyinDict",wK),nn(this,"pinyinCharTable"),nn(this,"initializationPromise"),this.db=new mu("PinyinCharDB"),this.db.version(1).stores({pinyinCharEntries:"++id, &[pinyin+char], pinyin, char, weight"}),this.pinyinCharTable=this.db.table("pinyinCharEntries"),this.initializationPromise=this.initializeDatabase()}async initializeDatabase(){try{if(await this.pinyinCharTable.count()===0){const e=[];for(const[t,n]of Object.entries(this.pinyinDict))for(const s of n.split(""))e.push({pinyin:t,char:s,weight:1});await this.pinyinCharTable.bulkAdd(e)}}catch(e){throw console.error(" PinyinCharDB :",e),e}}async processInput(e){if(await this.initializationPromise,this.currentInput=e.toLowerCase(),this.candidates=[],!this.currentInput)return[];const t=await this.pinyinCharTable.where("pinyin").startsWith(this.currentInput).toArray(),n=(s,r)=>{const o=s.pinyin===r,a=s.weight>1;return o&&a?1:!o&&a?2:o&&!a?3:!o&&!a?4:5};return t.sort((s,r)=>{const o=n(s,this.currentInput),a=n(r,this.currentInput);return o!==a?o-a:r.weight!==s.weight?r.weight-s.weight:s.id-r.id}),this.candidates=t.map(s=>s.char),this.candidates=[...new Set(this.candidates)],this.candidates}async selectCandidate(e){var t,n,s;if(await this.initializationPromise,!this.currentInput)return;let r=this.currentInput;for(const a of Object.keys(this.pinyinDict))if(a.startsWith(this.currentInput)&&this.pinyinDict[a].includes(e))if(a.length>r.length||a===this.currentInput){if(r=a,(t=this.pinyinDict[this.currentInput])!=null&&t.includes(e)&&this.currentInput===a)break}else r===this.currentInput&&(n=this.pinyinDict[a])!=null&&n.includes(e)&&(r=a);if(!((s=this.pinyinDict[r])!=null&&s.includes(e))){for(const a of Object.keys(this.pinyinDict))if(this.pinyinDict[a].includes(e)){if(a.startsWith(this.currentInput)){r=a;break}r===this.currentInput&&(r=a)}}const o=await this.pinyinCharTable.where({pinyin:r,char:e}).first();if(o&&o.id!==void 0){const a=Math.min((o.weight||0)+1,vK);await this.pinyinCharTable.update(o.id,{weight:a})}else this.pinyinDict[r]?await this.pinyinCharTable.add({pinyin:r,char:e,weight:1}):console.warn(` ${e}  ${r} `);this.clear()}clear(){this.currentInput="",this.candidates=[]}getCurrentInput(){return this.currentInput}getCandidates(){return this.candidates}},xK=class{constructor(e,t={}){nn(this,"canvas"),nn(this,"ctx"),nn(this,"lastX",0),nn(this,"lastY",0),nn(this,"strokeData",[]),nn(this,"clearTimerId",null),nn(this,"isDrawing",!1),nn(this,"options"),nn(this,"handleStart",s=>{s.preventDefault(),this.isDrawing=!0;const{offsetX:r,offsetY:o}=this.getEventCoordinates(s);this.startDrawing(r,o),this.resetClearTimer()}),nn(this,"handleMove",s=>{if(!this.isDrawing)return;s.preventDefault();const{offsetX:r,offsetY:o}=this.getEventCoordinates(s);this.draw(r,o),this.resetClearTimer()}),nn(this,"handleEnd",s=>{this.isDrawing&&(s.preventDefault(),this.isDrawing=!1,this.endStroke(),this.startClearTimer(),this.options.onDrawEnd&&this.options.onDrawEnd())}),this.canvas=e,this.options={clearDelay:1e3,...t};const n=this.canvas.getContext("2d");if(!n)throw new Error("Failed to get 2D rendering context");this.ctx=n,this.setupCanvas(),this.attachEvents()}setupCanvas(){this.ctx.lineJoin="round",this.ctx.lineCap="round",this.ctx.lineWidth=3,this.ctx.strokeStyle="#000",this.clearCanvas(),this.drawGrid()}drawGrid(){const e=this.canvas.width,t=this.canvas.height;this.ctx.save(),this.ctx.strokeStyle="#ddd",this.ctx.lineWidth=1,this.ctx.setLineDash([3,3]),this.ctx.beginPath(),this.ctx.moveTo(0,t/2),this.ctx.lineTo(e,t/2),this.ctx.moveTo(e/2,0),this.ctx.lineTo(e/2,t),this.ctx.stroke(),this.ctx.setLineDash([]),this.ctx.beginPath(),this.ctx.rect(0,0,e,t),this.ctx.stroke(),this.ctx.restore()}clearCanvas(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.drawGrid(),this.strokeData=[],this.resetClearTimer()}startDrawing(e,t){this.lastX=e,this.lastY=t,this.ctx.strokeStyle="#000",this.ctx.lineWidth=3,this.ctx.setLineDash([]),this.strokeData.push(e,t,0)}draw(e,t){this.ctx.beginPath(),this.ctx.moveTo(this.lastX,this.lastY),this.ctx.lineTo(e,t),this.ctx.stroke(),this.lastX=e,this.lastY=t,this.strokeData.push(e,t,0)}endStroke(){this.strokeData.length>=3&&(this.strokeData[this.strokeData.length-1]=1)}getStrokeData(){return this.strokeData}resetClearTimer(){this.clearTimerId&&(window.clearTimeout(this.clearTimerId),this.clearTimerId=null)}startClearTimer(){this.resetClearTimer(),this.clearTimerId=window.setTimeout(()=>{this.clearCanvas(),this.clearTimerId=null},this.options.clearDelay)}getEventCoordinates(e){if(e instanceof MouseEvent)return{offsetX:e.offsetX,offsetY:e.offsetY};{const t=e.touches[0]||e.changedTouches[0],n=e.target.getBoundingClientRect();return{offsetX:t.clientX-n.left,offsetY:t.clientY-n.top}}}attachEvents(){this.canvas.addEventListener("mousedown",this.handleStart),this.canvas.addEventListener("mousemove",this.handleMove),this.canvas.addEventListener("mouseup",this.handleEnd),this.canvas.addEventListener("mouseleave",this.handleEnd),this.canvas.addEventListener("touchstart",this.handleStart,{passive:!1}),this.canvas.addEventListener("touchmove",this.handleMove,{passive:!1}),this.canvas.addEventListener("touchend",this.handleEnd),this.canvas.addEventListener("touchcancel",this.handleEnd)}detachEvents(){this.canvas.removeEventListener("mousedown",this.handleStart),this.canvas.removeEventListener("mousemove",this.handleMove),this.canvas.removeEventListener("mouseup",this.handleEnd),this.canvas.removeEventListener("mouseleave",this.handleEnd),this.canvas.removeEventListener("touchstart",this.handleStart),this.canvas.removeEventListener("touchmove",this.handleMove),this.canvas.removeEventListener("touchend",this.handleEnd),this.canvas.removeEventListener("touchcancel",this.handleEnd)}destroy(){this.detachEvents(),this.resetClearTimer()}getCanvas(){return this.canvas}getContext(){return this.ctx}};function SK(e,t,n){if(!e||!t||n==="static")return null;let s,r;if(n==="bottom")s=window.innerHeight-t.offsetHeight,r=0;else{const o=e.getBoundingClientRect(),a=t.offsetWidth;s=o.bottom+window.scrollY,r=o.left+window.scrollX+o.width/2-a/2;const i=window.innerWidth;r+a>i&&(r=i-a-10),r<10&&(r=10)}return{top:`${s}px`,left:`${r}px`}}function nm(e){if(!e)return!1;if(e.tagName==="TEXTAREA")return!0;if(e.tagName==="INPUT"){const t=(e.type||"text").toLowerCase();return!["checkbox","radio","button","submit","reset","file","image","range","color","hidden","date","datetime-local","month","week","time"].includes(t)}return!1}function IK(e,t,n){e.value=t,EK(e,n),e.dispatchEvent(new Event("input",{bubbles:!0}))}function NK(e,t,n,s=""){return e.slice(0,t)+s+e.slice(t+n)}function lw(e,t=""){const n=Number(e.getAttribute("maxlength"));let s=e.selectionStart??0;const r=e.selectionEnd??s;let o;if(t.length>0)o=r-s;else{const u=r-s;if(u>0)o=u;else if(s>0)o=1,s--;else return}if(t.length>0&&n&&e.value.length-o+t.length>n)return;const a=NK(e.value,s,o,t),i=s+t.length;IK(e,a,i)}function _K(e,t){lw(e,t)}function TK(e){lw(e)}function EK(e,t){e.selectionStart=t,e.selectionEnd=t}function Gu(e={}){const t=e.delay??400,n=e.interval??60;let s,r;function o(){s&&(clearTimeout(s),s=void 0),r&&(clearInterval(r),r=void 0)}function a(i){o(),i(),s=setTimeout(()=>{r=setInterval(()=>{i()},n)},t)}return{start:a,stop:o}}let fw=null;function $K(e){fw=e}function Hl(){return fw}function CK(e=!1){const t=Se(!1),n=Se(0);async function s(){const o=Hl();if(o)try{t.value=await o.initialize({onProgress:a=>{n.value=a}})}catch(a){console.error(":",a),t.value=!1}else console.warn(""),t.value=!1}async function r(){const o=Hl();if(o&&t.value)try{await o.close(),t.value=!1}catch(a){console.error(":",a)}}return Ua(()=>{e&&s()}),Wu(()=>{r()}),{recognizerInitialized:t,recognizerProgress:n}}const qh="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M21,11H6.83L10.41,7.41L9,6L3,12L9,18L10.41,16.58L6.83,13H21V11Z'%20/%3e%3c/svg%3e",Kh="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M19,7V11H5.83L9.41,7.41L8,6L2,12L8,18L9.41,16.58L5.83,13H21V7H19Z'%20/%3e%3c/svg%3e",AK={class:"zhk-candidate-list"},DK=["onClick"],hw=Hs({__name:"CandidateList",props:{candidates:{}},emits:["select"],setup(e,{emit:t}){const n=t;function s(r){n("select",r)}return(r,o)=>(Yt(),se("div",AK,[(Yt(!0),se(Oe,null,ms(e.candidates,(a,i)=>(Yt(),se("button",{key:`candidate-${i}`,class:"zhk-candidate-list__item",onClick:u=>s(a)},hn(a),9,DK))),128))]))}}),OK={class:"handwriting-input"},FK={class:"handwriting-buttons"},RK={class:"handwriting-canvas-container"},PK={class:"progress-bar"},MK={class:"progress-text"},LK=["width","height"],zK={class:"handwriting-buttons"},VK=Hs({__name:"HandwritingInput",props:{recognizerInitialized:{type:Boolean},recognizerProgress:{}},emits:["key","exit"],setup(e,{emit:t}){const n=e,s=t,r=Se(null),o=Se(null);let a=null;const i=Se(!1),{height:u}=cw(o);function c(){a&&a.clearCanvas()}function l(){r.value&&(a&&a.destroy(),a=new xK(r.value,{onDrawEnd:y}))}const f=Se([]),d=Gu();function m(I,_){var N,C;I.preventDefault(),(C=(N=I.currentTarget)==null?void 0:N.setPointerCapture)==null||C.call(N,I.pointerId),d.start(_)}function g(){d.stop()}function b(I,_){I.preventDefault(),_()}async function y(){if(!a||a.getStrokeData().length===0||i.value)return;const I=Hl();if(I){i.value=!0;try{const _=[...a.getStrokeData()],N=await I.recognize(_);f.value=N}catch(_){console.error(":",_)}finally{i.value=!1}}else console.warn("")}Wu(()=>{a&&a.destroy(),d.stop()}),Lu(()=>{r.value&&u.value&&n.recognizerInitialized&&Pa(()=>{l()})});function v(I){s("key",{key:I}),f.value=[],c()}return(I,_)=>(Yt(),se("div",OK,[Hn(hw,{candidates:f.value,onSelect:v},null,8,["candidates"]),It("div",{ref_key:"containerRef",ref:o,class:"handwriting-content"},[It("div",FK,[It("button",{class:"handwriting-btn handwriting-btn--function",onPointerdown:_[0]||(_[0]=N=>m(N,()=>s("key",{key:""}))),onPointerup:g,onPointerleave:g,onPointercancel:g,onContextmenu:_[1]||(_[1]=ve(()=>{},["prevent"]))},"  ",32),It("button",{class:"handwriting-btn handwriting-btn--function",onPointerdown:_[2]||(_[2]=N=>m(N,()=>s("key",{key:""}))),onPointerup:g,onPointerleave:g,onPointercancel:g,onContextmenu:_[3]||(_[3]=ve(()=>{},["prevent"]))},"  ",32),It("button",{class:"handwriting-btn handwriting-btn--function",onPointerdown:_[4]||(_[4]=N=>m(N,()=>s("key",{key:""}))),onPointerup:g,onPointerleave:g,onPointercancel:g,onContextmenu:_[5]||(_[5]=ve(()=>{},["prevent"]))},"  ",32),It("button",{class:"handwriting-btn handwriting-btn--function",onPointerdown:_[6]||(_[6]=N=>m(N,()=>s("key",{key:""}))),onPointerup:g,onPointerleave:g,onPointercancel:g,onContextmenu:_[7]||(_[7]=ve(()=>{},["prevent"]))},"  ",32)]),It("div",RK,[e.recognizerInitialized?(Yt(),se("canvas",{key:1,ref_key:"canvasRef",ref:r,class:"handwriting-canvas",width:Cn(u),height:Cn(u)},null,8,LK)):(Yt(),se("div",{key:0,class:"handwriting-loading",style:Ro({width:`${Cn(u)}px`,height:`${Cn(u)}px`})},[_[16]||(_[16]=It("div",{class:"loading-text"}," ... ",-1)),It("div",PK,[It("div",{class:"progress-fill",style:Ro({width:`${e.recognizerProgress*100}%`})},null,4)]),It("div",MK,hn(Math.round(e.recognizerProgress*100))+"% ",1)],4))]),It("div",zK,[It("button",{class:"handwriting-btn handwriting-btn--function",onPointerdown:_[8]||(_[8]=N=>m(N,()=>s("key",{key:"delete",isControl:!0}))),onPointerup:g,onPointerleave:g,onPointercancel:g,onContextmenu:_[9]||(_[9]=ve(()=>{},["prevent"]))},[..._[17]||(_[17]=[It("img",{src:qh,alt:""},null,-1)])],32),It("button",{class:"handwriting-btn handwriting-btn--function",onPointerdown:_[10]||(_[10]=N=>b(N,()=>s("exit"))),onContextmenu:_[11]||(_[11]=ve(()=>{},["prevent"]))},"  ",32),It("button",{class:"handwriting-btn handwriting-btn--function",onPointerdown:_[12]||(_[12]=N=>m(N,()=>s("key",{key:""}))),onPointerup:g,onPointerleave:g,onPointercancel:g,onContextmenu:_[13]||(_[13]=ve(()=>{},["prevent"]))},"  ",32),It("button",{class:"handwriting-btn handwriting-btn--function",onPointerdown:_[14]||(_[14]=N=>m(N,()=>s("key",{key:"enter",isControl:!0}))),onPointerup:g,onPointerleave:g,onPointercancel:g,onContextmenu:_[15]||(_[15]=ve(()=>{},["prevent"]))},[..._[18]||(_[18]=[It("img",{src:Kh,alt:""},null,-1)])],32)])],512)]))}}),BK="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M6,18H18V16H6M12,8.41L16.59,13L18,11.58L12,5.58L6,11.58L7.41,13L12,8.41Z'%20/%3e%3c/svg%3e",dw="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M3%2015H5V19H19V15H21V19C21%2020.1%2020.1%2021%2019%2021H5C3.9%2021%203%2020.1%203%2019V15Z'%20/%3e%3c/svg%3e",WK="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z'%20/%3e%3c/svg%3e",jK={class:"zhk-selection"},HK={class:"zhk-selection__list"},qK=["onClick"],KK=Hs({__name:"CandidateSelection",props:{candidates:{}},emits:["select","close"],setup(e,{emit:t}){const n=t;function s(o){n("select",o)}function r(){n("close")}return(o,a)=>(Yt(),se("div",jK,[It("div",HK,[(Yt(!0),se(Oe,null,ms(e.candidates,(i,u)=>(Yt(),se("div",{key:u,class:"zhk-selection__text",onClick:c=>s(i)},hn(i),9,qK))),128))]),It("div",{class:"zhk-selection__func"},[It("button",{class:"zhk-selection__func-btn",onClick:r},"  ")])]))}}),UK={class:"zhk-candidate"},GK={class:"zhk-candidate__container"},XK={key:0,class:"zhk-candidate__pinyin"},YK={class:"zhk-candidate__bottom-container"},ZK=Hs({__name:"CandidateBar",props:{modelValue:{required:!0},modelModifiers:{}},emits:Rl(["key","input"],["update:modelValue"]),setup(e,{emit:t}){const n=t,s=P0(e,"modelValue"),r=new kK,o=Se([]);Lu(async()=>{o.value=await r.processInput(s.value)});const a=kn(()=>o.value.slice(0,30)),i=Se(!1);function u(c){r.selectCandidate(c),n("input",c),s.value="",i.value=!1}return(c,l)=>(Yt(),se("div",UK,[It("div",GK,[s.value?(Yt(),se("div",XK,hn(s.value),1)):Vr("",!0),It("div",YK,[o.value.length>0?(Yt(),sr(hw,{key:0,candidates:a.value,onSelect:u},null,8,["candidates"])):Vr("",!0),o.value.length>0?(Yt(),se("button",{key:1,class:"zhk-candidate__more",onClick:l[0]||(l[0]=f=>i.value=!0)},[...l[2]||(l[2]=[It("img",{src:WK,alt:""},null,-1)])])):Vr("",!0)])]),as(Hn(KK,{candidates:o.value,onSelect:u,onClose:l[1]||(l[1]=f=>i.value=!1)},null,8,["candidates"]),[[ow,i.value]])]))}}),QK={class:"zhk-base"},JK={class:"zhk-base__row"},t6=["onPointerdown"],e6=["disabled"],n6={key:1,src:BK,class:"zhk-base__key-icon",alt:"Shift"},s6=["onPointerdown"],r6={class:"zhk-base__row"},o6={class:"zhk-base__toggle-main"},a6={class:"zhk-base__toggle-sub"},i6=Hs({__name:"KeyboardBase",props:Rl({enableHandwriting:{type:Boolean}},{modelValue:{default:"en"},modelModifiers:{}}),emits:Rl(["key"],["update:modelValue"]),setup(e,{emit:t}){const n=e,s=t,r=P0(e,"modelValue"),o=Se(!1),a=kn(()=>r.value==="zh"),i=kn(()=>a.value?!0:o.value);function u(z,P=!1){s("key",{key:z,isControl:P})}function c(){a.value?r.value="hand":o.value=!o.value}function l(){r.value="num"}function f(){r.value="symbol"}const d=["1","2","3","4","5","6","7","8","9","0"],m=[["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l"],["z","x","c","v","b","n","m"]],g=Se(""),b=Gu();function y(z,P){var D,L;z.preventDefault(),(L=(D=z.currentTarget)==null?void 0:D.setPointerCapture)==null||L.call(D,z.pointerId),b.start(P)}function v(){b.stop()}Bu(()=>{b.stop()});function I(){if(r.value==="zh"&&g.value){g.value=g.value.slice(0,-1);return}u("delete",!0)}function _(z){if(r.value==="zh"){g.value+=z;return}const P=o.value?z.toUpperCase():z;u(P)}function N(){r.value=r.value==="zh"?"en":"zh"}const C=kn(()=>n.enableHandwriting?"":"-"),F=kn(()=>!n.enableHandwriting);return(z,P)=>(Yt(),se("div",QK,[It("div",JK,[r.value==="zh"?(Yt(),sr(ZK,{key:0,modelValue:g.value,"onUpdate:modelValue":P[0]||(P[0]=D=>g.value=D),onInput:P[1]||(P[1]=D=>u(D,!1))},null,8,["modelValue"])):(Yt(),se(Oe,{key:1},ms(d,(D,L)=>It("button",{key:`number-${L}`,class:"zhk-base__key zhk-base__key--letter",onPointerdown:T=>y(T,()=>_(D)),onPointerup:v,onPointerleave:v,onPointercancel:v,onContextmenu:P[2]||(P[2]=ve(()=>{},["prevent"]))},hn(D),41,t6)),64))]),(Yt(),se(Oe,null,ms(m,(D,L)=>It("div",{key:`row-${L}`,class:"zhk-base__row"},[L===2?(Yt(),se("button",{key:0,class:cr(["zhk-base__key zhk-base__key--function zhk-base__key--shift",{"zhk-base__key--active":!a.value&&o.value,"zhk-base__key--disabled":a.value&&F.value}]),disabled:a.value&&F.value,onClick:c,onContextmenu:P[3]||(P[3]=ve(()=>{},["prevent"]))},[a.value?(Yt(),se(Oe,{key:0},[fu(hn(C.value),1)],64)):(Yt(),se("img",n6))],42,e6)):Vr("",!0),(Yt(!0),se(Oe,null,ms(D,(T,K)=>(Yt(),se("button",{key:`key-${L}-${K}`,class:"zhk-base__key zhk-base__key--letter",onPointerdown:Z=>y(Z,()=>_(T)),onPointerup:v,onPointerleave:v,onPointercancel:v,onContextmenu:P[4]||(P[4]=ve(()=>{},["prevent"]))},hn(i.value?T.toUpperCase():T),41,s6))),128)),L===2?(Yt(),se("button",{key:1,class:"zhk-base__key zhk-base__key--function zhk-base__key--delete",onPointerdown:P[5]||(P[5]=T=>y(T,()=>I())),onPointerup:v,onPointerleave:v,onPointercancel:v,onContextmenu:P[6]||(P[6]=ve(()=>{},["prevent"]))},[...P[18]||(P[18]=[It("img",{src:qh,class:"zhk-base__key-icon",alt:"Delete"},null,-1)])],32)):Vr("",!0)])),64)),It("div",r6,[It("button",{class:"zhk-base__key zhk-base__key--function",onClick:f,onContextmenu:P[7]||(P[7]=ve(()=>{},["prevent"]))},"  ",32),It("button",{class:"zhk-base__key zhk-base__key--function",onClick:l,onContextmenu:P[8]||(P[8]=ve(()=>{},["prevent"]))}," 123 ",32),It("button",{class:"zhk-base__key",onPointerdown:P[9]||(P[9]=D=>y(D,()=>u(","))),onPointerup:v,onPointerleave:v,onPointercancel:v,onContextmenu:P[10]||(P[10]=ve(()=>{},["prevent"]))},"  ",32),It("button",{class:"zhk-base__key zhk-base__key--space",onPointerdown:P[11]||(P[11]=D=>y(D,()=>u(" "))),onPointerup:v,onPointerleave:v,onPointercancel:v,onContextmenu:P[12]||(P[12]=ve(()=>{},["prevent"]))},[...P[19]||(P[19]=[It("img",{src:dw,class:"zhk-base__key-icon",alt:"Space"},null,-1)])],32),It("button",{class:"zhk-base__key",onPointerdown:P[13]||(P[13]=D=>y(D,()=>u(""))),onPointerup:v,onPointerleave:v,onPointercancel:v,onContextmenu:P[14]||(P[14]=ve(()=>{},["prevent"]))},"  ",32),It("button",{class:"zhk-base__key zhk-base__key--function",onClick:N,onContextmenu:P[15]||(P[15]=ve(()=>{},["prevent"]))},[It("span",o6,hn(r.value==="zh"?"":""),1),It("span",a6,"/"+hn(r.value==="zh"?"":""),1)],32),It("button",{class:"zhk-base__key zhk-base__key--function",onPointerdown:P[16]||(P[16]=D=>y(D,()=>u("enter",!0))),onPointerup:v,onPointerleave:v,onPointercancel:v,onContextmenu:P[17]||(P[17]=ve(()=>{},["prevent"]))},[...P[20]||(P[20]=[It("img",{src:Kh,class:"zhk-base__key-icon",alt:"Enter"},null,-1)])],32)])]))}}),u6={class:"num-keyboard"},c6={class:"num-keyboard__container"},l6={class:"num-keyboard__left"},f6={class:"num-keyboard__rows"},h6=["onPointerdown"],d6={key:1,src:dw,class:"zhk-base__key-icon",alt:"Space"},p6={class:"num-keyboard__right"},m6=["onPointerdown"],g6=["src","alt"],y6={key:1},b6=Hs({__name:"NumericKeyboard",props:{keyboardRows:{default:()=>[["1","2","3"],["4","5","6"],["7","8","9"],["back","0","space"]]}},emits:["key","exit"],setup(e,{emit:t}){const n=t,s=[{key:"delete",icon:qh,text:"",alt:"Delete"},{key:".",icon:"",text:".",alt:"."},{key:"@",icon:"",text:"@",alt:"@"},{key:"enter",icon:Kh,text:"",alt:"Enter"}];function r(g){n("key",{key:g})}function o(g,b=!0){n("key",{key:g,isControl:b})}function a(){n("exit")}const i=Gu();function u(g,b){var y,v;g.preventDefault(),(v=(y=g.currentTarget)==null?void 0:y.setPointerCapture)==null||v.call(y,g.pointerId),i.start(b)}function c(){i.stop()}Bu(()=>{i.stop()});function l(g,b){g.preventDefault(),b()}function f(g){return g==="back"?()=>a():g==="space"?()=>r(" "):()=>r(g)}function d(g,b){const y=f(g);if(g==="back"){l(b,y);return}u(b,y)}function m(g,b){if(g==="."||g==="@"){u(b,()=>r(g));return}u(b,()=>o(g))}return(g,b)=>(Yt(),se("div",u6,[It("div",c6,[It("div",l6,[It("div",f6,[(Yt(!0),se(Oe,null,ms(e.keyboardRows,(y,v)=>(Yt(),se("div",{key:`row-${v}`,class:"num-keyboard__row"},[(Yt(!0),se(Oe,null,ms(y,(I,_)=>(Yt(),se("button",{key:`key-${v}-${_}`,class:cr(["num-keyboard__key",{"num-keyboard__key--back":I==="back","num-keyboard__key--space":I==="space"}]),onPointerdown:N=>d(I,N),onPointerup:c,onPointerleave:c,onPointercancel:c,onContextmenu:b[0]||(b[0]=ve(()=>{},["prevent"]))},[I==="back"?(Yt(),se(Oe,{key:0},[fu("  ")],64)):I==="space"?(Yt(),se("img",d6)):(Yt(),se(Oe,{key:2},[fu(hn(I),1)],64))],42,h6))),128))]))),128))])]),It("div",p6,[(Yt(),se(Oe,null,ms(s,(y,v)=>It("button",{key:`func-${v}`,class:"num-keyboard__key num-keyboard__key--function",onPointerdown:I=>m(y.key,I),onPointerup:c,onPointerleave:c,onPointercancel:c,onContextmenu:b[1]||(b[1]=ve(()=>{},["prevent"]))},[y.icon?(Yt(),se("img",{key:0,src:y.icon,class:"num-keyboard__key-icon",alt:y.alt},null,8,g6)):(Yt(),se("span",y6,hn(y.text),1))],40,m6)),64))])])]))}}),w6="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M18,20V10H6V20H18M18,8A2,2%200%200,1%2020,10V20A2,2%200%200,1%2018,22H6C4.89,22%204,21.1%204,20V10A2,2%200%200,1%206,8H15V6A3,3%200%200,0%2012,3A3,3%200%200,0%209,6H7A5,5%200%200,1%2012,1A5,5%200%200,1%2017,6V8H18M12,17A2,2%200%200,1%2010,15A2,2%200%200,1%2012,13A2,2%200%200,1%2014,15A2,2%200%200,1%2012,17Z'%20/%3e%3c/svg%3e",v6="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%3e%3cpath%20d='M12,17C10.89,17%2010,16.1%2010,15C10,13.89%2010.89,13%2012,13A2,2%200%200,1%2014,15A2,2%200%200,1%2012,17M18,20V10H6V20H18M18,8A2,2%200%200,1%2020,10V20A2,2%200%200,1%2018,22H6C4.89,22%204,21.1%204,20V10C4,8.89%204.89,8%206,8H7V6A5,5%200%200,1%2012,1A5,5%200%200,1%2017,6V8H18M12,3A3,3%200%200,0%209,6V8H15V6A3,3%200%200,0%2012,3Z'%20/%3e%3c/svg%3e",k6={class:"symbol-keyboard"},x6={class:"symbol-keyboard__content"},S6={class:"symbol-keyboard__functions"},I6={class:"symbol-keyboard__lang-selector"},N6={class:"symbol-keyboard__control-group"},_6=["src"],T6=["src"],E6={class:"symbol-keyboard__symbols-container"},$6={class:"symbol-keyboard__symbols-grid"},C6=["onPointerdown"],A6="!@#$%^&*(){}[]<>/\\|:;\"',.?+-=_~`",D6="",O6=Hs({__name:"SymbolKeyboard",emits:["key","exit"],setup(e,{emit:t}){const n=t,s=Se("en"),r=kn(()=>s.value==="zh"?D6:A6),o=Se(!1),a=Gu();function i(g,b){var y,v;g.preventDefault(),(v=(y=g.currentTarget)==null?void 0:y.setPointerCapture)==null||v.call(y,g.pointerId),a.start(b)}function u(){a.stop()}Bu(()=>{a.stop()});function c(g,b){if(!o.value){b.preventDefault(),l(g);return}i(b,()=>l(g))}function l(g){n("key",{key:g}),o.value||n("exit")}function f(){n("exit")}function d(g){s.value=g}function m(){o.value=!o.value}return(g,b)=>(Yt(),se("div",k6,[It("div",x6,[It("div",S6,[It("div",I6,[It("button",{class:cr(["symbol-keyboard__lang-btn",{"symbol-keyboard__lang-btn--active":s.value==="zh"}]),onClick:b[0]||(b[0]=y=>d("zh")),onContextmenu:b[1]||(b[1]=ve(()=>{},["prevent"]))},"  ",34),It("button",{class:cr(["symbol-keyboard__lang-btn",{"symbol-keyboard__lang-btn--active":s.value==="en"}]),onClick:b[2]||(b[2]=y=>d("en")),onContextmenu:b[3]||(b[3]=ve(()=>{},["prevent"]))},"  ",34)]),It("div",N6,[It("button",{class:cr(["symbol-keyboard__key symbol-keyboard__key--function symbol-keyboard__key--lock",{"symbol-keyboard__key--locked":o.value}]),onClick:m,onContextmenu:b[4]||(b[4]=ve(()=>{},["prevent"]))},[o.value?(Yt(),se("img",{key:1,src:Cn(v6),alt:"Lock closed"},null,8,T6)):(Yt(),se("img",{key:0,src:Cn(w6),alt:"Lock open"},null,8,_6))],34),It("button",{class:"symbol-keyboard__key symbol-keyboard__key--function symbol-keyboard__key--back",onClick:f,onContextmenu:b[5]||(b[5]=ve(()=>{},["prevent"]))},"  ",32)])]),It("div",E6,[It("div",$6,[(Yt(!0),se(Oe,null,ms(r.value,(y,v)=>(Yt(),se("button",{key:`key-${v}`,class:"symbol-keyboard__key",onPointerdown:I=>c(y,I),onPointerup:u,onPointerleave:u,onPointercancel:u,onContextmenu:b[6]||(b[6]=ve(()=>{},["prevent"]))},hn(y),41,C6))),128))])])])]))}}),F6={key:0,class:"zhk__disabled-overlay"},R6=Hs({__name:"ZhKeyboard",props:{defaultMode:{default:"en"},enableHandwriting:{type:Boolean,default:!1},position:{default:"static"},disableWhenNoFocus:{type:Boolean,default:!0},numKeys:{}},emits:["key"],setup(e,{emit:t}){const n=e,s=t,r=Se(n.defaultMode||"en"),o=Se(n.defaultMode||"en"),a=Se([]),i=Se(!1),u=Se(null),c=Se(null),{recognizerInitialized:l,recognizerProgress:f}=CK(n.enableHandwriting);ps(r,(P,D)=>{P!==D&&(o.value=D)});const d=Vz(),m=kn(()=>d.value&&nm(d.value)?d.value:null),g=kn(()=>n.position==="static"||!!(d.value&&nm(d.value))),{height:b}=cw(c),y=Se(!1);Lu(()=>{if(m.value){const P=m.value.dataset.inputmode;P&&(r.value=P)}}),ps([g,m],()=>{g.value&&b.value&&Pa(()=>{I(),y.value=!0})}),ps(b,(P,D)=>{!y.value&&P&&P!==D&&Pa(()=>{I()})},{once:!0});const v=kn(()=>n.disableWhenNoFocus===!1?!1:!m.value);function I(){if(!b.value)return;const P=SK(m.value,c.value,n.position);u.value=P}const _=Fz(I,100);pu(window,"scroll",_,{passive:!0}),pu(window,"resize",_,{passive:!0});function N(P){if(P.isControl){switch(P.key){case"delete":TK(m.value);break;case"more":i.value=!0;break}return}else C(P.key);s("key",P)}function C(P){_K(m.value,P)}function F(){r.value=o.value}function z(P){a.value=P}return(P,D)=>(Yt(),sr(eL,{to:"body",disabled:e.position==="static"},[as(It("div",tw(P.$attrs,{ref_key:"keyboardRef",ref:c,class:["zhk",{"zhk--floating":e.position==="float","zhk--bottom":e.position==="bottom","zhk--disabled":v.value}],style:{"--keyboard-height":`${Cn(b)}px`,...u.value},onMousedown:D[1]||(D[1]=ve(()=>{},["prevent"]))}),[v.value||!g.value||!Cn(b)?(Yt(),se("div",F6,[...D[2]||(D[2]=[It("span",null,"",-1)])])):(Yt(),se(Oe,{key:1},[r.value==="hand"?(Yt(),sr(VK,{key:0,"recognizer-initialized":Cn(l),"recognizer-progress":Cn(f),onKey:N,onExit:F,onRecognize:z},null,8,["recognizer-initialized","recognizer-progress"])):r.value==="num"?(Yt(),sr(b6,{key:1,"keyboard-rows":e.numKeys,onKey:N,onExit:F},null,8,["keyboard-rows"])):r.value==="symbol"?(Yt(),sr(O6,{key:2,onKey:N,onExit:F})):r.value==="en"||r.value==="zh"?(Yt(),sr(i6,{key:3,modelValue:r.value,"onUpdate:modelValue":D[0]||(D[0]=L=>r.value=L),"enable-handwriting":e.enableHandwriting,onKey:N},null,8,["modelValue","enable-handwriting"])):Vr("",!0)],64))],16),[[ow,g.value]])],8,["disabled"]))}}),P6={class:"root-container"},M6={class:"container"},L6={class:"input-grid"},z6={class:"input-container"},V6={class:"input-container"},B6={class:"input-container"},W6={class:"input-container"},j6={class:"controls"},H6={class:"checkbox-container"},q6={class:"checkbox-item"},K6={class:"position-container"},U6={class:"radio-group"},G6=["id","value"],X6=["for"],Y6={class:"keyboard-wrapper"},Z6=Hs({__name:"App",setup(e){const t=Se(""),n=Se(""),s=Se(""),r=Se(""),o=Se(400),a=Se(300),i=Se("float"),u=Se(!0),c={static:"",float:"",bottom:""};return Ua(()=>{window.innerWidth<960&&(i.value="bottom")}),(l,f)=>(Yt(),se("div",P6,[It("div",M6,[f[14]||(f[14]=It("div",{class:"header"},[It("h1",null,""),It("div",{class:"github-link"},[It("a",{href:"https://github.com/dusionlike/zh-keyboard",target:"_blank",rel:"noopener noreferrer"},[It("img",{src:"https://img.shields.io/github/stars/dusionlike/zh-keyboard?style=social",alt:"GitHub stars"})])])],-1)),It("div",L6,[It("div",z6,[f[8]||(f[8]=It("label",null,":",-1)),as(It("input",{"onUpdate:modelValue":f[0]||(f[0]=d=>t.value=d),type:"text","data-inputmode":"en",inputmode:"none",placeholder:""},null,512),[[ho,t.value]])]),It("div",V6,[f[9]||(f[9]=It("label",null,":",-1)),as(It("input",{"onUpdate:modelValue":f[1]||(f[1]=d=>n.value=d),type:"text","data-inputmode":"zh",inputmode:"none",placeholder:""},null,512),[[ho,n.value]])]),It("div",B6,[f[10]||(f[10]=It("label",null,":",-1)),as(It("input",{"onUpdate:modelValue":f[2]||(f[2]=d=>s.value=d),type:"text","data-inputmode":"hand",inputmode:"none",placeholder:""},null,512),[[ho,s.value]])]),It("div",W6,[f[11]||(f[11]=It("label",null,":",-1)),as(It("input",{"onUpdate:modelValue":f[3]||(f[3]=d=>r.value=d),type:"text","data-inputmode":"num",inputmode:"none",placeholder:""},null,512),[[ho,r.value]])])]),It("div",j6,[i.value!=="bottom"?(Yt(),se(Oe,{key:0},[It("label",null,": "+hn(o.value)+"px",1),as(It("input",{"onUpdate:modelValue":f[4]||(f[4]=d=>o.value=d),type:"range",min:"400",max:"1080",step:"10",class:"width-slider"},null,512),[[ho,o.value]]),It("label",null,": "+hn(a.value)+"px",1),as(It("input",{"onUpdate:modelValue":f[5]||(f[5]=d=>a.value=d),type:"range",min:"300",max:"1000",step:"10",class:"width-slider"},null,512),[[ho,a.value]])],64)):Vr("",!0),It("div",H6,[It("div",q6,[as(It("input",{id:"disable-when-no-focus","onUpdate:modelValue":f[6]||(f[6]=d=>u.value=d),type:"checkbox"},null,512),[[gz,u.value]]),f[12]||(f[12]=It("label",{for:"disable-when-no-focus"},"",-1))])]),It("div",K6,[f[13]||(f[13]=It("label",null,":",-1)),It("div",U6,[(Yt(),se(Oe,null,ms(c,(d,m)=>It("div",{key:m,class:"radio-item"},[as(It("input",{id:`pos-${m}`,"onUpdate:modelValue":f[7]||(f[7]=g=>i.value=g),type:"radio",value:m,name:"position"},null,8,G6),[[yz,i.value]]),It("label",{for:`pos-${m}`},hn(d),9,X6)])),64))])])])]),It("div",Y6,[Hn(Cn(R6),{position:i.value,style:Ro(i.value==="bottom"?{width:"100%",height:"auto"}:{width:`${o.value}px`,height:`${a.value}px`}),"enable-handwriting":"","disable-when-no-focus":u.value},null,8,["position","style","disable-when-no-focus"])])]))}});$K(new nM({modelPath:new URL(""+new URL("../models/handwrite/model.json",import.meta.url).href,import.meta.url).href,dictPath:new URL(""+new URL("../models/dict.txt",import.meta.url).href,import.meta.url).href}));xz(Z6).mount("#app");
